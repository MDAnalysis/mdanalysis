
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>12.2.4. Neighbor search library — MDAnalysis.lib.nsgrid &#8212; MDAnalysis 0.20.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.20.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12.2.5. PeriodicKDTree — MDAnalysis.lib.pkdtree" href="pkdtree.html" />
    <link rel="prev" title="12.2.3. Neighbor Search wrapper for MDAnalysis — MDAnalysis.lib.NeighborSearch" href="NeighborSearch.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.lib.nsgrid"></span><div class="section" id="neighbor-search-library-mdanalysis-lib-nsgrid">
<h1><span class="section-number">12.2.4. </span>Neighbor search library — <a class="reference internal" href="#module-MDAnalysis.lib.nsgrid" title="MDAnalysis.lib.nsgrid"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.nsgrid</span></code></a><a class="headerlink" href="#neighbor-search-library-mdanalysis-lib-nsgrid" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about-the-code">
<h2><span class="section-number">12.2.4.1. </span>About the code<a class="headerlink" href="#about-the-code" title="Permalink to this headline">¶</a></h2>
<p>This Neighbor search library is a serialized Cython version greatly
inspired by the NS grid search implemented in
<a class="reference external" href="http://www.gromacs.org/">GROMACS</a> .</p>
<p>GROMACS 4.x code (more precisely
<a class="reference external" href="https://github.com/gromacs/gromacs/commits/master/src/mdlib/nsgrid.c">nsgrid.c</a>
and <a class="reference external" href="https://github.com/gromacs/gromacs/commits/master/src/mdlib/ns.c">ns.c</a> )
was used as reference to write this file.</p>
<p>GROMACS 4.x code is released under the GNU Public Licence v2.</p>
</div>
<div class="section" id="about-the-algorithm">
<h2><span class="section-number">12.2.4.2. </span>About the algorithm<a class="headerlink" href="#about-the-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The neighbor search implemented here is based on
<a class="reference external" href="https://en.wikipedia.org/wiki/Cell_lists">cell lists</a> which allow
computation of pairs <a class="footnote-reference brackets" href="#id2" id="id1">1</a> with a cost of <span class="math notranslate nohighlight">\(O(N)\)</span>, instead
of <span class="math notranslate nohighlight">\(O(N^2)\)</span>. The basic algorithm is described in
Appendix F,  Page 552 of
<code class="docutils literal notranslate"><span class="pre">Understanding</span> <span class="pre">Molecular</span> <span class="pre">Dynamics:</span> <span class="pre">From</span> <span class="pre">Algorithm</span> <span class="pre">to</span> <span class="pre">Applications</span></code> by Frenkel and Smit.</p>
<p>In brief, the algorithm divides the domain into smaller subdomains called <cite>cells</cite>
and distributes every particle to these cells based on their positions. Subsequently,
any distance based query first identifies the corresponding cell position in the
domain followed by distance evaluations within the identified cell and
neighboring cells only. Care must be taken to ensure that <cite>cellsize</cite> is
greater than the desired search distance, otherwise all of the neighbours might
not reflect in the results.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>a pair correspond to two particles that are considered as neighbors .</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</div>
<div class="section" id="classes">
<h2><span class="section-number">12.2.4.3. </span>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.lib.nsgrid.FastNS">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.lib.nsgrid.</code><code class="sig-name descname">FastNS</code><span class="sig-paren">(</span><em class="sig-param">cutoff</em>, <em class="sig-param">coords</em>, <em class="sig-param">box</em>, <em class="sig-param">max_gridsize=5000</em>, <em class="sig-param">pbc=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.FastNS" title="Permalink to this definition">¶</a></dt>
<dd><p>Grid based search between two group of atoms</p>
<p>Instantiates a class object which uses <code class="xref py py-class docutils literal notranslate"><span class="pre">_PBCBox</span></code> and
<code class="xref py py-class docutils literal notranslate"><span class="pre">_NSGrid</span></code> to construct a cuboidal
grid in an orthogonal brick shaped box.</p>
<p>Minimum image convention is used for distance evaluations
if pbc is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>Initialize the grid and sort the coordinates in respective
cells by shifting the coordinates in a brick shaped box.
The brick shaped box is defined by <code class="xref py py-class docutils literal notranslate"><span class="pre">_PBCBox</span></code>
and cuboidal grid is initialize by <code class="xref py py-class docutils literal notranslate"><span class="pre">_NSGrid</span></code>.
If box is supplied, periodic shifts along box vectors are used
to contain all the coordinates inside the brick shaped box.
If box is not supplied, the range of coordinates i.e.
<code class="docutils literal notranslate"><span class="pre">[xmax,</span> <span class="pre">ymax,</span> <span class="pre">zmax]</span> <span class="pre">-</span> <span class="pre">[xmin,</span> <span class="pre">ymin,</span> <span class="pre">zmin]</span></code> should be used
to construct a pseudo box. Subsequently, the origin should also be
shifted to <code class="docutils literal notranslate"><span class="pre">[xmin,</span> <span class="pre">ymin,</span> <span class="pre">zmin]</span></code>. These arguments must be provided
to the function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Desired cutoff distance</p></li>
<li><p><strong>coords</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – atom coordinates of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">3)</span></code> for <code class="docutils literal notranslate"><span class="pre">N</span></code> atoms.
<code class="docutils literal notranslate"><span class="pre">dtype=numpy.float32</span></code>. For Non-PBC calculations,
all the coords must be within the bounding box specified
by <code class="docutils literal notranslate"><span class="pre">box</span></code></p></li>
<li><p><strong>box</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Box dimension of shape (6, ). The dimensions must be
provided in the same format as returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>:
<code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. For non-PBC
evaluations, provide an orthogonal bounding box
(dtype = numpy.float32)</p></li>
<li><p><strong>max_gridsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – maximum number of cells in the grid. This parameter
can be tuned for superior performance.</p></li>
<li><p><strong>pbc</strong> (<em>boolean</em>) – Handle to switch periodic boundary conditions on/off [True]</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pbc=False</span></code> Only works for orthogonal boxes.</p></li>
<li><p>Care must be taken such that all particles are inside
the bounding box as defined by the box argument for non-PBC
calculations.</p></li>
<li><p>In case of Non-PBC calculations, a bounding box must be provided
to encompass all the coordinates as well as the search coordinates.
The dimension should be similar to <code class="docutils literal notranslate"><span class="pre">box</span></code> argument but for
an orthogonal box. For instance, one valid set of argument
for <code class="docutils literal notranslate"><span class="pre">box</span></code> for the case of no PBC could be
<code class="docutils literal notranslate"><span class="pre">[10,</span> <span class="pre">10,</span> <span class="pre">10,</span> <span class="pre">90,</span> <span class="pre">90,</span> <span class="pre">90]</span></code></p></li>
<li><p>Following operations are advisable for non-PBC calculations</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lmax</span> <span class="o">=</span> <span class="n">all_coords</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">lmin</span> <span class="o">=</span> <span class="n">all_coords</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pseudobox</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">*</span><span class="p">(</span><span class="n">lmax</span> <span class="o">-</span> <span class="n">lmin</span><span class="p">)</span>
<span class="n">pseudobox</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="mf">90.</span>
<span class="n">shift</span> <span class="o">=</span> <span class="n">all_coords</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">shift</span> <span class="o">-=</span> <span class="n">lmin</span>
<span class="n">gridsearch</span> <span class="o">=</span> <span class="n">FastNS</span><span class="p">(</span><span class="n">max_cutoff</span><span class="p">,</span> <span class="n">shift</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">pseudobox</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="method">
<dt id="MDAnalysis.lib.nsgrid.FastNS.search">
<code class="sig-name descname">search</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">search_coords</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.FastNS.search" title="Permalink to this definition">¶</a></dt>
<dd><p>Search a group of atoms against initialized coordinates</p>
<p>Creates a new grid with the query atoms and searches
against the initialized coordinates. The search is exclusive
i.e. only the pairs <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> such that <code class="docutils literal notranslate"><span class="pre">atom[i]</span></code> from query atoms
and <code class="docutils literal notranslate"><span class="pre">atom[j]</span></code> from the initialized set of coordinates is stored as
neighbors.</p>
<p>PBC-aware/non PBC-aware calculations are automatically enabled during
the instantiation of :class:FastNS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>search_coords</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Query coordinates of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">3)</span></code> where
<code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of queries</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results</strong> – An <a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults" title="MDAnalysis.lib.nsgrid.NSResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSResults</span></code></a> object holding neighbor search results, which
can be accessed by its methods <a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_indices" title="MDAnalysis.lib.nsgrid.NSResults.get_indices"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_indices()</span></code></a>,
<a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_distances" title="MDAnalysis.lib.nsgrid.NSResults.get_distances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_distances()</span></code></a>, <a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_pairs" title="MDAnalysis.lib.nsgrid.NSResults.get_pairs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pairs()</span></code></a>, and
<a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_pair_distances" title="MDAnalysis.lib.nsgrid.NSResults.get_pair_distances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pair_distances()</span></code></a>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults" title="MDAnalysis.lib.nsgrid.NSResults">NSResults</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-PBC aware calculations, the current implementation doesn’t work
if any of the query coordinates lies outside the <cite>box</cite> supplied to
<a class="reference internal" href="#MDAnalysis.lib.nsgrid.FastNS" title="MDAnalysis.lib.nsgrid.FastNS"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastNS</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.lib.nsgrid.FastNS.self_search">
<code class="sig-name descname">self_search</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.FastNS.self_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches all the pairs within the initialized coordinates</p>
<p>All the pairs among the initialized coordinates are registered
in hald the time. Although the algorithm is still the same, but
the distance checks can be reduced to half in this particular case
as every pair need not be evaluated twice.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>results</strong> – An <a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults" title="MDAnalysis.lib.nsgrid.NSResults"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSResults</span></code></a> object holding neighbor search results, which
can be accessed by its methods <a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_indices" title="MDAnalysis.lib.nsgrid.NSResults.get_indices"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_indices()</span></code></a>,
<a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_distances" title="MDAnalysis.lib.nsgrid.NSResults.get_distances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_distances()</span></code></a>, <a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_pairs" title="MDAnalysis.lib.nsgrid.NSResults.get_pairs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pairs()</span></code></a>, and
<a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_pair_distances" title="MDAnalysis.lib.nsgrid.NSResults.get_pair_distances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pair_distances()</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults" title="MDAnalysis.lib.nsgrid.NSResults">NSResults</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.lib.nsgrid.NSResults">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.lib.nsgrid.</code><code class="sig-name descname">NSResults</code><span class="sig-paren">(</span><em class="sig-param">dreal cutoff</em>, <em class="sig-param">real[:</em>, <em class="sig-param">::1] coords</em>, <em class="sig-param">real[:</em>, <em class="sig-param">::1] searchcoords</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.NSResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store the results</p>
<p>All outputs from <a class="reference internal" href="#MDAnalysis.lib.nsgrid.FastNS" title="MDAnalysis.lib.nsgrid.FastNS"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastNS</span></code></a> are stored in an instance of this class.
All methods of <a class="reference internal" href="#MDAnalysis.lib.nsgrid.FastNS" title="MDAnalysis.lib.nsgrid.FastNS"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastNS</span></code></a> return an instance of this class, which can
be used to  generate the desired results on demand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Specified cutoff distance</p></li>
<li><p><strong>coords</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Array with coordinates of atoms of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">3)</span></code> for
<code class="docutils literal notranslate"><span class="pre">N</span></code> particles. <code class="docutils literal notranslate"><span class="pre">dtype</span></code> must be <code class="docutils literal notranslate"><span class="pre">numpy.float32</span></code></p></li>
<li><p><strong>searchcoords</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Array with query coordinates. Shape must be <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">3)</span></code>
for <code class="docutils literal notranslate"><span class="pre">M</span></code> queries. <code class="docutils literal notranslate"><span class="pre">dtype</span></code> must be <code class="docutils literal notranslate"><span class="pre">numpy.float32</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MDAnalysis.lib.nsgrid.NSResults.get_distances">
<code class="sig-name descname">get_distances</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.NSResults.get_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance corresponding to individual neighbors of query atom</p>
<p>For every queried atom <code class="docutils literal notranslate"><span class="pre">i</span></code>, a list of all the distances
from its neighboring atoms can be obtained from <code class="docutils literal notranslate"><span class="pre">get_distances()[i]</span></code>.
Every <code class="docutils literal notranslate"><span class="pre">distance[i][j]</span></code> will correspond
to the distance between atoms <code class="docutils literal notranslate"><span class="pre">atom[i]</span></code> from the query
atoms and <code class="docutils literal notranslate"><span class="pre">atom[indices[j]]</span></code> from the initialized
set of coordinates, where <code class="docutils literal notranslate"><span class="pre">indices</span></code> can be obtained
by <code class="docutils literal notranslate"><span class="pre">get_indices()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>distances</strong> – Every element i.e. <code class="docutils literal notranslate"><span class="pre">distances[i]</span></code> will be an array of
shape <code class="docutils literal notranslate"><span class="pre">m</span></code> where m is the number of neighbours of
query atom[i].</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">NSResults</span><span class="p">()</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_distances</span><span class="p">()</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_indices" title="MDAnalysis.lib.nsgrid.NSResults.get_indices"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_indices()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.lib.nsgrid.NSResults.get_indices">
<code class="sig-name descname">get_indices</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.NSResults.get_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Individual neighbours of query atom</p>
<p>For every queried atom <code class="docutils literal notranslate"><span class="pre">i</span></code>, an array of all its neighbors
indices can be obtained from <code class="docutils literal notranslate"><span class="pre">get_indices()[i]</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>indices</strong> – Indices of neighboring atoms.
Every element i.e. <code class="docutils literal notranslate"><span class="pre">indices[i]</span></code> will be a list of
size <code class="docutils literal notranslate"><span class="pre">m</span></code> where m is the number of neighbours of
query atom[i].</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">NSResults</span><span class="p">()</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">get_indices</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">indices[i]</span></code> will be a list of neighboring atoms of
<code class="docutils literal notranslate"><span class="pre">atom[i]</span></code> from query atoms <code class="docutils literal notranslate"><span class="pre">atom</span></code>. <code class="docutils literal notranslate"><span class="pre">indices[i][j]</span></code> will give
the atom-id of initial coordinates such that
<code class="docutils literal notranslate"><span class="pre">initial_atom[indices[i][j]]</span></code> is a neighbor of <code class="docutils literal notranslate"><span class="pre">atom[i]</span></code>.</p>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.lib.nsgrid.NSResults.get_pair_distances">
<code class="sig-name descname">get_pair_distances</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.NSResults.get_pair_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the distances corresponding to each pair of neighbors</p>
<p>Returns an array of shape <code class="docutils literal notranslate"><span class="pre">N</span></code> where N is the number of pairs
among the query atoms and initial atoms within a specified distance.
Every element <code class="docutils literal notranslate"><span class="pre">[i]</span></code> corresponds to the distance between
<code class="docutils literal notranslate"><span class="pre">pairs[i,</span> <span class="pre">0]</span></code> and <code class="docutils literal notranslate"><span class="pre">pairs[i,</span> <span class="pre">1]</span></code>, where pairs is the array
obtained from <code class="docutils literal notranslate"><span class="pre">get_pairs()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>distances</strong> – distances between pairs of query and initial
atom coordinates of shape <code class="docutils literal notranslate"><span class="pre">N</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.lib.nsgrid.NSResults.get_pairs" title="MDAnalysis.lib.nsgrid.NSResults.get_pairs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pairs()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.lib.nsgrid.NSResults.get_pairs">
<code class="sig-name descname">get_pairs</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.nsgrid.NSResults.get_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the pairs within the desired cutoff distance</p>
<p>Returns an array of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">2)</span></code>, where N is the number of pairs
between <code class="docutils literal notranslate"><span class="pre">reference</span></code> and <code class="docutils literal notranslate"><span class="pre">configuration</span></code> within the specified distance.
For every pair <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code>, <code class="docutils literal notranslate"><span class="pre">reference[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">configuration[j]</span></code> are
atom positions such that <code class="docutils literal notranslate"><span class="pre">reference</span></code> is the position of query
atoms while <code class="docutils literal notranslate"><span class="pre">configuration</span></code> coontains the position of group of
atoms used to search against  the query atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>pairs</strong> – pairs of atom indices of neighbors from query
and initial atom coordinates of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">2)</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">7. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">8. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">9. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">10. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">11. Visualization modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../lib_modules.html">12. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../lib_modules.html#overview">12.1. Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../lib_modules.html#list-of-modules">12.2. List of modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="distances.html">12.2.1. Fast distance array computation — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.distances</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="distances.html#low-level-modules-for-mdanalysis-lib-distances">12.2.2. Low-level modules for <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.distances</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="NeighborSearch.html">12.2.3. Neighbor Search wrapper for MDAnalysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.NeighborSearch</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">12.2.4. Neighbor search library — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.nsgrid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#about-the-code">12.2.4.1. About the code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#about-the-algorithm">12.2.4.2. About the algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">12.2.4.3. Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pkdtree.html">12.2.5. PeriodicKDTree — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.pkdtree</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="log.html">12.2.6. Setting up logging — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.log</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mdamath.html">12.2.7. Mathematical helper functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.mdamath</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="transformations.html">12.2.8. Homogeneous Transformation Matrices and Quaternions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="qcprot.html">12.2.9. Fast QCP RMSD structure alignment — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.qcprot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="util.html">12.2.10. Helper functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.util</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lib_modules.html#low-level-file-formats">12.3. Low level file formats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">13. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">14. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">15. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">16. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../lib_modules.html"><span class="section-number">12. </span>Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a><ul>
      <li>Previous: <a href="NeighborSearch.html" title="previous chapter"><span class="section-number">12.2.3. </span>Neighbor Search wrapper for MDAnalysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.NeighborSearch</span></code></a></li>
      <li>Next: <a href="pkdtree.html" title="next chapter"><span class="section-number">12.2.5. </span>PeriodicKDTree — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib.pkdtree</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Matthieu Chavent, Kathleen Clark, Ruggero Cortini, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Henry Mull, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Kashish Punjani, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Xiki Tempula, Matthew W. Thompson, Matteo Tiberti, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/documentation_pages/lib/nsgrid.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>