
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>10.1.2. Core objects: Containers — MDAnalysis.core.groups &#8212; MDAnalysis 0.20.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.20.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10.2.1. Core Topology object — MDAnalysis.core.topology" href="topology.html" />
    <link rel="prev" title="10.1.1. Core object: Universe — MDAnalysis.core.universe" href="universe.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.core.groups"></span><div class="section" id="core-objects-containers-mdanalysis-core-groups">
<h1><span class="section-number">10.1.2. </span>Core objects: Containers — <a class="reference internal" href="#module-MDAnalysis.core.groups" title="MDAnalysis.core.groups"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.groups</span></code></a><a class="headerlink" href="#core-objects-containers-mdanalysis-core-groups" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> instance contains all the
particles in the system (which MDAnalysis calls <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>). Groups of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">atoms</span></code></a> are handled as <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances. The
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is probably the most important object in MDAnalysis because
virtually everything can be accessed through it. <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances
can be easily created (e.g., from an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.select_atoms()</span></code></a> selection or
simply by slicing).</p>
<p>For convenience, chemically meaningful groups of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> such as a
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> or a <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> (typically a whole molecule or all of the
solvent) also exist as containers, as well as groups of these units
(<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>).</p>
<div class="section" id="classes">
<h2><span class="section-number">10.1.2.1. </span>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="collections">
<h3><span class="section-number">10.1.2.1.1. </span>Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="MDAnalysis.core.groups.AtomGroup">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">AtomGroup</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>An ordered array of atoms.</p>
<p>Can be initiated from an iterable of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="p">([</span><span class="n">Atom1</span><span class="p">,</span> <span class="n">Atom2</span><span class="p">,</span> <span class="n">Atom3</span><span class="p">])</span>
</pre></div>
</div>
<p>Or from providing a list of indices and the
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> it should belong to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="p">([</span><span class="mi">72</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is generated by indexing/slicing
another <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>, such as the group of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in
the <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> at
<code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.universe.Universe.atoms</span></code>.</p>
<p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> can be indexed and sliced like a list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>will return the first and the last <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> in the group whereas the
slice:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>returns an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of every second element, corresponding to
indices 0, 2, and 4.</p>
<p>It also supports “advanced slicing” when the argument is a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> or a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aslice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ag</span><span class="p">[</span><span class="n">aslice</span><span class="p">]</span>
</pre></div>
</div>
<p>will return a new <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> with those
indices in the old <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>Finally, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a> can be created from a selection.
See <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a> originating from a selection are sorted
and duplicate elements are removed. This is not true for
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a> produced by slicing. Thus, slicing can be
used when the order of atoms is crucial (for instance, in order to
define angles or dihedrals).</p>
</div>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a> can be compared and combined using group
operators. For instance, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a> can be concatenated
using <cite>+</cite> or <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag_concat</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag_concat = ag1.concatenate(ag2)</span>
</pre></div>
</div>
<p>When groups are concatenated, the order of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> is
conserved. If <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> appear several times in one of the
groups, the duplicates are kept in the resulting group. On the contrary to
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.union" title="MDAnalysis.core.groups.AtomGroup.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a> treats the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a>
as sets so that duplicates are removed from the resulting group, and
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> are ordered. The <cite>|</cite> operator is synomymous to
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.union" title="MDAnalysis.core.groups.AtomGroup.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag_union</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag_union = ag1.union(ag2)</span>
</pre></div>
</div>
<p>The opposite operation to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a> is <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>. This
method creates a new group with all the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> of the group
that are not in a given other group; the order of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
is kept, and so are duplicates. <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> is the set version of
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>. The resulting group is sorted and deduplicated.</p>
<p>All set methods are listed in the table below. These methods treat the
groups as sorted and deduplicated sets of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 17%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Equivalent</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s.isdisjoint(t)</span></code></p></td>
<td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">s</span></code> and
<code class="docutils literal notranslate"><span class="pre">t</span></code> do not share
elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s.issubset(t)</span></code></p></td>
<td></td>
<td><p>test if all elements of
<code class="docutils literal notranslate"><span class="pre">s</span></code> are part of <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s.is_strict_subset(t)</span></code></p></td>
<td></td>
<td><p>test if all elements of
<code class="docutils literal notranslate"><span class="pre">s</span></code> are part of <code class="docutils literal notranslate"><span class="pre">t</span></code>,
and <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">!=</span> <span class="pre">t</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s.issuperset(t)</span></code></p></td>
<td></td>
<td><p>test if all elements of
<code class="docutils literal notranslate"><span class="pre">t</span></code> are part of <code class="docutils literal notranslate"><span class="pre">s</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s.is_strict_superset(t)</span></code></p></td>
<td></td>
<td><p>test if all elements of
<code class="docutils literal notranslate"><span class="pre">t</span></code> are part of <code class="docutils literal notranslate"><span class="pre">s</span></code>,
and <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">!=</span> <span class="pre">t</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s.union(t)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">|</span> <span class="pre">t</span></code></p></td>
<td><p>new Group with elements
from both <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s.intersection(t)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">&amp;</span> <span class="pre">t</span></code></p></td>
<td><p>new Group with elements
common to <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s.difference(t)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">-</span> <span class="pre">t</span></code></p></td>
<td><p>new Group with elements of
<code class="docutils literal notranslate"><span class="pre">s</span></code> that are not in <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s.symmetric_difference(t)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">^</span> <span class="pre">t</span></code></p></td>
<td><p>new Group with elements
that are part of <code class="docutils literal notranslate"><span class="pre">s</span></code> or
<code class="docutils literal notranslate"><span class="pre">t</span></code> but not both</p></td>
</tr>
</tbody>
</table>
<p>The following methods keep the order of the atoms as well as duplicates.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 17%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Equivalent</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">len(s)</span></code></p></td>
<td></td>
<td><p>number of elements (atoms,
residues or segment) in
the group</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">==</span> <span class="pre">t</span></code></p></td>
<td></td>
<td><p>test if <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>
contain the same elements
in the same order</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s.concatenate(t)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">+</span> <span class="pre">t</span></code></p></td>
<td><p>new Group with elements
from <code class="docutils literal notranslate"><span class="pre">s</span></code> and from <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s.subtract(t)</span></code></p></td>
<td></td>
<td><p>new Group with elements
from <code class="docutils literal notranslate"><span class="pre">s</span></code> that are not
in <code class="docutils literal notranslate"><span class="pre">t</span></code></p></td>
</tr>
</tbody>
</table>
<p>The <cite>in</cite> operator allows to test if an <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> is in the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances are always bound to a
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.universe.Universe</span></code></a>. They cannot exist in isolation.</p>
<p class="rubric">Deprecated functionality</p>
<p><em>Instant selectors</em> will be removed in the 1.0 release.  See issue <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/1377">#1377</a> for more details.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> can also be accessed in a Pythonic fashion by using the
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> name as an attribute. For instance,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="o">.</span><span class="n">CA</span>
</pre></div>
</div>
<p>will provide an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the
group. These <em>instant selector</em> attributes are auto-generated for
each atom name encountered in the group.</p>
<p class="rubric">Notes</p>
<p>The name-attribute instant selector access to <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> is mainly
meant for quick interactive work. Thus it either returns a single
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> if there is only one matching <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>, <em>or</em> a
new <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> for multiple matches.  This makes it difficult to use
the feature consistently in scripts.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.universe.Universe</span></code></a></p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> will be removed in the 1.0
release. See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details
and alternatives.</p>
</div>
<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.accumulate">
<code class="sig-name descname">accumulate</code><span class="sig-paren">(</span><em class="sig-param">attribute</em>, <em class="sig-param">function=&lt;function sum&gt;</em>, <em class="sig-param">compound='group'</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.accumulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulates the attribute associated with (compounds of) the group.</p>
<p>Accumulates the attribute of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group.
The accumulation per <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule,
or fragment can be obtained by setting the <cite>compound</cite> parameter
accordingly. By default, the method sums up all attributes per compound,
but any function that takes an array and returns an acuumulation over a
given axis can be used. For multi-dimensional input arrays, the
accumulation is performed along the first axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>array_like</em>) – Attribute or array of values to accumulate.
If a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> (or compatible) is provided, its first
dimension must have the same length as the total number of atoms in
the group.</p></li>
<li><p><strong>function</strong> (<em>callable</em><em>, </em><em>optional</em>) – The function performing the accumulation. It must take the array of
attribute values to accumulate as its only positional argument and
accept an (optional) keyword argument <code class="docutils literal notranslate"><span class="pre">axis</span></code> allowing to specify
the axis along which the accumulation is performed.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>,                   </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the accumulation of all attributes associated with
atoms in the group will be returned as a single value. Otherwise,
the accumulation of the attributes per <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>,
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, molecule, or fragment will be returned as a 1d
array. Note that, in any case, <em>only</em> the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Acuumulation of the <cite>attribute</cite>.
If <cite>compound</cite> is set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the first dimension of the
<cite>attribute</cite> array will be contracted to a single value.
If <cite>compound</cite> is set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>, the length of the first
dimension will correspond to the number of compounds. In all cases,
the other dimensions of the returned array will be of the original
shape (without the first dimension).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the length of a provided <cite>attribute</cite> array does not correspond to
    the number of atoms in the group.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums), or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the total charge of a given <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;charges&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the total mass per residue of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s1">&#39;residues&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the maximum atomic charge per fragment of a given
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;charges&#39;</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.angle">
<em class="property">property </em><code class="sig-name descname">angle</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>This <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> represented as an
<a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.Angle" title="MDAnalysis.core.topologyobjects.Angle"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.topologyobjects.Angle</span></code></a> object</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is not length 3</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.atoms">
<em class="property">property </em><code class="sig-name descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> itself.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.copy" title="MDAnalysis.core.groups.AtomGroup.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a></dt><dd><p>return a true copy of the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a></p>
</dd>
</dl>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>In previous versions, this returned a copy, but now
the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> itself is returned. This should
not affect any code but only speed up calculations.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.bbox">
<code class="sig-name descname">bbox</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding box of the selection.</p>
<p>The lengths A,B,C of the orthorhombic enclosing box are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">bbox</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, move all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to the primary unit cell
before calculation. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corners</strong> – 2x3 array giving corners of bounding box as
<code class="docutils literal notranslate"><span class="pre">[[xmin,</span> <span class="pre">ymin,</span> <span class="pre">zmin],</span> <span class="pre">[xmax,</span> <span class="pre">ymax,</span> <span class="pre">zmax]]</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.bond">
<em class="property">property </em><code class="sig-name descname">bond</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.bond" title="Permalink to this definition">¶</a></dt>
<dd><p>This <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> represented as a
<a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.Bond" title="MDAnalysis.core.topologyobjects.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.topologyobjects.Bond</span></code></a> object</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is not length 2</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.bsphere">
<code class="sig-name descname">bsphere</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.bsphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding sphere of the selection.</p>
<p>The sphere is calculated relative to the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.center_of_geometry" title="MDAnalysis.core.groups.AtomGroup.center_of_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">center</span> <span class="pre">of</span> <span class="pre">geometry</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, move all atoms to the primary unit cell before
calculation. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>R</strong> (<em>float</em>) – Radius of the bounding sphere.</p></li>
<li><p><strong>center</strong> (<em>numpy.ndarray</em>) – Coordinates of the sphere center as <code class="docutils literal notranslate"><span class="pre">[xcen,</span> <span class="pre">ycen,</span> <span class="pre">zcen]</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.center">
<code class="sig-name descname">center</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted center of (compounds of) the group</p>
<p>Computes the weighted center of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group.
Weighted centers per <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or
fragment can be obtained by setting the <cite>compound</cite> parameter
accordingly. If the weights of a compound sum up to zero, the
coordinates of that compound’s weighted center will be <code class="docutils literal notranslate"><span class="pre">nan</span></code> (not a
number).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Weights to be used. Setting <cite>weights=None</cite> is equivalent to passing
identical weights for all atoms of the group.</p></li>
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>,
the center of each compound will be calculated without moving any
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the compounds intact. Instead, the
resulting position vectors will be moved to the primary unit cell
after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the weighted center of all atoms in the group will
be returned as a single position vector. Else, the weighted centers
of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, molecule, or fragment
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the weighted center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>, the output will be a 2d array
of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If both ‘pbc’ and ‘unwrap’ set to true.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums) or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the center of charge of a given <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the centers of mass per residue of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s1">&#39;residues&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.center_of_geometry">
<code class="sig-name descname">center_of_geometry</code><span class="sig-paren">(</span><em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry of (compounds of) the group.</p>
<p>Computes the center of geometry (a.k.a. centroid) of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group. Centers of geometry per
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or fragment can be
obtained by setting the <cite>compound</cite> parameter accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the center of each compound will
be calculated without moving any <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the
compounds intact. Instead, the resulting position vectors will be
moved to the primary unit cell after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the center of geometry of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
in the group will be returned as a single position vector. Else, the
centers of geometry of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the geometric center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the
output will be a 2d array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.centroid">
<code class="sig-name descname">centroid</code><span class="sig-paren">(</span><em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry of (compounds of) the group.</p>
<p>Computes the center of geometry (a.k.a. centroid) of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group. Centers of geometry per
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or fragment can be
obtained by setting the <cite>compound</cite> parameter accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the center of each compound will
be calculated without moving any <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the
compounds intact. Instead, the resulting position vectors will be
moved to the primary unit cell after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the center of geometry of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
in the group will be returned as a single position vector. Else, the
centers of geometry of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the geometric center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the
output will be a 2d array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.concatenate">
<code class="sig-name descname">concatenate</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate with another Group or Component of the same level.</p>
<p>Duplicate entries and original order is preserved. It is synomymous to
the <cite>+</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with elements of <cite>self</cite> and <cite>other</cite> concatenated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The order of the original contents (including duplicates)
are preserved when performing a concatenation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag1.concatenate(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;O&#39;, &#39;O&#39;, &#39;O&#39;], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;N&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another group identical to this one.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.difference">
<code class="sig-name descname">difference</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Elements from this Group that do not appear in another</p>
<p>This method removes duplicate elements and sorts the result. As such,
it is different from <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>. <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> is synomymous
to the <cite>-</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.symmetric_difference" title="MDAnalysis.core.groups.AtomGroup.symmetric_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">symmetric_difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.dihedral">
<em class="property">property </em><code class="sig-name descname">dihedral</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>This <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> represented as a
<a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.Dihedral" title="MDAnalysis.core.topologyobjects.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code></a> object</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is not length 4</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.dimensions">
<em class="property">property </em><code class="sig-name descname">dimensions</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a copy of the dimensions of the currently loaded Timestep</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.forces">
<em class="property">property </em><code class="sig-name descname">forces</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces on each <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.shape.html#numpy.ndarray.shape" title="(in NumPy v1.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape</span></code></a><code class="docutils literal notranslate"><span class="pre">=(</span></code><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="MDAnalysis.core.groups.AtomGroup.n_atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_atoms</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">3)</span></code>
and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.dtype.html#numpy.ndarray.dtype" title="(in NumPy v1.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dtype</span></code></a><code class="docutils literal notranslate"><span class="pre">=numpy.float32</span></code>.</p>
<p>The forces can be changed by assigning an array of the appropriate
shape, i.e. either <code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="MDAnalysis.core.groups.AtomGroup.n_atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_atoms</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">3)</span></code> to assign
individual forces or <code class="docutils literal notranslate"><span class="pre">(3,)</span></code> to assign the <em>same</em> force to all
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> (e.g. <code class="docutils literal notranslate"><span class="pre">ag.forces</span> <span class="pre">=</span> <span class="pre">array([0,0,0])</span></code> will give all
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> a zero <a class="reference internal" href="#MDAnalysis.core.groups.Atom.force" title="MDAnalysis.core.groups.Atom.force"><code class="xref py py-attr docutils literal notranslate"><span class="pre">force</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If the <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> does not
    contain <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.forces" title="MDAnalysis.coordinates.base.Timestep.forces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forces</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.groupby">
<code class="sig-name descname">groupby</code><span class="sig-paren">(</span><em class="sig-param">topattrs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together items in this group according to values of <em>topattr</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topattrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – One or more topology attributes to group components by.
Single arguments are passed as a string. Multiple arguments
are passed as a list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Unique values of the multiple combinations of topology attributes
as keys, Groups as values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To group atoms with the same mass together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
<span class="go">{12.010999999999999: &lt;AtomGroup with 462 atoms&gt;,</span>
<span class="go"> 14.007: &lt;AtomGroup with 116 atoms&gt;,</span>
<span class="go"> 15.999000000000001: &lt;AtomGroup with 134 atoms&gt;}</span>
</pre></div>
</div>
<p>To group atoms with the same residue name and mass together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;resnames&#39;</span><span class="p">,</span> <span class="s1">&#39;masses&#39;</span><span class="p">])</span>
<span class="go">{(&#39;ALA&#39;, 1.008): &lt;AtomGroup with 95 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 12.011): &lt;AtomGroup with 57 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 14.007): &lt;AtomGroup with 19 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 15.999): &lt;AtomGroup with 19 atoms&gt;},</span>
<span class="go"> (&#39;ARG&#39;, 1.008): &lt;AtomGroup with 169 atoms&gt;,</span>
<span class="go"> ...}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;resnames&#39;</span><span class="p">,</span> <span class="s1">&#39;masses&#39;</span><span class="p">])(</span><span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="mf">15.999</span><span class="p">)</span>
<span class="go"> &lt;AtomGroup with 19 atoms&gt;</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.18.0: </span>The function accepts multiple attributes</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.guess_bonds">
<code class="sig-name descname">guess_bonds</code><span class="sig-paren">(</span><em class="sig-param">vdwradii=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.guess_bonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.guess_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess bonds that exist within this <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> and add them to
the underlying <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.universe" title="MDAnalysis.core.groups.AtomGroup.universe"><code class="xref py py-attr docutils literal notranslate"><span class="pre">universe</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vdwradii</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – Dict relating atom types: vdw radii</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../topology/guessers.html#MDAnalysis.topology.guessers.guess_bonds" title="MDAnalysis.topology.guessers.guess_bonds"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.topology.guessers.guess_bonds()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.improper">
<em class="property">property </em><code class="sig-name descname">improper</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.improper" title="Permalink to this definition">¶</a></dt>
<dd><p>This <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> represented as an
<a class="reference internal" href="topologyobjects.html#MDAnalysis.core.topologyobjects.ImproperDihedral" title="MDAnalysis.core.topologyobjects.ImproperDihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.topologyobjects.ImproperDihedral</span></code></a> object</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is not length 4</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.intersection">
<code class="sig-name descname">intersection</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are in both this Group and another</p>
<p>This method removes duplicate elements and sorts the result. It is
synomymous to the <cite>&amp;</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the common elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Intersections can be used when the select atoms string would
become too complicated.  For example to find the water atoms
which are within 4.0A of two segments:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shell1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL and around 4.0 segid 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL and around 4.0 segid 2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">common</span> <span class="o">=</span> <span class="n">shell1</span> <span class="o">&amp;</span> <span class="n">shell2</span>  <span class="c1"># or shell1.intersection(shell2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.union" title="MDAnalysis.core.groups.AtomGroup.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.is_strict_subset">
<code class="sig-name descname">is_strict_subset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.is_strict_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a subset of another Group but not identical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a strict subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.is_strict_superset">
<code class="sig-name descname">is_strict_superset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.is_strict_superset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a superset of another Group but not identical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a strict superset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.isdisjoint">
<code class="sig-name descname">isdisjoint</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>If the Group has no elements in common with the other Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the two Groups do not have common elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.issubset">
<code class="sig-name descname">issubset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of this Group are part of another Group</p>
<p>Note that an empty group is a subset of any group of the same level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.issuperset">
<code class="sig-name descname">issuperset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of another Group are part of this Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.isunique">
<em class="property">property </em><code class="sig-name descname">isunique</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.isunique" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether all components of the group are unique,
i.e., the group contains no duplicates.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span>
<span class="go">&lt;AtomGroup with 6 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">isunique</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">ag</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span><span class="o">.</span><span class="n">isunique</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.ix">
<em class="property">property </em><code class="sig-name descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<ul class="simple">
<li><p>If this Group is an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>, these are the
indices of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instances.</p></li>
<li><p>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> instances.</p></li>
<li><p>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> instances.</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.ix_array">
<em class="property">property </em><code class="sig-name descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<p>For a Group, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ix_array" title="MDAnalysis.core.groups.AtomGroup.ix_array"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix_array</span></code></a> is the same as <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ix" title="MDAnalysis.core.groups.AtomGroup.ix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix</span></code></a>. This method
gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ix" title="MDAnalysis.core.groups.AtomGroup.ix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.n_atoms">
<em class="property">property </em><code class="sig-name descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.n_residues">
<em class="property">property </em><code class="sig-name descname">n_residues</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.n_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unique <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a> present in the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self.residues)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.n_segments">
<em class="property">property </em><code class="sig-name descname">n_segments</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.n_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unique segments present in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self.segments)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.pack_into_box">
<code class="sig-name descname">pack_into_box</code><span class="sig-paren">(</span><em class="sig-param">box=None</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in this group to the primary unit
cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<em>array_like</em>) – Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses these
timestep dimensions.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> to change coordinates in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Shifted atom coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All atoms will be moved so that they lie between 0 and boxlength
<span class="math notranslate nohighlight">\(L_i\)</span> in all dimensions, i.e. the lower left corner of the
simulation box is taken to be at (0,0,0):</p>
<div class="math notranslate nohighlight">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\]</div>
<p>The default is to take unit cell information from the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> instance. The optional
argument <cite>box</cite> can be used to provide alternative unit cell information
(in the MDAnalysis standard format
<code class="docutils literal notranslate"><span class="pre">[Lx,</span> <span class="pre">Ly,</span> <span class="pre">Lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>).</p>
<p>Works with either orthogonal or triclinic box types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a> is identical to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="MDAnalysis.core.groups.AtomGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wrap()</span></code></a> with all default
keywords.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.pack_into_box()</span></code></a> is currently faster than
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ResidueGroup.pack_into_box()</span></code></a> or
<a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SegmentGroup.pack_into_box()</span></code></a>.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.positions">
<em class="property">property </em><code class="sig-name descname">positions</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.shape.html#numpy.ndarray.shape" title="(in NumPy v1.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape</span></code></a><code class="docutils literal notranslate"><span class="pre">=(</span></code><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="MDAnalysis.core.groups.AtomGroup.n_atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_atoms</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">3)</span></code>
and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.dtype.html#numpy.ndarray.dtype" title="(in NumPy v1.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dtype</span></code></a><code class="docutils literal notranslate"><span class="pre">=numpy.float32</span></code>.</p>
<p>The positions can be changed by assigning an array of the appropriate
shape, i.e., either <code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="MDAnalysis.core.groups.AtomGroup.n_atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_atoms</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">3)</span></code> to
assign individual coordinates, or <code class="docutils literal notranslate"><span class="pre">(3,)</span></code> to assign the <em>same</em>
coordinate to all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> (e.g.,
<code class="docutils literal notranslate"><span class="pre">ag.positions</span> <span class="pre">=</span> <span class="pre">array([0,0,0])</span></code> will move all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
to the origin).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Changing positions is not reflected in any files; reading any
frame from the
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe.trajectory" title="MDAnalysis.core.universe.Universe.trajectory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trajectory</span></code></a> will
replace the change with that from the file <em>except</em> if the
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe.trajectory" title="MDAnalysis.core.universe.Universe.trajectory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trajectory</span></code></a> is held
in memory, e.g., when the
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe.transfer_to_memory" title="MDAnalysis.core.universe.Universe.transfer_to_memory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transfer_to_memory()</span></code></a>
method was used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If the underlying <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a>
    does not contain
    <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.positions" title="MDAnalysis.coordinates.base.Timestep.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">positions</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.residues">
<em class="property">property </em><code class="sig-name descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>A sorted <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> of the unique
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a> present in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param">R</em>, <em class="sig-param">point=(0</em>, <em class="sig-param">0</em>, <em class="sig-param">0)</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation matrix <cite>R</cite> to the selection’s coordinates.
<span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is a 3x3 orthogonal matrix that transforms a vector
<span class="math notranslate nohighlight">\(\mathbf{x} \rightarrow \mathbf{x}'\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\mathbf{x}\]</div>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are rotated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<em>array_like</em>) – 3x3 rotation matrix</p></li>
<li><p><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Center of rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>By default, rotates about the origin <code class="docutils literal notranslate"><span class="pre">point=(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>. To rotate
a group <code class="docutils literal notranslate"><span class="pre">g</span></code> around its center of geometry, use
<code class="docutils literal notranslate"><span class="pre">g.rotate(R,</span> <span class="pre">point=g.center_of_geometry())</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.rotateby" title="MDAnalysis.core.groups.AtomGroup.rotateby"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rotateby()</span></code></a></dt><dd><p>rotate around given axis and angle</p>
</dd>
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.rotateby">
<code class="sig-name descname">rotateby</code><span class="sig-paren">(</span><em class="sig-param">angle</em>, <em class="sig-param">axis</em>, <em class="sig-param">point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.rotateby" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation to the selection’s coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Rotation angle in degrees.</p></li>
<li><p><strong>axis</strong> (<em>array_like</em>) – Rotation axis vector.</p></li>
<li><p><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Center of rotation. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then the center of geometry of this
group is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The transformation from current coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>
to new coordinates <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span> is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\,(\mathbf{x}-\mathbf{p}) + \mathbf{p}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is the rotation by <cite>angle</cite> around the
<cite>axis</cite> going through <cite>point</cite> <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations.rotation_matrix()</span></code></p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate()</span></code></dt><dd><p>math:<cite>mathsf{R}</cite></p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.segments">
<em class="property">property </em><code class="sig-name descname">segments</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.segments" title="Permalink to this definition">¶</a></dt>
<dd><p>A sorted <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> of the unique segments present in the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.select_atoms">
<code class="sig-name descname">select_atoms</code><span class="sig-paren">(</span><em class="sig-param">sel</em>, <em class="sig-param">*othersel</em>, <em class="sig-param">**selgroups</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.select_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Select <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> using a selection string.</p>
<p>Returns an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> with <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> sorted according
to their index in the topology (this is to ensure that there are no
duplicates, which can happen with complicated selections).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><strong>TypeError</strong></a> – If the arbitrary groups passed are not of type
    <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>All simple selection listed below support multiple arguments which are
implicitly combined with an or operator. For example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname MET GLY&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent to</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname MET or resname GLY&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Will select all atoms with a residue name of either MET or GLY.</p>
<p>Subselections can be grouped with parentheses.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;segid DMPC and not ( name H* O* )&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span>
<span class="go">&lt;AtomGroup with 3420 atoms&gt;</span>
</pre></div>
</div>
<p>Existing <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> objects can be passed as named arguments,
which will then be available to the selection parser.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;around 10 group notHO&quot;</span><span class="p">,</span> <span class="n">notHO</span><span class="o">=</span><span class="n">sel</span><span class="p">)</span>
<span class="go">&lt;AtomGroup with 1250 atoms&gt;</span>
</pre></div>
</div>
<p>Selections can be set to update automatically on frame change, by
setting the <cite>updating</cite> keyword argument to <cite>True</cite>.  This will return
a <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> which can represent the solvation shell
around another object.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resname SOL and around 2.0 protein&quot;</span><span class="p">,</span> <span class="n">updating</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&lt;Updating AtomGroup with 100 atoms&gt;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If exact ordering of atoms is required (for instance, for
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.angle" title="MDAnalysis.core.groups.AtomGroup.angle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">angle()</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.dihedral" title="MDAnalysis.core.groups.AtomGroup.dihedral"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dihedral()</span></code></a> calculations)
then one supplies selections <em>separately</em> in the required order. Also,
when multiple <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances are concatenated with the
<code class="docutils literal notranslate"><span class="pre">+</span></code> operator, then the order of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instances is preserved
and duplicates are <em>not</em> removed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../selections.html#selection-commands-label"><span class="std std-ref">Selection commands</span></a></p>
</div>
<p class="rubric">Selection syntax</p>
<p>The selection parser understands the following CASE SENSITIVE
<em>keywords</em>:</p>
<p><strong>Simple selections</strong></p>
<blockquote>
<div><dl class="simple">
<dt>protein, backbone, nucleic, nucleicbackbone</dt><dd><p>selects all atoms that belong to a standard set of residues;
a protein is identfied by a hard-coded set of residue names so
it  may not work for esoteric residues.</p>
</dd>
<dt>segid <em>seg-name</em></dt><dd><p>select by segid (as given in the topology), e.g. <code class="docutils literal notranslate"><span class="pre">segid</span> <span class="pre">4AKE</span></code>
or <code class="docutils literal notranslate"><span class="pre">segid</span> <span class="pre">DMPC</span></code></p>
</dd>
<dt>resid <em>residue-number-range</em></dt><dd><p>resid can take a single residue number or a range of numbers. A
range consists of two numbers separated by a colon (inclusive)
such as <code class="docutils literal notranslate"><span class="pre">resid</span> <span class="pre">1:5</span></code>. A residue number (“resid”) is taken
directly from the topology.
If icodes are present in the topology, then these will be
taken into account.  Ie ‘resid 163B’ will only select resid
163 with icode B while ‘resid 163’ will select only residue 163.
Range selections will also respect icodes, so ‘resid 162-163B’
will select all residues in 162 and those in 163 up to icode B.</p>
</dd>
<dt>resnum <em>resnum-number-range</em></dt><dd><p>resnum is the canonical residue number; typically it is set to
the residue id in the original PDB structure.</p>
</dd>
<dt>resname <em>residue-name</em></dt><dd><p>select by residue name, e.g. <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">LYS</span></code></p>
</dd>
<dt>name <em>atom-name</em></dt><dd><p>select by atom name (as given in the topology). Often, this is
force field dependent. Example: <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">CA</span></code> (for C&amp;alpha; atoms)
or <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">OW</span></code> (for SPC water oxygen)</p>
</dd>
<dt>type <em>atom-type</em></dt><dd><p>select by atom type; this is either a string or a number and
depends on the force field; it is read from the topology file
(e.g. the CHARMM PSF file contains numeric atom types). It has
non-sensical values when a PDB or GRO file is used as a topology</p>
</dd>
<dt>atom <em>seg-name</em>  <em>residue-number</em>  <em>atom-name</em></dt><dd><p>a selector for a single atom consisting of segid resid atomname,
e.g. <code class="docutils literal notranslate"><span class="pre">DMPC</span> <span class="pre">1</span> <span class="pre">C2</span></code> selects the C2 carbon of the first residue of
the DMPC segment</p>
</dd>
<dt>altloc <em>alternative-location</em></dt><dd><p>a selection for atoms where alternative locations are available,
which is often the case with high-resolution crystal structures
e.g. <cite>resid 4 and resname ALA and altloc B</cite> selects only the
atoms of ALA-4 that have an altloc B record.</p>
</dd>
<dt>moltype <em>molecule-type</em></dt><dd><p>select by molecule type, e.g. <code class="docutils literal notranslate"><span class="pre">moltype</span> <span class="pre">Protein_A</span></code>. At the
moment, only the TPR format defines the molecule type.</p>
</dd>
<dt>record_type <em>record_type</em></dt><dd><p>for selecting either ATOM or HETATM from PDB-like files.
e.g. <code class="docutils literal notranslate"><span class="pre">select_atoms('name</span> <span class="pre">CA</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">record_type</span> <span class="pre">HETATM')</span></code></p>
</dd>
</dl>
</div></blockquote>
<p><strong>Boolean</strong></p>
<blockquote>
<div><dl class="simple">
<dt>not</dt><dd><p>all atoms not in the selection, e.g. <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">protein</span></code> selects
all atoms that aren’t part of a protein</p>
</dd>
<dt>and, or</dt><dd><p>combine two selections according to the rules of boolean
algebra, e.g. <code class="docutils literal notranslate"><span class="pre">protein</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">resname</span> <span class="pre">ALA</span> <span class="pre">LYS</span></code>
selects all atoms that belong to a protein, but are not in a
lysine or alanine residue</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Geometric</strong></p>
<blockquote>
<div><dl class="simple">
<dt>around <em>distance</em>  <em>selection</em></dt><dd><p>selects all atoms a certain cutoff away from another selection,
e.g. <code class="docutils literal notranslate"><span class="pre">around</span> <span class="pre">3.5</span> <span class="pre">protein</span></code> selects all atoms not belonging to
protein that are within 3.5 Angstroms from the protein</p>
</dd>
<dt>point <em>x</em> <em>y</em> <em>z</em>  <em>distance</em></dt><dd><p>selects all atoms within a cutoff of a point in space, make sure
coordinate is separated by spaces,
e.g. <code class="docutils literal notranslate"><span class="pre">point</span> <span class="pre">5.0</span> <span class="pre">5.0</span> <span class="pre">5.0</span>&#160; <span class="pre">3.5</span></code> selects all atoms within 3.5
Angstroms of the coordinate (5.0, 5.0, 5.0)</p>
</dd>
<dt>prop [abs] <em>property</em>  <em>operator</em>  <em>value</em></dt><dd><p>selects atoms based on position, using <em>property</em>  <strong>x</strong>, <strong>y</strong>,
or <strong>z</strong> coordinate. Supports the <strong>abs</strong> keyword (for absolute
value) and the following <em>operators</em>: <strong>&lt;, &gt;, &lt;=, &gt;=, ==, !=</strong>.
For example, <code class="docutils literal notranslate"><span class="pre">prop</span> <span class="pre">z</span> <span class="pre">&gt;=</span> <span class="pre">5.0</span></code> selects all atoms with z
coordinate greater than 5.0; <code class="docutils literal notranslate"><span class="pre">prop</span> <span class="pre">abs</span> <span class="pre">z</span> <span class="pre">&lt;=</span> <span class="pre">5.0</span></code> selects all
atoms within -5.0 &lt;= z &lt;= 5.0.</p>
</dd>
<dt>sphzone <em>radius</em> <em>selection</em></dt><dd><p>Selects all atoms that are within <em>radius</em> of the center of
geometry of <em>selection</em></p>
</dd>
<dt>sphlayer <em>inner radius</em> <em>outer radius</em> <em>selection</em></dt><dd><p>Similar to sphzone, but also excludes atoms that are within
<em>inner radius</em> of the selection COG</p>
</dd>
<dt>cyzone <em>externalRadius</em> <em>zMax</em> <em>zMin</em> <em>selection</em></dt><dd><p>selects all atoms within a cylindric zone centered in the
center of geometry (COG) of a given selection,
e.g. <code class="docutils literal notranslate"><span class="pre">cyzone</span> <span class="pre">15</span> <span class="pre">4</span> <span class="pre">-8</span> <span class="pre">protein</span> <span class="pre">and</span> <span class="pre">resid</span> <span class="pre">42</span></code> selects the
center of geometry of protein and resid 42, and creates a
cylinder of external radius 15 centered on the COG. In z, the
cylinder extends from 4 above the COG to 8 below. Positive
values for <em>zMin</em>, or negative ones for <em>zMax</em>, are allowed.</p>
</dd>
<dt>cylayer <em>innerRadius</em> <em>externalRadius</em> <em>zMax</em> <em>zMin</em> <em>selection</em></dt><dd><p>selects all atoms within a cylindric layer centered in the
center of geometry (COG) of a given selection,
e.g. <code class="docutils literal notranslate"><span class="pre">cylayer</span> <span class="pre">5</span> <span class="pre">10</span> <span class="pre">10</span> <span class="pre">-8</span> <span class="pre">protein</span></code> selects the center of
geometry of protein, and creates a cylindrical layer of inner
radius 5, external radius 10 centered on the COG. In z, the
cylinder extends from 10 above the COG to 8 below. Positive
values for <em>zMin</em>, or negative ones for <em>zMax</em>, are allowed.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Connectivity</strong></p>
<blockquote>
<div><dl class="simple">
<dt>byres <em>selection</em></dt><dd><p>selects all atoms that are in the same segment and residue as
selection, e.g. specify the subselection after the byres keyword</p>
</dd>
<dt>bonded <em>selection</em></dt><dd><p>selects all atoms that are bonded to selection
eg: <code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">name</span> <span class="pre">H</span> <span class="pre">and</span> <span class="pre">bonded</span> <span class="pre">name</span> <span class="pre">O</span></code> selects only hydrogens
bonded to oxygens</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Index</strong></p>
<blockquote>
<div><dl class="simple">
<dt>bynum <em>index-range</em></dt><dd><p>selects all atoms within a range of (1-based) inclusive indices,
e.g. <code class="docutils literal notranslate"><span class="pre">bynum</span> <span class="pre">1</span></code> selects the first atom in the universe;
<code class="docutils literal notranslate"><span class="pre">bynum</span> <span class="pre">5:10</span></code> selects atoms 5 through 10 inclusive. All atoms
in the <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> are
consecutively numbered, and the index runs from 1 up to the
total number of atoms.</p>
</dd>
<dt>index <em>index-range</em></dt><dd><p>selects all atoms within a range of (0-based) inclusive indices,
e.g. <code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">0</span></code> selects the first atom in the universe;
<code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">5:10</span></code> selects atoms 6 through 11 inclusive. All atoms
in the <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> are
consecutively numbered, and the index runs from 0 up to the
total number of atoms - 1.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>Preexisting selections</strong></p>
<blockquote>
<div><dl class="simple">
<dt>group <cite>group-name</cite></dt><dd><p>selects the atoms in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> passed to the
function as an argument named <cite>group-name</cite>. Only the atoms
common to <cite>group-name</cite> and the instance
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a>
was called from will be considered, unless <code class="docutils literal notranslate"><span class="pre">group</span></code> is
preceded by the <code class="docutils literal notranslate"><span class="pre">global</span></code> keyword. <cite>group-name</cite> will be
included in the parsing just by comparison of atom indices.
This means that it is up to the user to make sure the
<cite>group-name</cite> group was defined in an appropriate
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>.</p>
</dd>
<dt>global <em>selection</em></dt><dd><p>by default, when issuing
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> from an
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>, selections and
subselections are returned intersected with the atoms of that
instance. Prefixing a selection term with <code class="docutils literal notranslate"><span class="pre">global</span></code> causes its
selection to be returned in its entirety.  As an example, the
<code class="docutils literal notranslate"><span class="pre">global</span></code> keyword allows for
<code class="docutils literal notranslate"><span class="pre">lipids.select_atoms(&quot;around</span> <span class="pre">10</span> <span class="pre">global</span> <span class="pre">protein&quot;)</span></code> — where
<code class="docutils literal notranslate"><span class="pre">lipids</span></code> is a group that does not contain any proteins. Were
<code class="docutils literal notranslate"><span class="pre">global</span></code> absent, the result would be an empty selection since
the <code class="docutils literal notranslate"><span class="pre">protein</span></code> subselection would itself be empty. When issuing
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> from a
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>, <code class="docutils literal notranslate"><span class="pre">global</span></code> is
ignored.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt><strong>Dynamic selections</strong></dt><dd><p>If <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> is
invoked with named argument <cite>updating</cite> set to <cite>True</cite>, an
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> instance will be
returned, instead of a regular
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>. It behaves just like
the latter, with the difference that the selection expressions are
re-evaluated every time the trajectory frame changes (this happens
lazily, only when the
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> is accessed so
that there is no redundant updating going on).
Issuing an updating selection from an already updating group will
cause later updates to also reflect the updating of the base group.
A non-updating selection or a slicing operation made on an
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> will return a
static <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>, which will no
longer update across frames.</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.7.4: </span>Added <em>resnum</em> selection.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8.1: </span>Added <em>group</em> and <em>fullgroup</em> selections.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.11: </span>The use of <em>fullgroup</em> has been deprecated in favor
of the equivalent <em>global group</em> selections.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.13.0: </span>Added <em>bonded</em> selection.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.16.0: </span>Resid selection now takes icodes into account
where present.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.16.0: </span>Updating selections now possible by setting
the <cite>updating</cite> argument.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Added <em>moltype</em> and <em>molnum</em> selections.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added strict type checking for passed groups.
Added periodic kwarg (default True)</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.2: </span>Empty sel string now returns an empty Atom group.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param">level</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> into a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroups</span></code></a> by <cite>level</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>level</strong> (<em>{'atom'</em><em>, </em><em>'residue'</em><em>, </em><em>'molecule'</em><em>, </em><em>'segment'}</em>) – </p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Added the ‘molecule’ level.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.subtract">
<code class="sig-name descname">subtract</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Group with elements from this Group that don’t appear in other</p>
<p>The original order of this group is kept, as well as any duplicate
elements. If an element of this Group is duplicated and appears in
the other Group or Component, then all the occurences of that element
are removed from the returned Group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>,
conserves order and duplicates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Unlike <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> this method will not sort or remove
duplicates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">-</span> <span class="n">ag2</span>  <span class="c1"># or ag1.subtract(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span><span class="o">.</span><span class="n">indices</span>
<span class="go">array([3, 3, 1, 1])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.symmetric_difference">
<code class="sig-name descname">symmetric_difference</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are only in one of this Group or another</p>
<p>This method removes duplicate elements and the result is sorted. It is
synomym to the <cite>^</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements that are in <cite>self</cite> or in <cite>other</cite> but not in
both, without duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">^</span> <span class="n">ag2</span>  <span class="c1"># or ag1.symmetric_difference(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="o">.</span><span class="n">indices</span>  <span class="c1"># 0 and 1 are only in ag1, 4 and 6 are only in ag2</span>
<span class="go">[0, 1, 4, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.difference" title="MDAnalysis.core.groups.AtomGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">M</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply homogenous transformation matrix <cite>M</cite> to the coordinates.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are rotated and translated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> (<em>array_like</em>) – 4x4 matrix with the rotation in <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">M[:3,</span> <span class="pre">:3]</span></code> and the
translation in <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">M[:3,</span> <span class="pre">3]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is about the origin and is applied
before the translation <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.translate">
<code class="sig-name descname">translate</code><span class="sig-paren">(</span><em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply translation vector <cite>t</cite> to the selection’s coordinates.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are translated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>array_like</em>) – vector to translate coordinates with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The method applies a translation to the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>
from current coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> to new coordinates
<span class="math notranslate nohighlight">\(\mathbf{x}'\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.ts">
<em class="property">property </em><code class="sig-name descname">ts</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Temporary Timestep that contains the selection coordinates.</p>
<p>A <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> instance,
which can be passed to a trajectory writer.</p>
<p>If <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ts" title="MDAnalysis.core.groups.AtomGroup.ts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ts</span></code></a> is modified then these modifications
will be present until the frame number changes (which
typically happens when the underlying
<a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe.trajectory" title="MDAnalysis.core.universe.Universe.trajectory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trajectory</span></code></a> frame changes).</p>
<p>It is not possible to assign a new
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> to the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.ts" title="MDAnalysis.core.groups.AtomGroup.ts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AtomGroup.ts</span></code></a> attribute; change attributes of the object.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements either in this Group or another</p>
<p>On the contrary to concatenation, this method sort the elements and
removes duplicate ones. It is synomymous to the <cite>|</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the combined elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>In contrast to <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, any duplicates are dropped
and the result is sorted.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag1.union(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;O&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.concatenate" title="MDAnalysis.core.groups.AtomGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.intersection" title="MDAnalysis.core.groups.AtomGroup.intersection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">intersection()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.unique">
<em class="property">property </em><code class="sig-name descname">unique</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> containing sorted and unique
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> only.</p>
<p>If the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is unique, this is the group itself.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span>
<span class="go">&lt;AtomGroup with 6 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([2, 1, 2, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">ag</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([0, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span><span class="o">.</span><span class="n">unique</span> <span class="ow">is</span> <span class="n">ag2</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>If the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> is already unique,
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.unique" title="MDAnalysis.core.groups.AtomGroup.unique"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AtomGroup.unique</span></code></a> now returns the group itself instead of a
copy.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.universe">
<em class="property">property </em><code class="sig-name descname">universe</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.universe" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> the group
belongs to.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.unwrap">
<code class="sig-name descname">unwrap</code><span class="sig-paren">(</span><em class="sig-param">compound='fragments'</em>, <em class="sig-param">reference='com'</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.unwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Move atoms of this group so that bonds within the
group’s compounds aren’t split across periodic boundaries.</p>
<p>This function is most useful when atoms have been packed into the
primary unit cell, causing breaks mid-molecule, with the molecule then
appearing on either side of the unit cell. This is problematic for
operations such as calculating the center of mass of the molecule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+-----------+       +-----------+
|           |       |           |
| 6       3 |       |         3 | 6
| !       ! |       |         ! | !
|-5-8   1-2-|  ==&gt;  |       1-2-|-5-8
| !       ! |       |         ! | !
| 7       4 |       |         4 | 7
|           |       |           |
+-----------+       +-----------+
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>,                     </em><em>'fragments'}</em><em>, </em><em>optional</em>) – Which type of component to unwrap. Note that, in any case, all
atoms within each compound must be interconnected by bonds, i.e.,
compounds must correspond to (parts of) molecules.</p></li>
<li><p><strong>reference</strong> (<em>{'com'</em><em>, </em><em>'cog'</em><em>, </em><em>None}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'com'</span></code> (center of mass) or <code class="docutils literal notranslate"><span class="pre">'cog'</span></code> (center of geometry), the
unwrapped compounds will be shifted so that their individual
reference point lies within the primary unit cell.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no such shift is performed.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, coordinates are modified in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Unwrapped atom coordinate array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> but the underlying topology does
    not contain molecule information, or if <cite>reference</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code>
    but the topology does not contain masses.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>reference</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'com'</span></code>, <code class="docutils literal notranslate"><span class="pre">'cog'</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, or
    if <cite>reference</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code> and the total mass of any <cite>compound</cite> is
    zero.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware of the fact that only atoms <em>belonging to the group</em> will
be unwrapped! If you want entire molecules to be unwrapped, make sure
that all atoms of these molecules are part of the group.</p>
<p>An AtomGroup containing all atoms of all fragments in the group <code class="docutils literal notranslate"><span class="pre">ag</span></code>
can be created with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_frag_atoms</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ag</span><span class="o">.</span><span class="n">fragments</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../lib/mdamath.html#MDAnalysis.lib.mdamath.make_whole" title="MDAnalysis.lib.mdamath.make_whole"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_whole()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="MDAnalysis.core.groups.AtomGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wrap()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">apply_PBC()</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.velocities">
<em class="property">property </em><code class="sig-name descname">velocities</code><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocities of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>.</p>
<p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.shape.html#numpy.ndarray.shape" title="(in NumPy v1.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape</span></code></a><code class="docutils literal notranslate"><span class="pre">=(</span></code><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="MDAnalysis.core.groups.AtomGroup.n_atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_atoms</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">3)</span></code>
and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.dtype.html#numpy.ndarray.dtype" title="(in NumPy v1.19)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dtype</span></code></a><code class="docutils literal notranslate"><span class="pre">=numpy.float32</span></code>.</p>
<p>The velocities can be changed by assigning an array of the appropriate
shape, i.e. either <code class="docutils literal notranslate"><span class="pre">(</span></code><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.n_atoms" title="MDAnalysis.core.groups.AtomGroup.n_atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_atoms</span></code></a><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">3)</span></code> to assign
individual velocities or <code class="docutils literal notranslate"><span class="pre">(3,)</span></code> to assign the <em>same</em> velocity to all
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> (e.g. <code class="docutils literal notranslate"><span class="pre">ag.velocities</span> <span class="pre">=</span> <span class="pre">array([0,0,0])</span></code> will give
all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> zero <a class="reference internal" href="#MDAnalysis.core.groups.Atom.velocity" title="MDAnalysis.core.groups.Atom.velocity"><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocity</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If the underlying <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a>
    does not contain
    <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.velocities" title="MDAnalysis.coordinates.base.Timestep.velocities"><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocities</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.wrap">
<code class="sig-name descname">wrap</code><span class="sig-paren">(</span><em class="sig-param">compound='atoms'</em>, <em class="sig-param">center='com'</em>, <em class="sig-param">box=None</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the contents of this group back into the primary unit cell
according to periodic boundary conditions.</p>
<p>Specifying a <cite>compound</cite> will keep the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in each
compound together during the process. If <cite>compound</cite> is different from
<code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, each compound as a whole will be shifted so that its
<cite>center</cite> lies within the primary unit cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>{'atoms'</em><em>, </em><em>'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>,                     </em><em>'fragments'}</em><em>, </em><em>optional</em>) – Which type of component to keep together during wrapping. Note that,
in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>center</strong> (<em>{'com'</em><em>, </em><em>'cog'}</em>) – How to define the center of a given group of atoms. If <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, this parameter is meaningless and therefore ignored.</p></li>
<li><p><strong>box</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>The unitcell dimensions of the system, which can be orthogonal or
triclinic and must be provided in the same format as returned by
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>:</p>
<p><code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses the
dimensions of the current time step.</p>
</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, coordinates will be changed in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of wrapped atom coordinates of dtype <cite>np.float32</cite> and shape
<code class="docutils literal notranslate"><span class="pre">(len(self.atoms.n_atoms),</span> <span class="pre">3)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, <code class="docutils literal notranslate"><span class="pre">'group'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums) or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds or if
    <cite>center</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code> but the topology doesn’t contain masses.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All atoms of the group will be moved so that the centers of its
compounds lie within the primary periodic image. For orthorhombic unit
cells, the primary periodic image is defined as the half-open interval
<span class="math notranslate nohighlight">\([0,L_i)\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and boxlength <span class="math notranslate nohighlight">\(L_i\)</span> in all
dimensions <span class="math notranslate nohighlight">\(i\in\{x,y,z\}\)</span>, i.e., the origin of the of the
simulation box is taken to be at the origin <span class="math notranslate nohighlight">\((0,0,0)\)</span> of the
euclidian coordinate system. A compound center residing at position
<span class="math notranslate nohighlight">\(x_i\)</span> in dimension <span class="math notranslate nohighlight">\(i\)</span> will be shifted to <span class="math notranslate nohighlight">\(x_i'\)</span>
according to</p>
<div class="math notranslate nohighlight">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\,.\]</div>
<p>When specifying a <cite>compound</cite>, the translation is calculated based on
each compound. The same translation is applied to all atoms
within this compound, meaning it will not be broken by the shift.
This might however mean that not all atoms of a compound will be
inside the unit cell after wrapping, but rather will be the center of
the compound.</p>
<p>Be aware of the fact that only atoms <em>belonging to the group</em> will be
taken into account!</p>
<p><cite>center</cite> allows to define how the center of each group is computed.
This can be either <code class="docutils literal notranslate"><span class="pre">'com'</span></code> for center of mass, or <code class="docutils literal notranslate"><span class="pre">'cog'</span></code> for center
of geometry.</p>
<p><cite>box</cite> allows a unit cell to be given for the transformation. If not
specified, the <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dimensions</span></code></a>
information from the current
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> will be used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="MDAnalysis.core.groups.AtomGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.wrap()</span></code></a> is currently faster than
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="MDAnalysis.core.groups.ResidueGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ResidueGroup.wrap()</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="MDAnalysis.core.groups.SegmentGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SegmentGroup.wrap()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.unwrap" title="MDAnalysis.core.groups.AtomGroup.unwrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unwrap()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">MDanalysis.lib.distances.apply_PBC()</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>The method only acts on atoms <em>belonging to the group</em> and returns
the wrapped positions as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.
Added optional argument <cite>inplace</cite>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.AtomGroup.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">file_format=None</em>, <em class="sig-param">filenamefmt='{trjname}_{frame}'</em>, <em class="sig-param">frames=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#AtomGroup.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.AtomGroup.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <cite>AtomGroup</cite> to a file.</p>
<p>The output can either be a coordinate file or a selection, depending on
the format.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;selection.ndx&#39;</span><span class="p">)</span>  <span class="c1"># Write a gromacs index file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;coordinates.pdb&#39;</span><span class="p">)</span>  <span class="c1"># Write the current frame as PDB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write the trajectory in XTC format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;trajectory.xtc&#39;</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write every other frame of the trajectory in PBD format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;trajectory.pdb&#39;</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – <code class="docutils literal notranslate"><span class="pre">None</span></code>: create TRJNAME_FRAME.FORMAT from filenamefmt [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>file_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The name or extension of a coordinate, trajectory, or selection
file format such as PDB, CRD, GRO, VMD (tcl), PyMol (pml), Gromacs
(ndx) CHARMM (str) or Jmol (spt); case-insensitive [PDB]</p></li>
<li><p><strong>filenamefmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – format string for default filename; use substitution tokens
‘trjname’ and ‘frame’ [“%(trjname)s_%(frame)d”]</p></li>
<li><p><strong>bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – how to handle bond information, especially relevant for PDBs.
<code class="docutils literal notranslate"><span class="pre">&quot;conect&quot;</span></code>: write only the CONECT records defined in the original
file. <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>: write out all bonds, both the original defined and
those guessed by MDAnalysis. <code class="docutils literal notranslate"><span class="pre">None</span></code>: do not write out bonds.
Default is <code class="docutils literal notranslate"><span class="pre">&quot;conect&quot;</span></code>.</p></li>
<li><p><strong>frames</strong> (<em>array-like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.9)"><em>slice</em></a><em> or </em><a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.FrameIteratorBase" title="MDAnalysis.coordinates.base.FrameIteratorBase"><em>FrameIteratorBase</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – An ensemble of frames to write. The ensemble can be an list or
array of frame indices, a mask of booleans, an instance of
<a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a>, or the value returned when a trajectory is indexed.
By default, <cite>frames</cite> is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> and only the current frame
is written. If <cite>frames</cite> is set to “all”, then all the frame from
trajectory are written.</p></li>
</ul>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Merged with write_selection. This method can
now write both selections out.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Can write multiframe trajectories with the ‘frames’ argument.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.ResidueGroup">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">ResidueGroup</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#ResidueGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>ResidueGroup base class.</p>
<p>This class is used by a <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> for
generating its Topology-specific <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> class. All the
<a class="reference internal" href="topologyattrs.html#MDAnalysis.core.topologyattrs.TopologyAttr" title="MDAnalysis.core.topologyattrs.TopologyAttr"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyAttr</span></code></a> components are obtained
from <code class="xref py py-class docutils literal notranslate"><span class="pre">GroupBase</span></code>, so this class only includes ad-hoc methods
specific to <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroups</span></code></a>.</p>
<p>ResidueGroups can be compared and combined using group operators. See the
list of these operators on <code class="xref py py-class docutils literal notranslate"><span class="pre">GroupBase</span></code>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of Segments will be removed in the 1.0 release.
See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details and
alternatives.</p>
</div>
<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.accumulate">
<code class="sig-name descname">accumulate</code><span class="sig-paren">(</span><em class="sig-param">attribute</em>, <em class="sig-param">function=&lt;function sum&gt;</em>, <em class="sig-param">compound='group'</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.accumulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulates the attribute associated with (compounds of) the group.</p>
<p>Accumulates the attribute of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group.
The accumulation per <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule,
or fragment can be obtained by setting the <cite>compound</cite> parameter
accordingly. By default, the method sums up all attributes per compound,
but any function that takes an array and returns an acuumulation over a
given axis can be used. For multi-dimensional input arrays, the
accumulation is performed along the first axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>array_like</em>) – Attribute or array of values to accumulate.
If a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> (or compatible) is provided, its first
dimension must have the same length as the total number of atoms in
the group.</p></li>
<li><p><strong>function</strong> (<em>callable</em><em>, </em><em>optional</em>) – The function performing the accumulation. It must take the array of
attribute values to accumulate as its only positional argument and
accept an (optional) keyword argument <code class="docutils literal notranslate"><span class="pre">axis</span></code> allowing to specify
the axis along which the accumulation is performed.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>,                   </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the accumulation of all attributes associated with
atoms in the group will be returned as a single value. Otherwise,
the accumulation of the attributes per <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>,
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, molecule, or fragment will be returned as a 1d
array. Note that, in any case, <em>only</em> the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Acuumulation of the <cite>attribute</cite>.
If <cite>compound</cite> is set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the first dimension of the
<cite>attribute</cite> array will be contracted to a single value.
If <cite>compound</cite> is set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>, the length of the first
dimension will correspond to the number of compounds. In all cases,
the other dimensions of the returned array will be of the original
shape (without the first dimension).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the length of a provided <cite>attribute</cite> array does not correspond to
    the number of atoms in the group.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums), or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the total charge of a given <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;charges&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the total mass per residue of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s1">&#39;residues&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the maximum atomic charge per fragment of a given
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;charges&#39;</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.atoms">
<em class="property">property </em><code class="sig-name descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> present in this
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> are ordered locally by <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> in the
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>.  Duplicates are <em>not</em> removed.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.bbox">
<code class="sig-name descname">bbox</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding box of the selection.</p>
<p>The lengths A,B,C of the orthorhombic enclosing box are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">bbox</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, move all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to the primary unit cell
before calculation. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corners</strong> – 2x3 array giving corners of bounding box as
<code class="docutils literal notranslate"><span class="pre">[[xmin,</span> <span class="pre">ymin,</span> <span class="pre">zmin],</span> <span class="pre">[xmax,</span> <span class="pre">ymax,</span> <span class="pre">zmax]]</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.bsphere">
<code class="sig-name descname">bsphere</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.bsphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding sphere of the selection.</p>
<p>The sphere is calculated relative to the
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.center_of_geometry" title="MDAnalysis.core.groups.ResidueGroup.center_of_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">center</span> <span class="pre">of</span> <span class="pre">geometry</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, move all atoms to the primary unit cell before
calculation. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>R</strong> (<em>float</em>) – Radius of the bounding sphere.</p></li>
<li><p><strong>center</strong> (<em>numpy.ndarray</em>) – Coordinates of the sphere center as <code class="docutils literal notranslate"><span class="pre">[xcen,</span> <span class="pre">ycen,</span> <span class="pre">zcen]</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.center">
<code class="sig-name descname">center</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted center of (compounds of) the group</p>
<p>Computes the weighted center of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group.
Weighted centers per <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or
fragment can be obtained by setting the <cite>compound</cite> parameter
accordingly. If the weights of a compound sum up to zero, the
coordinates of that compound’s weighted center will be <code class="docutils literal notranslate"><span class="pre">nan</span></code> (not a
number).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Weights to be used. Setting <cite>weights=None</cite> is equivalent to passing
identical weights for all atoms of the group.</p></li>
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>,
the center of each compound will be calculated without moving any
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the compounds intact. Instead, the
resulting position vectors will be moved to the primary unit cell
after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the weighted center of all atoms in the group will
be returned as a single position vector. Else, the weighted centers
of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, molecule, or fragment
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the weighted center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>, the output will be a 2d array
of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If both ‘pbc’ and ‘unwrap’ set to true.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums) or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the center of charge of a given <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the centers of mass per residue of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s1">&#39;residues&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.center_of_geometry">
<code class="sig-name descname">center_of_geometry</code><span class="sig-paren">(</span><em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry of (compounds of) the group.</p>
<p>Computes the center of geometry (a.k.a. centroid) of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group. Centers of geometry per
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or fragment can be
obtained by setting the <cite>compound</cite> parameter accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the center of each compound will
be calculated without moving any <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the
compounds intact. Instead, the resulting position vectors will be
moved to the primary unit cell after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the center of geometry of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
in the group will be returned as a single position vector. Else, the
centers of geometry of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the geometric center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the
output will be a 2d array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.centroid">
<code class="sig-name descname">centroid</code><span class="sig-paren">(</span><em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry of (compounds of) the group.</p>
<p>Computes the center of geometry (a.k.a. centroid) of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group. Centers of geometry per
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or fragment can be
obtained by setting the <cite>compound</cite> parameter accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the center of each compound will
be calculated without moving any <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the
compounds intact. Instead, the resulting position vectors will be
moved to the primary unit cell after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the center of geometry of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
in the group will be returned as a single position vector. Else, the
centers of geometry of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the geometric center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the
output will be a 2d array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.concatenate">
<code class="sig-name descname">concatenate</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate with another Group or Component of the same level.</p>
<p>Duplicate entries and original order is preserved. It is synomymous to
the <cite>+</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with elements of <cite>self</cite> and <cite>other</cite> concatenated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The order of the original contents (including duplicates)
are preserved when performing a concatenation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag1.concatenate(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;O&#39;, &#39;O&#39;, &#39;O&#39;], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;N&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another group identical to this one.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.difference">
<code class="sig-name descname">difference</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Elements from this Group that do not appear in another</p>
<p>This method removes duplicate elements and sorts the result. As such,
it is different from <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.subtract" title="MDAnalysis.core.groups.ResidueGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>. <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> is synomymous
to the <cite>-</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.subtract" title="MDAnalysis.core.groups.ResidueGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.symmetric_difference" title="MDAnalysis.core.groups.ResidueGroup.symmetric_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">symmetric_difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.dimensions">
<em class="property">property </em><code class="sig-name descname">dimensions</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a copy of the dimensions of the currently loaded Timestep</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.groupby">
<code class="sig-name descname">groupby</code><span class="sig-paren">(</span><em class="sig-param">topattrs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together items in this group according to values of <em>topattr</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topattrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – One or more topology attributes to group components by.
Single arguments are passed as a string. Multiple arguments
are passed as a list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Unique values of the multiple combinations of topology attributes
as keys, Groups as values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To group atoms with the same mass together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
<span class="go">{12.010999999999999: &lt;AtomGroup with 462 atoms&gt;,</span>
<span class="go"> 14.007: &lt;AtomGroup with 116 atoms&gt;,</span>
<span class="go"> 15.999000000000001: &lt;AtomGroup with 134 atoms&gt;}</span>
</pre></div>
</div>
<p>To group atoms with the same residue name and mass together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;resnames&#39;</span><span class="p">,</span> <span class="s1">&#39;masses&#39;</span><span class="p">])</span>
<span class="go">{(&#39;ALA&#39;, 1.008): &lt;AtomGroup with 95 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 12.011): &lt;AtomGroup with 57 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 14.007): &lt;AtomGroup with 19 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 15.999): &lt;AtomGroup with 19 atoms&gt;},</span>
<span class="go"> (&#39;ARG&#39;, 1.008): &lt;AtomGroup with 169 atoms&gt;,</span>
<span class="go"> ...}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;resnames&#39;</span><span class="p">,</span> <span class="s1">&#39;masses&#39;</span><span class="p">])(</span><span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="mf">15.999</span><span class="p">)</span>
<span class="go"> &lt;AtomGroup with 19 atoms&gt;</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.18.0: </span>The function accepts multiple attributes</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.intersection">
<code class="sig-name descname">intersection</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are in both this Group and another</p>
<p>This method removes duplicate elements and sorts the result. It is
synomymous to the <cite>&amp;</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the common elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Intersections can be used when the select atoms string would
become too complicated.  For example to find the water atoms
which are within 4.0A of two segments:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shell1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL and around 4.0 segid 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL and around 4.0 segid 2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">common</span> <span class="o">=</span> <span class="n">shell1</span> <span class="o">&amp;</span> <span class="n">shell2</span>  <span class="c1"># or shell1.intersection(shell2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.union" title="MDAnalysis.core.groups.ResidueGroup.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.is_strict_subset">
<code class="sig-name descname">is_strict_subset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.is_strict_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a subset of another Group but not identical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a strict subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.is_strict_superset">
<code class="sig-name descname">is_strict_superset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.is_strict_superset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a superset of another Group but not identical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a strict superset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.isdisjoint">
<code class="sig-name descname">isdisjoint</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>If the Group has no elements in common with the other Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the two Groups do not have common elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.issubset">
<code class="sig-name descname">issubset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of this Group are part of another Group</p>
<p>Note that an empty group is a subset of any group of the same level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.issuperset">
<code class="sig-name descname">issuperset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of another Group are part of this Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.isunique">
<em class="property">property </em><code class="sig-name descname">isunique</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.isunique" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether all components of the group are unique,
i.e., the group contains no duplicates.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span>
<span class="go">&lt;AtomGroup with 6 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">isunique</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">ag</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span><span class="o">.</span><span class="n">isunique</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.ix">
<em class="property">property </em><code class="sig-name descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<ul class="simple">
<li><p>If this Group is an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>, these are the
indices of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instances.</p></li>
<li><p>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> instances.</p></li>
<li><p>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> instances.</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.ix_array">
<em class="property">property </em><code class="sig-name descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<p>For a Group, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.ix_array" title="MDAnalysis.core.groups.ResidueGroup.ix_array"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix_array</span></code></a> is the same as <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.ix" title="MDAnalysis.core.groups.ResidueGroup.ix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix</span></code></a>. This method
gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.ix" title="MDAnalysis.core.groups.ResidueGroup.ix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.n_atoms">
<em class="property">property </em><code class="sig-name descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> present in this <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>,
including duplicate residues (and thus, duplicate atoms).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self.atoms)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.n_residues">
<em class="property">property </em><code class="sig-name descname">n_residues</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.n_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of residues in the <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.n_segments">
<em class="property">property </em><code class="sig-name descname">n_segments</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.n_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of unique segments present in the ResidueGroup.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self.segments)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.pack_into_box">
<code class="sig-name descname">pack_into_box</code><span class="sig-paren">(</span><em class="sig-param">box=None</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in this group to the primary unit
cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<em>array_like</em>) – Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses these
timestep dimensions.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> to change coordinates in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Shifted atom coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All atoms will be moved so that they lie between 0 and boxlength
<span class="math notranslate nohighlight">\(L_i\)</span> in all dimensions, i.e. the lower left corner of the
simulation box is taken to be at (0,0,0):</p>
<div class="math notranslate nohighlight">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\]</div>
<p>The default is to take unit cell information from the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> instance. The optional
argument <cite>box</cite> can be used to provide alternative unit cell information
(in the MDAnalysis standard format
<code class="docutils literal notranslate"><span class="pre">[Lx,</span> <span class="pre">Ly,</span> <span class="pre">Lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>).</p>
<p>Works with either orthogonal or triclinic box types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a> is identical to <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="MDAnalysis.core.groups.ResidueGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wrap()</span></code></a> with all default
keywords.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.pack_into_box()</span></code></a> is currently faster than
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ResidueGroup.pack_into_box()</span></code></a> or
<a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SegmentGroup.pack_into_box()</span></code></a>.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.residues">
<em class="property">property </em><code class="sig-name descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> itself.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.copy" title="MDAnalysis.core.groups.ResidueGroup.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a></dt><dd><p>return a true copy of the <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a></p>
</dd>
</dl>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>In previous versions, this returned a copy, but now
the <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> itself is returned. This should
not affect any code but only speed up calculations.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param">R</em>, <em class="sig-param">point=(0</em>, <em class="sig-param">0</em>, <em class="sig-param">0)</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation matrix <cite>R</cite> to the selection’s coordinates.
<span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is a 3x3 orthogonal matrix that transforms a vector
<span class="math notranslate nohighlight">\(\mathbf{x} \rightarrow \mathbf{x}'\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\mathbf{x}\]</div>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are rotated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<em>array_like</em>) – 3x3 rotation matrix</p></li>
<li><p><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Center of rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>By default, rotates about the origin <code class="docutils literal notranslate"><span class="pre">point=(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>. To rotate
a group <code class="docutils literal notranslate"><span class="pre">g</span></code> around its center of geometry, use
<code class="docutils literal notranslate"><span class="pre">g.rotate(R,</span> <span class="pre">point=g.center_of_geometry())</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.rotateby" title="MDAnalysis.core.groups.ResidueGroup.rotateby"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rotateby()</span></code></a></dt><dd><p>rotate around given axis and angle</p>
</dd>
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.rotateby">
<code class="sig-name descname">rotateby</code><span class="sig-paren">(</span><em class="sig-param">angle</em>, <em class="sig-param">axis</em>, <em class="sig-param">point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.rotateby" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation to the selection’s coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Rotation angle in degrees.</p></li>
<li><p><strong>axis</strong> (<em>array_like</em>) – Rotation axis vector.</p></li>
<li><p><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Center of rotation. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then the center of geometry of this
group is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The transformation from current coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>
to new coordinates <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span> is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\,(\mathbf{x}-\mathbf{p}) + \mathbf{p}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is the rotation by <cite>angle</cite> around the
<cite>axis</cite> going through <cite>point</cite> <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations.rotation_matrix()</span></code></p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate()</span></code></dt><dd><p>math:<cite>mathsf{R}</cite></p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.segments">
<em class="property">property </em><code class="sig-name descname">segments</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sorted <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> of the unique segments present in
the <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.subtract">
<code class="sig-name descname">subtract</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Group with elements from this Group that don’t appear in other</p>
<p>The original order of this group is kept, as well as any duplicate
elements. If an element of this Group is duplicated and appears in
the other Group or Component, then all the occurences of that element
are removed from the returned Group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>,
conserves order and duplicates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Unlike <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> this method will not sort or remove
duplicates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">-</span> <span class="n">ag2</span>  <span class="c1"># or ag1.subtract(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span><span class="o">.</span><span class="n">indices</span>
<span class="go">array([3, 3, 1, 1])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="MDAnalysis.core.groups.ResidueGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.symmetric_difference">
<code class="sig-name descname">symmetric_difference</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are only in one of this Group or another</p>
<p>This method removes duplicate elements and the result is sorted. It is
synomym to the <cite>^</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements that are in <cite>self</cite> or in <cite>other</cite> but not in
both, without duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">^</span> <span class="n">ag2</span>  <span class="c1"># or ag1.symmetric_difference(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="o">.</span><span class="n">indices</span>  <span class="c1"># 0 and 1 are only in ag1, 4 and 6 are only in ag2</span>
<span class="go">[0, 1, 4, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.difference" title="MDAnalysis.core.groups.ResidueGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">M</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply homogenous transformation matrix <cite>M</cite> to the coordinates.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are rotated and translated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> (<em>array_like</em>) – 4x4 matrix with the rotation in <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">M[:3,</span> <span class="pre">:3]</span></code> and the
translation in <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">M[:3,</span> <span class="pre">3]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is about the origin and is applied
before the translation <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.translate">
<code class="sig-name descname">translate</code><span class="sig-paren">(</span><em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply translation vector <cite>t</cite> to the selection’s coordinates.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are translated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>array_like</em>) – vector to translate coordinates with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The method applies a translation to the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>
from current coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> to new coordinates
<span class="math notranslate nohighlight">\(\mathbf{x}'\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements either in this Group or another</p>
<p>On the contrary to concatenation, this method sort the elements and
removes duplicate ones. It is synomymous to the <cite>|</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the combined elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>In contrast to <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="MDAnalysis.core.groups.ResidueGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, any duplicates are dropped
and the result is sorted.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag1.union(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;O&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.concatenate" title="MDAnalysis.core.groups.ResidueGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.intersection" title="MDAnalysis.core.groups.ResidueGroup.intersection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">intersection()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.unique">
<em class="property">property </em><code class="sig-name descname">unique</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> containing sorted and unique
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a> only.</p>
<p>If the <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> is unique, this is the group itself.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span>
<span class="go">&lt;ResidueGroup with 6 residues&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([2, 1, 2, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span> <span class="o">=</span> <span class="n">rg</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span>
<span class="go">&lt;ResidueGroup with 3 residues&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([0, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rg2</span><span class="o">.</span><span class="n">unique</span> <span class="ow">is</span> <span class="n">rg2</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>If the <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> is already
unique, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.unique" title="MDAnalysis.core.groups.ResidueGroup.unique"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ResidueGroup.unique</span></code></a> now returns the group itself
instead of a copy.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.universe">
<em class="property">property </em><code class="sig-name descname">universe</code><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.universe" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> the group
belongs to.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.unwrap">
<code class="sig-name descname">unwrap</code><span class="sig-paren">(</span><em class="sig-param">compound='fragments'</em>, <em class="sig-param">reference='com'</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.unwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Move atoms of this group so that bonds within the
group’s compounds aren’t split across periodic boundaries.</p>
<p>This function is most useful when atoms have been packed into the
primary unit cell, causing breaks mid-molecule, with the molecule then
appearing on either side of the unit cell. This is problematic for
operations such as calculating the center of mass of the molecule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+-----------+       +-----------+
|           |       |           |
| 6       3 |       |         3 | 6
| !       ! |       |         ! | !
|-5-8   1-2-|  ==&gt;  |       1-2-|-5-8
| !       ! |       |         ! | !
| 7       4 |       |         4 | 7
|           |       |           |
+-----------+       +-----------+
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>,                     </em><em>'fragments'}</em><em>, </em><em>optional</em>) – Which type of component to unwrap. Note that, in any case, all
atoms within each compound must be interconnected by bonds, i.e.,
compounds must correspond to (parts of) molecules.</p></li>
<li><p><strong>reference</strong> (<em>{'com'</em><em>, </em><em>'cog'</em><em>, </em><em>None}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'com'</span></code> (center of mass) or <code class="docutils literal notranslate"><span class="pre">'cog'</span></code> (center of geometry), the
unwrapped compounds will be shifted so that their individual
reference point lies within the primary unit cell.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no such shift is performed.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, coordinates are modified in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Unwrapped atom coordinate array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> but the underlying topology does
    not contain molecule information, or if <cite>reference</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code>
    but the topology does not contain masses.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>reference</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'com'</span></code>, <code class="docutils literal notranslate"><span class="pre">'cog'</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, or
    if <cite>reference</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code> and the total mass of any <cite>compound</cite> is
    zero.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware of the fact that only atoms <em>belonging to the group</em> will
be unwrapped! If you want entire molecules to be unwrapped, make sure
that all atoms of these molecules are part of the group.</p>
<p>An AtomGroup containing all atoms of all fragments in the group <code class="docutils literal notranslate"><span class="pre">ag</span></code>
can be created with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_frag_atoms</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ag</span><span class="o">.</span><span class="n">fragments</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../lib/mdamath.html#MDAnalysis.lib.mdamath.make_whole" title="MDAnalysis.lib.mdamath.make_whole"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_whole()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="MDAnalysis.core.groups.ResidueGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wrap()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">apply_PBC()</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.ResidueGroup.wrap">
<code class="sig-name descname">wrap</code><span class="sig-paren">(</span><em class="sig-param">compound='atoms'</em>, <em class="sig-param">center='com'</em>, <em class="sig-param">box=None</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the contents of this group back into the primary unit cell
according to periodic boundary conditions.</p>
<p>Specifying a <cite>compound</cite> will keep the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in each
compound together during the process. If <cite>compound</cite> is different from
<code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, each compound as a whole will be shifted so that its
<cite>center</cite> lies within the primary unit cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>{'atoms'</em><em>, </em><em>'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>,                     </em><em>'fragments'}</em><em>, </em><em>optional</em>) – Which type of component to keep together during wrapping. Note that,
in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>center</strong> (<em>{'com'</em><em>, </em><em>'cog'}</em>) – How to define the center of a given group of atoms. If <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, this parameter is meaningless and therefore ignored.</p></li>
<li><p><strong>box</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>The unitcell dimensions of the system, which can be orthogonal or
triclinic and must be provided in the same format as returned by
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>:</p>
<p><code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses the
dimensions of the current time step.</p>
</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, coordinates will be changed in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of wrapped atom coordinates of dtype <cite>np.float32</cite> and shape
<code class="docutils literal notranslate"><span class="pre">(len(self.atoms.n_atoms),</span> <span class="pre">3)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, <code class="docutils literal notranslate"><span class="pre">'group'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums) or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds or if
    <cite>center</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code> but the topology doesn’t contain masses.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All atoms of the group will be moved so that the centers of its
compounds lie within the primary periodic image. For orthorhombic unit
cells, the primary periodic image is defined as the half-open interval
<span class="math notranslate nohighlight">\([0,L_i)\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and boxlength <span class="math notranslate nohighlight">\(L_i\)</span> in all
dimensions <span class="math notranslate nohighlight">\(i\in\{x,y,z\}\)</span>, i.e., the origin of the of the
simulation box is taken to be at the origin <span class="math notranslate nohighlight">\((0,0,0)\)</span> of the
euclidian coordinate system. A compound center residing at position
<span class="math notranslate nohighlight">\(x_i\)</span> in dimension <span class="math notranslate nohighlight">\(i\)</span> will be shifted to <span class="math notranslate nohighlight">\(x_i'\)</span>
according to</p>
<div class="math notranslate nohighlight">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\,.\]</div>
<p>When specifying a <cite>compound</cite>, the translation is calculated based on
each compound. The same translation is applied to all atoms
within this compound, meaning it will not be broken by the shift.
This might however mean that not all atoms of a compound will be
inside the unit cell after wrapping, but rather will be the center of
the compound.</p>
<p>Be aware of the fact that only atoms <em>belonging to the group</em> will be
taken into account!</p>
<p><cite>center</cite> allows to define how the center of each group is computed.
This can be either <code class="docutils literal notranslate"><span class="pre">'com'</span></code> for center of mass, or <code class="docutils literal notranslate"><span class="pre">'cog'</span></code> for center
of geometry.</p>
<p><cite>box</cite> allows a unit cell to be given for the transformation. If not
specified, the <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dimensions</span></code></a>
information from the current
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> will be used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="MDAnalysis.core.groups.AtomGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.wrap()</span></code></a> is currently faster than
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="MDAnalysis.core.groups.ResidueGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ResidueGroup.wrap()</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="MDAnalysis.core.groups.SegmentGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SegmentGroup.wrap()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.unwrap" title="MDAnalysis.core.groups.ResidueGroup.unwrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unwrap()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">MDanalysis.lib.distances.apply_PBC()</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>The method only acts on atoms <em>belonging to the group</em> and returns
the wrapped positions as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.
Added optional argument <cite>inplace</cite>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.SegmentGroup">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">SegmentGroup</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#SegmentGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> base class.</p>
<p>This class is used by a <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> for
generating its Topology-specific <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> class. All the
<a class="reference internal" href="topologyattrs.html#MDAnalysis.core.topologyattrs.TopologyAttr" title="MDAnalysis.core.topologyattrs.TopologyAttr"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyAttr</span></code></a> components are obtained
from <code class="xref py py-class docutils literal notranslate"><span class="pre">GroupBase</span></code>, so this class only includes ad-hoc methods specific
to <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroups</span></code></a>.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroups</span></code></a> can be compared and combined using
group operators. See the list of these operators on <code class="xref py py-class docutils literal notranslate"><span class="pre">GroupBase</span></code>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of Segments will be removed in the 1.0 release.
See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for details and
alternatives.</p>
</div>
<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.accumulate">
<code class="sig-name descname">accumulate</code><span class="sig-paren">(</span><em class="sig-param">attribute</em>, <em class="sig-param">function=&lt;function sum&gt;</em>, <em class="sig-param">compound='group'</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.accumulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulates the attribute associated with (compounds of) the group.</p>
<p>Accumulates the attribute of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group.
The accumulation per <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule,
or fragment can be obtained by setting the <cite>compound</cite> parameter
accordingly. By default, the method sums up all attributes per compound,
but any function that takes an array and returns an acuumulation over a
given axis can be used. For multi-dimensional input arrays, the
accumulation is performed along the first axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attribute</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>array_like</em>) – Attribute or array of values to accumulate.
If a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> (or compatible) is provided, its first
dimension must have the same length as the total number of atoms in
the group.</p></li>
<li><p><strong>function</strong> (<em>callable</em><em>, </em><em>optional</em>) – The function performing the accumulation. It must take the array of
attribute values to accumulate as its only positional argument and
accept an (optional) keyword argument <code class="docutils literal notranslate"><span class="pre">axis</span></code> allowing to specify
the axis along which the accumulation is performed.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>,                   </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the accumulation of all attributes associated with
atoms in the group will be returned as a single value. Otherwise,
the accumulation of the attributes per <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>,
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, molecule, or fragment will be returned as a 1d
array. Note that, in any case, <em>only</em> the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Acuumulation of the <cite>attribute</cite>.
If <cite>compound</cite> is set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the first dimension of the
<cite>attribute</cite> array will be contracted to a single value.
If <cite>compound</cite> is set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>, the length of the first
dimension will correspond to the number of compounds. In all cases,
the other dimensions of the returned array will be of the original
shape (without the first dimension).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the length of a provided <cite>attribute</cite> array does not correspond to
    the number of atoms in the group.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums), or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the total charge of a given <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;charges&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the total mass per residue of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s1">&#39;residues&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the maximum atomic charge per fragment of a given
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="s1">&#39;charges&#39;</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s2">&quot;fragments&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.atoms">
<em class="property">property </em><code class="sig-name descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> present in this
<a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> are ordered locally by <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, which
are further ordered by <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> in the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>.
Duplicates are <em>not</em> removed.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.bbox">
<code class="sig-name descname">bbox</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding box of the selection.</p>
<p>The lengths A,B,C of the orthorhombic enclosing box are</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">bbox</span><span class="p">()</span>
<span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, move all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to the primary unit cell
before calculation. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corners</strong> – 2x3 array giving corners of bounding box as
<code class="docutils literal notranslate"><span class="pre">[[xmin,</span> <span class="pre">ymin,</span> <span class="pre">zmin],</span> <span class="pre">[xmax,</span> <span class="pre">ymax,</span> <span class="pre">zmax]]</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.bsphere">
<code class="sig-name descname">bsphere</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.bsphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the bounding sphere of the selection.</p>
<p>The sphere is calculated relative to the
<a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.center_of_geometry" title="MDAnalysis.core.groups.SegmentGroup.center_of_geometry"><code class="xref py py-meth docutils literal notranslate"><span class="pre">center</span> <span class="pre">of</span> <span class="pre">geometry</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, move all atoms to the primary unit cell before
calculation. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>R</strong> (<em>float</em>) – Radius of the bounding sphere.</p></li>
<li><p><strong>center</strong> (<em>numpy.ndarray</em>) – Coordinates of the sphere center as <code class="docutils literal notranslate"><span class="pre">[xcen,</span> <span class="pre">ycen,</span> <span class="pre">zcen]</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> when set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> allows the <em>pbc</em> flag to be used by default.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.3.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <em>pbc</em> keyword</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.center">
<code class="sig-name descname">center</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.center" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted center of (compounds of) the group</p>
<p>Computes the weighted center of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group.
Weighted centers per <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or
fragment can be obtained by setting the <cite>compound</cite> parameter
accordingly. If the weights of a compound sum up to zero, the
coordinates of that compound’s weighted center will be <code class="docutils literal notranslate"><span class="pre">nan</span></code> (not a
number).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) – Weights to be used. Setting <cite>weights=None</cite> is equivalent to passing
identical weights for all atoms of the group.</p></li>
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>,
the center of each compound will be calculated without moving any
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the compounds intact. Instead, the
resulting position vectors will be moved to the primary unit cell
after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the weighted center of all atoms in the group will
be returned as a single position vector. Else, the weighted centers
of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, molecule, or fragment
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the weighted center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>, the output will be a 2d array
of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If both ‘pbc’ and ‘unwrap’ set to true.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums) or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To find the center of charge of a given <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;prop mass &gt; 4.0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">charges</span><span class="p">)</span>
</pre></div>
</div>
<p>To find the centers of mass per residue of all CA <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">sel</span><span class="o">.</span><span class="n">masses</span><span class="p">,</span> <span class="n">compound</span><span class="o">=</span><span class="s1">&#39;residues&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.center_of_geometry">
<code class="sig-name descname">center_of_geometry</code><span class="sig-paren">(</span><em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.center_of_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry of (compounds of) the group.</p>
<p>Computes the center of geometry (a.k.a. centroid) of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group. Centers of geometry per
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or fragment can be
obtained by setting the <cite>compound</cite> parameter accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the center of each compound will
be calculated without moving any <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the
compounds intact. Instead, the resulting position vectors will be
moved to the primary unit cell after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the center of geometry of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
in the group will be returned as a single position vector. Else, the
centers of geometry of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the geometric center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the
output will be a 2d array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.centroid">
<code class="sig-name descname">centroid</code><span class="sig-paren">(</span><em class="sig-param">pbc=None</em>, <em class="sig-param">compound='group'</em>, <em class="sig-param">unwrap=False</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Center of geometry of (compounds of) the group.</p>
<p>Computes the center of geometry (a.k.a. centroid) of
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the group. Centers of geometry per
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, molecule, or fragment can be
obtained by setting the <cite>compound</cite> parameter accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, move all atoms to the
primary unit cell before calculation. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the center of each compound will
be calculated without moving any <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> to keep the
compounds intact. Instead, the resulting position vectors will be
moved to the primary unit cell after calculation.</p></li>
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>, </em><em>'fragments'}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the center of geometry of all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
in the group will be returned as a single position vector. Else, the
centers of geometry of each <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>
will be returned as an array of position vectors, i.e. a 2d array.
Note that, in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>unwrap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, compounds will be unwrapped before computing their centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center</strong> – Position vector(s) of the geometric center(s) of the group.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'group'</span></code>, the output will be a single
position vector.
If <cite>compound</cite> was set to <code class="docutils literal notranslate"><span class="pre">'segments'</span></code> or <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, the
output will be a 2d array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of compounds.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If the <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.flags</span></code> flag <em>use_pbc</em> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> then the <cite>pbc</cite> keyword is used by default.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>Added <cite>pbc</cite> keyword</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>Added <cite>compound</cite> parameter</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> and <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>
compounds</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>Added <cite>unwrap</cite> parameter</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.concatenate">
<code class="sig-name descname">concatenate</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate with another Group or Component of the same level.</p>
<p>Duplicate entries and original order is preserved. It is synomymous to
the <cite>+</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with elements of <cite>self</cite> and <cite>other</cite> concatenated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The order of the original contents (including duplicates)
are preserved when performing a concatenation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">+</span> <span class="n">ag2</span>  <span class="c1"># or ag1.concatenate(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;O&#39;, &#39;O&#39;, &#39;O&#39;], dtype=object)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;N&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another group identical to this one.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.difference">
<code class="sig-name descname">difference</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Elements from this Group that do not appear in another</p>
<p>This method removes duplicate elements and sorts the result. As such,
it is different from <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.subtract" title="MDAnalysis.core.groups.SegmentGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>. <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> is synomymous
to the <cite>-</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.subtract" title="MDAnalysis.core.groups.SegmentGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtract()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.symmetric_difference" title="MDAnalysis.core.groups.SegmentGroup.symmetric_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">symmetric_difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.dimensions">
<em class="property">property </em><code class="sig-name descname">dimensions</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain a copy of the dimensions of the currently loaded Timestep</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.groupby">
<code class="sig-name descname">groupby</code><span class="sig-paren">(</span><em class="sig-param">topattrs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.groupby" title="Permalink to this definition">¶</a></dt>
<dd><p>Group together items in this group according to values of <em>topattr</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topattrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – One or more topology attributes to group components by.
Single arguments are passed as a string. Multiple arguments
are passed as a list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Unique values of the multiple combinations of topology attributes
as keys, Groups as values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>To group atoms with the same mass together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
<span class="go">{12.010999999999999: &lt;AtomGroup with 462 atoms&gt;,</span>
<span class="go"> 14.007: &lt;AtomGroup with 116 atoms&gt;,</span>
<span class="go"> 15.999000000000001: &lt;AtomGroup with 134 atoms&gt;}</span>
</pre></div>
</div>
<p>To group atoms with the same residue name and mass together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;resnames&#39;</span><span class="p">,</span> <span class="s1">&#39;masses&#39;</span><span class="p">])</span>
<span class="go">{(&#39;ALA&#39;, 1.008): &lt;AtomGroup with 95 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 12.011): &lt;AtomGroup with 57 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 14.007): &lt;AtomGroup with 19 atoms&gt;,</span>
<span class="go"> (&#39;ALA&#39;, 15.999): &lt;AtomGroup with 19 atoms&gt;},</span>
<span class="go"> (&#39;ARG&#39;, 1.008): &lt;AtomGroup with 169 atoms&gt;,</span>
<span class="go"> ...}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;resnames&#39;</span><span class="p">,</span> <span class="s1">&#39;masses&#39;</span><span class="p">])(</span><span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="mf">15.999</span><span class="p">)</span>
<span class="go"> &lt;AtomGroup with 19 atoms&gt;</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.18.0: </span>The function accepts multiple attributes</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.intersection">
<code class="sig-name descname">intersection</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are in both this Group and another</p>
<p>This method removes duplicate elements and sorts the result. It is
synomymous to the <cite>&amp;</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the common elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Intersections can be used when the select atoms string would
become too complicated.  For example to find the water atoms
which are within 4.0A of two segments:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shell1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL and around 4.0 segid 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shell2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname SOL and around 4.0 segid 2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">common</span> <span class="o">=</span> <span class="n">shell1</span> <span class="o">&amp;</span> <span class="n">shell2</span>  <span class="c1"># or shell1.intersection(shell2)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.union" title="MDAnalysis.core.groups.SegmentGroup.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.is_strict_subset">
<code class="sig-name descname">is_strict_subset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.is_strict_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a subset of another Group but not identical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a strict subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.is_strict_superset">
<code class="sig-name descname">is_strict_superset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.is_strict_superset" title="Permalink to this definition">¶</a></dt>
<dd><p>If this Group is a superset of another Group but not identical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a strict superset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.isdisjoint">
<code class="sig-name descname">isdisjoint</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>If the Group has no elements in common with the other Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the two Groups do not have common elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.issubset">
<code class="sig-name descname">issubset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of this Group are part of another Group</p>
<p>Note that an empty group is a subset of any group of the same level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.issuperset">
<code class="sig-name descname">issuperset</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>If all elements of another Group are part of this Group</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if this Group is a subset of the other one</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.isunique">
<em class="property">property </em><code class="sig-name descname">isunique</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.isunique" title="Permalink to this definition">¶</a></dt>
<dd><p>Boolean indicating whether all components of the group are unique,
i.e., the group contains no duplicates.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span>
<span class="go">&lt;AtomGroup with 6 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag</span><span class="o">.</span><span class="n">isunique</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">ag</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span><span class="o">.</span><span class="n">isunique</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.ix">
<em class="property">property </em><code class="sig-name descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<ul class="simple">
<li><p>If this Group is an <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>, these are the
indices of the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> instances.</p></li>
<li><p>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> instances.</p></li>
<li><p>If it is a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>, these are the indices of
the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> instances.</p></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.ix_array">
<em class="property">property </em><code class="sig-name descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique indices of the components in the Group.</p>
<p>For a Group, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.ix_array" title="MDAnalysis.core.groups.SegmentGroup.ix_array"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix_array</span></code></a> is the same as <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.ix" title="MDAnalysis.core.groups.SegmentGroup.ix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix</span></code></a>. This method
gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.ix" title="MDAnalysis.core.groups.SegmentGroup.ix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.n_atoms">
<em class="property">property </em><code class="sig-name descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms present in the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>, including
duplicate segments (and thus, duplicate atoms).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self.atoms)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.n_residues">
<em class="property">property </em><code class="sig-name descname">n_residues</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.n_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of residues present in this <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>, including
duplicate segments (and thus, residues).</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self.residues)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.n_segments">
<em class="property">property </em><code class="sig-name descname">n_segments</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.n_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of segments in the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">len(self)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.pack_into_box">
<code class="sig-name descname">pack_into_box</code><span class="sig-paren">(</span><em class="sig-param">box=None</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift all <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in this group to the primary unit
cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<em>array_like</em>) – Box dimensions, can be either orthogonal or triclinic information.
Cell dimensions must be in an identical to format to those returned
by <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>,
<code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses these
timestep dimensions.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> to change coordinates in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Shifted atom coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All atoms will be moved so that they lie between 0 and boxlength
<span class="math notranslate nohighlight">\(L_i\)</span> in all dimensions, i.e. the lower left corner of the
simulation box is taken to be at (0,0,0):</p>
<div class="math notranslate nohighlight">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\]</div>
<p>The default is to take unit cell information from the underlying
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> instance. The optional
argument <cite>box</cite> can be used to provide alternative unit cell information
(in the MDAnalysis standard format
<code class="docutils literal notranslate"><span class="pre">[Lx,</span> <span class="pre">Ly,</span> <span class="pre">Lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>).</p>
<p>Works with either orthogonal or triclinic box types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a> is identical to <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="MDAnalysis.core.groups.SegmentGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wrap()</span></code></a> with all default
keywords.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.pack_into_box" title="MDAnalysis.core.groups.AtomGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.pack_into_box()</span></code></a> is currently faster than
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.pack_into_box" title="MDAnalysis.core.groups.ResidueGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ResidueGroup.pack_into_box()</span></code></a> or
<a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SegmentGroup.pack_into_box()</span></code></a>.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.residues">
<em class="property">property </em><code class="sig-name descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a> present in this
<a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a> are ordered locally by
<a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> in the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a>. Duplicates are <em>not</em>
removed.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param">R</em>, <em class="sig-param">point=(0</em>, <em class="sig-param">0</em>, <em class="sig-param">0)</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation matrix <cite>R</cite> to the selection’s coordinates.
<span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is a 3x3 orthogonal matrix that transforms a vector
<span class="math notranslate nohighlight">\(\mathbf{x} \rightarrow \mathbf{x}'\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\mathbf{x}\]</div>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are rotated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<em>array_like</em>) – 3x3 rotation matrix</p></li>
<li><p><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Center of rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>By default, rotates about the origin <code class="docutils literal notranslate"><span class="pre">point=(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>. To rotate
a group <code class="docutils literal notranslate"><span class="pre">g</span></code> around its center of geometry, use
<code class="docutils literal notranslate"><span class="pre">g.rotate(R,</span> <span class="pre">point=g.center_of_geometry())</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.rotateby" title="MDAnalysis.core.groups.SegmentGroup.rotateby"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rotateby()</span></code></a></dt><dd><p>rotate around given axis and angle</p>
</dd>
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.rotateby">
<code class="sig-name descname">rotateby</code><span class="sig-paren">(</span><em class="sig-param">angle</em>, <em class="sig-param">axis</em>, <em class="sig-param">point=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.rotateby" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation to the selection’s coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Rotation angle in degrees.</p></li>
<li><p><strong>axis</strong> (<em>array_like</em>) – Rotation axis vector.</p></li>
<li><p><strong>point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Center of rotation. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then the center of geometry of this
group is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The transformation from current coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>
to new coordinates <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span> is</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\,(\mathbf{x}-\mathbf{p}) + \mathbf{p}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is the rotation by <cite>angle</cite> around the
<cite>axis</cite> going through <cite>point</cite> <span class="math notranslate nohighlight">\(\mathbf{p}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations.rotation_matrix()</span></code></p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate()</span></code></dt><dd><p>math:<cite>mathsf{R}</cite></p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.segments">
<em class="property">property </em><code class="sig-name descname">segments</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.segments" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> itself.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.copy" title="MDAnalysis.core.groups.SegmentGroup.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a></dt><dd><p>return a true copy of the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a></p>
</dd>
</dl>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>In previous versions, this returned a copy, but now
the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> itself is returned. This should
not affect any code but only speed up calculations.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.subtract">
<code class="sig-name descname">subtract</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Group with elements from this Group that don’t appear in other</p>
<p>The original order of this group is kept, as well as any duplicate
elements. If an element of this Group is duplicated and appears in
the other Group or Component, then all the occurences of that element
are removed from the returned Group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements of <cite>self</cite> that are not in  <cite>other</cite>,
conserves order and duplicates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Unlike <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a> this method will not sort or remove
duplicates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">-</span> <span class="n">ag2</span>  <span class="c1"># or ag1.subtract(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span><span class="o">.</span><span class="n">indices</span>
<span class="go">array([3, 3, 1, 1])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="MDAnalysis.core.groups.SegmentGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.symmetric_difference">
<code class="sig-name descname">symmetric_difference</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements which are only in one of this Group or another</p>
<p>This method removes duplicate elements and the result is sorted. It is
synomym to the <cite>^</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the elements that are in <cite>self</cite> or in <cite>other</cite> but not in
both, without duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">^</span> <span class="n">ag2</span>  <span class="c1"># or ag1.symmetric_difference(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="o">.</span><span class="n">indices</span>  <span class="c1"># 0 and 1 are only in ag1, 4 and 6 are only in ag2</span>
<span class="go">[0, 1, 4, 6]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.difference" title="MDAnalysis.core.groups.SegmentGroup.difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">difference()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">M</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply homogenous transformation matrix <cite>M</cite> to the coordinates.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are rotated and translated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> (<em>array_like</em>) – 4x4 matrix with the rotation in <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">M[:3,</span> <span class="pre">:3]</span></code> and the
translation in <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">M[:3,</span> <span class="pre">3]</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The rotation <span class="math notranslate nohighlight">\(\mathsf{R}\)</span> is about the origin and is applied
before the translation <span class="math notranslate nohighlight">\(\mathbf{t}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathsf{R}\mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.translate">
<code class="sig-name descname">translate</code><span class="sig-paren">(</span><em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply translation vector <cite>t</cite> to the selection’s coordinates.</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> coordinates are translated in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>array_like</em>) – vector to translate coordinates with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/transformations.html#module-MDAnalysis.lib.transformations" title="MDAnalysis.lib.transformations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.lib.transformations()</span></code></a></dt><dd><p>module of all coordinate transforms</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The method applies a translation to the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>
from current coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> to new coordinates
<span class="math notranslate nohighlight">\(\mathbf{x}'\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x}' = \mathbf{x} + \mathbf{t}\]</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><em class="sig-param">other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Group of elements either in this Group or another</p>
<p>On the contrary to concatenation, this method sort the elements and
removes duplicate ones. It is synomymous to the <cite>|</cite> operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Group</em><em> or </em><em>Component</em>) – Group or Component with <cite>other.level</cite> same as <cite>self.level</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Group with the combined elements of <cite>self</cite> and <cite>other</cite>, without
duplicate elements</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Group</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>In contrast to <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="MDAnalysis.core.groups.SegmentGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, any duplicates are dropped
and the result is sorted.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ag1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name N&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span> <span class="o">=</span> <span class="n">ag1</span> <span class="o">|</span> <span class="n">ag2</span>  <span class="c1"># or ag1.union(ag2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ag3</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">names</span>
<span class="go">array([&#39;N&#39;, &#39;O&#39;, &#39;N&#39;], dtype=object)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.concatenate" title="MDAnalysis.core.groups.SegmentGroup.concatenate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">concatenate()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.intersection" title="MDAnalysis.core.groups.SegmentGroup.intersection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">intersection()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.unique">
<em class="property">property </em><code class="sig-name descname">unique</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> containing sorted and unique
<a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segments</span></code></a> only.</p>
<p>If the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> is unique, this is the group itself.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">segments</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span>
<span class="go">&lt;SegmentGroup with 6 segments&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([2, 1, 2, 2, 1, 0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span> <span class="o">=</span> <span class="n">sg</span><span class="o">.</span><span class="n">unique</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span>
<span class="go">&lt;SegmentGroup with 3 segments&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span><span class="o">.</span><span class="n">ix</span>
<span class="go">array([0, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sg2</span><span class="o">.</span><span class="n">unique</span> <span class="ow">is</span> <span class="n">sg2</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>If the <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup" title="MDAnalysis.core.groups.SegmentGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">SegmentGroup</span></code></a> is already
unique, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.unique" title="MDAnalysis.core.groups.SegmentGroup.unique"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SegmentGroup.unique</span></code></a> now returns the group itself
instead of a copy.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.universe">
<em class="property">property </em><code class="sig-name descname">universe</code><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.universe" title="Permalink to this definition">¶</a></dt>
<dd><p>The underlying <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> the group
belongs to.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.unwrap">
<code class="sig-name descname">unwrap</code><span class="sig-paren">(</span><em class="sig-param">compound='fragments'</em>, <em class="sig-param">reference='com'</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.unwrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Move atoms of this group so that bonds within the
group’s compounds aren’t split across periodic boundaries.</p>
<p>This function is most useful when atoms have been packed into the
primary unit cell, causing breaks mid-molecule, with the molecule then
appearing on either side of the unit cell. This is problematic for
operations such as calculating the center of mass of the molecule.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+-----------+       +-----------+
|           |       |           |
| 6       3 |       |         3 | 6
| !       ! |       |         ! | !
|-5-8   1-2-|  ==&gt;  |       1-2-|-5-8
| !       ! |       |         ! | !
| 7       4 |       |         4 | 7
|           |       |           |
+-----------+       +-----------+
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>{'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>,                     </em><em>'fragments'}</em><em>, </em><em>optional</em>) – Which type of component to unwrap. Note that, in any case, all
atoms within each compound must be interconnected by bonds, i.e.,
compounds must correspond to (parts of) molecules.</p></li>
<li><p><strong>reference</strong> (<em>{'com'</em><em>, </em><em>'cog'</em><em>, </em><em>None}</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">'com'</span></code> (center of mass) or <code class="docutils literal notranslate"><span class="pre">'cog'</span></code> (center of geometry), the
unwrapped compounds will be shifted so that their individual
reference point lies within the primary unit cell.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no such shift is performed.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, coordinates are modified in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Unwrapped atom coordinate array of shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code> but the underlying topology does
    not contain molecule information, or if <cite>reference</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code>
    but the topology does not contain masses.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>reference</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'com'</span></code>, <code class="docutils literal notranslate"><span class="pre">'cog'</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>, or
    if <cite>reference</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code> and the total mass of any <cite>compound</cite> is
    zero.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware of the fact that only atoms <em>belonging to the group</em> will
be unwrapped! If you want entire molecules to be unwrapped, make sure
that all atoms of these molecules are part of the group.</p>
<p>An AtomGroup containing all atoms of all fragments in the group <code class="docutils literal notranslate"><span class="pre">ag</span></code>
can be created with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">all_frag_atoms</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ag</span><span class="o">.</span><span class="n">fragments</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../lib/mdamath.html#MDAnalysis.lib.mdamath.make_whole" title="MDAnalysis.lib.mdamath.make_whole"><code class="xref py py-func docutils literal notranslate"><span class="pre">make_whole()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="MDAnalysis.core.groups.SegmentGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wrap()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">apply_PBC()</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.SegmentGroup.wrap">
<code class="sig-name descname">wrap</code><span class="sig-paren">(</span><em class="sig-param">compound='atoms'</em>, <em class="sig-param">center='com'</em>, <em class="sig-param">box=None</em>, <em class="sig-param">inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the contents of this group back into the primary unit cell
according to periodic boundary conditions.</p>
<p>Specifying a <cite>compound</cite> will keep the <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in each
compound together during the process. If <cite>compound</cite> is different from
<code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, each compound as a whole will be shifted so that its
<cite>center</cite> lies within the primary unit cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compound</strong> (<em>{'atoms'</em><em>, </em><em>'group'</em><em>, </em><em>'segments'</em><em>, </em><em>'residues'</em><em>, </em><em>'molecules'</em><em>,                     </em><em>'fragments'}</em><em>, </em><em>optional</em>) – Which type of component to keep together during wrapping. Note that,
in any case, <em>only</em> the positions of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>
<em>belonging to the group</em> will be taken into account.</p></li>
<li><p><strong>center</strong> (<em>{'com'</em><em>, </em><em>'cog'}</em>) – How to define the center of a given group of atoms. If <cite>compound</cite> is
<code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, this parameter is meaningless and therefore ignored.</p></li>
<li><p><strong>box</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>The unitcell dimensions of the system, which can be orthogonal or
triclinic and must be provided in the same format as returned by
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep.dimensions</span></code></a>:</p>
<p><code class="docutils literal notranslate"><span class="pre">[lx,</span> <span class="pre">ly,</span> <span class="pre">lz,</span> <span class="pre">alpha,</span> <span class="pre">beta,</span> <span class="pre">gamma]</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses the
dimensions of the current time step.</p>
</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, coordinates will be changed in place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of wrapped atom coordinates of dtype <cite>np.float32</cite> and shape
<code class="docutils literal notranslate"><span class="pre">(len(self.atoms.n_atoms),</span> <span class="pre">3)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <cite>compound</cite> is not one of <code class="docutils literal notranslate"><span class="pre">'atoms'</span></code>, <code class="docutils literal notranslate"><span class="pre">'group'</span></code>,
    <code class="docutils literal notranslate"><span class="pre">'segments'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residues'</span></code>, <code class="docutils literal notranslate"><span class="pre">'molecules'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code>.</p></li>
<li><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If <cite>compound</cite> is <code class="docutils literal notranslate"><span class="pre">'molecule'</span></code> but the topology doesn’t
    contain molecule information (molnums) or if <cite>compound</cite> is
    <code class="docutils literal notranslate"><span class="pre">'fragments'</span></code> but the topology doesn’t contain bonds or if
    <cite>center</cite> is <code class="docutils literal notranslate"><span class="pre">'com'</span></code> but the topology doesn’t contain masses.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All atoms of the group will be moved so that the centers of its
compounds lie within the primary periodic image. For orthorhombic unit
cells, the primary periodic image is defined as the half-open interval
<span class="math notranslate nohighlight">\([0,L_i)\)</span> between <span class="math notranslate nohighlight">\(0\)</span> and boxlength <span class="math notranslate nohighlight">\(L_i\)</span> in all
dimensions <span class="math notranslate nohighlight">\(i\in\{x,y,z\}\)</span>, i.e., the origin of the of the
simulation box is taken to be at the origin <span class="math notranslate nohighlight">\((0,0,0)\)</span> of the
euclidian coordinate system. A compound center residing at position
<span class="math notranslate nohighlight">\(x_i\)</span> in dimension <span class="math notranslate nohighlight">\(i\)</span> will be shifted to <span class="math notranslate nohighlight">\(x_i'\)</span>
according to</p>
<div class="math notranslate nohighlight">
\[x_i' = x_i - \left\lfloor\frac{x_i}{L_i}\right\rfloor\,.\]</div>
<p>When specifying a <cite>compound</cite>, the translation is calculated based on
each compound. The same translation is applied to all atoms
within this compound, meaning it will not be broken by the shift.
This might however mean that not all atoms of a compound will be
inside the unit cell after wrapping, but rather will be the center of
the compound.</p>
<p>Be aware of the fact that only atoms <em>belonging to the group</em> will be
taken into account!</p>
<p><cite>center</cite> allows to define how the center of each group is computed.
This can be either <code class="docutils literal notranslate"><span class="pre">'com'</span></code> for center of mass, or <code class="docutils literal notranslate"><span class="pre">'cog'</span></code> for center
of geometry.</p>
<p><cite>box</cite> allows a unit cell to be given for the transformation. If not
specified, the <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dimensions</span></code></a>
information from the current
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> will be used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.wrap" title="MDAnalysis.core.groups.AtomGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.wrap()</span></code></a> is currently faster than
<a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup.wrap" title="MDAnalysis.core.groups.ResidueGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ResidueGroup.wrap()</span></code></a> or <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.wrap" title="MDAnalysis.core.groups.SegmentGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SegmentGroup.wrap()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.pack_into_box" title="MDAnalysis.core.groups.SegmentGroup.pack_into_box"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pack_into_box()</span></code></a>, <a class="reference internal" href="#MDAnalysis.core.groups.SegmentGroup.unwrap" title="MDAnalysis.core.groups.SegmentGroup.unwrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unwrap()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">MDanalysis.lib.distances.apply_PBC()</span></code></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.20.0: </span>The method only acts on atoms <em>belonging to the group</em> and returns
the wrapped positions as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.
Added optional argument <cite>inplace</cite>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">UpdatingAtomGroup</code><span class="sig-paren">(</span><em class="sig-param">base_group</em>, <em class="sig-param">selections</em>, <em class="sig-param">strings</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#UpdatingAtomGroup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> subclass that dynamically updates its selected atoms.</p>
<p>Accessing any attribute/method of an <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> instance
triggers a check for the last frame the group was updated. If the last
frame matches the current trajectory frame, the attribute is returned
normally; otherwise the group is updated (the stored selections are
re-applied), and only then is the attribute returned.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_group</strong> (<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>) – group on which <em>selections</em> are to be applied.</p></li>
<li><p><strong>selections</strong> (a tuple of <code class="xref py py-class docutils literal notranslate"><span class="pre">Selection</span></code>) – instances selections ready to be applied to <em>base_group</em>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup.atoms">
<em class="property">property </em><code class="sig-name descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a <em>static</em> <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> identical to the group of currently
selected <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> in the <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a>.</p>
<p>By returning a <em>static</em> <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> it becomes possible to
compare the contents of the group <em>between</em> trajectory frames. See the
Example below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup.atoms" title="MDAnalysis.core.groups.UpdatingAtomGroup.atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">atoms</span></code></a> attribute of an <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> behaves
differently from <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.atoms" title="MDAnalysis.core.groups.AtomGroup.atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AtomGroup.atoms</span></code></a>: the latter returns the
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> itself whereas the former returns a
<a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> and not an <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> (for this, use
<a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup.copy" title="MDAnalysis.core.groups.UpdatingAtomGroup.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UpdatingAtomGroup.copy()</span></code></a>).</p>
</div>
<p class="rubric">Example</p>
<p>The static <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup.atoms" title="MDAnalysis.core.groups.UpdatingAtomGroup.atoms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">atoms</span></code></a> allows comparison of groups of atoms between
frames. For example, track water molecules that move in and out of a
solvation shell of a protein:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">TPR</span><span class="p">,</span> <span class="n">XTC</span><span class="p">)</span>
<span class="n">water_shell</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;name OW and around 3.5 protein&quot;</span><span class="p">,</span> <span class="n">updating</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">water_shell_prev</span> <span class="o">=</span> <span class="n">water_shell</span><span class="o">.</span><span class="n">atoms</span>

<span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
    <span class="n">exchanged</span> <span class="o">=</span> <span class="n">water_shell</span> <span class="o">-</span> <span class="n">water_shell_prev</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s2">&quot;waters in shell =&quot;</span><span class="p">,</span> <span class="n">water_shell</span><span class="o">.</span><span class="n">n_residues</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s2">&quot;waters that exchanged = &quot;</span><span class="p">,</span> <span class="n">exchanged</span><span class="o">.</span><span class="n">n_residues</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="s2">&quot;waters that remained bound = &quot;</span><span class="p">,</span>
          <span class="n">water_shell</span><span class="o">.</span><span class="n">n_residues</span> <span class="o">-</span> <span class="n">exchanged</span><span class="o">.</span><span class="n">n_residues</span><span class="p">)</span>

    <span class="n">water_shell_prev</span> <span class="o">=</span> <span class="n">water_shell</span><span class="o">.</span><span class="n">atoms</span>
</pre></div>
</div>
<p>By remembering the atoms of the current time step in
<cite>water_shell_prev</cite>, it becomes possible to use the <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup.subtract" title="MDAnalysis.core.groups.AtomGroup.subtract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">subtraction</span>
<span class="pre">of</span> <span class="pre">AtomGroups</span></code></a> to find the water molecules that
changed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup.copy" title="MDAnalysis.core.groups.UpdatingAtomGroup.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a></dt><dd><p>return a true copy of the <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a></p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#UpdatingAtomGroup.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get another <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup" title="MDAnalysis.core.groups.UpdatingAtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdatingAtomGroup</span></code></a> identical to this one.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate">
<em class="property">property </em><code class="sig-name descname">is_uptodate</code><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the selection needs updating based on frame number only.</p>
<p>Modifications to the coordinate data that render selections stale are
not caught, and in those cases <a class="reference internal" href="#MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate" title="MDAnalysis.core.groups.UpdatingAtomGroup.is_uptodate"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_uptodate</span></code></a> may return an
erroneous value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the group’s selection is up-to-date, <code class="docutils literal notranslate"><span class="pre">False</span></code>
otherwise.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.UpdatingAtomGroup.update_selection">
<code class="sig-name descname">update_selection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#UpdatingAtomGroup.update_selection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.UpdatingAtomGroup.update_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Forces the reevaluation and application of the group’s selection(s).</p>
<p>This method is triggered automatically when accessing attributes, if
the last update occurred under a different trajectory frame.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="chemical-units">
<h3><span class="section-number">10.1.2.1.2. </span>Chemical units<a class="headerlink" href="#chemical-units" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="MDAnalysis.core.groups.Atom">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">Atom</code><span class="sig-paren">(</span><em class="sig-param">ix</em>, <em class="sig-param">u</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#Atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> base class.</p>
<p>This class is used by a <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> for
generating its Topology-specific <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> class. All the
<a class="reference internal" href="topologyattrs.html#MDAnalysis.core.topologyattrs.TopologyAttr" title="MDAnalysis.core.topologyattrs.TopologyAttr"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyAttr</span></code></a> components are obtained
from <code class="xref py py-class docutils literal notranslate"><span class="pre">ComponentBase</span></code>, so this class only includes ad-hoc methods
specific to <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a>.</p>
<dl class="method">
<dt id="MDAnalysis.core.groups.Atom.force">
<em class="property">property </em><code class="sig-name descname">force</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.force" title="Permalink to this definition">¶</a></dt>
<dd><p>Force on the atom.</p>
<p>The force can be changed by assigning an array of shape <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>changing the force is not reflected in any files; reading any
frame from the trajectory will replace the change with that
from the file</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If the underlying <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a>
    does not contain
    <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.forces" title="MDAnalysis.coordinates.base.Timestep.forces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forces</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Atom.ix">
<em class="property">property </em><code class="sig-name descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component.</p>
<p>If this component is an <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>, this is the index of the
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>.
If it is a <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, this is the index of the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>.
If it is a <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, this is the index of the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Atom.ix_array">
<em class="property">property </em><code class="sig-name descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component as an array.</p>
<p>This method gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Atom.ix" title="MDAnalysis.core.groups.Atom.ix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Atom.position">
<em class="property">property </em><code class="sig-name descname">position</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.position" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates of the atom.</p>
<p>The position can be changed by assigning an array of length (3,).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>changing the position is not reflected in any files; reading
any frame from the trajectory will replace the change with
that from the file</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If the underlying <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a>
    does not contain
    <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.positions" title="MDAnalysis.coordinates.base.Timestep.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">positions</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Atom.velocity">
<em class="property">property </em><code class="sig-name descname">velocity</code><a class="headerlink" href="#MDAnalysis.core.groups.Atom.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Velocity of the atom.</p>
<p>The velocity can be changed by assigning an array of shape <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>changing the velocity is not reflected in any files; reading
any frame from the trajectory will replace the change with
that from the file</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If the underlying <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a>
    does not contain
    <a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep.velocities" title="MDAnalysis.coordinates.base.Timestep.velocities"><code class="xref py py-attr docutils literal notranslate"><span class="pre">velocities</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.Residue">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">Residue</code><span class="sig-paren">(</span><em class="sig-param">ix</em>, <em class="sig-param">u</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#Residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> base class.</p>
<p>This class is used by a <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> for
generating its Topology-specific <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> class. All the
<a class="reference internal" href="topologyattrs.html#MDAnalysis.core.topologyattrs.TopologyAttr" title="MDAnalysis.core.topologyattrs.TopologyAttr"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyAttr</span></code></a> components are obtained
from <code class="xref py py-class docutils literal notranslate"><span class="pre">ComponentBase</span></code>, so this class only includes ad-hoc methods
specific to <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a>.</p>
<dl class="method">
<dt id="MDAnalysis.core.groups.Residue.atoms">
<em class="property">property </em><code class="sig-name descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.Residue.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> present in this
<a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Residue.ix">
<em class="property">property </em><code class="sig-name descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.Residue.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component.</p>
<p>If this component is an <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>, this is the index of the
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>.
If it is a <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, this is the index of the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>.
If it is a <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, this is the index of the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Residue.ix_array">
<em class="property">property </em><code class="sig-name descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.Residue.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component as an array.</p>
<p>This method gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Residue.ix" title="MDAnalysis.core.groups.Residue.ix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Residue.segment">
<em class="property">property </em><code class="sig-name descname">segment</code><a class="headerlink" href="#MDAnalysis.core.groups.Residue.segment" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> this <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> belongs to.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.core.groups.Segment">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.groups.</code><code class="sig-name descname">Segment</code><span class="sig-paren">(</span><em class="sig-param">ix</em>, <em class="sig-param">u</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/groups.html#Segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.groups.Segment" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> base class.</p>
<p>This class is used by a <a class="reference internal" href="universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> for
generating its Topology-specific <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a> class. All the
<a class="reference internal" href="topologyattrs.html#MDAnalysis.core.topologyattrs.TopologyAttr" title="MDAnalysis.core.topologyattrs.TopologyAttr"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyAttr</span></code></a> components are obtained
from <code class="xref py py-class docutils literal notranslate"><span class="pre">ComponentBase</span></code>, so this class only includes ad-hoc methods
specific to <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segments</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.2: </span><em>Instant selectors</em> of <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segments</span></code></a> will be removed in the
1.0 release. See <a class="reference internal" href="../selections.html#instance-selectors"><span class="std std-ref">Instant selectors</span></a> for
details and alternatives.</p>
</div>
<dl class="method">
<dt id="MDAnalysis.core.groups.Segment.atoms">
<em class="property">property </em><code class="sig-name descname">atoms</code><a class="headerlink" href="#MDAnalysis.core.groups.Segment.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code></a> present in this
<a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Segment.ix">
<em class="property">property </em><code class="sig-name descname">ix</code><a class="headerlink" href="#MDAnalysis.core.groups.Segment.ix" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component.</p>
<p>If this component is an <a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>, this is the index of the
<a class="reference internal" href="#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>.
If it is a <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>, this is the index of the <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a>.
If it is a <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>, this is the index of the <a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Segment.ix_array">
<em class="property">property </em><code class="sig-name descname">ix_array</code><a class="headerlink" href="#MDAnalysis.core.groups.Segment.ix_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique index of this component as an array.</p>
<p>This method gives a consistent API between components and groups.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.core.groups.Segment.ix" title="MDAnalysis.core.groups.Segment.ix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ix</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.groups.Segment.residues">
<em class="property">property </em><code class="sig-name descname">residues</code><a class="headerlink" href="#MDAnalysis.core.groups.Segment.residues" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code></a> of <a class="reference internal" href="#MDAnalysis.core.groups.Residue" title="MDAnalysis.core.groups.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residues</span></code></a> present in this
<a class="reference internal" href="#MDAnalysis.core.groups.Segment" title="MDAnalysis.core.groups.Segment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Segment</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="levels">
<h3><span class="section-number">10.1.2.1.3. </span>Levels<a class="headerlink" href="#levels" title="Permalink to this headline">¶</a></h3>
<p>Each of the above classes has a <em>level</em> attribute.  This can be used to verify
that two objects are of the same level, or to access a particular class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">()</span>

<span class="n">ag</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">at</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span>

<span class="n">ag</span><span class="o">.</span><span class="n">level</span> <span class="o">==</span> <span class="n">at</span><span class="o">.</span><span class="n">level</span>  <span class="c1"># Returns True</span>

<span class="n">ag</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">singular</span>  <span class="c1"># Returns Atom class</span>
<span class="n">at</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">plural</span>  <span class="c1"># Returns AtomGroup class</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">7. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">8. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">9. Auxiliary modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../core_modules.html">10. Core modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../core_modules.html#important-objects-for-users">10.1. Important objects for users</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="universe.html">10.1.1. Core object: Universe — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.universe</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">10.1.2. Core objects: Containers — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.groups</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#classes">10.1.2.1. Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#topology-system">10.2. Topology system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#selection-system">10.3. Selection system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#flag-system">10.4. Flag system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">11. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">12. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">13. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">14. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">15. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">16. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../core_modules.html"><span class="section-number">10. </span>Core modules</a><ul>
      <li>Previous: <a href="universe.html" title="previous chapter"><span class="section-number">10.1.1. </span>Core object: Universe — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.universe</span></code></a></li>
      <li>Next: <a href="topology.html" title="next chapter"><span class="section-number">10.2.1. </span>Core Topology object — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.topology</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Matthieu Chavent, Kathleen Clark, Ruggero Cortini, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Henry Mull, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Kashish Punjani, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Xiki Tempula, Matthew W. Thompson, Matteo Tiberti, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/documentation_pages/core/groups.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>