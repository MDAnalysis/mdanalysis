
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>10.1.1. Core object: Universe — MDAnalysis.core.universe &#8212; MDAnalysis 0.20.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.20.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10.1.2. Core objects: Containers — MDAnalysis.core.groups" href="groups.html" />
    <link rel="prev" title="10. Core modules" href="../core_modules.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.core.universe"></span><div class="section" id="core-object-universe-mdanalysis-core-universe">
<h1><span class="section-number">10.1.1. </span>Core object: Universe — <a class="reference internal" href="#module-MDAnalysis.core.universe" title="MDAnalysis.core.universe"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.universe</span></code></a><a class="headerlink" href="#core-object-universe-mdanalysis-core-universe" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> class ties a topology
and a trajectory together. Almost all code in MDAnalysis starts with a
<code class="docutils literal notranslate"><span class="pre">Universe</span></code>.</p>
<p>Normally, a <code class="docutils literal notranslate"><span class="pre">Universe</span></code> is created from files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;topology.psf&quot;</span><span class="p">,</span> <span class="s2">&quot;trajectory.dcd&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to construct new simulation system it is also convenient to
construct a <code class="docutils literal notranslate"><span class="pre">Universe</span></code> from existing
<code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code> instances with the
<a class="reference internal" href="#MDAnalysis.core.universe.Merge" title="MDAnalysis.core.universe.Merge"><code class="xref py py-func docutils literal notranslate"><span class="pre">Merge()</span></code></a> function.</p>
<div class="section" id="working-with-universes">
<h2><span class="section-number">10.1.1.1. </span>Working with Universes<a class="headerlink" href="#working-with-universes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quick-segid-selection">
<h3><span class="section-number">10.1.1.1.1. </span>Quick segid selection<a class="headerlink" href="#quick-segid-selection" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.2: </span>Instant selectors will be removed in the 1.0 release.  See issue <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/1377">#1377</a> for more details.</p>
</div>
<p>If the loaded topology provided segids, then these are made accessible
as attributes of the Universe.  If the segid starts with a number such
as ‘4AKE’, the letter ‘s’ will be prepended to the segid.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysisTests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span><span class="p">)</span>
<span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;segid 4AKE&#39;</span><span class="p">)</span>  <span class="c1"># selects all segments with segid 4AKE</span>
</pre></div>
</div>
<p>If only a single segment has that segid then a Segment object will
be returned, otherwise a SegmentGroup will be returned.</p>
</div>
</div>
<div class="section" id="classes">
<h2><span class="section-number">10.1.1.2. </span>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.core.universe.Universe">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.core.universe.</code><code class="sig-name descname">Universe</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe" title="Permalink to this definition">¶</a></dt>
<dd><p>The MDAnalysis Universe contains all the information describing the system.</p>
<p>The system always requires a <em>topology</em> file — in the simplest case just
a list of atoms. This can be a CHARMM/NAMD PSF file or a simple coordinate
file with atom informations such as XYZ, PDB, Gromacs GRO, or CHARMM
CRD. See <a class="reference internal" href="../topology/init.html#supported-topology-formats"><span class="std std-ref">Table of Supported Topology Formats</span></a> for what kind of topologies can
be read.</p>
<p>A trajectory provides coordinates; the coordinates have to be ordered in
the same way as the list of atoms in the topology. A trajectory can be a
single frame such as a PDB, CRD, or GRO file, or it can be a MD trajectory
(in CHARMM/NAMD/LAMMPS DCD, Gromacs XTC/TRR, or generic XYZ format).  See
<a class="reference internal" href="../coordinates/init.html#id2"><span class="std std-ref">Table of supported coordinate formats</span></a> for what can be read as a
“trajectory”.</p>
<p>As a special case, when the topology is a file that contains atom
information <em>and</em> coordinates (such as XYZ, PDB, GRO or CRD, see
<a class="reference internal" href="../coordinates/init.html#id2"><span class="std std-ref">Table of supported coordinate formats</span></a>) then the coordinates are immediately
loaded from the “topology” file unless a trajectory is supplied.</p>
<p>Examples for setting up a universe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>          <span class="c1"># read system from file(s)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>                       <span class="c1"># read atoms and coordinates from PDB or GRO</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="p">[</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="c1"># read from a list of trajectories</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>   <span class="c1"># read from multiple trajectories</span>
</pre></div>
</div>
<p>Load new data into a universe (replaces old trajectory and does <em>not</em> append):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">load_new</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>                      <span class="c1"># read from a new trajectory file</span>
</pre></div>
</div>
<p>Select atoms, with syntax similar to CHARMM (see
<a class="reference internal" href="#MDAnalysis.core.universe.Universe.select_atoms" title="MDAnalysis.core.universe.Universe.select_atoms"><code class="xref py py-class docutils literal notranslate"><span class="pre">select_atoms</span></code></a> for details):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>Topology object</em><em> or </em><em>stream</em>) – A CHARMM/XPLOR PSF topology file, PDB file or Gromacs GRO file; used to
define the list of atoms. If the file includes bond information,
partial charges, atom masses, … then these data will be available to
MDAnalysis. A “structure” file (PSF, PDB or GRO, in the sense of a
topology) is always required. Alternatively, an existing
<a class="reference internal" href="topology.html#MDAnalysis.core.topology.Topology" title="MDAnalysis.core.topology.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.topology.Topology</span></code></a> instance may also be given.</p></li>
<li><p><strong>topology_format</strong> – Provide the file format of the topology file; <code class="docutils literal notranslate"><span class="pre">None</span></code> guesses it from
the file extension [<code class="docutils literal notranslate"><span class="pre">None</span></code>] Can also pass a subclass of
<a class="reference internal" href="../topology/base.html#MDAnalysis.topology.base.TopologyReaderBase" title="MDAnalysis.topology.base.TopologyReaderBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.topology.base.TopologyReaderBase</span></code></a> to define a custom
reader to be used on the topology file.</p></li>
<li><p><strong>format</strong> – Provide the file format of the coordinate or trajectory file; <code class="docutils literal notranslate"><span class="pre">None</span></code>
guesses it from the file extension. Note that this keyword has no
effect if a list of file names is supplied because the “chained” reader
has to guess the file format for each individual list member.
[<code class="docutils literal notranslate"><span class="pre">None</span></code>] Can also pass a subclass of
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader" title="MDAnalysis.coordinates.base.ProtoReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.ProtoReader</span></code></a> to define a custom
reader to be used on the trajectory file.</p></li>
<li><p><strong>all_coordinates</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> specifies that if more than one filename is passed
they are all to be used, if possible, as coordinate files (employing a
<a class="reference internal" href="../coordinates/chain.html#MDAnalysis.coordinates.chain.ChainReader" title="MDAnalysis.coordinates.chain.ChainReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.chain.ChainReader</span></code></a>). [<code class="docutils literal notranslate"><span class="pre">False</span></code>] The
default behavior is to take the first file as a topology and the
remaining as coordinates. The first argument will always always be used
to infer a topology regardless of <em>all_coordinates</em>. This parameter is
ignored if only one argument is passed.</p></li>
<li><p><strong>guess_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Once Universe has been loaded, attempt to guess the connectivity
between atoms.  This will populate the .bonds .angles and .dihedrals
attributes of the Universe.</p></li>
<li><p><strong>vdwradii</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – For use with <em>guess_bonds</em>. Supply a dict giving a vdwradii for each
atom type which are used in guessing bonds.</p></li>
<li><p><strong>is_anchor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – When unpickling instances of
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a> existing Universes are
searched for one where to anchor those atoms. Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to
prevent this Universe from being considered. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>anchor_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Setting to other than <code class="docutils literal notranslate"><span class="pre">None</span></code> will cause
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a> instances pickled from the
Universe to only unpickle if a compatible Universe with matching
<em>anchor_name</em> is found. Even if <em>anchor_name</em> is set <em>is_anchor</em> will
still be honored when unpickling.</p></li>
<li><p><strong>transformations</strong> (<em>function</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – Provide a list of transformations that you wish to apply to the
trajectory upon reading. Transformations can be found in
<a class="reference internal" href="../trajectory_transformations.html#module-MDAnalysis.transformations" title="MDAnalysis.transformations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.transformations</span></code></a>, or can be user-created.</p></li>
<li><p><strong>in_memory</strong> – After reading in the trajectory, transfer it to an in-memory
representations, which allow for manipulation of coordinates.</p></li>
<li><p><strong>in_memory_step</strong> – Only read every nth frame into in-memory representation.</p></li>
<li><p><strong>continuous</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – The <cite>continuous</cite> option is used by the
<a class="reference internal" href="../coordinates/chain.html#module-MDAnalysis.coordinates.chain" title="MDAnalysis.coordinates.chain"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ChainReader</span></code></a>, which contains the
functionality to treat independent trajectory files as a single virtual
trajectory.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.trajectory">
<code class="sig-name descname">trajectory</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>currently loaded trajectory reader;</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.core.universe.Universe.dimensions">
<code class="sig-name descname">dimensions</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>current system dimensions (simulation unit cell, if set in the
trajectory)</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">atoms, residues, segments</code></dt>
<dd><p>master Groups for each topology level</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="sig-name descname">bonds, angles, dihedrals</code></dt>
<dd><p>master ConnectivityGroups for each connectivity type</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.add_Residue">
<code class="sig-name descname">add_Residue</code><span class="sig-paren">(</span><em class="sig-param">segment=None</em>, <em class="sig-param">**attrs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.add_Residue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.add_Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new Residue to this Universe</p>
<p>New Residues will not contain any Atoms, but can be assigned to Atoms
as per usual.  If the Universe contains multiple segments, this must
be specified as a keyword.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment</strong> (<em>MDAnalysis.Segment</em>) – If there are multiple segments, then the Segment that the new
Residue will belong in must be specified.</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – For each Residue attribute, the value for the new Residue must be
specified</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A reference to the new Residue</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If any information was missing.  This happens before any changes have
    been made, ie the change is rolled back.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Adding a new GLY residue, then placing atoms within it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">newres</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">add_Residue</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resid</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">resname</span><span class="o">=</span><span class="s1">&#39;GLY&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">residues</span> <span class="o">=</span> <span class="n">newres</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resname GLY and resid 42&#39;</span><span class="p">)</span>
<span class="go">&lt;AtomGroup with 3 atoms&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.add_Segment">
<code class="sig-name descname">add_Segment</code><span class="sig-paren">(</span><em class="sig-param">**attrs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.add_Segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.add_Segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new Segment to this Universe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – For each Segment attribute as a key, give the value in the new
Segment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A reference to the new Segment</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><strong>NoDataError</strong></a> – If any attributes were not specified as a keyword.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.add_TopologyAttr">
<code class="sig-name descname">add_TopologyAttr</code><span class="sig-paren">(</span><em class="sig-param">topologyattr</em>, <em class="sig-param">values=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.add_TopologyAttr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.add_TopologyAttr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new topology attribute to the Universe</p>
<p>Adding a TopologyAttribute to the Universe makes it available to
all AtomGroups etc throughout the Universe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topologyattr</strong> (<a class="reference internal" href="topologyattrs.html#MDAnalysis.core.topologyattrs.TopologyAttr" title="MDAnalysis.core.topologyattrs.TopologyAttr"><em>TopologyAttr</em></a><em> or </em><em>string</em>) – Either a MDAnalysis TopologyAttr object or the name of a possible
topology attribute.</p></li>
<li><p><strong>values</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – If initiating an attribute from a string, the initial values to
use.  If not supplied, the new TopologyAttribute will have empty
or zero values.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>For example to add bfactors to a Universe:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">add_TopologyAttr</span><span class="p">(</span><span class="s1">&#39;bfactors&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">bfactors</span>
<span class="go">array([ 0.,  0.,  0., ...,  0.,  0.,  0.])</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Can now also add TopologyAttrs with a string of the name of the
attribute to add (eg ‘charges’), can also supply initial values
using values keyword.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.angles">
<em class="property">property </em><code class="sig-name descname">angles</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Angles between atoms</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.bonds">
<em class="property">property </em><code class="sig-name descname">bonds</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Bonds between atoms</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.coord">
<em class="property">property </em><code class="sig-name descname">coord</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference to current timestep and coordinates of universe.</p>
<p>The raw trajectory coordinates are <code class="xref py py-attr docutils literal notranslate"><span class="pre">Universe.coord.positions</span></code>,
represented as a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code> array.</p>
<p>Because <a class="reference internal" href="#MDAnalysis.core.universe.Universe.coord" title="MDAnalysis.core.universe.Universe.coord"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coord</span></code></a> is a reference to a
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a>, it changes its contents
while one is stepping through the trajectory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to access the coordinates it is better to use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">AtomGroup.positions()</span></code> method; for instance, all coordinates of
the Universe as a numpy array: <code class="xref py py-meth docutils literal notranslate"><span class="pre">Universe.atoms.positions()</span></code>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an independent copy of this Universe</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.dihedrals">
<em class="property">property </em><code class="sig-name descname">dihedrals</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Dihedral angles between atoms</p>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">dimensions</code></dt>
<dd><p>Current dimensions of the unitcell</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.empty">
<em class="property">classmethod </em><code class="sig-name descname">empty</code><span class="sig-paren">(</span><em class="sig-param">n_atoms</em>, <em class="sig-param">n_residues=None</em>, <em class="sig-param">n_segments=None</em>, <em class="sig-param">atom_resindex=None</em>, <em class="sig-param">residue_segindex=None</em>, <em class="sig-param">trajectory=False</em>, <em class="sig-param">velocities=False</em>, <em class="sig-param">forces=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.empty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a blank Universe</p>
<p>Useful for building a Universe without requiring existing files,
for example for system building.</p>
<p>If <cite>trajectory</cite> is set to True, a
<a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a> will be
attached to the Universe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – number of Atoms in the Universe</p></li>
<li><p><strong>n_residues</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – number of Residues in the Universe, defaults to 1</p></li>
<li><p><strong>n_segments</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – number of Segments in the Universe, defaults to 1</p></li>
<li><p><strong>atom_resindex</strong> (<em>array like</em><em>, </em><em>optional</em>) – mapping of atoms to residues, e.g. with 6 atoms,
<cite>atom_resindex=[0, 0, 1, 1, 2, 2]</cite> would put 2 atoms
into each of 3 residues.</p></li>
<li><p><strong>residue_segindex</strong> (<em>array like</em><em>, </em><em>optional</em>) – mapping of residues to segments</p></li>
<li><p><strong>trajectory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, attaches a <a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a>
allowing coordinates to be set and written.  Default is False</p></li>
<li><p><strong>velocities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – include velocities in the <a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a></p></li>
<li><p><strong>forces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – include forces in the <a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>MDAnalysis.Universe object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For example to create a new Universe with 6 atoms in 2 residues, with
positions for the atoms and a mass attribute:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="go">                           atom_resindex=np.array([0, 0, 0, 1, 1, 1]),</span>
<span class="go">                           trajectory=True,</span>
<span class="go">        )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">add_TopologyAttr</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.19.0: </span>The attached Reader when trajectory=True is now a MemoryReader</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.impropers">
<em class="property">property </em><code class="sig-name descname">impropers</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.impropers" title="Permalink to this definition">¶</a></dt>
<dd><p>Improper dihedral angles between atoms</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.is_anchor">
<em class="property">property </em><code class="sig-name descname">is_anchor</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.is_anchor" title="Permalink to this definition">¶</a></dt>
<dd><p>Is this Universe an anchoring for unpickling AtomGroups</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.kwargs">
<em class="property">property </em><code class="sig-name descname">kwargs</code><a class="headerlink" href="#MDAnalysis.core.universe.Universe.kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>keyword arguments used to initialize this universe</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.load_new">
<code class="sig-name descname">load_new</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">format=None</em>, <em class="sig-param">in_memory=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.load_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.load_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Load coordinates from <cite>filename</cite>.</p>
<p>The file format of <cite>filename</cite> is autodetected from the file name suffix
or can be explicitly set with the <cite>format</cite> keyword. A sequence of files
can be read as a single virtual trajectory by providing a list of
filenames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – the coordinate file (single frame or trajectory) <em>or</em> a list of
filenames, which are read one after another.</p></li>
<li><p><strong>format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><em>object</em></a><em> (</em><em>optional</em><em>)</em>) – provide the file format of the coordinate or trajectory file;
<code class="docutils literal notranslate"><span class="pre">None</span></code> guesses it from the file extension. Note that this
keyword has no effect if a list of file names is supplied because
the “chained” reader has to guess the file format for each
individual list member [<code class="docutils literal notranslate"><span class="pre">None</span></code>]. Can also pass a subclass of
<a class="reference internal" href="../coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader" title="MDAnalysis.coordinates.base.ProtoReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.ProtoReader</span></code></a> to define a custom
reader to be used on the trajectory file.</p></li>
<li><p><strong>in_memory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Directly load trajectory into memory with the
<a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MemoryReader</span></code></a></p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
</p></li>
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Other kwargs are passed to the trajectory reader (only for
advanced use)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>universe</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe">Universe</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError if trajectory format can not be</strong> – determined or no appropriate trajectory reader found</p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.8: </span>If a list or sequence that is provided for <cite>filename</cite> only contains
a single entry then it is treated as single coordinate file. This
has the consequence that it is not read by the
<a class="reference internal" href="../coordinates/chain.html#MDAnalysis.coordinates.chain.ChainReader" title="MDAnalysis.coordinates.chain.ChainReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainReader</span></code></a> but directly by
its specialized file format reader, which typically has more
features than the
<a class="reference internal" href="../coordinates/chain.html#MDAnalysis.coordinates.chain.ChainReader" title="MDAnalysis.coordinates.chain.ChainReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainReader</span></code></a>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Now returns a <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> instead of the tuple of file/array
and detected file type.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.remove_anchor">
<code class="sig-name descname">remove_anchor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.remove_anchor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.remove_anchor" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove this Universe from the possible anchor list for unpickling</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.select_atoms">
<code class="sig-name descname">select_atoms</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.select_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.select_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Select atoms.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.select_atoms()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt>
<em class="property">property </em><code class="sig-name descname">trajectory</code></dt>
<dd><p>Reference to trajectory reader object containing trajectory data.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.core.universe.Universe.transfer_to_memory">
<code class="sig-name descname">transfer_to_memory</code><span class="sig-paren">(</span><em class="sig-param">start=None</em>, <em class="sig-param">stop=None</em>, <em class="sig-param">step=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Universe.transfer_to_memory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Universe.transfer_to_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer the trajectory to in memory representation.</p>
<p>Replaces the current trajectory reader object with one of type
<a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a> to support in-place
editing of coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – start reading from the nth frame.</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – read upto and excluding the nth frame.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Read in every nth frame. [1]</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Will print the progress of loading trajectory to memory, if
set to True. Default value is False.</p></li>
</ul>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="functions">
<h2><span class="section-number">10.1.1.3. </span>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="MDAnalysis.core.universe.Merge">
<code class="sig-prename descclassname">MDAnalysis.core.universe.</code><code class="sig-name descname">Merge</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/core/universe.html#Merge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.core.universe.Merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new new <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> from one or more
<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> (<a class="reference internal" href="groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>) – One or more AtomGroups.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>universe</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – Too few arguments or an AtomGroup is empty and</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><strong>TypeError</strong></a> – Arguments are not <code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code> instances.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The resulting <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> will only inherit the common topology
attributes that all merged universes share.</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code> instances can come from different Universes, or can come
directly from a <a class="reference internal" href="#MDAnalysis.core.universe.Universe.select_atoms" title="MDAnalysis.core.universe.Universe.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> call.</p>
<p><a class="reference internal" href="#MDAnalysis.core.universe.Merge" title="MDAnalysis.core.universe.Merge"><code class="xref py py-class docutils literal notranslate"><span class="pre">Merge</span></code></a> can also be used with a single <code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code> if the
user wants to, for example, re-order the atoms in the <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>.</p>
<p>If multiple <code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code> instances from the same <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>
are given, the merge will first simply “add” together the
<code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code> instances.</p>
<p>Merging does not create a full trajectory but only a single structure even
if the input consists of one or more trajectories.  However, one can use
the <a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MemoryReader</span></code></a> to construct a
trajectory for the new Universe as described under
<a class="reference internal" href="../coordinates/memory.html#creating-in-memory-trajectory-label"><span class="std std-ref">Creating an in-memory trajectory of a sub-system</span></a>.</p>
<p class="rubric">Example</p>
<p>In this example, protein, ligand, and solvent were externally prepared in
three different PDB files. They are loaded into separate <a class="reference internal" href="#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>
objects (where they could be further manipulated, e.g. renumbered,
relabeled, rotated, …) The <a class="reference internal" href="#MDAnalysis.core.universe.Merge" title="MDAnalysis.core.universe.Merge"><code class="xref py py-func docutils literal notranslate"><span class="pre">Merge()</span></code></a> command is used to combine all
of them together:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;protein.pdb&quot;</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;ligand.pdb&quot;</span><span class="p">)</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;solvent.pdb&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">u1</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">),</span> <span class="n">u2</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">u3</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;system.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The complete system is then written out to a new PDB file.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.9.0: </span>Raises exceptions instead of assertion errors.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.16.0: </span>The trajectory is now a
<a class="reference internal" href="../coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MemoryReader</span></code></a>.</p>
</div>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">7. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">8. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">9. Auxiliary modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../core_modules.html">10. Core modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../core_modules.html#important-objects-for-users">10.1. Important objects for users</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">10.1.1. Core object: Universe — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.universe</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#working-with-universes">10.1.1.1. Working with Universes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">10.1.1.2. Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#functions">10.1.1.3. Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="groups.html">10.1.2. Core objects: Containers — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.groups</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#topology-system">10.2. Topology system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#selection-system">10.3. Selection system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core_modules.html#flag-system">10.4. Flag system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">11. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">12. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">13. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">14. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">15. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">16. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../core_modules.html"><span class="section-number">10. </span>Core modules</a><ul>
      <li>Previous: <a href="../core_modules.html" title="previous chapter"><span class="section-number">10. </span>Core modules</a></li>
      <li>Next: <a href="groups.html" title="next chapter"><span class="section-number">10.1.2. </span>Core objects: Containers — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.core.groups</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Matthieu Chavent, Kathleen Clark, Ruggero Cortini, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Henry Mull, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Kashish Punjani, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Xiki Tempula, Matthew W. Thompson, Matteo Tiberti, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/documentation_pages/core/universe.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>