
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>4.7.4. Dihedral angles analysis — MDAnalysis.analysis.dihedrals &#8212; MDAnalysis 0.20.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.20.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.8.1. Generating densities from trajectories — MDAnalysis.analysis.density" href="density.html" />
    <link rel="prev" title="4.7.3. Radial Distribution Functions — MDAnalysis.analysis.rdf" href="rdf.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.dihedrals"></span><div class="section" id="dihedral-angles-analysis-mdanalysis-analysis-dihedrals">
<h1><span class="section-number">4.7.4. </span>Dihedral angles analysis — <a class="reference internal" href="#module-MDAnalysis.analysis.dihedrals" title="MDAnalysis.analysis.dihedrals"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.dihedrals</span></code></a><a class="headerlink" href="#dihedral-angles-analysis-mdanalysis-analysis-dihedrals" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Henry Mull</p>
</dd>
<dt class="field-even">Year</dt>
<dd class="field-even"><p>2018</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>GNU Public License v2</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
<p>This module contains classes for calculating dihedral angles for a given set of
atoms or residues. This can be done for selected frames or whole trajectories.</p>
<p>A list of time steps that contain angles of interest is generated and can be
easily plotted if desired. For the <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Ramachandran" title="MDAnalysis.analysis.dihedrals.Ramachandran"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ramachandran</span></code></a>
and <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Janin" title="MDAnalysis.analysis.dihedrals.Janin"><code class="xref py py-class docutils literal notranslate"><span class="pre">Janin</span></code></a> classes, basic plots can be
generated using the method <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Ramachandran.plot" title="MDAnalysis.analysis.dihedrals.Ramachandran.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ramachandran.plot()</span></code></a> or <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Janin.plot" title="MDAnalysis.analysis.dihedrals.Janin.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Janin.plot()</span></code></a>.
These plots are best used as references, but they also allow for user customization.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../lib/distances.html#MDAnalysis.lib.distances.calc_dihedrals" title="MDAnalysis.lib.distances.calc_dihedrals"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.lib.distances.calc_dihedrals()</span></code></a></dt><dd><p>function to calculate dihedral angles from atom positions</p>
</dd>
</dl>
</div>
<div class="section" id="example-applications">
<h2><span class="section-number">4.7.4.1. </span>Example applications<a class="headerlink" href="#example-applications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-dihedral-analysis">
<h3><span class="section-number">4.7.4.1.1. </span>General dihedral analysis<a class="headerlink" href="#general-dihedral-analysis" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Dihedral" title="MDAnalysis.analysis.dihedrals.Dihedral"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code></a> class is useful for calculating
angles for many dihedrals of interest. For example, we can find the phi angles
for residues 5-10 of adenylate kinase (AdK). The trajectory is included within
the test data files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysisTests.datafiles</span> <span class="kn">import</span> <span class="n">GRO</span><span class="p">,</span> <span class="n">XTC</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">GRO</span><span class="p">,</span> <span class="n">XTC</span><span class="p">)</span>

<span class="c1"># selection of atomgroups</span>
<span class="n">ags</span> <span class="o">=</span> <span class="p">[</span><span class="n">res</span><span class="o">.</span><span class="n">phi_selection</span><span class="p">()</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">9</span><span class="p">]]</span>

<span class="kn">from</span> <span class="nn">MDAnalysis.analysis.dihedrals</span> <span class="kn">import</span> <span class="n">Dihedral</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">Dihedral</span><span class="p">(</span><span class="n">ags</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The angles can then be accessed with <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Dihedral.angles" title="MDAnalysis.analysis.dihedrals.Dihedral.angles"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Dihedral.angles</span></code></a>.</p>
</div>
<div class="section" id="ramachandran-analysis">
<h3><span class="section-number">4.7.4.1.2. </span>Ramachandran analysis<a class="headerlink" href="#ramachandran-analysis" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Ramachandran" title="MDAnalysis.analysis.dihedrals.Ramachandran"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ramachandran</span></code></a> class allows for the
quick calculation of phi and psi angles. Unlike the <code class="xref py py-class docutils literal notranslate"><span class="pre">Dihedral</span></code>
class which takes a list of <cite>atomgroups</cite>, this class only needs a list of
residues or atoms from those residues. The previous example can repeated with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">GRO</span><span class="p">,</span> <span class="n">XTC</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;resid 5-10&quot;</span><span class="p">)</span>

<span class="n">R</span> <span class="o">=</span> <span class="n">Ramachandran</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Then it can be plotted using the built-in plotting method <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Ramachandran.plot" title="MDAnalysis.analysis.dihedrals.Ramachandran.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ramachandran.plot()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figaspect</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">R</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>as shown in the example <a class="reference internal" href="#figure-ramachandran"><span class="std std-ref">Ramachandran plot figure</span></a>.</p>
<div class="figure align-default" id="id4">
<span id="figure-ramachandran"></span><a class="reference internal image-reference" href="../../_images/rama_demo_plot.png"><img alt="Ramachandran plot" src="../../_images/rama_demo_plot.png" style="width: 720.0px; height: 720.0px;" /></a>
<p class="caption"><span class="caption-text">Ramachandran plot for residues 5 to 10 of AdK, sampled from the AdK test
trajectory (XTC). The contours in the background are the “allowed region”
and the “marginally allowed” regions.</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p>The Janin class works in the same way, only needing a list of residues; see the
<a class="reference internal" href="#figure-janin"><span class="std std-ref">Janin plot figure</span></a> as an example. To plot the data
yourself, the angles can be accessed using <a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Ramachandran.angles" title="MDAnalysis.analysis.dihedrals.Ramachandran.angles"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Ramachandran.angles</span></code></a> or
<a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Janin.angles" title="MDAnalysis.analysis.dihedrals.Janin.angles"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Janin.angles</span></code></a>.</p>
<p>Reference plots can be added to the axes for both the Ramachandran and Janin
classes using the kwarg <code class="docutils literal notranslate"><span class="pre">ref=True</span></code>. The Ramachandran reference data
(<a class="reference internal" href="data.html#MDAnalysis.analysis.data.filenames.Rama_ref" title="MDAnalysis.analysis.data.filenames.Rama_ref"><code class="xref py py-data docutils literal notranslate"><span class="pre">Rama_ref</span></code></a>) and Janin reference data
(<a class="reference internal" href="data.html#MDAnalysis.analysis.data.filenames.Janin_ref" title="MDAnalysis.analysis.data.filenames.Janin_ref"><code class="xref py py-data docutils literal notranslate"><span class="pre">Janin_ref</span></code></a>) were made using data
obtained from a large selection of 500 PDB files, and were analyzed using these
classes. The allowed and marginally allowed regions of the Ramachandran reference
plt have cutoffs set to include 90% and 99% of the data points, and the Janin
reference plot has cutoffs for 90% and 98% of the data points. The list of PDB
files used for the referece plots was taken from <a class="reference internal" href="#lovell2003" id="id1"><span>[Lovell2003]</span></a> and information
about general Janin regions was taken from <a class="reference internal" href="#janin1978" id="id2"><span>[Janin1978]</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These classes are prone to errors if the topology contains duplicate or missing
atoms (e.g. atoms with <cite>altloc</cite> or incomplete residues). If the topology has as
an <cite>altloc</cite> attribute, you must specify only one <cite>altloc</cite> for the atoms with
more than one (<code class="docutils literal notranslate"><span class="pre">&quot;protein</span> <span class="pre">and</span> <span class="pre">not</span> <span class="pre">altloc</span> <span class="pre">B&quot;</span></code>).</p>
</div>
<div class="figure align-default" id="id5">
<span id="figure-janin"></span><a class="reference internal image-reference" href="../../_images/janin_demo_plot.png"><img alt="Janin plot" src="../../_images/janin_demo_plot.png" style="width: 720.0px; height: 720.0px;" /></a>
<p class="caption"><span class="caption-text">Janin plot for residues 5 to 10 of AdK, sampled from the AdK test trajectory
(XTC). The contours in the background are the “allowed region” and the
“marginally allowed” regions for all possible residues.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="analysis-classes">
<h2><span class="section-number">4.7.4.2. </span>Analysis Classes<a class="headerlink" href="#analysis-classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.dihedrals.Dihedral">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.analysis.dihedrals.</code><code class="sig-name descname">Dihedral</code><span class="sig-paren">(</span><em class="sig-param">atomgroups</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/dihedrals.html#Dihedral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate dihedral angles for specified atomgroups.</p>
<p>Dihedral angles will be calculated for each atomgroup that is given for
each step in the trajectory. Each <a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>
must contain 4 atoms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class takes a list as an input and is most useful for a large
selection of atomgroups. If there is only one atomgroup of interest, then
it must be given as a list of one atomgroup.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atomgroups</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – a list of atomgroups for which the dihedral angles are calculated</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any atomgroups do not contain 4 atoms</p>
</dd>
</dl>
<dl class="attribute">
<dt id="MDAnalysis.analysis.dihedrals.Dihedral.angles">
<code class="sig-name descname">angles</code><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Dihedral.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the time steps of the angles for each atomgroup in the list as
an <code class="docutils literal notranslate"><span class="pre">n_frames×len(atomgroups)</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with content
<code class="docutils literal notranslate"><span class="pre">[[angle</span> <span class="pre">1,</span> <span class="pre">angle</span> <span class="pre">2,</span> <span class="pre">...],</span> <span class="pre">[time</span> <span class="pre">step</span> <span class="pre">2],</span> <span class="pre">...]</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.dihedrals.Dihedral.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">start=None</em>, <em class="sig-param">stop=None</em>, <em class="sig-param">step=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Dihedral.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – start frame of analysis</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – stop frame of analysis</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – number of frames to skip between each analysed frame</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Turn on verbosity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.analysis.dihedrals.Ramachandran">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.analysis.dihedrals.</code><code class="sig-name descname">Ramachandran</code><span class="sig-paren">(</span><em class="sig-param">atomgroup</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/dihedrals.html#Ramachandran"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Ramachandran" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> dihedral angles of selected residues.</p>
<p><span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> angles will be calculated for each residue
corresponding to <cite>atomgroup</cite> for each time step in the trajectory. A
<code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code> is generated from <cite>atomgroup</cite> which is
compared to the protein to determine if it is a legitimate selection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the residue selection is beyond the scope of the protein, then an error
will be raised. If the residue selection includes the first or last residue,
then a warning will be raised and they will be removed from the list of
residues, but the analysis will still run. If a <span class="math notranslate nohighlight">\(\phi\)</span> or <span class="math notranslate nohighlight">\(\psi\)</span>
selection cannot be made, that residue will be removed from the analysis.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atomgroup</strong> (<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><em>AtomGroup</em></a><em> or </em><a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><em>ResidueGroup</em></a>) – atoms for residues for which <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> are
calculated</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the selection of residues is not contained within the protein</p>
</dd>
</dl>
<dl class="attribute">
<dt id="MDAnalysis.analysis.dihedrals.Ramachandran.angles">
<code class="sig-name descname">angles</code><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Ramachandran.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the time steps of the <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> angles for
each residue as an <code class="docutils literal notranslate"><span class="pre">n_frames×n_residues×2</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with
content <code class="docutils literal notranslate"><span class="pre">[[[phi,</span> <span class="pre">psi],</span> <span class="pre">[residue</span> <span class="pre">2],</span> <span class="pre">...],</span> <span class="pre">[time</span> <span class="pre">step</span> <span class="pre">2],</span> <span class="pre">...]</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.dihedrals.Ramachandran.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">ax=None</em>, <em class="sig-param">ref=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/dihedrals.html#Ramachandran.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Ramachandran.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots data into standard ramachandran plot. Each time step in
<a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Ramachandran.angles" title="MDAnalysis.analysis.dihedrals.Ramachandran.angles"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Ramachandran.angles</span></code></a> is plotted onto the same graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>) – If no <cite>ax</cite> is supplied or set to <code class="docutils literal notranslate"><span class="pre">None</span></code> then the plot will
be added to the current active axes.</p></li>
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Adds a general Ramachandran plot which shows allowed and
marginally allowed regions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> – Axes with the plot, either <cite>ax</cite> or the current axes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.dihedrals.Ramachandran.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">start=None</em>, <em class="sig-param">stop=None</em>, <em class="sig-param">step=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Ramachandran.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – start frame of analysis</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – stop frame of analysis</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – number of frames to skip between each analysed frame</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Turn on verbosity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.analysis.dihedrals.Janin">
<em class="property">class </em><code class="sig-prename descclassname">MDAnalysis.analysis.dihedrals.</code><code class="sig-name descname">Janin</code><span class="sig-paren">(</span><em class="sig-param">atomgroup</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/dihedrals.html#Janin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Janin" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <span class="math notranslate nohighlight">\(\chi_1\)</span> and <span class="math notranslate nohighlight">\(\chi_2\)</span> dihedral angles of selected residues.</p>
<p><span class="math notranslate nohighlight">\(\chi_1\)</span> and <span class="math notranslate nohighlight">\(\chi_2\)</span> angles will be calculated for each residue
corresponding to <cite>atomgroup</cite> for each time step in the trajectory. A
<code class="xref py py-class docutils literal notranslate"><span class="pre">ResidueGroup</span></code> is generated from <cite>atomgroup</cite> which is
compared to the protein to determine if it is a legitimate selection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the residue selection is beyond the scope of the protein, then an error
will be raised. If the residue selection includes the residues ALA, CYS,
GLY, PRO, SER, THR, or VAL, then a warning will be raised and they will be
removed from the list of residues, but the analysis will still run. Some
topologies have altloc attribues which can add duplicate atoms to the
selection and must be removed.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atomgroup</strong> (<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><em>AtomGroup</em></a><em> or </em><a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.ResidueGroup" title="MDAnalysis.core.groups.ResidueGroup"><em>ResidueGroup</em></a>) – atoms for residues for which <span class="math notranslate nohighlight">\(\chi_1\)</span> and <span class="math notranslate nohighlight">\(\chi_2\)</span> are
calculated</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the selection of residues is not contained within the protein</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If not enough or too many atoms are found for a residue in the
    selection, usually due to missing atoms or alternative locations</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="MDAnalysis.analysis.dihedrals.Janin.angles">
<code class="sig-name descname">angles</code><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Janin.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the time steps of the <span class="math notranslate nohighlight">\(\chi_1\)</span> and <span class="math notranslate nohighlight">\(\chi_2\)</span> angles
for each residue as an <code class="docutils literal notranslate"><span class="pre">n_frames×n_residues×2</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>
with content <code class="docutils literal notranslate"><span class="pre">[[[chi1,</span> <span class="pre">chi2],</span> <span class="pre">[residue</span> <span class="pre">2],</span> <span class="pre">...],</span> <span class="pre">[time</span> <span class="pre">step</span> <span class="pre">2],</span> <span class="pre">...]</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.dihedrals.Janin.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">ax=None</em>, <em class="sig-param">ref=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/dihedrals.html#Janin.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Janin.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots data into standard Janin plot. Each time step in
<a class="reference internal" href="#MDAnalysis.analysis.dihedrals.Janin.angles" title="MDAnalysis.analysis.dihedrals.Janin.angles"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Janin.angles</span></code></a> is plotted onto the same graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>) – If no <cite>ax</cite> is supplied or set to <code class="docutils literal notranslate"><span class="pre">None</span></code> then the plot will
be added to the current active axes.</p></li>
<li><p><strong>ref</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Adds a general Janin plot which shows allowed and marginally
allowed regions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong> – Axes with the plot, either <cite>ax</cite> or the current axes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.dihedrals.Janin.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">start=None</em>, <em class="sig-param">stop=None</em>, <em class="sig-param">step=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.dihedrals.Janin.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – start frame of analysis</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – stop frame of analysis</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – number of frames to skip between each analysed frame</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Turn on verbosity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="lovell2003"><span class="brackets"><a class="fn-backref" href="#id1">Lovell2003</a></span></dt>
<dd><p>Simon C. Lovell, Ian W. Davis, W. Bryan Arendall III,
Paul I. W. de Bakker, J. Michael Word, Michael G. Prisant,
Jane S. Richardson, and David C. Richardson (2003). “Structure validation by
<span class="math notranslate nohighlight">\(C_{\alpha}\)</span> geometry: <span class="math notranslate nohighlight">\(\phi\)</span>, <span class="math notranslate nohighlight">\(\psi\)</span>, and
<span class="math notranslate nohighlight">\(C_{\beta}\)</span> deviation”. <em>Proteins</em> 50(3): 437-450. doi:
<a class="reference external" href="https://doi.org/10.1002/prot.10286">10.1002/prot.10286</a></p>
</dd>
<dt class="label" id="janin1978"><span class="brackets"><a class="fn-backref" href="#id2">Janin1978</a></span></dt>
<dd><p>Joël Janin, Shoshanna Wodak, Michael Levitt, and Bernard
Maigret. (1978). “Conformation of amino acid side-chains in
proteins”. <em>Journal of Molecular Biology</em> 125(3): 357-386. doi:
<a class="reference external" href="https://doi.org/10.1016/0022-2836(78)90408-4">10.1016/0022-2836(78)90408-4</a></p>
</dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gnm.html">4.7.1. Elastic network analysis of MD trajectories — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.gnm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="helanal.html">4.7.2. HELANAL — analysis of protein helices</a></li>
<li class="toctree-l3"><a class="reference internal" href="rdf.html">4.7.3. Radial Distribution Functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.rdf</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.7.4. Dihedral angles analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.dihedrals</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-applications">4.7.4.1. Example applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#analysis-classes">4.7.4.2. Analysis Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#data">4.11. Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">7. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">8. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">9. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">10. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">11. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">12. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">13. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">14. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">15. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">16. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../analysis_modules.html"><span class="section-number">4. </span>Analysis modules</a><ul>
      <li>Previous: <a href="rdf.html" title="previous chapter"><span class="section-number">4.7.3. </span>Radial Distribution Functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.rdf</span></code></a></li>
      <li>Next: <a href="density.html" title="next chapter"><span class="section-number">4.8.1. </span>Generating densities from trajectories — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.density</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Matthieu Chavent, Kathleen Clark, Ruggero Cortini, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Henry Mull, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Kashish Punjani, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Xiki Tempula, Matthew W. Thompson, Matteo Tiberti, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/documentation_pages/analysis/dihedrals.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>