

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MDAnalysis.analysis.hole2.hole &mdash; MDAnalysis 0.20.2-dev0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../../_static/mdanalysis-logo.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.20.2-dev0 documentation"
          href="../../../../_static/opensearch.xml"/>

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../../../index.html">
          

          
            
            <img src="../../../../_static/mdanalysis-logo-thin.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.20
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/lib_modules.html">13. Library functions — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/version.html">14. Version information for MDAnalysis - <code class="docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/units.html">15. Constants and unit conversion — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/exceptions.html">16. Custom exceptions and warnings — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../documentation_pages/references.html">17. References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">MDAnalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>MDAnalysis.analysis.hole2.hole</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for MDAnalysis.analysis.hole2.hole</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- Mode: python; tab-width: 4; indent-tabs-mode:nil; coding:utf-8 -*-</span>
<span class="c1"># vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4</span>
<span class="c1">#</span>
<span class="c1"># MDAnalysis --- https://www.mdanalysis.org</span>
<span class="c1"># Copyright (c) 2006-2020 The MDAnalysis Development Team and contributors</span>
<span class="c1"># (see the file AUTHORS for the full list of names)</span>
<span class="c1">#</span>
<span class="c1"># Released under the GNU Public Licence, v2 or any higher version</span>
<span class="c1">#</span>
<span class="c1"># Please cite your use of MDAnalysis in published work:</span>
<span class="c1">#</span>
<span class="c1"># R. J. Gowers, M. Linke, J. Barnoud, T. J. E. Reddy, M. N. Melo, S. L. Seyler,</span>
<span class="c1"># D. L. Dotson, J. Domanski, S. Buchoux, I. M. Kenney, and O. Beckstein.</span>
<span class="c1"># MDAnalysis: A Python package for the rapid analysis of molecular dynamics</span>
<span class="c1"># simulations. In S. Benthall and S. Rostrup editors, Proceedings of the 15th</span>
<span class="c1"># Python in Science Conference, pages 102-109, Austin, TX, 2016. SciPy.</span>
<span class="c1"># doi: 10.25080/majora-629e541a-00e</span>
<span class="c1">#</span>
<span class="c1"># N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and O. Beckstein.</span>
<span class="c1"># MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations.</span>
<span class="c1"># J. Comput. Chem. 32 (2011), 2319--2327, doi:10.1002/jcc.21787</span>
<span class="c1">#</span>

<span class="sd">&quot;&quot;&quot;HOLE Analysis --- :mod:`MDAnalysis.analysis.hole2.hole`</span>
<span class="sd">=====================================================================================</span>

<span class="sd">:Author: Lily Wang</span>
<span class="sd">:Year: 2020</span>
<span class="sd">:Copyright: GNU Public License v3</span>

<span class="sd">.. versionadded:: 1.0.0</span>

<span class="sd">This module contains the tools to interface with HOLE_ [Smart1993]_</span>
<span class="sd">[Smart1996]_ to analyse an ion channel pore or transporter pathway [Stelzl2014]_ .</span>

<span class="sd">Using HOLE on a PDB file</span>
<span class="sd">------------------------</span>

<span class="sd">Use the :func:``hole`` function to run `HOLE`_ on a single PDB file. For example,</span>
<span class="sd">the code below runs the `HOLE`_ program installed at &#39;~/hole2/exe/hole&#39; ::</span>

<span class="sd">    from MDAnalysis.tests.datafiles import PDB_HOLE</span>
<span class="sd">    from MDAnalysis.analysis import hole2</span>
<span class="sd">    profiles = hole2.hole(PDB_HOLE, executable=&#39;~/hole2/exe/hole&#39;)</span>
<span class="sd">    # to create a VMD surface of the pore</span>
<span class="sd">    hole2.create_vmd_surface(filename=&#39;hole.vmd&#39;)</span>

<span class="sd">``profiles`` is a dictionary of HOLE profiles, indexed by the frame number. If only</span>
<span class="sd">a PDB file is passed to the function, there will only be one profile at frame 0.</span>
<span class="sd">You can visualise the pore by loading your PDB file into VMD, and in</span>
<span class="sd">Extensions &gt; Tk Console, type::</span>

<span class="sd">    source hole.vmd</span>

<span class="sd">You can also pass a DCD trajectory with the same atoms in the same order as</span>
<span class="sd">your PDB file with the ``dcd`` keyword argument. In that case, ``profiles`` will</span>
<span class="sd">contain multiple HOLE profiles, indexed by frame.</span>

<span class="sd">The HOLE program will create some output files:</span>

<span class="sd">    * an output file (default name: hole.out)</span>
<span class="sd">    * an sphpdb file (default name: hole.sph)</span>
<span class="sd">    * a file of van der Waals&#39; radii</span>
<span class="sd">      (if not specified with ``vdwradii_file``. Default name: simple2.rad)</span>
<span class="sd">    * a symlink of your PDB or DCD files (if the original name is too long)</span>
<span class="sd">    * the input text (if you specify ``infile``)</span>

<span class="sd">By default (`keep_files=True`), these files are kept. If you would like to</span>
<span class="sd">delete the files after the function is wrong, set `keep_files=False`. Keep in</span>
<span class="sd">mind that if you delete the sphpdb file, you cannot then create a VMD surface.</span>


<span class="sd">Using HOLE on a trajectory</span>
<span class="sd">--------------------------</span>

<span class="sd">You can also run HOLE on a trajectory through the :class:`HoleAnalysis` class.</span>
<span class="sd">This behaves similarly to the ``hole`` function, although arguments such as ``cpoint``</span>
<span class="sd">and ``cvect`` become runtime arguments for the :meth:`~HoleAnalysis.run` function.</span>

<span class="sd">The class can be set-up and run like a normal MDAnalysis analysis class::</span>

<span class="sd">    import MDAnalysis as mda</span>
<span class="sd">    from MDAnalysis.tests.datafiles import MULTIPDB_HOLE</span>
<span class="sd">    from MDAnalysis.analysis import hole2</span>

<span class="sd">    ha = hole2.HoleAnalysis(u, executable=&#39;~/hole2/exe/hole&#39;) as h2:</span>
<span class="sd">    ha.run()</span>
<span class="sd">    ha.create_vmd_surface(filename=&#39;hole.vmd&#39;)</span>

<span class="sd">The VMD surface created by the class updates the pore for each frame of the trajectory.</span>
<span class="sd">Use it as normal by loading your trajectory in VMD and sourcing the file in the Tk Console.</span>

<span class="sd">Again, HOLE writes out files for each frame. If you would like to delete these files</span>
<span class="sd">after the analysis, you can call :meth:`~HoleAnalysis.delete_temporary_files`::</span>

<span class="sd">    ha.delete_temporary_files()</span>

<span class="sd">Alternatively, you can use HoleAnalysis as a context manager that deletes temporary</span>
<span class="sd">files when you are finished with the context manager::</span>

<span class="sd">    import MDAnalysis as mda</span>
<span class="sd">    from MDAnalysis.tests.datafiles import MULTIPDB_HOLE</span>
<span class="sd">    from MDAnalysis.analysis import hole2</span>

<span class="sd">    with hole2.HoleAnalysis(u, executable=&#39;~/hole2/exe/hole&#39;) as h2:</span>
<span class="sd">        h2.run()</span>
<span class="sd">        h2.create_vmd_surface()</span>


<span class="sd">.. _HOLE: http://www.holeprogram.org</span>


<span class="sd">Functions and classes</span>
<span class="sd">---------------------</span>

<span class="sd">.. autofunction:: hole</span>

<span class="sd">.. autoclass:: HoleAnalysis</span>
<span class="sd">   :members:</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">zip</span><span class="p">,</span> <span class="n">cPickle</span>
<span class="kn">import</span> <span class="nn">six</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">...exceptions</span> <span class="kn">import</span> <span class="n">ApplicationError</span>
<span class="kn">from</span> <span class="nn">..base</span> <span class="kn">import</span> <span class="n">AnalysisBase</span>
<span class="kn">from</span> <span class="nn">...lib</span> <span class="kn">import</span> <span class="n">util</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="p">(</span><span class="n">check_and_fix_long_filename</span><span class="p">,</span> <span class="n">write_simplerad2</span><span class="p">,</span>
                    <span class="n">set_up_hole_input</span><span class="p">,</span> <span class="n">run_hole</span><span class="p">,</span> <span class="n">collect_hole</span><span class="p">,</span>
                    <span class="n">create_vmd_surface</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.templates</span> <span class="kn">import</span> <span class="p">(</span><span class="n">hole_input</span><span class="p">,</span> <span class="n">hole_lines</span><span class="p">,</span> <span class="n">vmd_script_array</span><span class="p">,</span>
                        <span class="n">vmd_script_function</span><span class="p">,</span>
                        <span class="n">IGNORE_RESIDUES</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="hole"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.hole">[docs]</a><span class="k">def</span> <span class="nf">hole</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">,</span>
         <span class="n">infile_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">infile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;hole.out&#39;</span><span class="p">,</span>
         <span class="n">sphpdb_file</span><span class="o">=</span><span class="s1">&#39;hole.sph&#39;</span><span class="p">,</span>
         <span class="n">vdwradii_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;hole&#39;</span><span class="p">,</span>
         <span class="n">tmpdir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span>
         <span class="n">sample</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
         <span class="n">end_radius</span><span class="o">=</span><span class="mf">22.0</span><span class="p">,</span>
         <span class="n">cpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">cvect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">ignore_residues</span><span class="o">=</span><span class="n">IGNORE_RESIDUES</span><span class="p">,</span>
         <span class="n">output_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
         <span class="n">dcd</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">dcd_iniskip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
         <span class="n">dcd_step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">keep_files</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Run :program:`hole` on a single frame or a DCD trajectory.</span>

<span class="sd">    :program:`hole` is part of the HOLE_ suite of programs. It is used to</span>
<span class="sd">    analyze channels and cavities in proteins, especially ion channels.</span>

<span class="sd">    Only a subset of all `HOLE control parameters &lt;http://www.holeprogram.org/doc/old/hole_d03.html&gt;`_ </span>
<span class="sd">    is supported and can be set with keyword arguments.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    pdbfile : str</span>
<span class="sd">        The `filename` is used as input for HOLE in the &quot;COORD&quot; card of the</span>
<span class="sd">        input file.  It specifies the name of a PDB coordinate file to be</span>
<span class="sd">        used. This must be in Brookhaven protein databank format or</span>
<span class="sd">        something closely approximating this. Both ATOM and HETATM records</span>
<span class="sd">        are read.</span>
<span class="sd">    infile_text: str, optional</span>
<span class="sd">        HOLE input text or template. If set to ``None``, the function will</span>
<span class="sd">        create the input text from the other parameters.</span>
<span class="sd">    infile: str, optional</span>
<span class="sd">        File to write the HOLE input text for later inspection. If set to</span>
<span class="sd">        ``None``, the input text is not written out.</span>
<span class="sd">    outfile : str, optional</span>
<span class="sd">        file name of the file collecting HOLE&#39;s output (which can be</span>
<span class="sd">        parsed using :meth:`collect_hole(outfile)`.</span>
<span class="sd">    sphpdb_file : str, optional</span>
<span class="sd">        path to the HOLE sph file, a PDB-like file containing the</span>
<span class="sd">        coordinates of the pore centers.</span>
<span class="sd">        The coordinates are set to the sphere centres and the occupancies</span>
<span class="sd">        are the sphere radii. All centres are assigned the atom name QSS and</span>
<span class="sd">        residue name SPH and the residue number is set to the storage</span>
<span class="sd">        number of the centre. In VMD, sph</span>
<span class="sd">        objects are best displayed as &quot;Points&quot;. Displaying .sph objects</span>
<span class="sd">        rather than rendered or dot surfaces can be useful to analyze the</span>
<span class="sd">        distance of particular atoms from the sphere-centre line.</span>
<span class="sd">        .sph files can be used to produce molecular graphical</span>
<span class="sd">        output from a hole run, by using the</span>
<span class="sd">        :program:`sph_process` program to read the .sph file.</span>
<span class="sd">    vdwradii_file: str, optional</span>
<span class="sd">        path to the file specifying van der Waals radii for each atom. If</span>
<span class="sd">        set to ``None``, then a set of default radii,</span>
<span class="sd">        :data:`SIMPLE2_RAD`, is used (an extension of ``simple.rad`` from</span>
<span class="sd">        the HOLE distribution). </span>
<span class="sd">    executable: str, optional</span>
<span class="sd">        Path to the :program:`hole` executable.</span>
<span class="sd">        (e.g. ``~/hole2/exe/hole``). If</span>
<span class="sd">        :program:`hole` is found on the :envvar:`PATH`, then the bare</span>
<span class="sd">        executable name is sufficient.</span>
<span class="sd">    tmpdir: str, optional</span>
<span class="sd">        The temporary directory that files can be symlinked to, to shorten</span>
<span class="sd">        the path name. HOLE can only read filenames up to a certain length.</span>
<span class="sd">    sample : float, optional</span>
<span class="sd">        distance of sample points in Å.</span>
<span class="sd">        Specifies the distance between the planes used in the HOLE</span>
<span class="sd">        procedure. The default value should be reasonable for most</span>
<span class="sd">        purposes. However, if you wish to visualize a very tight</span>
<span class="sd">        constriction then specify a smaller value.</span>
<span class="sd">        This value determines how many points in the pore profile are</span>
<span class="sd">        calculated.</span>
<span class="sd">    end_radius : float, optional</span>
<span class="sd">        Radius in Å, which is considered to be the end of the pore. This</span>
<span class="sd">        keyword can be used to specify the radius above which the</span>
<span class="sd">        program regards a result as indicating that the end of the pore</span>
<span class="sd">        has been reached. This may need to be increased for large channels,</span>
<span class="sd">        or reduced for small channels.</span>
<span class="sd">    cpoint : array_like, &#39;center_of_geometry&#39; or None, optional</span>
<span class="sd">        coordinates of a point inside the pore, e.g. ``[12.3, 0.7,</span>
<span class="sd">        18.55]``. If set to ``None`` (the default) then HOLE&#39;s own search</span>
<span class="sd">        algorithm is used.</span>
<span class="sd">        ``cpoint`` specifies a point which lies within the channel. For</span>
<span class="sd">        simple channels (e.g. gramicidin), results do not show great</span>
<span class="sd">        sensitivity to the exact point taken. An easy way to produce an</span>
<span class="sd">        initial point is to use molecular graphics to find two atoms which</span>
<span class="sd">        lie either side of the pore and to average their coordinates. Or</span>
<span class="sd">        if the channel structure contains water molecules or counter ions</span>
<span class="sd">        then take the coordinates of one of these (and use the</span>
<span class="sd">        ``ignore_residues`` keyword to ignore them in the pore radius</span>
<span class="sd">        calculation).</span>
<span class="sd">        If this card is not specified, then HOLE (from version 2.2)</span>
<span class="sd">        attempts to guess where the channel will be. The procedure</span>
<span class="sd">        assumes the channel is reasonably symmetric. The initial guess on</span>
<span class="sd">        cpoint will be the centroid of all alpha carbon atoms (name &#39;CA&#39;</span>
<span class="sd">        in pdb file). This is then refined by a crude grid search up to 5</span>
<span class="sd">        Å from the original position. This procedure works most of the</span>
<span class="sd">        time but is far from infallible — results should be</span>
<span class="sd">        carefully checked (with molecular graphics) if it is used.</span>
<span class="sd">    cvect : array_like, optional</span>
<span class="sd">        Search direction, should be parallel to the pore axis,</span>
<span class="sd">        e.g. ``[0,0,1]`` for the z-axis.</span>
<span class="sd">        If this keyword is ``None`` (the default), then HOLE attempts to guess</span>
<span class="sd">        where the channel will be. The procedure assumes that the channel is</span>
<span class="sd">        reasonably symmetric. The guess will be either along the X axis</span>
<span class="sd">        (1,0,0), Y axis (0,1,0) or Z axis (0,0,1). If the structure is not</span>
<span class="sd">        aligned on one of these axis the results will clearly be</span>
<span class="sd">        approximate. If a guess is used then results should be carefully</span>
<span class="sd">        checked. </span>
<span class="sd">    random_seed : int, optional</span>
<span class="sd">        integer number to start the random number generator.</span>
<span class="sd">        By default,</span>
<span class="sd">        :program:`hole` will use the time of the day.</span>
<span class="sd">        For reproducible runs (e.g., for testing) set ``random_seed``</span>
<span class="sd">        to an integer. </span>
<span class="sd">    ignore_residues : array_like, optional</span>
<span class="sd">        sequence of three-letter residues that are not taken into</span>
<span class="sd">        account during the calculation; wildcards are *not*</span>
<span class="sd">        supported. Note that all residues must have 3 letters. Pad</span>
<span class="sd">        with space on the right-hand side if necessary.</span>
<span class="sd">    output_level : int, optional</span>
<span class="sd">        Determines the output of output in the ``outfile``.</span>
<span class="sd">        For automated processing, this must be &lt; 3.</span>
<span class="sd">        0: Full text output,</span>
<span class="sd">        1: All text output given except &quot;run in progress&quot; (i.e.,</span>
<span class="sd">        detailed contemporary description of what HOLE is doing).</span>
<span class="sd">        2: Ditto plus no graph type output - only leaving minimum</span>
<span class="sd">        radius and conductance calculations.</span>
<span class="sd">        3: All text output other than input card mirroring and error messages</span>
<span class="sd">        turned off.</span>
<span class="sd">    dcd : str, optional</span>
<span class="sd">        File name of CHARMM-style DCD trajectory (must be supplied together with a</span>
<span class="sd">        matching PDB file `filename`) and then HOLE runs its analysis on</span>
<span class="sd">        each frame. HOLE can *not* read DCD trajectories written by MDAnalysis, </span>
<span class="sd">        which are NAMD-style.</span>
<span class="sd">        ignored. Note that structural parameters determined for each</span>
<span class="sd">        individual structure are written in a tagged format so that it is</span>
<span class="sd">        possible to extract the information from the text output file using</span>
<span class="sd">        a :program:`grep` command. The reading of the file can be</span>
<span class="sd">        controlled by the ``dcd_step`` keyword and/or setting</span>
<span class="sd">        ``dcd_iniskip`` to the number of frames to be skipped</span>
<span class="sd">        initially.</span>
<span class="sd">    dcd_step : int, optional</span>
<span class="sd">        step size for going through the trajectory (skips ``dcd_step-1``</span>
<span class="sd">        frames). </span>
<span class="sd">    keep_files : bool, optional</span>
<span class="sd">        Whether to keep the HOLE output files and possible temporary</span>
<span class="sd">        symlinks after running the function. Default: ``True``</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    dict</span>
<span class="sd">        A dictionary of :class:`numpy.recarray`\ s, indexed by frame.</span>


<span class="sd">    .. versionadded:: 1.0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">output_level</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;output_level (</span><span class="si">{}</span><span class="s1">) needs to be &lt; 3 in order to extract a HOLE profile!&#39;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_level</span><span class="p">))</span>

    <span class="c1"># get executable</span>
    <span class="n">exe</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">executable</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">exe_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">executable</span><span class="p">,</span>
                                                   <span class="n">kw</span><span class="o">=</span><span class="s1">&#39;executable&#39;</span><span class="p">))</span>

    <span class="c1"># get temp files</span>
    <span class="n">tmp_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">outfile</span><span class="p">,</span> <span class="n">sphpdb_file</span><span class="p">]</span>

    <span class="n">short_filename</span> <span class="o">=</span> <span class="n">check_and_fix_long_filename</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">,</span> <span class="n">tmpdir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="n">short_filename</span><span class="p">):</span>
        <span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">short_filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dcd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dcd</span> <span class="o">=</span> <span class="n">check_and_fix_long_filename</span><span class="p">(</span><span class="n">dcd</span><span class="p">,</span> <span class="n">tmpdir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="n">dcd</span><span class="p">):</span>
            <span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dcd</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">vdwradii_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vdwradii_file</span> <span class="o">=</span> <span class="n">check_and_fix_long_filename</span><span class="p">(</span><span class="n">vdwradii_file</span><span class="p">,</span>
                                                    <span class="n">tmpdir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vdwradii_file</span> <span class="o">=</span> <span class="n">write_simplerad2</span><span class="p">()</span>
        <span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vdwradii_file</span><span class="p">)</span>

    <span class="n">infile_text</span> <span class="o">=</span> <span class="n">set_up_hole_input</span><span class="p">(</span><span class="n">short_filename</span><span class="p">,</span>
                                    <span class="n">infile_text</span><span class="o">=</span><span class="n">infile_text</span><span class="p">,</span>
                                    <span class="n">infile</span><span class="o">=</span><span class="n">infile</span><span class="p">,</span>
                                    <span class="n">sphpdb_file</span><span class="o">=</span><span class="n">sphpdb_file</span><span class="p">,</span>
                                    <span class="n">vdwradii_file</span><span class="o">=</span><span class="n">vdwradii_file</span><span class="p">,</span>
                                    <span class="n">tmpdir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span>
                                    <span class="n">end_radius</span><span class="o">=</span><span class="n">end_radius</span><span class="p">,</span>
                                    <span class="n">cpoint</span><span class="o">=</span><span class="n">cpoint</span><span class="p">,</span> <span class="n">cvect</span><span class="o">=</span><span class="n">cvect</span><span class="p">,</span>
                                    <span class="n">random_seed</span><span class="o">=</span><span class="n">random_seed</span><span class="p">,</span>
                                    <span class="n">ignore_residues</span><span class="o">=</span><span class="n">ignore_residues</span><span class="p">,</span>
                                    <span class="n">output_level</span><span class="o">=</span><span class="n">output_level</span><span class="p">,</span>
                                    <span class="n">dcd</span><span class="o">=</span><span class="n">dcd</span><span class="p">,</span>
                                    <span class="n">dcd_iniskip</span><span class="o">=</span><span class="n">dcd_iniskip</span><span class="p">,</span>
                                    <span class="n">dcd_step</span><span class="o">=</span><span class="n">dcd_step</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">run_hole</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">,</span> <span class="n">infile_text</span><span class="o">=</span><span class="n">infile_text</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="n">exe</span><span class="p">)</span>
    <span class="n">recarrays</span> <span class="o">=</span> <span class="n">collect_hole</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_files</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">tmp_files</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">return</span> <span class="n">recarrays</span></div>


<div class="viewcode-block" id="HoleAnalysis"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis">[docs]</a><span class="k">class</span> <span class="nc">HoleAnalysis</span><span class="p">(</span><span class="n">AnalysisBase</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run :program:`hole` on a trajectory.</span>

<span class="sd">    :program:`hole` is part of the HOLE_ suite of programs. It is used to</span>
<span class="sd">    analyze channels and cavities in proteins, especially ion channels.</span>

<span class="sd">    Only a subset of all `HOLE control parameters &lt;http://www.holeprogram.org/doc/old/hole_d03.html&gt;`_ </span>
<span class="sd">    is supported and can be set with keyword arguments.</span>

<span class="sd">    This class creates temporary PDB files for each frame and runs HOLE on</span>
<span class="sd">    the frame. It can be used normally, or as a context manager. If used as a</span>
<span class="sd">    context manager, the class will try to delete any temporary files created</span>
<span class="sd">    by HOLE, e.g. sphpdb files and logfiles. ::</span>

<span class="sd">        with hole2.HoleAnalysis(u, executable=&#39;~/hole2/exe/hole&#39;) as h2:</span>
<span class="sd">            h2.run()</span>
<span class="sd">            h2.create_vmd_surface()</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    universe: Universe or AtomGroup</span>
<span class="sd">        The Universe or AtomGroup to apply the analysis to.</span>
<span class="sd">    select: string, optional</span>
<span class="sd">        The selection string to create an atom selection that the HOLE</span>
<span class="sd">        analysis is applied to.</span>
<span class="sd">    vdwradii_file: str, optional</span>
<span class="sd">        path to the file specifying van der Waals radii for each atom. If</span>
<span class="sd">        set to ``None``, then a set of default radii,</span>
<span class="sd">        :data:`SIMPLE2_RAD`, is used (an extension of ``simple.rad`` from</span>
<span class="sd">        the HOLE distribution).</span>
<span class="sd">    executable: str, optional</span>
<span class="sd">        Path to the :program:`hole` executable.</span>
<span class="sd">        (e.g. ``~/hole2/exe/hole``). If</span>
<span class="sd">        :program:`hole` is found on the :envvar:`PATH`, then the bare</span>
<span class="sd">        executable name is sufficient.</span>
<span class="sd">    tmpdir: str, optional</span>
<span class="sd">        The temporary directory that files can be symlinked to, to shorten</span>
<span class="sd">        the path name. HOLE can only read filenames up to a certain length.</span>
<span class="sd">    cpoint : array_like, &#39;center_of_geometry&#39; or None, optional</span>
<span class="sd">        coordinates of a point inside the pore, e.g. ``[12.3, 0.7,</span>
<span class="sd">        18.55]``. If set to ``None`` (the default) then HOLE&#39;s own search</span>
<span class="sd">        algorithm is used.</span>
<span class="sd">        ``cpoint`` specifies a point which lies within the channel. For</span>
<span class="sd">        simple channels (e.g. gramicidin), results do not show great</span>
<span class="sd">        sensitivity to the exact point taken. An easy way to produce an</span>
<span class="sd">        initial point is to use molecular graphics to find two atoms which</span>
<span class="sd">        lie either side of the pore and to average their coordinates. Or</span>
<span class="sd">        if the channel structure contains water molecules or counter ions</span>
<span class="sd">        then take the coordinates of one of these (and use the</span>
<span class="sd">        ``ignore_residues`` keyword to ignore them in the pore radius</span>
<span class="sd">        calculation).</span>
<span class="sd">        If this card is not specified, then HOLE (from version 2.2)</span>
<span class="sd">        attempts to guess where the channel will be. The procedure</span>
<span class="sd">        assumes the channel is reasonably symmetric. The initial guess on</span>
<span class="sd">        cpoint will be the centroid of all alpha carbon atoms (name &#39;CA&#39;</span>
<span class="sd">        in pdb file). This is then refined by a crude grid search up to 5</span>
<span class="sd">        Å from the original position. This procedure works most of the</span>
<span class="sd">        time but is far from infallible — results should be</span>
<span class="sd">        carefully checked (with molecular graphics) if it is used.</span>
<span class="sd">    cvect : array_like, optional</span>
<span class="sd">        Search direction, should be parallel to the pore axis,</span>
<span class="sd">        e.g. ``[0,0,1]`` for the z-axis.</span>
<span class="sd">        If this keyword is ``None`` (the default), then HOLE attempts to guess</span>
<span class="sd">        where the channel will be. The procedure assumes that the channel is</span>
<span class="sd">        reasonably symmetric. The guess will be either along the X axis</span>
<span class="sd">        (1,0,0), Y axis (0,1,0) or Z axis (0,0,1). If the structure is not</span>
<span class="sd">        aligned on one of these axis the results will clearly be</span>
<span class="sd">        approximate. If a guess is used then results should be carefully</span>
<span class="sd">        checked. </span>
<span class="sd">    sample : float, optional</span>
<span class="sd">        distance of sample points in Å.</span>
<span class="sd">        Specifies the distance between the planes used in the HOLE</span>
<span class="sd">        procedure. The default value should be reasonable for most</span>
<span class="sd">        purposes. However, if you wish to visualize a very tight</span>
<span class="sd">        constriction then specify a smaller value.</span>
<span class="sd">        This value determines how many points in the pore profile are</span>
<span class="sd">        calculated. </span>
<span class="sd">    end_radius : float, optional</span>
<span class="sd">        Radius in Å, which is considered to be the end of the pore. This</span>
<span class="sd">        keyword can be used to specify the radius above which the</span>
<span class="sd">        program regards a result as indicating that the end of the pore</span>
<span class="sd">        has been reached. This may need to be increased for large channels,</span>
<span class="sd">        or reduced for small channels. </span>
<span class="sd">    output_level : int, optional</span>
<span class="sd">        Determines the output of output in the ``outfile``.</span>
<span class="sd">        For automated processing, this must be &lt; 3.</span>
<span class="sd">        0: Full text output,</span>
<span class="sd">        1: All text output given except &quot;run in progress&quot; (i.e.,</span>
<span class="sd">        detailed contemporary description of what HOLE is doing).</span>
<span class="sd">        2: Ditto plus no graph type output - only leaving minimum</span>
<span class="sd">        radius and conductance calculations.</span>
<span class="sd">        3: All text output other than input card mirroring and error messages</span>
<span class="sd">        turned off.</span>
<span class="sd">    ignore_residues : array_like, optional</span>
<span class="sd">        sequence of three-letter residues that are not taken into</span>
<span class="sd">        account during the calculation; wildcards are *not*</span>
<span class="sd">        supported. Note that all residues must have 3 letters. Pad</span>
<span class="sd">        with space on the right-hand side if necessary.</span>
<span class="sd">    prefix: str, optional</span>
<span class="sd">        Prefix for HOLE output files. </span>
<span class="sd">    write_input_files: bool, optional</span>
<span class="sd">        Whether to write out the input HOLE text as files.</span>
<span class="sd">        Files are called `hole.inp`. </span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary of :class:`numpy.recarray`\ s, indexed by frame.</span>


<span class="sd">    .. versionadded:: 1.0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">hole</span><span class="si">{i:03d}</span><span class="s1">.inp&#39;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">hole</span><span class="si">{i:03d}</span><span class="s1">.out&#39;</span>
    <span class="n">sphpdb_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">hole</span><span class="si">{i:03d}</span><span class="s1">.sph&#39;</span>

    <span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">hole</span><span class="si">{i:03d}</span><span class="s1">.inp&#39;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">hole</span><span class="si">{i:03d}</span><span class="s1">.out&#39;</span>
    <span class="n">sphpdb_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{prefix}</span><span class="s1">hole</span><span class="si">{i:03d}</span><span class="s1">.sph&#39;</span>

    <span class="n">hole_header</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        ! Input file for Oliver Smart&#39;s HOLE program</span>
<span class="s2">        ! written by MDAnalysis.analysis.hole2.HoleAnalysis</span>
<span class="s2">        ! for a Universe</span>
<span class="s2">        ! u = mda.Universe(</span><span class="si">{}</span><span class="s2"></span>
<span class="s2">        !   )</span>
<span class="s2">        ! Frame {{i}}</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">hole_body</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        COORD  {{coordinates}}</span>
<span class="s2">        RADIUS </span><span class="si">{radius}</span><span class="s2"></span>
<span class="s2">        SPHPDB {{sphpdb}}</span>
<span class="s2">        SAMPLE </span><span class="si">{sample:f}</span><span class="s2"></span>
<span class="s2">        ENDRAD </span><span class="si">{end_radius:f}</span><span class="s2"></span>
<span class="s2">        IGNORE </span><span class="si">{ignore}</span><span class="s2"></span>
<span class="s2">        SHORTO </span><span class="si">{output_level:d}</span><span class="s2"></span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">_guess_cpoint</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">sphpdbs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">outfiles</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">profiles</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">universe</span><span class="p">,</span>
                 <span class="n">select</span><span class="o">=</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ignore_residues</span><span class="o">=</span><span class="n">IGNORE_RESIDUES</span><span class="p">,</span>
                 <span class="n">vdwradii_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;hole&#39;</span><span class="p">,</span>
                 <span class="n">sos_triangle</span><span class="o">=</span><span class="s1">&#39;sos_triangle&#39;</span><span class="p">,</span>
                 <span class="n">sph_process</span><span class="o">=</span><span class="s1">&#39;sph_process&#39;</span><span class="p">,</span>
                 <span class="n">tmpdir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">curdir</span><span class="p">,</span>
                 <span class="n">cpoint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">cvect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">sample</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">end_radius</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span>
                 <span class="n">output_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">write_input_files</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">HoleAnalysis</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">universe</span><span class="o">.</span><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span>
                                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_level</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;output_level (</span><span class="si">{}</span><span class="s1">) needs to be &lt; 3 in order to extract a HOLE profile!&#39;</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_level</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cpoint</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;geometry&#39;</span> <span class="ow">in</span> <span class="n">cpoint</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_guess_cpoint</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cpoint</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{cpoint[0]:.10f}</span><span class="s1"> </span><span class="si">{cpoint[1]:.10f}</span><span class="s1"> </span><span class="si">{cpoint[2]:.10f}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_guess_cpoint</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cpoint</span> <span class="o">=</span> <span class="n">cpoint</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cvect</span> <span class="o">=</span> <span class="n">cvect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample</span> <span class="o">=</span> <span class="n">sample</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_radius</span> <span class="o">=</span> <span class="n">end_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_level</span> <span class="o">=</span> <span class="n">output_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_input_files</span> <span class="o">=</span> <span class="n">write_input_files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select</span> <span class="o">=</span> <span class="n">select</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ag</span> <span class="o">=</span> <span class="n">universe</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="n">select</span><span class="p">,</span> <span class="n">updating</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">universe</span> <span class="o">=</span> <span class="n">universe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmpdir</span> <span class="o">=</span> <span class="n">tmpdir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_residues</span> <span class="o">=</span> <span class="n">ignore_residues</span>

        <span class="c1"># --- finding executables ----</span>
        <span class="n">hole</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">executable</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hole</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">exe_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">hole</span><span class="p">,</span>
                                                       <span class="n">kw</span><span class="o">=</span><span class="s1">&#39;executable&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">hole</span><span class="p">)</span>

        <span class="n">sos_triangle_path</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">sos_triangle</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sos_triangle_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_path</span><span class="p">,</span> <span class="n">sos_triangle</span><span class="p">)</span>
            <span class="n">sos_triangle_path</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sos_triangle_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">exe_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">sos_triangle</span><span class="p">,</span>
                                                       <span class="n">kw</span><span class="o">=</span><span class="s1">&#39;sos_triangle&#39;</span><span class="p">))</span>
        <span class="n">sph_process_path</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">sph_process</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sph_process_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_path</span><span class="p">,</span> <span class="s1">&#39;sph_process&#39;</span><span class="p">)</span>
            <span class="n">sph_process_path</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">which</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sph_process_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">OSError</span><span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">exe_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">sph_process</span><span class="p">,</span>
                                                       <span class="n">kw</span><span class="o">=</span><span class="s1">&#39;sph_process&#39;</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">exe</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;hole&#39;</span><span class="p">:</span> <span class="n">hole</span><span class="p">,</span>
            <span class="s1">&#39;sos_triangle&#39;</span><span class="p">:</span> <span class="n">sos_triangle_path</span><span class="p">,</span>
            <span class="s1">&#39;sph_process&#39;</span><span class="p">:</span> <span class="n">sph_process_path</span>
        <span class="p">}</span>

        <span class="c1"># --- setting up temp files ----</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">vdwradii_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdwradii_file</span> <span class="o">=</span> <span class="n">check_and_fix_long_filename</span><span class="p">(</span><span class="n">vdwradii_file</span><span class="p">,</span>
                                                             <span class="n">tmpdir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpdir</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdwradii_file</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdwradii_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vdwradii_file</span> <span class="o">=</span> <span class="n">write_simplerad2</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vdwradii_file</span><span class="p">)</span>

        <span class="c1"># --- setting up input header ----</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">universe</span><span class="o">.</span><span class="n">filename</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">hole_filenames</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">!    &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hole_header</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hole_filenames</span><span class="p">)</span>

<div class="viewcode-block" id="HoleAnalysis.run"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform the calculation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start : int, optional</span>
<span class="sd">            start frame of analysis</span>

<span class="sd">        stop : int, optional</span>
<span class="sd">            stop frame of analysis</span>

<span class="sd">        step : int, optional</span>
<span class="sd">            number of frames to skip between each analysed frame</span>

<span class="sd">        verbose : bool, optional</span>
<span class="sd">            Turn on verbosity</span>

<span class="sd">        random_seed : int, optional</span>
<span class="sd">            integer number to start the random number generator.</span>
<span class="sd">            By default,</span>
<span class="sd">            :program:`hole` will use the time of the day.</span>
<span class="sd">            For reproducible runs (e.g., for testing) set ``random_seed``</span>
<span class="sd">            to an integer. Default: ``None``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span> <span class="o">=</span> <span class="n">random_seed</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">HoleAnalysis</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="n">stop</span><span class="p">,</span>
                                             <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up containers and generate input file text&quot;&quot;&quot;</span>
        <span class="c1"># set up containers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sphpdbs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outfiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># generate input file</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">set_up_hole_input</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                 <span class="n">infile_text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hole_body</span><span class="p">,</span>
                                 <span class="n">infile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                 <span class="n">vdwradii_file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vdwradii_file</span><span class="p">,</span>
                                 <span class="n">tmpdir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmpdir</span><span class="p">,</span>
                                 <span class="n">sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">,</span>
                                 <span class="n">end_radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_radius</span><span class="p">,</span>
                                 <span class="n">cpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cpoint</span><span class="p">,</span>
                                 <span class="n">cvect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cvect</span><span class="p">,</span>
                                 <span class="n">random_seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_seed</span><span class="p">,</span>
                                 <span class="n">ignore_residues</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_residues</span><span class="p">,</span>
                                 <span class="n">output_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_level</span><span class="p">,</span>
                                 <span class="n">dcd</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">infile_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_header</span> <span class="o">+</span> <span class="n">body</span>

<div class="viewcode-block" id="HoleAnalysis.guess_cpoint"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.guess_cpoint">[docs]</a>    <span class="k">def</span> <span class="nf">guess_cpoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Guess a point inside the pore.</span>

<span class="sd">        This method simply uses the center of geometry of the selection as a</span>
<span class="sd">        guess.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float:</span>
<span class="sd">            center of geometry of selected AtomGroup</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ag</span><span class="o">.</span><span class="n">center_of_geometry</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_single_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run HOLE analysis and collect profiles&quot;&quot;&quot;</span>
        <span class="c1"># set up files</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ts</span><span class="o">.</span><span class="n">frame</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frame_index</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">sphpdb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphpdb_file</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sphpdbs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sphpdb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outfiles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">outfile</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sphpdb</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sphpdb</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sphpdb</span> <span class="o">+</span> <span class="s1">&#39;.old&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span>

        <span class="c1"># temp pdb</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;HOLE analysis frame </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>
        <span class="n">fd</span><span class="p">,</span> <span class="n">pdbfile</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.pdb&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>  <span class="c1"># close immediately (Issue 129)</span>

        <span class="c1"># get infile text</span>
        <span class="n">fmt_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="n">frame</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">:</span> <span class="n">pdbfile</span><span class="p">,</span> <span class="s1">&#39;sphpdb&#39;</span><span class="p">:</span> <span class="n">sphpdb</span><span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guess_cpoint</span><span class="p">:</span>
            <span class="n">fmt_kwargs</span><span class="p">[</span><span class="s1">&#39;cpoint&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guess_cpoint</span><span class="p">()</span>
        <span class="n">infile_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">infile_text</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">fmt_kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_input_files</span><span class="p">:</span>
            <span class="n">infile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_file</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefix</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="n">frame</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">infile_text</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ag</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>
            <span class="n">run_hole</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">,</span> <span class="n">infile_text</span><span class="o">=</span><span class="n">infile_text</span><span class="p">,</span>
                     <span class="n">executable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s1">&#39;hole&#39;</span><span class="p">])</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">recarrays</span> <span class="o">=</span> <span class="n">collect_hole</span><span class="p">(</span><span class="n">outfile</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span> <span class="o">=</span> <span class="n">recarrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No profile found in HOLE output. Output level: </span><span class="si">{}</span><span class="s1">&#39;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_level</span><span class="p">))</span>

<div class="viewcode-block" id="HoleAnalysis.create_vmd_surface"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.create_vmd_surface">[docs]</a>    <span class="k">def</span> <span class="nf">create_vmd_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hole.vmd&#39;</span><span class="p">,</span> <span class="n">dot_density</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                           <span class="n">no_water_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">one_water_color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                           <span class="n">double_water_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process HOLE output to create a smooth pore surface suitable for VMD.</span>

<span class="sd">        Takes the ``sphpdb`` file for each frame and feeds it to `sph_process &lt;http://www.holeprogram.org/doc/old/hole_d04.html#sph_process&gt;`_</span>
<span class="sd">        and `sos_triangle &lt;http://www.holeprogram.org/doc/old/hole_d04.html#sos_triangle&gt;`_ as described under `Visualization of HOLE</span>
<span class="sd">        results &lt;http://www.holeprogram.org/doc/index.html&gt;`_.</span>

<span class="sd">        Load the output file *filename* into VMD in Extensions &gt; Tk Console ::</span>

<span class="sd">           source hole.vmd</span>

<span class="sd">        The level of detail is determined by ``dot_density``.</span>
<span class="sd">        The surface will be colored by ``no_water_color``, ``one_water_color``, and </span>
<span class="sd">        ``double_water_color``. You can change these in the</span>
<span class="sd">        Tk Console::</span>

<span class="sd">            set no_water_color blue</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str, optional</span>
<span class="sd">            file to write the pore surfaces to.</span>

<span class="sd">        dot_density: int, optional</span>
<span class="sd">            density of facets for generating a 3D pore representation.</span>
<span class="sd">            The number controls the density of dots that will be used.</span>
<span class="sd">            A sphere of dots is placed on each centre determined in the</span>
<span class="sd">            Monte Carlo procedure. The actual number of dots written is</span>
<span class="sd">            controlled by ``dot_density`` and the ``sample`` level of the</span>
<span class="sd">            original analysis. ``dot_density`` should be set between 5</span>
<span class="sd">            (few dots per sphere) and 35 (many dots per sphere).</span>

<span class="sd">        no_water_color: str, optional</span>
<span class="sd">            Color of the surface where the pore radius is too tight for a </span>
<span class="sd">            water molecule.</span>

<span class="sd">        one_water_color: str, optional</span>
<span class="sd">            Color of the surface where the pore can fit one water molecule.</span>

<span class="sd">        double_water_color: str, optional</span>
<span class="sd">            Color of the surface where the radius is at least double the </span>
<span class="sd">            minimum radius for one water molecule.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            ``filename`` with the pore surfaces.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphpdbs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sphpdbs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No sphpdb files to read. Try calling run()&#39;</span><span class="p">)</span>

        <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sphpdb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphpdbs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">]):</span>
            <span class="n">tmp_tri</span> <span class="o">=</span> <span class="n">create_vmd_surface</span><span class="p">(</span><span class="n">sphpdb</span><span class="o">=</span><span class="n">sphpdb</span><span class="p">,</span>
                                         <span class="n">sph_process</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s1">&#39;sph_process&#39;</span><span class="p">],</span>
                                         <span class="n">sos_triangle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exe</span><span class="p">[</span><span class="s1">&#39;sos_triangle&#39;</span><span class="p">],</span>
                                         <span class="n">dot_density</span><span class="o">=</span><span class="n">dot_density</span><span class="p">)</span>

            <span class="n">shapes</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[],</span> <span class="p">[]]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">tmp_tri</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;draw color&#39;</span><span class="p">):</span>
                        <span class="n">color</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;red&#39;</span><span class="p">:</span>
                            <span class="n">dest</span> <span class="o">=</span> <span class="n">shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;green&#39;</span><span class="p">:</span>
                            <span class="n">dest</span> <span class="o">=</span> <span class="n">shapes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;blue&#39;</span><span class="p">:</span>
                            <span class="n">dest</span> <span class="o">=</span> <span class="n">shapes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Encountered unknown color </span><span class="si">{}</span><span class="s1">&#39;</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;draw trinorm&#39;</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;draw trinorm&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">dest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;{{ </span><span class="si">{}</span><span class="s1"> }}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">tmp_tri</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">tri</span> <span class="o">=</span> <span class="s1">&#39;{ { &#39;</span> <span class="o">+</span> <span class="s1">&#39; } { &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">shapes</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39; } }&#39;</span>
            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;set triangles(</span><span class="si">{i}</span><span class="s1">) &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">tri</span><span class="p">)</span>

        <span class="n">trinorms</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
        <span class="n">vmd_1</span> <span class="o">=</span> <span class="n">vmd_script_array</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">no_water_color</span><span class="o">=</span><span class="n">no_water_color</span><span class="p">,</span> 
                                        <span class="n">one_water_color</span><span class="o">=</span><span class="n">one_water_color</span><span class="p">,</span>
                                        <span class="n">double_water_color</span><span class="o">=</span><span class="n">double_water_color</span><span class="p">)</span>
        <span class="n">vmd_text</span> <span class="o">=</span> <span class="n">vmd_1</span> <span class="o">+</span> <span class="n">trinorms</span> <span class="o">+</span> <span class="n">vmd_script_function</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vmd_text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filename</span></div>
    
    <span class="k">def</span> <span class="nf">min_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the minimum radius over all profiles as a function of q&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No profiles available. Try calling run()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

<div class="viewcode-block" id="HoleAnalysis.min_radius"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.min_radius">[docs]</a>    <span class="k">def</span> <span class="nf">min_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the minimum radius over all profiles as a function of q&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No profiles available. Try calling run()&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span> <span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span></div>

<div class="viewcode-block" id="HoleAnalysis.delete_temporary_files"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.delete_temporary_files">[docs]</a>    <span class="k">def</span> <span class="nf">delete_temporary_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete temporary files&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmp_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outfiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sphpdbs</span> <span class="o">=</span> <span class="p">[]</span></div>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete temporary files on exit&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_temporary_files</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_process_plot_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Process the colors and linestyles for plotting</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frames: array-like, optional</span>
<span class="sd">            Frames to plot. If ``None``, plots all of them.</span>
<span class="sd">            Default: ``None``</span>
<span class="sd">        color: str or array-like, optional</span>
<span class="sd">            Color or colors for the plot. If ``None``, colors are</span>
<span class="sd">            drawn from ``cmap``. Default: ``None``</span>
<span class="sd">        cmap: str, optional</span>
<span class="sd">            color map to make colors for the plot if ``color`` is</span>
<span class="sd">            not given. Names should be from the ``matplotlib.pyplot.cm``</span>
<span class="sd">            module. Default: &#39;viridis&#39;</span>
<span class="sd">        linestyle: str or array-like, optional</span>
<span class="sd">            Line style for the plot. Default: &#39;-&#39;</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (array-like, array-like, array-like)</span>
<span class="sd">            frames, colors, linestyles</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">asiterable</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">frames</span><span class="p">),</span>
                                               <span class="n">vmax</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">frames</span><span class="p">))</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">frames</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">asiterable</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>

        <span class="n">linestyles</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">cycle</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">asiterable</span><span class="p">(</span><span class="n">linestyle</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">frames</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">linestyles</span>

<div class="viewcode-block" id="HoleAnalysis.plot"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">y_shift</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot HOLE profiles :math:`R(\zeta)` in a 1D graph.</span>

<span class="sd">        Lines are colored according to the specified ``color`` or</span>
<span class="sd">        drawn from the color map ``cmap``. One line is</span>
<span class="sd">        plotted for each trajectory frame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frames: array-like, optional</span>
<span class="sd">            Frames to plot. If ``None``, plots all of them.</span>
<span class="sd">            Default: ``None``</span>
<span class="sd">        color: str or array-like, optional</span>
<span class="sd">            Color or colors for the plot. If ``None``, colors are</span>
<span class="sd">            drawn from ``cmap``. Default: ``None``</span>
<span class="sd">        cmap: str, optional</span>
<span class="sd">            color map to make colors for the plot if ``color`` is</span>
<span class="sd">            not given. Names should be from the ``matplotlib.pyplot.cm``</span>
<span class="sd">            module. Default: &#39;viridis&#39;</span>
<span class="sd">        linestyle: str or array-like, optional</span>
<span class="sd">            Line style for the plot. Default: &#39;-&#39;</span>
<span class="sd">        y_shift : float, optional</span>
<span class="sd">            displace each :math:`R(\zeta)` profile by ``y_shift`` in the</span>
<span class="sd">            :math:`y`-direction for clearer visualization. Default: 0.0</span>
<span class="sd">        label : bool or string, optional</span>
<span class="sd">            If ``False`` then no legend is</span>
<span class="sd">            displayed. Default: ``True``</span>
<span class="sd">        ax : :class:`matplotlib.axes.Axes`</span>
<span class="sd">            If no `ax` is supplied or set to ``None`` then the plot will</span>
<span class="sd">            be added to the current active axes. Default: ``None``</span>
<span class="sd">        legend_loc : str, optional</span>
<span class="sd">            Location of the legend. Default: &#39;best&#39;</span>
<span class="sd">        kwargs :  `**kwargs`</span>
<span class="sd">            All other `kwargs` are passed to :func:`matplotlib.pyplot.plot`.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : :class:`~matplotlib.axes.Axes`</span>
<span class="sd">             Axes with the plot, either `ax` or the current axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No profiles available. Try calling run()&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">fcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_plot_kwargs</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ls</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">fcl</span><span class="p">)):</span>
            <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">y_shift</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">rxn_coord</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">radius</span><span class="o">+</span><span class="n">dy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                    <span class="n">linestyle</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="n">frame</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">),</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pore coordinate $\zeta$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;HOLE radius $R$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HoleAnalysis.plot3D"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.plot3D">[docs]</a>    <span class="k">def</span> <span class="nf">plot3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
               <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frames&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stacked 3D graph of profiles :math:`R(\zeta)`.</span>

<span class="sd">        Lines are colored according to the specified ``color`` or</span>
<span class="sd">        drawn from the color map ``cmap``. One line is</span>
<span class="sd">        plotted for each trajectory frame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frames: array-like, optional</span>
<span class="sd">            Frames to plot. If ``None``, plots all of them.</span>
<span class="sd">            Default: ``None``</span>
<span class="sd">        color: str or array-like, optional</span>
<span class="sd">            Color or colors for the plot. If ``None``, colors are</span>
<span class="sd">            drawn from ``cmap``. Default: ``None``</span>
<span class="sd">        cmap: str, optional</span>
<span class="sd">            color map to make colors for the plot if ``color`` is</span>
<span class="sd">            not given. Names should be from the ``matplotlib.pyplot.cm``</span>
<span class="sd">            module. Default: &#39;viridis&#39;</span>
<span class="sd">        linestyle: str or array-like, optional</span>
<span class="sd">            Line style for the plot. Default: &#39;-&#39;</span>
<span class="sd">        r_max : float, optional</span>
<span class="sd">            only display radii up to ``r_max``. If ``None``, all radii are</span>
<span class="sd">            plotted. Default: ``None``</span>
<span class="sd">        ax : :class:`matplotlib.axes.Axes`</span>
<span class="sd">            If no `ax` is supplied or set to ``None`` then the plot will</span>
<span class="sd">            be added to the current active axes. Default: ``None``</span>
<span class="sd">        ylabel : str, optional</span>
<span class="sd">            Y-axis label. Default: &#39;Frames&#39;</span>
<span class="sd">        **kwargs :</span>
<span class="sd">            All other `kwargs` are passed to :func:`matplotlib.pyplot.plot`.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : :class:`~mpl_toolkits.mplot3d.Axes3D`</span>
<span class="sd">             Axes with the plot, either `ax` or the current axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No profiles available. Try calling run()&#39;</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

        <span class="n">fcl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_plot_kwargs</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                        <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">frame</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">fcl</span><span class="p">):</span>
            <span class="n">profile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">r_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">radius</span>
                <span class="n">rxn_coord</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">rxn_coord</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># does not seem to work with masked arrays but with nan hack!</span>
                <span class="c1"># http://stackoverflow.com/questions/4913306/python-matplotlib-mplot3d-how-do-i-set-a-maximum-value-for-the-z-axis</span>
                <span class="n">rxn_coord</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">rxn_coord</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">radius</span><span class="p">[</span><span class="n">radius</span> <span class="o">&gt;</span> <span class="n">r_max</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxn_coord</span><span class="p">,</span> <span class="n">frame</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">rxn_coord</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="n">frame</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">frame</span><span class="p">),</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pore coordinate $\zeta$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;HOLE radius $R$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HoleAnalysis.over_order_parameters"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.over_order_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">over_order_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_parameters</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get HOLE profiles sorted over order parameters ``order_parameters``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order_parameters: array-like or string</span>
<span class="sd">            Sequence or text file containing order parameters (float</span>
<span class="sd">            numbers) corresponding to the frames in the trajectory. Must</span>
<span class="sd">            be same length as trajectory.</span>
<span class="sd">        frames: array-like, optional</span>
<span class="sd">            Selected frames to return. If ``None``, returns all of them.</span>
<span class="sd">            Default: ``None``</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        collections.OrderedDict</span>
<span class="sd">            sorted dictionary of {order_parameter:profile}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No profiles available. Try calling run()&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">order_parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data file not found: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Could not parse given file: </span><span class="si">{}</span><span class="s1">. &#39;</span>
                       <span class="s1">&#39;`order_parameters` must be array-like &#39;</span>
                       <span class="s1">&#39;or a filename with array data &#39;</span>
                       <span class="s1">&#39;that can be read by np.loadtxt&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">))</span>
            

        <span class="n">order_parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trajectory</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;The number of order parameters (</span><span class="si">{}</span><span class="s1">) must match the &#39;</span>
                   <span class="s1">&#39;length of the trajectory (</span><span class="si">{}</span><span class="s1"> frames)&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">),</span>
                                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trajectory</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">asiterable</span><span class="p">(</span><span class="n">frames</span><span class="p">))</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">[</span><span class="n">frames</span><span class="p">])</span>
        <span class="n">sorted_frames</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="n">profiles</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">sorted_frames</span><span class="p">:</span>
            <span class="n">profiles</span><span class="p">[</span><span class="n">order_parameters</span><span class="p">[</span><span class="n">frame</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">profiles</span></div>

<div class="viewcode-block" id="HoleAnalysis.plot_order_parameters"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.plot_order_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">plot_order_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_parameters</span><span class="p">,</span>
                              <span class="n">aggregator</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span>
                              <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                              <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Minimum HOLE pore radius $r$ ($\AA$)&#39;</span><span class="p">,</span>
                              <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Order parameter&#39;</span><span class="p">,</span>
                              <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Plot HOLE radii over order parameters. This function needs</span>
<span class="sd">        an ``aggregator`` function to reduce the ``radius`` array to a</span>
<span class="sd">        single value, e.g. ``min``, ``max``, or ``np.mean``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order_parameters: array-like or string</span>
<span class="sd">            Sequence or text file containing order parameters (float</span>
<span class="sd">            numbers) corresponding to the frames in the trajectory. Must</span>
<span class="sd">            be same length as trajectory.</span>
<span class="sd">        aggregator: callable, optional</span>
<span class="sd">            Function applied to the radius array of each profile to</span>
<span class="sd">            reduce it to one representative value. Default: ``min``</span>
<span class="sd">        frames: array-like, optional</span>
<span class="sd">            Frames to plot. If ``None``, plots all of them.</span>
<span class="sd">            Default: ``None``</span>
<span class="sd">        color: str or array-like, optional</span>
<span class="sd">            Color for the plot. Default: &#39;blue&#39;</span>
<span class="sd">        linestyle: str or array-like, optional</span>
<span class="sd">            Line style for the plot. Default: &#39;-&#39;</span>
<span class="sd">        ax : :class:`matplotlib.axes.Axes`</span>
<span class="sd">            If no `ax` is supplied or set to ``None`` then the plot will</span>
<span class="sd">            be added to the current active axes. Default: ``None``</span>
<span class="sd">        xlabel : str, optional</span>
<span class="sd">            X-axis label. Default: &#39;Order parameter&#39;</span>
<span class="sd">        ylabel : str, optional</span>
<span class="sd">            Y-axis label. Default: &#39;Minimum HOLE pore radius $r$ ($\AA$)&#39;</span>
<span class="sd">        **kwargs :</span>
<span class="sd">            All other `kwargs` are passed to :func:`matplotlib.pyplot.plot`.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : :class:`~matplotlib.axes.Axes`</span>
<span class="sd">             Axes with the plot, either `ax` or the current axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">op_profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">over_order_parameters</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">,</span>
                                                 <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">aggregator</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">radius</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">op_profiles</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HoleAnalysis.gather"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.gather">[docs]</a>    <span class="k">def</span> <span class="nf">gather</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gather the fields of each profile recarray together.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frames: int or iterable of ints, optional</span>
<span class="sd">            Profiles to include by frame. If ``None``, includes</span>
<span class="sd">            all frames. Default: ``None``</span>

<span class="sd">        flat: bool, optional</span>
<span class="sd">            Whether to flatten the list of field arrays into a</span>
<span class="sd">            single array. Default: ``False``</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            dictionary of fields</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">asiterable</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
        <span class="n">profiles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">frames</span><span class="p">]</span>

        <span class="n">rxncoords</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">rxn_coord</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">]</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">radius</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">]</span>
        <span class="n">cen_line_Ds</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">cen_line_D</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">flat</span><span class="p">:</span>
            <span class="n">rxncoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">rxncoords</span><span class="p">)</span>
            <span class="n">radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span>
            <span class="n">cen_line_Ds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">cen_line_Ds</span><span class="p">)</span>

        <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rxn_coord&#39;</span><span class="p">:</span> <span class="n">rxncoords</span><span class="p">,</span>
               <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="n">radii</span><span class="p">,</span>
               <span class="s1">&#39;cen_line_D&#39;</span><span class="p">:</span> <span class="n">cen_line_Ds</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">dct</span></div>

<div class="viewcode-block" id="HoleAnalysis.bin_radii"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.bin_radii">[docs]</a>    <span class="k">def</span> <span class="nf">bin_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Collects the pore radii into bins by reaction coordinate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frames: int or iterable of ints, optional</span>
<span class="sd">            Profiles to include by frame. If ``None``, includes</span>
<span class="sd">            all frames. Default: ``None``</span>

<span class="sd">        bins: int or iterable of edges, optional</span>
<span class="sd">            If bins is an int, it defines the number of equal-width bins in the given range. If bins is a sequence, it defines a monotonically increasing array of bin edges, including the rightmost edge, allowing for non-uniform bin widths. Default: 100</span>

<span class="sd">        range : (float, float), optional</span>
<span class="sd">            The lower and upper range of the bins.</span>
<span class="sd">            If not provided, ``range`` is simply ``(a.min(), a.max())``,</span>
<span class="sd">            where ``a`` is the array of reaction coordinates.</span>
<span class="sd">            Values outside the range are ignored. The first element of the range must be less than or equal to the second.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of arrays of floats</span>
<span class="sd">            List of radii present in each bin</span>
<span class="sd">        array of (float, float)</span>
<span class="sd">            Edges of each bin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">agg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">agg</span><span class="p">[</span><span class="s1">&#39;rxn_coord&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">util</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">coords</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="nb">range</span>
            <span class="k">if</span> <span class="n">xmin</span> <span class="o">==</span> <span class="n">xmax</span><span class="p">:</span>
                <span class="n">xmin</span> <span class="o">-=</span> <span class="mf">0.5</span>
                <span class="n">xmax</span> <span class="o">+=</span> <span class="mf">0.5</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">bins</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
            <span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">bins</span><span class="p">)]</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">radii</span> <span class="o">=</span> <span class="n">agg</span><span class="p">[</span><span class="s1">&#39;radius&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
        <span class="c1"># left: inserts at i where coords[:i] &lt; edge</span>
        <span class="c1"># right: inserts at i where coords[:i] &lt;= edge</span>
        <span class="c1"># r_ concatenates</span>
        <span class="n">bin_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">coords</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)]</span>
        <span class="n">binned</span> <span class="o">=</span> <span class="p">[</span><span class="n">radii</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bin_idx</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bin_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>
        <span class="k">return</span> <span class="n">binned</span><span class="p">,</span> <span class="n">bins</span></div>

<div class="viewcode-block" id="HoleAnalysis.histogram_radii"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.histogram_radii">[docs]</a>    <span class="k">def</span> <span class="nf">histogram_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aggregator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Histograms the pore radii into bins by reaction coordinate,</span>
<span class="sd">        aggregate the radii with an `aggregator` function, and returns the </span>
<span class="sd">        aggregated radii and bin edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aggregator: callable, optional</span>
<span class="sd">            this function must take an iterable of floats and return a </span>
<span class="sd">            single value. Default: np.mean</span>

<span class="sd">        frames: int or iterable of ints, optional</span>
<span class="sd">            Profiles to include by frame. If ``None``, includes</span>
<span class="sd">            all frames. Default: ``None``</span>

<span class="sd">        bins: int or iterable of edges, optional</span>
<span class="sd">            If bins is an int, it defines the number of equal-width bins in the given range. If bins is a sequence, it defines a monotonically increasing array of bin edges, including the rightmost edge, allowing for non-uniform bin widths. Default: 100</span>

<span class="sd">        range : (float, float), optional</span>
<span class="sd">            The lower and upper range of the bins.</span>
<span class="sd">            If not provided, ``range`` is simply ``(a.min(), a.max())``,</span>
<span class="sd">            where ``a`` is the array of reaction coordinates.</span>
<span class="sd">            Values outside the range are ignored. The first element of the range must be less than or equal to the second.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array of floats</span>
<span class="sd">            histogrammed, aggregate value of radii</span>
<span class="sd">        array of (float, float)</span>
<span class="sd">            Edges of each bin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">binned</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_radii</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">aggregator</span><span class="p">,</span> <span class="n">binned</span><span class="p">))),</span> <span class="n">bins</span></div>

<div class="viewcode-block" id="HoleAnalysis.plot_mean_profile"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.plot_mean_profile">[docs]</a>    <span class="k">def</span> <span class="nf">plot_mean_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                          <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="n">fill_alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                          <span class="n">n_std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">legend_loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
                          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Collects the pore radii into bins by reaction coordinate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frames: int or iterable of ints, optional</span>
<span class="sd">            Profiles to include by frame. If ``None``, includes</span>
<span class="sd">            all frames. Default: ``None``</span>

<span class="sd">        bins: int or iterable of edges, optional</span>
<span class="sd">            If bins is an int, it defines the number of equal-width bins in the given range. If bins is a sequence, it defines a monotonically increasing array of bin edges, including the rightmost edge, allowing for non-uniform bin widths. Default: 100</span>

<span class="sd">        range : (float, float), optional</span>
<span class="sd">            The lower and upper range of the bins.</span>
<span class="sd">            If not provided, ``range`` is simply ``(a.min(), a.max())``,</span>
<span class="sd">            where ``a`` is the array of reaction coordinates.</span>
<span class="sd">            Values outside the range are ignored. The first element of the range must be less than or equal to the second.</span>

<span class="sd">        color: str or array-like, optional</span>
<span class="sd">            Color for the plot. Default: &#39;blue&#39;</span>

<span class="sd">        linestyle: str or array-like, optional</span>
<span class="sd">            Line style for the plot. Default: &#39;-&#39;</span>

<span class="sd">        ax : :class:`matplotlib.axes.Axes`</span>
<span class="sd">            If no `ax` is supplied or set to ``None`` then the plot will</span>
<span class="sd">            be added to the current active axes. Default: ``None``</span>

<span class="sd">        xlabel : str, optional</span>
<span class="sd">            X-axis label. Default: &#39;Order parameter&#39;</span>

<span class="sd">        fill_alpha: float, optional</span>
<span class="sd">            Opacity of filled standard deviation area Default: 0.3</span>

<span class="sd">        n_std: int, optional</span>
<span class="sd">            Number of standard deviations from the mean to fill between.</span>
<span class="sd">            Default: 1</span>

<span class="sd">        legend: bool, optional</span>
<span class="sd">            Whether to plot a legend. Default: True</span>

<span class="sd">        legend_loc: str, optional</span>
<span class="sd">            Location of legend. Default: &#39;best&#39;</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            All other `kwargs` are passed to :func:`matplotlib.pyplot.plot`.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : :class:`~matplotlib.axes.Axes`</span>
<span class="sd">             Axes with the plot, either `ax` or the current axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">binned</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_radii</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="nb">range</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">binned</span><span class="p">)))</span>
        <span class="n">midpoints</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">n_std</span><span class="p">:</span>
            <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">binned</span><span class="p">)))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">midpoints</span><span class="p">,</span> <span class="n">mean</span><span class="o">-</span><span class="p">(</span><span class="n">n_std</span><span class="o">*</span><span class="n">std</span><span class="p">),</span> <span class="n">mean</span><span class="o">+</span><span class="p">(</span><span class="n">n_std</span><span class="o">*</span><span class="n">std</span><span class="p">),</span>
                            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">fill_alpha</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> std&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_std</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">midpoints</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pore coordinate $\zeta$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;HOLE radius $R$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend_loc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HoleAnalysis.plot3D_order_parameters"><a class="viewcode-back" href="../../../../documentation_pages/analysis/hole2.html#MDAnalysis.analysis.hole2.hole.HoleAnalysis.plot3D_order_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">plot3D_order_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order_parameters</span><span class="p">,</span>
                                <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
                                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">r_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Order parameter&#39;</span><span class="p">,</span>
                                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot HOLE radii over order parameters as a 3D graph.</span>

<span class="sd">        Lines are colored according to the specified ``color`` or</span>
<span class="sd">        drawn from the color map ``cmap``. One line is</span>
<span class="sd">        plotted for each trajectory frame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        order_parameters: array-like or string</span>
<span class="sd">            Sequence or text file containing order parameters(float</span>
<span class="sd">            numbers) corresponding to the frames in the trajectory. Must</span>
<span class="sd">            be same length as trajectory.</span>
<span class="sd">        frames: array-like, optional</span>
<span class="sd">            Frames to plot. If ``None``, plots all of them.</span>
<span class="sd">            Default: ``None``</span>
<span class="sd">        color: str or array-like, optional</span>
<span class="sd">            Color or colors for the plot. If ``None``, colors are</span>
<span class="sd">            drawn from ``cmap``. Default: ``None``</span>
<span class="sd">        cmap: str, optional</span>
<span class="sd">            color map to make colors for the plot if ``color`` is</span>
<span class="sd">            not given. Names should be from the ``matplotlib.pyplot.cm``</span>
<span class="sd">            module. Default: &#39;viridis&#39;</span>
<span class="sd">        linestyle: str or array-like, optional</span>
<span class="sd">            Line style for the plot. Default: &#39;-&#39;</span>
<span class="sd">        ax: : class: `matplotlib.axes.Axes`</span>
<span class="sd">            If no `ax` is supplied or set to ``None`` then the plot will</span>
<span class="sd">            be added to the current active axes. Default: ``None``</span>
<span class="sd">        r_max: float, optional</span>
<span class="sd">            only display radii up to ``r_max``. If ``None``, all radii are</span>
<span class="sd">            plotted. Default: ``None``</span>
<span class="sd">        ylabel: str, optional</span>
<span class="sd">            Y-axis label. Default: &#39;Order parameter&#39;</span>
<span class="sd">        **kwargs:</span>
<span class="sd">            All other `kwargs` are passed to: func: `matplotlib.pyplot.plot`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax: : class: `~mpl_toolkits.mplot3d.Axes3D`</span>
<span class="sd">             Axes with the plot, either `ax` or the current axes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">op_profiles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">over_order_parameters</span><span class="p">(</span><span class="n">order_parameters</span><span class="p">,</span>
                                                 <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

        <span class="n">ocl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_plot_kwargs</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">op_profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
                                        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                                        <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">op</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">ocl</span><span class="p">):</span>
            <span class="n">profile</span> <span class="o">=</span> <span class="n">op_profiles</span><span class="p">[</span><span class="n">op</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">r_max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">radius</span>
                <span class="n">rxn_coord</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">rxn_coord</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># does not seem to work with masked arrays but with nan hack!</span>
                <span class="c1"># http://stackoverflow.com/questions/4913306/python-matplotlib-mplot3d-how-do-i-set-a-maximum-value-for-the-z-axis</span>
                <span class="n">rxn_coord</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">rxn_coord</span>
                <span class="n">radius</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">radius</span><span class="p">[</span><span class="n">radius</span> <span class="o">&gt;</span> <span class="n">r_max</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rxn_coord</span><span class="p">,</span> <span class="n">op</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">rxn_coord</span><span class="p">),</span> <span class="n">radius</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">ls</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">op</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="p">),</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pore coordinate $\zeta$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;HOLE radius $R$ ($\AA$)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ax</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2005-2020, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Yuanyu Chang, Matthieu Chavent, Kathleen Clark, Charlie Cook, Ruggero Cortini, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Guillaume Fraux, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik &#39;Rathann&#39; Mierzejewski, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Faraaz Shah, Abhishek Shandilya, Shubham Sharma, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Matthijs Tadema, Joao Miguel Correia Teixeira, Xiki Tempula, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Wiep van der Toorn, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Yuxuan Zhuang, and Oliver Beckstein

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>