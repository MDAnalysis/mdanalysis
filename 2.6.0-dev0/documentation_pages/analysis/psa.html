<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.2.6. Calculating path similarity — MDAnalysis.analysis.psa &mdash; MDAnalysis 2.6.0-dev0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/msmb.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../../_static/js/versions.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 2.6.0-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2.7. ENCORE Ensemble Similarity Calculations — MDAnalysis.analysis.encore" href="encore.html" />
    <link rel="prev" title="4.2.5. Calculating root mean square quantities — MDAnalysis.analysis.rms" href="rms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/mdanalysis-logo-thin.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.6.0-dev0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="align.html">4.2.1. Coordinate fitting and alignment — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.align</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="contacts.html">4.2.2. Native contacts analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.contacts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="distances.html">4.2.3. Distance analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.distances</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="atomicdistances.html">4.2.4. Simple atomic distance analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.atomicdistances</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rms.html">4.2.5. Calculating root mean square quantities — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.rms</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.2.6. Calculating path similarity — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.psa</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#helper-functions-and-variables">4.2.6.1. Helper functions and variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes-methods-and-functions">4.2.6.2. Classes, methods, and functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="encore.html">4.2.7. ENCORE Ensemble Similarity Calculations — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.encore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="bat.html">4.2.8. Bond-Angle-Torsion coordinates analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.bat</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#data">4.11. Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">13. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">14. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">15. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">16. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">17. References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../analysis_modules.html"><span class="section-number">4. </span>Analysis modules</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4.2.6. </span>Calculating path similarity — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.psa</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/documentation_pages/analysis/psa.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="module-MDAnalysis.analysis.psa"></span><section id="calculating-path-similarity-mdanalysis-analysis-psa">
<h1><span class="section-number">4.2.6. </span>Calculating path similarity — <a class="reference internal" href="#module-MDAnalysis.analysis.psa" title="MDAnalysis.analysis.psa"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.psa</span></code></a><a class="headerlink" href="#calculating-path-similarity-mdanalysis-analysis-psa" title="Permalink to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p>Sean Seyler</p>
</dd>
<dt class="field-even">Year</dt>
<dd class="field-even"><p>2015</p>
</dd>
<dt class="field-odd">Copyright</dt>
<dd class="field-odd"><p>GNU Public License v3</p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.10.0.</span></p>
</div>
<p>The module contains code to calculate the geometric similarity of trajectories
using path metrics such as the Hausdorff or Fréchet distances
<span id="id1">[<a class="reference internal" href="#id43" title="Sean L. Seyler, Avishek Kumar, M. F. Thorpe, and Oliver Beckstein. Path similarity analysis: a method for quantifying macromolecular pathways. PLOS Computational Biology, 11(10):1-37, 10 2015. doi:10.1371/journal.pcbi.1004568.">Seyler2015</a>]</span>. The path metrics are functions of two paths and return a
nonnegative number, i.e., a distance. Two paths are identical if their distance
is zero, and large distances indicate dissimilarity. Each path metric is a
function of the individual points (e.g., coordinate snapshots) that comprise
each path and, loosely speaking, identify the two points, one per path of a
pair of paths, where the paths deviate the most.  The distance between these
points of maximal deviation is measured by the root mean square deviation
(RMSD), i.e., to compute structural similarity.</p>
<p>One typically computes the pairwise similarity for an ensemble of paths to
produce a symmetric distance matrix, which can be clustered to, at a glance,
identify patterns in the trajectory data. To properly analyze a path ensemble,
one must select a suitable reference structure to which all paths (each
conformer in each path) will be universally aligned using the rotations
determined by the best-fit rmsds. Distances between paths and their structures
are then computed directly with no further alignment. This pre-processing step
is necessary to preserve the metric properties of the Hausdorff and Fréchet
metrics; using the best-fit rmsd on a pairwise basis does not generally
preserve the triangle inequality.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference external" href="https://github.com/Becksteinlab/PSAnalysisTutorial">PSAnalysisTutorial</a> outlines a typical application of PSA to
a set of trajectories, including doing proper alignment,
performing distance comparisons, and generating heat
map-dendrogram plots from hierarchical clustering.</p>
</div>
<p class="rubric">References</p>
<div class="docutils container" id="id2">
<dl class="citation">
<dt class="label" id="id43"><span class="brackets">Seyler2015</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id137">2</a>,<a href="#id138">3</a>,<a href="#id139">4</a>)</span></dt>
<dd><p>Sean L. Seyler, Avishek Kumar, M. F. Thorpe, and Oliver Beckstein. Path similarity analysis: a method for quantifying macromolecular pathways. <em>PLOS Computational Biology</em>, 11(10):1–37, 10 2015. <a class="reference external" href="https://doi.org/10.1371/journal.pcbi.1004568">doi:10.1371/journal.pcbi.1004568</a>.</p>
</dd>
</dl>
</div>
<section id="helper-functions-and-variables">
<h2><span class="section-number">4.2.6.1. </span>Helper functions and variables<a class="headerlink" href="#helper-functions-and-variables" title="Permalink to this heading"></a></h2>
<p>The following convenience functions are used by other functions in this module.</p>
<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.sqnorm">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">sqnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#sqnorm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.sqnorm" title="Permalink to this definition"></a></dt>
<dd><p>Compute the sum of squares of elements along specified axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – coordinates</p></li>
<li><p><strong>axes</strong> (<em>None / int / tuple</em><em> (</em><em>optional</em><em>)</em>) – Axes or axes along which a sum is performed. The default
(<em>axes</em> = <code class="docutils literal notranslate"><span class="pre">None</span></code>) performs a sum over all the dimensions of
the input array.  The value of <em>axes</em> may be negative, in
which case it counts from the last axis to the zeroth axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the sum of the squares of the elements of <cite>v</cite> along <cite>axes</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.get_msd_matrix">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">get_msd_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#get_msd_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.get_msd_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Generate the matrix of pairwise mean-squared deviations between paths.</p>
<p>The MSDs between all pairs of points in <cite>P</cite> and <cite>Q</cite> are
calculated, each pair having a point from <cite>P</cite> and a point from
<cite>Q</cite>.</p>
<p><cite>P</cite> (<cite>Q</cite>) is a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of <span class="math notranslate nohighlight">\(N_p\)</span> (<span class="math notranslate nohighlight">\(N_q\)</span>) time
steps, <span class="math notranslate nohighlight">\(N\)</span> atoms, and <span class="math notranslate nohighlight">\(3N\)</span> coordinates (e.g.,
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.positions" title="MDAnalysis.core.groups.AtomGroup.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.positions</span></code></a>). The pairwise MSD
matrix has dimensions <span class="math notranslate nohighlight">\(N_p\)</span> by <span class="math notranslate nohighlight">\(N_q\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the first path</p></li>
<li><p><strong>Q</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the second path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>msd_matrix</strong> – matrix of pairwise MSDs between points in <cite>P</cite> and points
in <cite>Q</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We calculate the MSD matrix</p>
<div class="math notranslate nohighlight">
\[M_{ij} = ||p_i - q_j||^2\]</div>
<p>where <span class="math notranslate nohighlight">\(p_i \in P\)</span> and <span class="math notranslate nohighlight">\(q_j \in Q\)</span>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.get_coord_axes">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">get_coord_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#get_coord_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.get_coord_axes" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of atoms and the axes corresponding to atoms
and coordinates for a given path.</p>
<p>The <cite>path</cite> is assumed to be a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> where the 0th axis
corresponds to a frame (a snapshot of coordinates). The <span class="math notranslate nohighlight">\(3N\)</span>
(Cartesian) coordinates are assumed to be either:</p>
<ol class="arabic simple">
<li><p>all in the 1st axis, starting with the x,y,z coordinates of the
first atom, followed by the <em>x</em>,*y*,*z* coordinates of the 2nd, etc.</p></li>
<li><p>in the 1st <em>and</em> 2nd axis, where the 1st axis indexes the atom
number and the 2nd axis contains the <em>x</em>,*y*,*z* coordinates of
each atom.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – representing a path</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the number of atoms and the axes containing coordinates</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a>, (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a>, …))</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="classes-methods-and-functions">
<h2><span class="section-number">4.2.6.2. </span>Classes, methods, and functions<a class="headerlink" href="#classes-methods-and-functions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.get_path_metric_func">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">get_path_metric_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#get_path_metric_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.get_path_metric_func" title="Permalink to this definition"></a></dt>
<dd><p>Selects a path metric function by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of path metric</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>path_metric</strong> – The path metric function specified by <em>name</em> (if found).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.hausdorff">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">hausdorff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#hausdorff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.hausdorff" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the symmetric Hausdorff distance between two paths.</p>
<p>The metric used is RMSD, as opposed to the more conventional L2
(Euclidean) norm, because this is convenient for i.e., comparing
protein configurations.</p>
<p><em>P</em> (<em>Q</em>) is a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of <span class="math notranslate nohighlight">\(N_p\)</span> (<span class="math notranslate nohighlight">\(N_q\)</span>) time
steps, <span class="math notranslate nohighlight">\(N\)</span> atoms, and <span class="math notranslate nohighlight">\(3N\)</span> coordinates (e.g.,
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.positions" title="MDAnalysis.core.groups.AtomGroup.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.positions</span></code></a>). <em>P</em> (<em>Q</em>) has
either shape <span class="math notranslate nohighlight">\(N_p \times N \times 3\)</span> (<span class="math notranslate nohighlight">\(N_q \times N \times 3\)</span>), or <span class="math notranslate nohighlight">\(N_p \times (3N)\)</span> (<span class="math notranslate nohighlight">\(N_q \times (3N)\)</span>) in flattened form.</p>
<p>Note that reversing the path does not change the Hausdorff distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the first path</p></li>
<li><p><strong>Q</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the second path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the Hausdorff distance between paths <cite>P</cite> and <cite>Q</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Calculate the Hausdorff distance between two halves of a trajectory:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">psa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ca</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[:</span><span class="n">mid</span><span class="p">:]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># first half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">mid</span><span class="p">::]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># second half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">hausdorff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">4.778663899862152</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">hausdorff</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># hausdorff distance w/ reversed 2nd trajectory</span>
<span class="go">4.778663899862152</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.directed_hausdorff.html#scipy.spatial.distance.directed_hausdorff" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.spatial.distance.directed_hausdorff()</span></code></a> is an optimized
implementation of the early break algorithm of <span id="id69">[<a class="reference internal" href="#id115" title="Abdel Aziz Taha and Allan Hanbury. An efficient algorithm for calculating the exact hausdorff distance. IEEE Transactions on Pattern Analysis and Machine Intelligence, 37(11):2153-2163, 2015. doi:10.1109/TPAMI.2015.2408351.">Taha2015</a>]</span>; the
latter code is used here to calculate the symmetric Hausdorff
distance with an RMSD metric</p>
<p class="rubric">References</p>
<div class="docutils container" id="id70">
<dl class="citation">
<dt class="label" id="id115"><span class="brackets"><a class="fn-backref" href="#id69">Taha2015</a></span></dt>
<dd><p>Abdel Aziz Taha and Allan Hanbury. An efficient algorithm for calculating the exact hausdorff distance. <em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, 37(11):2153–2163, 2015. <a class="reference external" href="https://doi.org/10.1109/TPAMI.2015.2408351">doi:10.1109/TPAMI.2015.2408351</a>.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.hausdorff_wavg">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">hausdorff_wavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#hausdorff_wavg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.hausdorff_wavg" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the weighted average Hausdorff distance between two paths.</p>
<p><em>P</em> (<em>Q</em>) is a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of <span class="math notranslate nohighlight">\(N_p\)</span> (<span class="math notranslate nohighlight">\(N_q\)</span>) time
steps, <span class="math notranslate nohighlight">\(N\)</span> atoms, and <span class="math notranslate nohighlight">\(3N\)</span> coordinates (e.g.,
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.positions" title="MDAnalysis.core.groups.AtomGroup.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.positions</span></code></a>). <em>P</em> (<em>Q</em>) has
either shape <span class="math notranslate nohighlight">\(N_p \times N \times 3\)</span> (<span class="math notranslate nohighlight">\(N_q \times N \times 3\)</span>), or <span class="math notranslate nohighlight">\(N_p \times (3N)\)</span> (<span class="math notranslate nohighlight">\(N_q \times (3N)\)</span>) in flattened form. The nearest
neighbor distances for <em>P</em> (to <em>Q</em>) and those of <em>Q</em> (to <em>P</em>) are averaged
individually to get the average nearest neighbor distance for <em>P</em> and
likewise for <em>Q</em>. These averages are then summed and divided by 2 to get a
measure that gives equal weight to <em>P</em> and <em>Q</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the first path</p></li>
<li><p><strong>Q</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the second path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the weighted average Hausdorff distance between paths <cite>P</cite> and <cite>Q</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis</span> <span class="kn">import</span> <span class="n">Universe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">psa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ca</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[:</span><span class="n">mid</span><span class="p">:]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># first half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">mid</span><span class="p">::]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># second half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">hausdorff_wavg</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2.5669644353703447</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">hausdorff_wavg</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># weighted avg hausdorff dist w/ Q reversed</span>
<span class="go">2.5669644353703447</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The weighted average Hausdorff distance is not a true metric (it does not
obey the triangle inequality); see <span id="id137">[<a class="reference internal" href="#id43" title="Sean L. Seyler, Avishek Kumar, M. F. Thorpe, and Oliver Beckstein. Path similarity analysis: a method for quantifying macromolecular pathways. PLOS Computational Biology, 11(10):1-37, 10 2015. doi:10.1371/journal.pcbi.1004568.">Seyler2015</a>]</span> for further
details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.hausdorff_avg">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">hausdorff_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#hausdorff_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.hausdorff_avg" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the average Hausdorff distance between two paths.</p>
<p><em>P</em> (<em>Q</em>) is a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of <span class="math notranslate nohighlight">\(N_p\)</span> (<span class="math notranslate nohighlight">\(N_q\)</span>) time
steps, <span class="math notranslate nohighlight">\(N\)</span> atoms, and <span class="math notranslate nohighlight">\(3N\)</span> coordinates (e.g.,
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.positions" title="MDAnalysis.core.groups.AtomGroup.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.positions</span></code></a>). <em>P</em> (<em>Q</em>) has
either shape <span class="math notranslate nohighlight">\(N_p \times N \times 3\)</span> (<span class="math notranslate nohighlight">\(N_q \times N \times 3\)</span>), or <span class="math notranslate nohighlight">\(N_p \times (3N)\)</span> (<span class="math notranslate nohighlight">\(N_q \times (3N)\)</span>) in flattened form. The nearest
neighbor distances for <em>P</em> (to <em>Q</em>) and those of <em>Q</em> (to <em>P</em>) are all
averaged together to get a mean nearest neighbor distance. This measure
biases the average toward the path that has more snapshots, whereas weighted
average Hausdorff gives equal weight to both paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the first path</p></li>
<li><p><strong>Q</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the second path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the average Hausdorff distance between paths <cite>P</cite> and <cite>Q</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">psa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ca</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[:</span><span class="n">mid</span><span class="p">:]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># first half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">mid</span><span class="p">::]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># second half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">hausdorff_avg</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2.5669646575869005</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">hausdorff_avg</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># hausdorff distance w/ reversed 2nd trajectory</span>
<span class="go">2.5669646575869005</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The average Hausdorff distance is not a true metric (it does not obey the
triangle inequality); see <span id="id138">[<a class="reference internal" href="#id43" title="Sean L. Seyler, Avishek Kumar, M. F. Thorpe, and Oliver Beckstein. Path similarity analysis: a method for quantifying macromolecular pathways. PLOS Computational Biology, 11(10):1-37, 10 2015. doi:10.1371/journal.pcbi.1004568.">Seyler2015</a>]</span> for further details.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.hausdorff_neighbors">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">hausdorff_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#hausdorff_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.hausdorff_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Find the Hausdorff neighbors of two paths.</p>
<p><em>P</em> (<em>Q</em>) is a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of <span class="math notranslate nohighlight">\(N_p\)</span> (<span class="math notranslate nohighlight">\(N_q\)</span>) time
steps, <span class="math notranslate nohighlight">\(N\)</span> atoms, and <span class="math notranslate nohighlight">\(3N\)</span> coordinates (e.g.,
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.positions" title="MDAnalysis.core.groups.AtomGroup.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.positions</span></code></a>). <em>P</em> (<em>Q</em>) has
either shape <span class="math notranslate nohighlight">\(N_p \times N \times 3\)</span> (<span class="math notranslate nohighlight">\(N_q \times N \times 3\)</span>), or <span class="math notranslate nohighlight">\(N_p \times (3N)\)</span> (<span class="math notranslate nohighlight">\(N_q \times (3N)\)</span>) in flattened form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the first path</p></li>
<li><p><strong>Q</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the second path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary of two pairs of numpy arrays, the first pair (key
“frames”) containing the indices of (Hausdorff) nearest
neighbors for <cite>P</cite> and <cite>Q</cite>, respectively, the second (key
“distances”) containing (corresponding) nearest neighbor
distances for <cite>P</cite> and <cite>Q</cite>, respectively</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Hausdorff neighbors are those points on the two paths that are separated by
the Hausdorff distance. They are the farthest nearest neighbors and are
maximally different in the sense of the Hausdorff distance
<span id="id139">[<a class="reference internal" href="#id43" title="Sean L. Seyler, Avishek Kumar, M. F. Thorpe, and Oliver Beckstein. Path similarity analysis: a method for quantifying macromolecular pathways. PLOS Computational Biology, 11(10):1-37, 10 2015. doi:10.1371/journal.pcbi.1004568.">Seyler2015</a>]</span>.</p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.directed_hausdorff.html#scipy.spatial.distance.directed_hausdorff" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.spatial.distance.directed_hausdorff()</span></code></a> can also provide the
hausdorff neighbors.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.discrete_frechet">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">discrete_frechet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#discrete_frechet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.discrete_frechet" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the discrete Fréchet distance between two paths.</p>
<p><em>P</em> (<em>Q</em>) is a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of <span class="math notranslate nohighlight">\(N_p\)</span> (<span class="math notranslate nohighlight">\(N_q\)</span>) time
steps, <span class="math notranslate nohighlight">\(N\)</span> atoms, and <span class="math notranslate nohighlight">\(3N\)</span> coordinates (e.g.,
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.positions" title="MDAnalysis.core.groups.AtomGroup.positions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.positions</span></code></a>). <em>P</em> (<em>Q</em>) has
either shape <span class="math notranslate nohighlight">\(N_p \times N \times 3\)</span> (<span class="math notranslate nohighlight">\(N_q \times N \times 3\)</span>), or :<span class="math notranslate nohighlight">\(N_p \times (3N)\)</span> (<span class="math notranslate nohighlight">\(N_q \times (3N)\)</span>) in flattened form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the first path</p></li>
<li><p><strong>Q</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – the points in the second path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the discrete Fréchet distance between paths <em>P</em> and <em>Q</em></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Calculate the discrete Fréchet distance between two halves of a
trajectory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">psa</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ca</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;name CA&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[:</span><span class="n">mid</span><span class="p">:]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># first half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>               <span class="n">ca</span><span class="o">.</span><span class="n">positions</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">mid</span><span class="p">::]</span>
<span class="gp">... </span>             <span class="p">])</span> <span class="c1"># second half of trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">discrete_frechet</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">4.778663984013591</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psa</span><span class="o">.</span><span class="n">discrete_frechet</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># frechet distance w/ 2nd trj reversed 2nd</span>
<span class="go">6.842901117711383</span>
</pre></div>
</div>
<p>Note that reversing the direction increased the Fréchet distance:
it is sensitive to the direction of the path.</p>
<p class="rubric">Notes</p>
<p>The discrete Fréchet metric is an approximation to the continuous Fréchet
metric <span id="id140">[<a class="reference internal" href="#id161" title="M. Maurice Frèchet. Sur quelques points du calcul fonctionnel. Rendiconti del Circolo Matematico di Palermo (1884-1940), 22(1):1–72, 1906. doi:10.1007/BF03018603.">Frèchet1906</a>, <a class="reference internal" href="#id146" title="Helmut Alt and Michael Godau. Computing the frechet distance between two polygonal curves. International Journal of Computational Geometry &amp; Applications, 05(01n02):75-91, 1995. doi:10.1142/S0218195995000064.">Alt1995</a>]</span>. The calculation of the continuous
Fréchet distance is implemented with the dynamic programming algorithm of
<span id="id141">[<a class="reference internal" href="#id157" title="Thomas Eiter and Heikki Mannila. Computing discrete frechet distance. 05 1994.">Eiter1994</a>, <a class="reference internal" href="#id158" title="Thomas Eiter and Heikki Mannila. Distance measures for point sets and their computation. Acta Informatica, 34(2):109–133, 1997. doi:10.1007/s002360050075.">Eiter1997</a>]</span>.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id142">
<dl class="citation">
<dt class="label" id="id161"><span class="brackets"><a class="fn-backref" href="#id140">Frèchet1906</a></span></dt>
<dd><p>M. Maurice Frèchet. Sur quelques points du calcul fonctionnel. <em>Rendiconti del Circolo Matematico di Palermo (1884-1940)</em>, 22(1):1–72, 1906. <a class="reference external" href="https://doi.org/10.1007/BF03018603">doi:10.1007/BF03018603</a>.</p>
</dd>
<dt class="label" id="id146"><span class="brackets"><a class="fn-backref" href="#id140">Alt1995</a></span></dt>
<dd><p>Helmut Alt and Michael Godau. Computing the frechet distance between two polygonal curves. <em>International Journal of Computational Geometry &amp; Applications</em>, 05(01n02):75–91, 1995. <a class="reference external" href="https://doi.org/10.1142/S0218195995000064">doi:10.1142/S0218195995000064</a>.</p>
</dd>
<dt class="label" id="id157"><span class="brackets"><a class="fn-backref" href="#id141">Eiter1994</a></span></dt>
<dd><p>Thomas Eiter and Heikki Mannila. Computing discrete frechet distance. 05 1994.</p>
</dd>
<dt class="label" id="id158"><span class="brackets"><a class="fn-backref" href="#id141">Eiter1997</a></span></dt>
<dd><p>Thomas Eiter and Heikki Mannila. Distance measures for point sets and their computation. <em>Acta Informatica</em>, 34(2):109–133, 1997. <a class="reference external" href="https://doi.org/10.1007/s002360050075">doi:10.1007/s002360050075</a>.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.dist_mat_to_vec">
<span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">dist_mat_to_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#dist_mat_to_vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.dist_mat_to_vec" title="Permalink to this definition"></a></dt>
<dd><p>Convert distance matrix indices (in the upper triangle) to the index of
the corresponding distance vector.</p>
<p>This is a convenience function to locate distance matrix elements (and the
pair generating it) in the corresponding distance vector. The row index <em>j</em>
should be greater than <em>i+1</em>, corresponding to the upper triangle of the
distance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – size of the distance matrix (of shape <em>N</em>-by-<em>N</em>)</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – row index (starting at 0) of the distance matrix</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – column index (starting at 0) of the distance matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index (of the matrix element) in the corresponding distance vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">Path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#Path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.Path" title="Permalink to this definition"></a></dt>
<dd><p>Represent a path based on a <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>.</p>
<p>Pre-process a <code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code> object: (1) fit the trajectory to a
reference structure, (2) convert fitted time series to a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> representation of <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a>.</p>
<p>The analysis is performed with <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run" title="MDAnalysis.analysis.psa.PSAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run()</span></code></a> and stores the result
in the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> distance matrix <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a>.
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run" title="MDAnalysis.analysis.psa.PSAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run()</span></code></a> also generates a fitted trajectory and path from
alignment of the original trajectories to a reference structure.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.1.</span></p>
</div>
<p>Setting up trajectory alignment and fitted path generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>universe</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object containing a trajectory</p></li>
<li><p><strong>reference</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – reference structure (uses <cite>ref_frame</cite> from the trajectory)</p></li>
<li><p><strong>select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a><em> (</em><em>optional</em><em>)</em>) – <p>The selection to operate on for rms fitting; can be one of:</p>
<ol class="arabic simple">
<li><p>any valid selection string for
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> that
produces identical selections in <em>mobile</em> and <em>reference</em>; or</p></li>
<li><p>a dictionary <code class="docutils literal notranslate"><span class="pre">{'mobile':sel1,</span> <span class="pre">'reference':sel2}</span></code> (the
<a class="reference internal" href="align.html#MDAnalysis.analysis.align.fasta2select" title="MDAnalysis.analysis.align.fasta2select"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.analysis.align.fasta2select()</span></code></a> function returns
such a dictionary based on a <a class="reference external" href="http://www.clustal.org/">ClustalW</a> or <a class="reference external" href="http://www.compbio.dundee.ac.uk/manuals/stamp.4.2/">STAMP</a> sequence
alignment); or</p></li>
<li><p>a tuple <code class="docutils literal notranslate"><span class="pre">(sel1,</span> <span class="pre">sel2)</span></code></p></li>
</ol>
<p>When using 2. or 3. with <em>sel1</em> and <em>sel2</em> then these selections
can also each be a list of selection strings (to generate an
AtomGroup with defined atom order as described under
<a class="reference internal" href="../selections.html#ordered-selections-label"><span class="std std-ref">Ordered selections</span></a>).</p>
</p></li>
<li><p><strong>ref_frame</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – frame index to select the coordinate frame from
<cite>select.trajectory</cite></p></li>
<li><p><strong>path_select</strong> (<em>selection_string</em>) – atom selection composing coordinates of (fitted) path; if <code class="docutils literal notranslate"><span class="pre">None</span></code>
then <cite>path_select</cite> is set to <cite>select</cite> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.u_original">
<span class="sig-name descname"><span class="pre">u_original</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.u_original" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object with a trajectory</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.u_reference">
<span class="sig-name descname"><span class="pre">u_reference</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.u_reference" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object containing a reference structure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.select">
<span class="sig-name descname"><span class="pre">select</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.select" title="Permalink to this definition"></a></dt>
<dd><p>string, selection for
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> to select frame
from <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_reference" title="MDAnalysis.analysis.psa.Path.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_reference</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.path_select">
<span class="sig-name descname"><span class="pre">path_select</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.path_select" title="Permalink to this definition"></a></dt>
<dd><p>string, selection for
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> to select atoms
to compose <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.ref_frame">
<span class="sig-name descname"><span class="pre">ref_frame</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.ref_frame" title="Permalink to this definition"></a></dt>
<dd><p>int, frame index to select frame from <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_reference" title="MDAnalysis.analysis.psa.Path.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_reference</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.u_fitted">
<span class="sig-name descname"><span class="pre">u_fitted</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.u_fitted" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object with the fitted trajectory</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.path">
<span class="sig-name descname"><span class="pre">path</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.path" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> object representation of the fitted trajectory</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.fit_to_reference">
<span class="sig-name descname"><span class="pre">fit_to_reference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_fit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsdfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#Path.fit_to_reference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.fit_to_reference" title="Permalink to this definition"></a></dt>
<dd><p>Align each trajectory frame to the reference structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – file name for the RMS-fitted trajectory or pdb; defaults to the
original trajectory filename (from <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_original" title="MDAnalysis.analysis.psa.Path.u_original"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_original</span></code></a>) with
<cite>prefix</cite> prepended</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – prefix for auto-generating the new output filename</p></li>
<li><p><strong>rmsdfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – file name for writing the RMSD time series [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>weights</strong> ({“mass”, <code class="docutils literal notranslate"><span class="pre">None</span></code>} or array_like (optional)) – choose weights. With <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code> uses masses as weights; with
<code class="docutils literal notranslate"><span class="pre">None</span></code> weigh each atom equally. If a float array of the same
length as the selected AtomGroup is provided, use each element of
the <cite>array_like</cite> as a weight for the corresponding atom in the
AtomGroup.</p></li>
<li><p><strong>tol_mass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Reject match if the atomic masses for matched atoms differ by more
than <cite>tol_mass</cite> [0.1]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object containing a fitted trajectory</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe">Universe</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses <a class="reference internal" href="align.html#MDAnalysis.analysis.align.AlignTraj" title="MDAnalysis.analysis.align.AlignTraj"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.analysis.align.AlignTraj</span></code></a> for the fitting.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.1: </span>Instead of <code class="docutils literal notranslate"><span class="pre">mass_weighted=True</span></code> use new <code class="docutils literal notranslate"><span class="pre">weights='mass'</span></code>;
refactored to fit with AnalysisBase API</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Deprecated keyword <cite>mass_weighted</cite> was removed.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.get_num_atoms">
<span class="sig-name descname"><span class="pre">get_num_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#Path.get_num_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.get_num_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of atoms used to construct the <a class="reference internal" href="#MDAnalysis.analysis.psa.Path" title="MDAnalysis.analysis.psa.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a>.</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.to_path" title="MDAnalysis.analysis.psa.Path.to_path"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.to_path()</span></code></a> prior to calling this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of atoms in the <a class="reference internal" href="#MDAnalysis.analysis.psa.Path" title="MDAnalysis.analysis.psa.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_fit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsdfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#Path.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.run" title="Permalink to this definition"></a></dt>
<dd><p>Generate a path from a trajectory and reference structure.</p>
<p>As part of the path generation, the trajectory can be superimposed
(“aligned”) to a reference structure if specified.</p>
<p>This is a convenience method to generate a fitted trajectory from an
inputted universe (<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_original" title="MDAnalysis.analysis.psa.Path.u_original"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_original</span></code></a>) and reference structure
(<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_reference" title="MDAnalysis.analysis.psa.Path.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_reference</span></code></a>). <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.fit_to_reference" title="MDAnalysis.analysis.psa.Path.fit_to_reference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.fit_to_reference()</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.to_path" title="MDAnalysis.analysis.psa.Path.to_path"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.to_path()</span></code></a> are used consecutively to generate a new universe
(<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_fitted" title="MDAnalysis.analysis.psa.Path.u_fitted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_fitted</span></code></a>) containing the fitted trajectory along with the
corresponding <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> represented as an
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>. The method returns a tuple of the topology name
and new trajectory name, which can be fed directly into an
<code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object after unpacking the tuple using the
<code class="docutils literal notranslate"><span class="pre">*</span></code> operator, as in
<code class="docutils literal notranslate"><span class="pre">MDAnalysis.Universe(*(top_name,</span> <span class="pre">newtraj_name))</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>align</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Align trajectory to atom selection <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.select" title="MDAnalysis.analysis.psa.Path.select"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.select</span></code></a> of
<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_reference" title="MDAnalysis.analysis.psa.Path.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_reference</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a universe containing an
aligned trajectory is produced with <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.fit_to_reference" title="MDAnalysis.analysis.psa.Path.fit_to_reference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Path.fit_to_reference()</span></code></a>
[<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – filename for the RMS-fitted trajectory or pdb; defaults to the
original trajectory filename (from <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_original" title="MDAnalysis.analysis.psa.Path.u_original"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_original</span></code></a>) with
<em>prefix</em> prepended</p></li>
<li><p><strong>postfix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – prefix for auto-generating the new output filename</p></li>
<li><p><strong>rmsdfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – file name for writing the RMSD time series [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>weights</strong> ({“mass”, <code class="docutils literal notranslate"><span class="pre">None</span></code>} or array_like (optional)) – choose weights. With <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code> uses masses as weights; with
<code class="docutils literal notranslate"><span class="pre">None</span></code> weigh each atom equally. If a float array of the same
length as the selected AtomGroup is provided, use each element of
the <cite>array_like</cite> as a weight for the corresponding atom in the
AtomGroup.</p></li>
<li><p><strong>tol_mass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Reject match if the atomic masses for matched atoms differ by more
than <em>tol_mass</em> [0.1]</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – represent <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> with 2D (<span class="math notranslate nohighlight">\(N_p\times 3N\)</span>) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>;
if <code class="docutils literal notranslate"><span class="pre">False</span></code> then <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> is a 3D (<span class="math notranslate nohighlight">\(N_p\times N\times 3\)</span>)
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>topology_trajectory</strong> – A tuple of the topology name and new trajectory name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a></p>
</dd>
</dl>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.1: </span>Instead of <code class="docutils literal notranslate"><span class="pre">mass_weighted=True</span></code> use new <code class="docutils literal notranslate"><span class="pre">weights='mass'</span></code>;
refactored to fit with AnalysisBase API</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Deprecated keyword <cite>mass_weighted</cite> was removed.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.Path.to_path">
<span class="sig-name descname"><span class="pre">to_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#Path.to_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.Path.to_path" title="Permalink to this definition"></a></dt>
<dd><p>Generates a coordinate time series from the fitted universe
trajectory.</p>
<p>Given a selection of <em>N</em> atoms from <em>select</em>, the atomic positions for
each frame in the fitted universe (<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_fitted" title="MDAnalysis.analysis.psa.Path.u_fitted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_fitted</span></code></a>) trajectory
(with <span class="math notranslate nohighlight">\(N_p\)</span> total frames) are appended sequentially to form a 3D or 2D
(if <em>flat</em> is <code class="docutils literal notranslate"><span class="pre">True</span></code>) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> representation of the
fitted trajectory (with dimensions <span class="math notranslate nohighlight">\(N_p\times N\times 3\)</span> or <span class="math notranslate nohighlight">\(N_p\times 3N\)</span>, respectively).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fitted</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – construct a <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> from the <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_fitted" title="MDAnalysis.analysis.psa.Path.u_fitted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_fitted</span></code></a>
trajectory; if <code class="docutils literal notranslate"><span class="pre">False</span></code> then <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> is generated with
the trajectory from <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_original" title="MDAnalysis.analysis.psa.Path.u_original"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_original</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – the selection for constructing the coordinates of each frame in
<a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a>; if <code class="docutils literal notranslate"><span class="pre">None</span></code> then <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path_select" title="MDAnalysis.analysis.psa.Path.path_select"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path_select</span></code></a>
is used, else it is overridden by <em>select</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – represent <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> as a 2D (<span class="math notranslate nohighlight">\(N_p\times 3N\)</span>) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>;
if <code class="docutils literal notranslate"><span class="pre">False</span></code> then <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> is a 3D (<span class="math notranslate nohighlight">\(N_p\times N\times 3\)</span>)
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>representing a time series of atomic positions of an
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup</span></code></a> selection from
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_fitted.trajectory</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAPair">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">PSAPair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npaths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAPair"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAPair" title="Permalink to this definition"></a></dt>
<dd><p>Generate nearest neighbor and Hausdorff pair information between a pair
of paths from an all-pairs comparison generated by <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code>.</p>
<p>The nearest neighbors for each path of a pair of paths is generated by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAPair.compute_nearest_neighbors()</span></code> and stores the result
in a dictionary (<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair.nearest_neighbors" title="MDAnalysis.analysis.psa.PSAPair.nearest_neighbors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nearest_neighbors</span></code></a>): each path has a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of the frames of its nearest neighbors, and a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of its nearest neighbor distances
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a>. For example, <em>nearest_neighbors[‘frames’]</em> is a pair
of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, the first being the frames of the nearest
neighbors of the first path, <em>i</em>, the second being those of the second path,
<em>j</em>.</p>
<p>The Hausdorff pair for the pair of paths is found by calling
<code class="xref py py-meth docutils literal notranslate"><span class="pre">find_hausdorff_pair()</span></code> (locates the nearest neighbor pair having the
largest overall distance separating them), which stores the result in a
dictionary (<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair.hausdorff_pair" title="MDAnalysis.analysis.psa.PSAPair.hausdorff_pair"><code class="xref py py-attr docutils literal notranslate"><span class="pre">hausdorff_pair</span></code></a>) containing the frames (indices) of the
pair along with the corresponding (Hausdorff) distance.
<em>hausdorff_pair[‘frame’]</em> contains a pair of frames in the first path, <em>i</em>,
and the second path, <em>j</em>, respectively, that correspond to the Hausdorff
distance between them.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.</span></p>
</div>
<p>Set up a <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> for a pair of paths that are part of a
<code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code> comparison of <em>npaths</em> total paths.</p>
<p>Each unique pair of paths compared using <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code> is related by
their nearest neighbors (and corresponding distances) and the Hausdorff
pair and distance. <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> is a convenience class for
calculating and encapsulating nearest neighbor and Hausdorff pair
information for one pair of paths.</p>
<p>Given <em>npaths</em>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code> performs and all-pairs comparison among all
paths for a total of :math:`    ext{npaths}*(   ext{npaths}-1)/2` unique
comparisons. If distances between paths are computed, the all-pairs
comparison can be summarized in a symmetric distance matrix whose upper
triangle can be mapped to a corresponding distance vector form in a
one-to-one manner. A particular comparison of a pair of paths in a
given instance of <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> is thus unique identified by the row
and column indices in the distance matrix representation (whether or not
distances are actually computed), or a single ID (index) in the
corresponding distance vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>npaths</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – total number of paths in <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code> used to generate <em>this</em>
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a></p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – row index (starting at 0) of the distance matrix</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – column index (starting at 0) of the distance matrix</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAPair.npaths">
<span class="sig-name descname"><span class="pre">npaths</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAPair.npaths" title="Permalink to this definition"></a></dt>
<dd><p>int, total number of paths in the comparison in which <em>this</em>
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> was generated</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAPair.matrix_id">
<span class="sig-name descname"><span class="pre">matrix_id</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAPair.matrix_id" title="Permalink to this definition"></a></dt>
<dd><p>(int, int), (row, column) indices of the location of <em>this</em>
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> in the corresponding pairwise distance matrix</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAPair.pair_id">
<span class="sig-name descname"><span class="pre">pair_id</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAPair.pair_id" title="Permalink to this definition"></a></dt>
<dd><p>int, ID of <em>this</em> <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> (the pair_id:math:<cite>^text{th}</cite>
comparison) in the distance vector corresponding to the pairwise distance
matrix</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAPair.nearest_neighbors">
<span class="sig-name descname"><span class="pre">nearest_neighbors</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAPair.nearest_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>dict, contains the nearest neighbors by frame index and the
nearest neighbor distances for each path in <em>this</em> <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAPair.hausdorff_pair">
<span class="sig-name descname"><span class="pre">hausdorff_pair</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAPair.hausdorff_pair" title="Permalink to this definition"></a></dt>
<dd><p>dict, contains the frame indices of the Hausdorff pair for each path in
<em>this</em> <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> and the corresponding (Hausdorff) distance</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.psa.</span></span><span class="sig-name descname"><span class="pre">PSAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'name</span> <span class="pre">CA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis" title="Permalink to this definition"></a></dt>
<dd><p>Perform Path Similarity Analysis (PSA) on a set of trajectories.</p>
<p>The analysis is performed with <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run" title="MDAnalysis.analysis.psa.PSAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run()</span></code></a> and stores the result
in the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> distance matrix <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a>.
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run" title="MDAnalysis.analysis.psa.PSAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run()</span></code></a> also generates a fitted trajectory and path from
alignment of the original trajectories to a reference structure.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0.0: </span><code class="docutils literal notranslate"><span class="pre">save_result()</span></code> method has been removed. You can use <code class="docutils literal notranslate"><span class="pre">np.save()</span></code> on
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a> instead.</p>
</div>
<p>Setting up Path Similarity Analysis.</p>
<p>The mutual similarity between all unique pairs of trajectories
are computed using a selected path metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>universes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – a list of universes (<code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object), each
containing a trajectory</p></li>
<li><p><strong>reference</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – reference coordinates; <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object; if
<code class="docutils literal notranslate"><span class="pre">None</span></code> the first time step of the first item in <cite>universes</cite> is used
[<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a>) – <p>The selection to operate on; can be one of:</p>
<ol class="arabic simple">
<li><p>any valid selection string for
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> that
produces identical selections in <em>mobile</em> and <em>reference</em>; or</p></li>
<li><p>a dictionary <code class="docutils literal notranslate"><span class="pre">{'mobile':sel1,</span> <span class="pre">'reference':sel2}</span></code> (the
<a class="reference internal" href="align.html#MDAnalysis.analysis.align.fasta2select" title="MDAnalysis.analysis.align.fasta2select"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.analysis.align.fasta2select()</span></code></a> function returns
such a dictionary based on a <a class="reference external" href="http://www.clustal.org/">ClustalW</a> or <a class="reference external" href="http://www.compbio.dundee.ac.uk/manuals/stamp.4.2/">STAMP</a> sequence
alignment); or</p></li>
<li><p>a tuple <code class="docutils literal notranslate"><span class="pre">(sel1,</span> <span class="pre">sel2)</span></code></p></li>
</ol>
<p>When using 2. or 3. with <em>sel1</em> and <em>sel2</em> then these selections
can also each be a list of selection strings (to generate an
AtomGroup with defined atom order as described under
<a class="reference internal" href="../selections.html#ordered-selections-label"><span class="std std-ref">Ordered selections</span></a>).</p>
</p></li>
<li><p><strong>tol_mass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Reject match if the atomic masses for matched atoms differ by more
than <em>tol_mass</em> [0.1]</p></li>
<li><p><strong>ref_frame</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – frame index to select frame from <em>reference</em> [0]</p></li>
<li><p><strong>path_select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – atom selection composing coordinates of (fitted) path; if <code class="docutils literal notranslate"><span class="pre">None</span></code>
then <em>path_select</em> is set to <em>select</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>targetdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – output files are saved there; if <code class="docutils literal notranslate"><span class="pre">None</span></code> then “./psadata” is
created and used [.]</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – list of strings, names of trajectories to be analyzed
(<code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code>); if <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to trajectory
names [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.universes">
<span class="sig-name descname"><span class="pre">universes</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.universes" title="Permalink to this definition"></a></dt>
<dd><p>list of <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> objects containing trajectories</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.u_reference">
<span class="sig-name descname"><span class="pre">u_reference</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.u_reference" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object containing a reference structure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.select">
<span class="sig-name descname"><span class="pre">select</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.select" title="Permalink to this definition"></a></dt>
<dd><p>string, selection for
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> to select frame
from <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.u_reference" title="MDAnalysis.analysis.psa.PSAnalysis.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.u_reference</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.path_select">
<span class="sig-name descname"><span class="pre">path_select</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.path_select" title="Permalink to this definition"></a></dt>
<dd><p>string, selection for
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.select_atoms" title="MDAnalysis.core.groups.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select_atoms()</span></code></a> to select atoms
to compose <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.ref_frame">
<span class="sig-name descname"><span class="pre">ref_frame</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.ref_frame" title="Permalink to this definition"></a></dt>
<dd><p>int, frame index to select frame from <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.u_reference" title="MDAnalysis.analysis.psa.Path.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.u_reference</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.paths">
<span class="sig-name descname"><span class="pre">paths</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.paths" title="Permalink to this definition"></a></dt>
<dd><p>list of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects representing the set/ensemble of
fitted trajectories</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.D">
<span class="sig-name descname"><span class="pre">D</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> which stores the calculated distance matrix</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.cluster">
<span class="sig-name descname"><span class="pre">cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.cluster" title="Permalink to this definition"></a></dt>
<dd><p>Cluster trajectories and optionally plot the dendrogram.</p>
<p>This method is used by <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.plot" title="MDAnalysis.analysis.psa.PSAnalysis.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.plot()</span></code></a> to generate a heatmap-
dendrogram combination plot. By default, the distance matrix,
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a>, is assumed to exist, converted to
distance-vector form, and inputted to <code class="xref py py-func docutils literal notranslate"><span class="pre">cluster.hierarchy.linkage()</span></code>
to generate a clustering. For convenience in plotting arbitrary
distance matrices, one can also be specify <cite>dist_mat</cite>, which will be
checked for proper distance matrix form by
<code class="xref py py-func docutils literal notranslate"><span class="pre">spatial.distance.squareform()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_mat</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><em>numpy.ndarray</em></a>) – user-specified distance matrix to be clustered [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of linkage criterion for clustering [<code class="docutils literal notranslate"><span class="pre">'ward'</span></code>]</p></li>
<li><p><strong>no_plot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not render the dendrogram [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>no_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then do not label dendrogram [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>color_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – For brevity, let t be the color_threshold. Colors all the
descendent links below a cluster node k the same color if k is
the first node below the cut threshold t. All links connecting
nodes with distances greater than or equal to the threshold are
colored blue. If t is less than or equal to zero, all nodes are
colored blue. If color_threshold is None or ‘default’,
corresponding with MATLAB(TM) behavior, the threshold is set to
0.7*max(Z[:,2]). [<code class="docutils literal notranslate"><span class="pre">4</span></code>]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Z</em> – output from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.linkage.html#scipy.cluster.hierarchy.linkage" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.linkage()</span></code></a>;
list of indices representing the row-wise order of the objects
after clustering</p></li>
<li><p><em>dgram</em> – output from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html#scipy.cluster.hierarchy.dendrogram" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.dendrogram()</span></code></a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.generate_paths">
<span class="sig-name descname"><span class="pre">generate_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.generate_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.generate_paths" title="Permalink to this definition"></a></dt>
<dd><p>Generate paths, aligning each to reference structure if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>align</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Align trajectories to atom selection <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.select" title="MDAnalysis.analysis.psa.PSAnalysis.select"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.select</span></code></a>
of <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.u_reference" title="MDAnalysis.analysis.psa.PSAnalysis.u_reference"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.u_reference</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – strings representing base filename for fitted trajectories and
paths [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>infix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – additional tag string that is inserted into the output filename of
the fitted trajectory files [‘’]</p></li>
<li><p><strong>weights</strong> ({“mass”, <code class="docutils literal notranslate"><span class="pre">None</span></code>} or array_like (optional)) – choose weights. With <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code> uses masses as weights; with
<code class="docutils literal notranslate"><span class="pre">None</span></code> weigh each atom equally. If a float array of the same
length as the selected AtomGroup is provided, use each element of
the <cite>array_like</cite> as a weight for the corresponding atom in the
AtomGroup [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>tol_mass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Reject match if the atomic masses for matched atoms differ by more
than <em>tol_mass</em> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>ref_frame</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – frame index to select frame from <em>reference</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – represent <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> as a 2D (<span class="math notranslate nohighlight">\(N_p\times 3N\)</span>) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>;
if <code class="docutils literal notranslate"><span class="pre">False</span></code> then <a class="reference internal" href="#MDAnalysis.analysis.psa.Path.path" title="MDAnalysis.analysis.psa.Path.path"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Path.path</span></code></a> is a 3D (<span class="math notranslate nohighlight">\(N_p\times N\times 3\)</span>)
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>save</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, pickle list of names for fitted trajectories
[<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then writes each path (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>)
in <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.paths" title="MDAnalysis.analysis.psa.PSAnalysis.paths"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.paths</span></code></a> to compressed npz (numpy) files
[<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
</ul>
</dd>
</dl>
<p>The fitted trajectories are written to new files in the
“/trj_fit” subdirectory in <code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.targetdir</span></code> named
“filename(<em>trajectory</em>)XXX*infix*_psa”, where “XXX” is a number between
000 and 999; the extension of each file is the same as its original.
Optionally, the trajectories can also be saved in numpy compressed npz
format in the “/paths” subdirectory in <code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.targetdir</span></code> for
persistence and can be accessed as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.paths" title="MDAnalysis.analysis.psa.PSAnalysis.paths"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.paths</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.16.1: </span>Instead of <code class="docutils literal notranslate"><span class="pre">mass_weighted=True</span></code> use new <code class="docutils literal notranslate"><span class="pre">weights='mass'</span></code>;
refactored to fit with AnalysisBase API</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.17.0: </span>Deprecated keyword <cite>mass_weighted</cite> was removed.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0.0: </span>Defaults for the <cite>store</cite> and <cite>filename</cite> keywords have been changed
from <cite>True</cite> and <cite>fitted</cite> to <cite>False</cite> and <cite>None</cite> respectively. These
now match the docstring documented defaults.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.get_num_atoms">
<span class="sig-name descname"><span class="pre">get_num_atoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.get_num_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.get_num_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of atoms used to construct the <a class="reference internal" href="#MDAnalysis.analysis.psa.Path" title="MDAnalysis.analysis.psa.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> instances in
<code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of atoms in any path</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.generate_paths" title="MDAnalysis.analysis.psa.PSAnalysis.generate_paths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.generate_paths()</span></code></a> prior to calling this
method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.get_num_paths">
<span class="sig-name descname"><span class="pre">get_num_paths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.get_num_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.get_num_paths" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of paths in <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.generate_paths" title="MDAnalysis.analysis.psa.PSAnalysis.generate_paths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.generate_paths()</span></code></a> prior to calling this method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of paths in <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.get_pairwise_distances">
<span class="sig-name descname"><span class="pre">get_pairwise_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vectorform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.get_pairwise_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.get_pairwise_distances" title="Permalink to this definition"></a></dt>
<dd><p>Return the distance matrix (or vector) of pairwise path distances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run" title="MDAnalysis.analysis.psa.PSAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run()</span></code></a> prior to calling this method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vectorform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, return the distance vector instead [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>checks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, check that <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a> is a proper distance
matrix [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>representation of the distance matrix (or vector)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.get_paths">
<span class="sig-name descname"><span class="pre">get_paths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.get_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.get_paths" title="Permalink to this definition"></a></dt>
<dd><p>Return the paths in <code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.generate_paths" title="MDAnalysis.analysis.psa.PSAnalysis.generate_paths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.generate_paths()</span></code></a> prior to calling this
method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> representations of paths in
<code class="xref py py-class docutils literal notranslate"><span class="pre">PSA</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.hausdorff_pairs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hausdorff_pairs</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.hausdorff_pairs" title="Permalink to this definition"></a></dt>
<dd><p>The Hausdorff pair for each (unique) pairs of paths.</p>
<p>This attribute contains a list of Hausdorff pair information (in
distance vector order), where each element is a dictionary containing
the pair of frames and the (Hausdorff) distance between a pair of
paths. See <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.psa_pairs" title="MDAnalysis.analysis.psa.PSAnalysis.psa_pairs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.psa_pairs()</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair.hausdorff_pair" title="MDAnalysis.analysis.psa.PSAPair.hausdorff_pair"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAPair.hausdorff_pair</span></code></a> for more information about accessing
Hausdorff pair data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis" title="MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run_pairs_analysis()</span></code></a> with
<code class="docutils literal notranslate"><span class="pre">hausdorff_pairs=True</span></code> prior to calling this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.load" title="Permalink to this definition"></a></dt>
<dd><p>Load fitted paths specified by ‘psa_path-names.pkl’ in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.targetdir</span></code>.</p>
<p>All filenames are determined by <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis" title="MDAnalysis.analysis.psa.PSAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAnalysis</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.save_paths" title="MDAnalysis.analysis.psa.PSAnalysis.save_paths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_paths</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.nearest_neighbors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nearest_neighbors</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.nearest_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>The nearest neighbors for each (unique) pair of paths.</p>
<p>This attribute contains a list of nearest neighbor information (in
distance vector order), where each element is a dictionary containing
the nearest neighbor frames and distances between a pair of paths. See
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.psa_pairs" title="MDAnalysis.analysis.psa.PSAnalysis.psa_pairs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.psa_pairs()</span></code></a> and <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair.nearest_neighbors" title="MDAnalysis.analysis.psa.PSAPair.nearest_neighbors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAPair.nearest_neighbors</span></code></a> for
more information about accessing nearest neighbor data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis" title="MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run_pairs_analysis()</span></code></a> with
<code class="docutils literal notranslate"><span class="pre">neighbors=True</span></code> prior to calling this method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linkage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot a clustered distance matrix.</p>
<p>Usese method <em>linkage</em> and plots the corresponding dendrogram. Rows
(and columns) are identified using the list of strings specified by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.labels</span></code>.</p>
<p>If <cite>filename</cite> is supplied then the figure is also written to file (the
suffix determines the file type, e.g. pdf, png, eps, …). All other
keyword arguments are passed on to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.matshow.html#matplotlib.pyplot.matshow" title="(in Matplotlib v3.7.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.matshow()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – save figure to <em>filename</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>linkage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of linkage criterion for clustering [<code class="docutils literal notranslate"><span class="pre">'ward'</span></code>]</p></li>
<li><p><strong>count_sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html#scipy.cluster.hierarchy.dendrogram" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.dendrogram()</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>distance_sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html#scipy.cluster.hierarchy.dendrogram" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.dendrogram()</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – set the vertical size of plot in inches [<code class="docutils literal notranslate"><span class="pre">4.5</span></code>]</p></li>
<li><p><strong>labelsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – set the font size for colorbar labels; font size for path labels on
dendrogram default to 3 points smaller [<code class="docutils literal notranslate"><span class="pre">12</span></code>]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Z</em> – <cite>Z</cite> from <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.cluster" title="MDAnalysis.analysis.psa.PSAnalysis.cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cluster()</span></code></a></p></li>
<li><p><em>dgram</em> – <cite>dgram</cite> from <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.cluster" title="MDAnalysis.analysis.psa.PSAnalysis.cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cluster()</span></code></a></p></li>
<li><p><em>dist_matrix_clus</em> – clustered distance matrix (reordered)</p></li>
<li><p><em>.. versionchanged:: 1.0.0</em> – <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick1On</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick2On</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">label1On</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">label2On</span></code>
changed to <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick1line</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick2line</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">label1</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">label2</span></code> due to upstream deprecation (see #2493)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.plot_annotated_heatmap">
<span class="sig-name descname"><span class="pre">plot_annotated_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linkage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annot_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.plot_annotated_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.plot_annotated_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>Plot a clustered distance matrix.</p>
<p>Uses method <cite>linkage</cite> and plots annotated distances in the matrix. Rows
(and columns) are identified using the list of strings specified by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.labels</span></code>.</p>
<p>If <cite>filename</cite> is supplied then the figure is also written to file (the
suffix determines the file type, e.g. pdf, png, eps, …). All other
keyword arguments are passed on to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="(in Matplotlib v3.7.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – save figure to <em>filename</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>linkage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of linkage criterion for clustering [<code class="docutils literal notranslate"><span class="pre">'ward'</span></code>]</p></li>
<li><p><strong>count_sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html#scipy.cluster.hierarchy.dendrogram" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.dendrogram()</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>distance_sort</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html#scipy.cluster.hierarchy.dendrogram" title="(in SciPy v1.11.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.cluster.hierarchy.dendrogram()</span></code></a> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – set the vertical size of plot in inches [<code class="docutils literal notranslate"><span class="pre">4.5</span></code>]</p></li>
<li><p><strong>annot_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – font size of annotation labels on heat map [<code class="docutils literal notranslate"><span class="pre">6.5</span></code>]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Z</em> – <cite>Z</cite> from <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.cluster" title="MDAnalysis.analysis.psa.PSAnalysis.cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cluster()</span></code></a></p></li>
<li><p><em>dgram</em> – <cite>dgram</cite> from <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.cluster" title="MDAnalysis.analysis.psa.PSAnalysis.cluster"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cluster()</span></code></a></p></li>
<li><p><em>dist_matrix_clus</em> – clustered distance matrix (reordered)</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function requires the <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> package, which can be installed
with <cite>pip install seaborn</cite> or <cite>conda install seaborn</cite>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0.0: </span><code class="xref py py-attr docutils literal notranslate"><span class="pre">tick1On</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick2On</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">label1On</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">label2On</span></code>
changed to <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick1line</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">tick2line</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">label1</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">label2</span></code> due to upstream deprecation (see #2493)</p>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.plot_nearest_neighbors">
<span class="sig-name descname"><span class="pre">plot_nearest_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('Path</span> <span class="pre">1',</span> <span class="pre">'Path</span> <span class="pre">2')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aspect_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.plot_nearest_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.plot_nearest_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Plot nearest neighbor distances as a function of normalized frame
number.</p>
<p>The frame number is mapped to the interval <em>[0, 1]</em>.</p>
<p>If <cite>filename</cite> is supplied then the figure is also written to file (the
suffix determines the file type, e.g. pdf, png, eps, …). All other
keyword arguments are passed on to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html#matplotlib.pyplot.imshow" title="(in Matplotlib v3.7.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.imshow()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – save figure to <em>filename</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – index of path (pair) comparison to plot [<code class="docutils literal notranslate"><span class="pre">0</span></code>]</p></li>
<li><p><strong>labels</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>)</em>) – pair of names to label nearest neighbor distance
curves [<code class="docutils literal notranslate"><span class="pre">('Path</span> <span class="pre">1',</span> <span class="pre">'Path</span> <span class="pre">2')</span></code>]</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – set the vertical size of plot in inches [<code class="docutils literal notranslate"><span class="pre">4.5</span></code>]</p></li>
<li><p><strong>multiplot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to enable plotting multiple nearest
neighbor distances on the same figure [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>aspect_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – set the ratio of width to height of the plot [<code class="docutils literal notranslate"><span class="pre">1.75</span></code>]</p></li>
<li><p><strong>labelsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – set the font size for colorbar labels; font size for path labels on
dendrogram default to 3 points smaller [<code class="docutils literal notranslate"><span class="pre">12</span></code>]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>axes</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function requires the <a class="reference external" href="https://seaborn.pydata.org/">seaborn</a> package, which can be installed
with <cite>pip install seaborn</cite> or <cite>conda install seaborn</cite>.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.psa_pairs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psa_pairs</span></span><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.psa_pairs" title="Permalink to this definition"></a></dt>
<dd><p>The list of <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> instances for each pair of paths.</p>
<p><a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.psa_pairs" title="MDAnalysis.analysis.psa.PSAnalysis.psa_pairs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psa_pairs</span></code></a> is a list of all <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> objects (in
distance vector order). The elements of a <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> are pairs of
paths that have been compared using
<a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis" title="MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run_pairs_analysis()</span></code></a>. Each <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a> contains
nearest neighbor and Hausdorff pair information specific to a pair of
paths. The nearest neighbor frames and distances for a <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair" title="MDAnalysis.analysis.psa.PSAPair"><code class="xref py py-class docutils literal notranslate"><span class="pre">PSAPair</span></code></a>
can be accessed in the nearest neighbor dictionary using the keys
‘frames’ and ‘distances’, respectively. E.g.,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAPair.nearest_neighbors['distances']</span></code> returns a <em>pair</em> of
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.25)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> corresponding to the nearest neighbor distances
for each path. Similarly, Hausdorff pair information can be accessed
using <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAPair.hausdorff_pair" title="MDAnalysis.analysis.psa.PSAPair.hausdorff_pair"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAPair.hausdorff_pair</span></code></a> with the keys ‘frames’ and
‘distance’.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must run <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis" title="MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PSAnalysis.run_pairs_analysis()</span></code></a> prior to calling this
method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.run" title="Permalink to this definition"></a></dt>
<dd><p>Perform path similarity analysis on the trajectories to compute
the distance matrix.</p>
<p>A number of parameters can be changed from the defaults. The
result is stored as the array <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> or </em><em>callable</em>) – selection string specifying the path metric to measure pairwise
distances among <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.paths" title="MDAnalysis.analysis.psa.PSAnalysis.paths"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.paths</span></code></a> or a callable with the
same call signature as <a class="reference internal" href="#MDAnalysis.analysis.psa.hausdorff" title="MDAnalysis.analysis.psa.hausdorff"><code class="xref py py-func docutils literal notranslate"><span class="pre">hausdorff()</span></code></a>
[<code class="docutils literal notranslate"><span class="pre">'hausdorff'</span></code>]</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – <cite>start</cite> and <cite>stop</cite> frame index with <cite>step</cite> size: analyze
<code class="docutils literal notranslate"><span class="pre">trajectory[start:stop:step]</span></code> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>versionchanged:</strong> (<em>..</em>) – 1.0.0: <cite>store</cite> and <cite>filename</cite> have been removed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis">
<span class="sig-name descname"><span class="pre">run_pairs_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.run_pairs_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.run_pairs_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Perform PSA Hausdorff (nearest neighbor) pairs analysis on all unique
pairs of paths in <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.paths" title="MDAnalysis.analysis.psa.PSAnalysis.paths"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.paths</span></code></a>.</p>
<p>Partial results can be stored in separate lists, where each list is
indexed according to distance vector convention (i.e., element <em>(i,j)</em>
in distance matrix representation corresponds to element
<span class="math notranslate nohighlight">\(s=N*i+j-(i+1)*(i+2)\)</span> in distance vector representation, which is
the <span class="math notranslate nohighlight">\(s^   ext{th}\)</span> comparison). For each unique pair of paths, the
nearest neighbors for that pair can be stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">NN</span></code> and the
Hausdorff pair in <code class="xref py py-attr docutils literal notranslate"><span class="pre">HP</span></code>. <code class="xref py py-attr docutils literal notranslate"><span class="pre">PP</span></code> stores the full information
of Hausdorff pairs analysis that is available for each pair of path,
including nearest neighbors lists and the Hausdorff pairs.</p>
<p>The pairwise distances are stored as the array <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.D" title="MDAnalysis.analysis.psa.PSAnalysis.D"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.D</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – <cite>start</cite> and <cite>stop</cite> frame index with <cite>step</cite> size: analyze
<code class="docutils literal notranslate"><span class="pre">trajectory[start:stop:step]</span></code> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p></li>
<li><p><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – </p></li>
<li><p><strong>neighbors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then stores dictionary of nearest neighbor
frames/distances in <code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.NN</span></code> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>hausdorff_pairs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then stores dictionary of Hausdorff pair
frames/distances in <code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.HP</span></code> [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.psa.PSAnalysis.save_paths">
<span class="sig-name descname"><span class="pre">save_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/psa.html#PSAnalysis.save_paths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.psa.PSAnalysis.save_paths" title="Permalink to this definition"></a></dt>
<dd><p>Save fitted <a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.paths" title="MDAnalysis.analysis.psa.PSAnalysis.paths"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.paths</span></code></a> to numpy compressed npz files.</p>
<p>The data are saved with <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.savez_compressed.html#numpy.savez_compressed" title="(in NumPy v1.25)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.savez_compressed()</span></code></a> in the directory
specified by <code class="xref py py-attr docutils literal notranslate"><span class="pre">PSAnalysis.targetdir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – specifies filename [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filename</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#MDAnalysis.analysis.psa.PSAnalysis.load" title="MDAnalysis.analysis.psa.PSAnalysis.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rms.html" class="btn btn-neutral float-left" title="4.2.5. Calculating root mean square quantities — MDAnalysis.analysis.rms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="encore.html" class="btn btn-neutral float-right" title="4.2.7. ENCORE Ensemble Similarity Calculations — MDAnalysis.analysis.encore" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2005-2023, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Henok Ademtew, Shobhit Agarwal, Aya M. Alaa, Irfan Alibay, Kazi Shudipto Amin, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Patricio Barletta, Leonardo Barneschi, Jonathan Barnoud, Estefania Barreto-Ojeda, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Kavya Bisht, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Kevin Boyd, Meet Brijwani, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, Yantong Cai, David Caplan, Yuanyu Chang, Pratham Chauhan, Matthieu Chavent, Haochuan Chen, Xu Hong Chen, Kathleen Clark, Jennifer A Clark, Orion Cohen, Charlie Cook, Ruggero Cortini, Nicholas Craven, Ramon Crehuet, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Mark D. Driver, Ali Ehlen, Daniel J. Evans, Shujie Fan, Bjarne Feddersen, Lennard van der Feltz, Jake Fennick, Philip Fowler, Guillaume Fraux, Anirvinya G, Ahmed Salah Ghoneim, Mikhail Glagolev, William Glass, Joseph Goose, Alexander Gorfer, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Pratik Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Edis Jakupovic, Joe Jordan, Henrik Jäger, Uma D Kadam, Aditya Kamath, Jon Kapla, Haleema Khan, Navya Khare, Utsav Khatu, Andrew William King, Henry Kobin, Abhishek A. Kognole, Kosuke Kudo, Atharva Kulkarni, Manish Kumar, Mohit Kumar, Shubham Kumar, Alia Lescoulie, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Shaivi Malik, Egor Marin, Domenico Marson, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Marcelo C. R. Melo, Dominik &#39;Rathann&#39; Mierzejewski, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Meghan Osato, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Dimitrios Papageorgiou, Rafael R. Pappalardo, Vishal Parmar, Danny Parton, Shakul Pathak, Christian Pfaendner, Joshua L. Phillips, Marcelo D. Poleto, Hannah Pollak, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Andrea Rizzi, Xiaoxu Ruan, Carlos Yanez S., Utkarsh Saxena, Moritz Schaeffler, Alexander Schlaich, Marcello Sega, Ricky Sexton, Sean L. Seyler, Faraaz Shah, Sulay Shah, Abhishek Shandilya, Shubham Sharma, Rishabh Shukla, Karthikeyan Singaravelan, Tamandeep Singh, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Jan Stevens, Gorman Stock, Fenil Suchak, Ayush Suhane, Filip T. Szczypiński, Sukeerti T, Matthijs Tadema, Joao Miguel Correia Teixeira, Paarth Thadani, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Zaheer Timol, Wiep van der Toorn, Mieczyslaw Torchala, Aditi Tripathi, Mark Verma, Josh Vermaas, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Tengyu Xie, Zhuyi Xue, Mingyi Xue, Alexander Yang, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Raymond Zhao, Yuxuan Zhuang, and Oliver Beckstein.</p>
  </div>

  
 
<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        2.6.0-dev0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>