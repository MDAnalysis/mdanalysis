

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NCDF, NC (AMBER NetCDF trajectory) &mdash; MDAnalysis User Guide  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script src="../../_static/js/versions.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PDB, ENT (Standard PDB file)" href="pdb.html" />
    <link rel="prev" title="MOL2 (Tripos structure)" href="mol2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/user_guide.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/README.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../topology_system.html">The topology system</a></li>
</ul>
<p class="caption"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../units.html">Units and constants</a></li>
</ul>
<p class="caption"><span class="caption-text">Input/output</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../format_reference.html">Format reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config.html">CONFIG (DL_Poly Config)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#history-dl-poly-config">HISTORY (DL_Poly Config)</a></li>
<li class="toctree-l2"><a class="reference internal" href="crd.html">CRD (CHARMM CARD files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">DATA (LAMMPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcd.html">DCD (CHARMM, NAMD, or LAMMPS trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcd_lammps.html">DCD (Flexible LAMMPS trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dms.html">DMS (Desmond Molecular Structure files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gms.html">GMS (Gamess trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gro.html">GRO (GROMACS structure file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="gsd.html">GSD (HOOMD GSD file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="inpcrd.html">INPCRD, RESTRT (AMBER restart files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="itp.html">ITP (GROMACS portable topology files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="lammpsdump.html">LAMMPSDUMP (LAMMPS ascii dump file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtf.html">MMTF (Macromolecular Transmission Format)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mol2.html">MOL2 (Tripos structure)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NCDF, NC (AMBER NetCDF trajectory)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reading-in">Reading in</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-out">Writing out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pdb.html">PDB, ENT (Standard PDB file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdbqt.html">PDBQT (Autodock structure)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pqr.html">PQR file (PDB2PQR / APBS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="psf.html">PSF (CHARMM, NAMD, or XPLOR protein structure file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="top.html">TOP, PRMTOP, PARM7 (AMBER topology)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tpr.html">TPR (GROMACS run topology files)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trj.html">TRJ, MDCRD, CRDBOX (AMBER ASCII trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trr.html">TRR (GROMACS lossless trajectory file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="trz.html">TRZ (IBIsCO and YASP trajectory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="txyz.html">TXYZ, ARC (Tinker)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml.html">XML (HOOMD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xpdb.html">XPDB (Extended PDB file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xtc.html">XTC (GROMACS compressed trajectory file)</a></li>
<li class="toctree-l2"><a class="reference internal" href="xyz.html">XYZ trajectory</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/analysis/custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Example data</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis User Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../format_reference.html">Format reference</a> &raquo;</li>
        
      <li>NCDF, NC (AMBER NetCDF trajectory)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/formats/reference/ncdf.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ncdf-nc-amber-netcdf-trajectory">
<span id="ncdf-format"></span><h1>NCDF, NC (AMBER NetCDF trajectory)<a class="headerlink" href="#ncdf-nc-amber-netcdf-trajectory" title="Permalink to this headline">¶</a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Coordinate reader</strong></p></td>
<td><p><a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/coordinates/TRJ.html#MDAnalysis.coordinates.TRJ.NCDFReader" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ.NCDFReader</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><strong>Coordinate writer</strong></p></td>
<td><p><a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/coordinates/TRJ.html#MDAnalysis.coordinates.TRJ.NCDFWriter" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ.NCDFWriter</span></code></a></p></td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="https://ambermd.org/FileFormats.php#netcdf">AMBER binary trajectories</a> are automatically recognised by the file extension “.ncdf”. The NCDF module uses <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io.netcdf</span></code> and therefore <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy</span></code> must be installed.</p>
<div class="section" id="reading-in">
<h2>Reading in<a class="headerlink" href="#reading-in" title="Permalink to this headline">¶</a></h2>
<p>Units are assumed to be the following default AMBER units:</p>
<blockquote>
<div><ul class="simple">
<li><p>length: Angstrom</p></li>
<li><p>time: ps</p></li>
</ul>
</div></blockquote>
<p>Currently, if other units are detected, MDAnalysis will raise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.8)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a>.</p>
</div>
<div class="section" id="writing-out">
<h2>Writing out<a class="headerlink" href="#writing-out" title="Permalink to this headline">¶</a></h2>
<p>NCDF files are always written out in ångström and picoseconds.</p>
<p>Although scale_factors can be read from NCDF files, they are not kept or used when writing NCDF files out.</p>
<p><strong>Writing with the netCDF4 module and potential issues</strong></p>
<blockquote>
<div><p>Although <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io.netcdf</span></code> is very fast at reading NetCDF files, it is slow at writing them out. The <a class="reference external" href="https://unidata.github.io/netcdf4-python/">netCDF4</a> package is fast at writing (but slow at reading). This requires the compiled netcdf library to be installed. MDAnalysis tries to use <code class="xref py py-mod docutils literal notranslate"><span class="pre">netCDF4</span></code> for writing if it is available, but will fall back to <code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.io.netcdf</span></code> if it is not.</p>
<p><strong>AMBER users</strong> might have a hard time getting netCDF4 to work with a
conda-based installation (as discussed in <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/506#issuecomment-225081416">Issue #506</a>) because of the way
that AMBER itself handles netcdf. In this scenario, MDAnalysis will simply switch to the scipy package. If you encounter this error and wish to use the the faster <code class="xref py py-mod docutils literal notranslate"><span class="pre">netCDF4</span></code> writer, the only solution is to unload the AMBER environment.</p>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pdb.html" class="btn btn-neutral float-right" title="PDB, ENT (Standard PDB file)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mol2.html" class="btn btn-neutral float-left" title="MOL2 (Tripos structure)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, Lily Wang, Rocco Meli, Richard J. Gowers, and Oliver Beckstein.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>