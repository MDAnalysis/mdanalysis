

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Universe &mdash; MDAnalysis User Guide  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/mdanalysis-logo.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script src="_static/js/versions.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis User Guide  documentation"
          href="_static/opensearch.xml"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="AtomGroup" href="atomgroup.html" />
    <link rel="prev" title="Computing mass and charge density on each axis" href="examples/analysis/volumetric/linear_density.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/user_guide.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/README.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Data structures</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Universe</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-universe">Creating a Universe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-from-files">Loading from files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-from-atomgroups">Constructing from AtomGroups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-from-scratch">Constructing from scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#guessing-topology-attributes">Guessing topology attributes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#universe-properties-and-methods">Universe properties and methods</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="topology_system.html">The topology system</a></li>
</ul>
<p class="caption"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="trajectories/transformations.html">On-the-fly transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units and constants</a></li>
</ul>
<p class="caption"><span class="caption-text">Input/output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats/format_reference.html">Format reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/analysis/custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Example data</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MDAnalysis User Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Universe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/universe.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="universe">
<span id="id1"></span><h1>Universe<a class="headerlink" href="#universe" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p><em>If you wish to make an apple pie from scratch, you must first invent the universe.</em></p>
<p class="attribution">—Carl Sagan, Cosmos</p>
</div></blockquote>
<p>MDAnalysis is structured around two fundamental classes: the <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> and the <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>. Almost all code in MDAnalysis begins with <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>, which contains all the information describing a molecular dynamics system.</p>
<p>It has two key properties:</p>
<ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">atoms</span></code>: an <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> of the system’s atoms, providing access to important analysis methods (described below)</p></li>
<li><p><a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe.trajectory" title="(in MDAnalysis v1.0)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trajectory</span></code></a>: the currently loaded trajectory reader</p></li>
</ul>
<p>A <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> ties the static information from the “topology” (e.g. atom identities) to dynamically updating information from the “trajectory” (e.g. coordinates). A key feature of MDAnalysis is that an entire trajectory is not loaded into memory (unless the user explicitly does so with <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/coordinates/memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MemoryReader</span></code></a>). Instead, the <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe.trajectory" title="(in MDAnalysis v1.0)"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trajectory</span></code></a> attribute provides a view on a specific frame of the trajectory. This allows the analysis of arbitrarily long trajectories without a significant impact on memory.</p>
<div class="section" id="creating-a-universe">
<h2>Creating a Universe<a class="headerlink" href="#creating-a-universe" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading-from-files">
<span id="universe-loading"></span><h3>Loading from files<a class="headerlink" href="#loading-from-files" title="Permalink to this headline">¶</a></h3>
<p>A Universe is typically created from a “topology” file, with optional “trajectory” file/s. Trajectory files must have the coordinates in the same order as atoms in the topology. See <a class="reference internal" href="formats/index.html#formats"><span class="std std-ref">Formats</span></a> for the topology and trajectory formats supported by MDAnalysis, and how to load each specific format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">pdbfile</span><span class="p">)</span>                       <span class="c1"># read atoms and coordinates from PDB or GRO</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="p">[</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="c1"># read from a list of trajectories</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>   <span class="c1"># read from multiple trajectories</span>
</pre></div>
</div>
<p>The line between topology and trajectory files is quite blurry. For example, a PDB or GRO file is considered both a topology and a trajectory file. The difference is that a <strong>topology file</strong> provides static information, such as atom identities (name, mass, etc.), charges, and bond connectivity. A <strong>trajectory file</strong> provides dynamic information, such as coordinates, velocities, forces, and box dimensions.</p>
<p>If only a single file is provided, MDAnalysis tries to read both topology and trajectory information from it. When multiple trajectory files are provided, coordinates are loaded in the order given.</p>
<p>The default arguments should create a Universe suited for most analysis applications. However, the <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> constructor also takes optional arguments.</p>
<p><strong>The following options specify how to treat the input:</strong></p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">format</span></code>: the file format of the trajectory file/s. (default: None, formats are guessed)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">topology_format</span></code>: the file format of the topology file. (default: None, formats are guessed)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">all_coordinates</span></code>: whether to read coordinate information from the first file (default: False. Ignored when only one file is provided)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">continuous</span></code>: whether to give multiple trajectory files continuous time steps. This is currently only supported for XTC/TRR trajectories with a GRO/TPR topology, following the behaviour of <a class="reference external" href="http://manual.gromacs.org/documentation/2018/onlinehelp/gmx-trjcat.html">gmx trjcat</a> (default: False.)</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PDB</span><span class="p">,</span> <span class="n">GRO</span><span class="p">,</span> <span class="n">XTC</span>

<span class="gp">In [3]: </span><span class="n">u1</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">GRO</span><span class="p">,</span> <span class="n">XTC</span><span class="p">,</span> <span class="n">XTC</span><span class="p">,</span> <span class="n">all_coordinates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">u1</span><span class="o">.</span><span class="n">trajectory</span>
<span class="gh">Out[4]: </span><span class="go">&lt;ChainReader containing adk_oplsaa.gro, adk_oplsaa.xtc, adk_oplsaa.xtc with 21 frames of 47681 atoms&gt;</span>

<span class="gp">In [5]: </span><span class="n">u2</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">GRO</span><span class="p">,</span> <span class="n">XTC</span><span class="p">,</span> <span class="n">XTC</span><span class="p">,</span> <span class="n">all_coordinates</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="nb">print</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u2</span><span class="o">.</span><span class="n">trajectory</span><span class="p">])</span>
<span class="go">[0, 100, 200, 300, 400, 500, 600, 700, 800, 900, 0, 100, 200, 300, 400, 500, 600, 700, 800, 900]</span>
</pre></div>
</div>
<p><strong>The following options modify the created Universe:</strong></p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">guess_bonds</span></code>: whether to guess connectivity between atoms. (default: False)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">vdwradii</span></code>: a dictionary of <code class="code docutils literal notranslate"><span class="pre">{element:</span> <span class="pre">radius}</span></code> of van der Waals’ radii for use in guessing bonds.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">transformations</span></code>: a function or list of functions for on-the-fly trajectory transformation.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">in_memory</span></code>: whether to load coordinates into memory (default: False)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">in_memory_step</span></code>: only read every nth frame into an in-memory representation. (default: 1)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">is_anchor</span></code>: whether to consider this Universe when unpickling <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>s (default: True)</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">anchor_name</span></code>: the name of this Universe when unpickling <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>s (default: None, automatically generated)</p></li>
</ul>
<p id="universe-kwargs">You can also pass in keywords for parsing the topology or coordinates. For example, many file formats do not specify the timestep for their trajectory. In these cases, MDAnalysis assumes that the default timestep is 1 ps. If this is incorrect, you can pass in a <code class="docutils literal notranslate"><span class="pre">dt</span></code> argument to modify the timestep. <strong>This does not modify timesteps for formats that include time information.</strong></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PRM</span><span class="p">,</span> <span class="n">TRJ</span>

<span class="gp">In [8]: </span><span class="n">default_timestep</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PRM</span><span class="p">,</span> <span class="n">TRJ</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">default_timestep</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">dt</span>
<span class="gh">Out[9]: </span><span class="go">1.0</span>

<span class="gp">In [10]: </span><span class="n">user_timestep</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PRM</span><span class="p">,</span> <span class="n">TRJ</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># ps</span>

<span class="gp">In [11]: </span><span class="n">user_timestep</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">dt</span>
<span class="gh">Out[11]: </span><span class="go">5</span>
</pre></div>
</div>
</div>
<div class="section" id="constructing-from-atomgroups">
<h3>Constructing from AtomGroups<a class="headerlink" href="#constructing-from-atomgroups" title="Permalink to this headline">¶</a></h3>
<p>A new Universe can be created from one or more <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances with <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Merge" title="(in MDAnalysis v1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">Merge()</span></code></a>. The <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/groups.html#MDAnalysis.core.groups.AtomGroup" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> instances can come from different Universes, meaning that this is one way to concatenate selections from different datasets.</p>
<p>For example, to combine a protein, ligand, and solvent from separate PDB files:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u1</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;protein.pdb&quot;</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;ligand.pdb&quot;</span><span class="p">)</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;solvent.pdb&quot;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">u1</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">),</span> <span class="n">u2</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">u3</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
<span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;system.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="constructing-from-scratch">
<h3>Constructing from scratch<a class="headerlink" href="#constructing-from-scratch" title="Permalink to this headline">¶</a></h3>
<p>A Universe can be constructed from scratch with <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe.empty" title="(in MDAnalysis v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Universe.empty</span></code></a>. There are three stages to this process:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Create the blank Universe with specified number of atoms. If coordinates, set <code class="code docutils literal notranslate"><span class="pre">trajectory=True</span></code>.</p></li>
<li><p>Add topology attributes such as atom names.</p></li>
<li><p>(Optional) Load coordinates.</p></li>
</ol>
</div></blockquote>
<p>For example, to construct a universe with 6 atoms in 2 residues:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">atom_resindex</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">trajectory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">u</span><span class="o">.</span><span class="n">add_TopologyAttr</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span>  <span class="c1"># number of frames</span>
<span class="gp">   ....: </span>                        <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">,</span>
<span class="gp">   ....: </span>                        <span class="mi">3</span><span class="p">))</span>
<span class="gp">   ....: </span>

<span class="gp">In [15]: </span><span class="n">u</span><span class="o">.</span><span class="n">load_new</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;fac&#39;</span><span class="p">)</span>
<span class="gh">Out[15]: </span><span class="go">&lt;Universe with 6 atoms&gt;</span>
</pre></div>
</div>
<p><a class="reference internal" href="examples/constructing_universe.html"><span class="doc">See this notebook tutorial for more information.</span></a></p>
</div>
<div class="section" id="guessing-topology-attributes">
<h3>Guessing topology attributes<a class="headerlink" href="#guessing-topology-attributes" title="Permalink to this headline">¶</a></h3>
<p>MDAnalysis can guess two kinds of information. Sometimes MDAnalysis guesses information instead of reading it from certain file formats, which can lead to mistakes such as assigning atoms the wrong element or charge. See <a class="reference internal" href="formats/index.html#topology-parsers"><span class="std std-ref">the available topology parsers</span></a> for a case-by-case breakdown of which atom properties MDAnalysis guesses for each format. See <a class="reference internal" href="formats/guessing.html#guessing"><span class="std std-ref">Guessing</span></a> for how attributes are guessed, and <a class="reference internal" href="topology_system.html#topologyattr-defaults"><span class="std std-ref">Default values and attribute levels</span></a> for which attributes have default values.</p>
</div>
</div>
<div class="section" id="universe-properties-and-methods">
<span id="universe-properties"></span><h2>Universe properties and methods<a class="headerlink" href="#universe-properties-and-methods" title="Permalink to this headline">¶</a></h2>
<p>A Universe holds master groups of atoms and topology objects:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">atoms</span></code>: all Atoms in the system, in an <a class="reference internal" href="atomgroup.html#atomgroup"><span class="std std-ref">AtomGroup</span></a>.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">residues</span></code>: all Residues in the system</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">segments</span></code>: all Segments in the system</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">bonds</span></code>: all bond TopologyObjects in the system</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">angles</span></code>: all angle TopologyObjects in the system</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">dihedrals</span></code>: all dihedral TopologyObjects in the system</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">impropers</span></code>: all improper TopologyObjects in the system</p></li>
</ul>
</div></blockquote>
<p><a class="reference internal" href="groups_of_atoms.html#residues-and-segments"><span class="std std-ref">Residues and Segments</span></a> are chemically meaningful groups of Atoms.</p>
<p>Modifying a topology is typically done through the <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe" title="(in MDAnalysis v1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>, which contains several methods for adding properties:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe.add_TopologyAttr" title="(in MDAnalysis v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_TopologyAttr()</span></code></a></p></li>
<li><p><a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe.add_Residue" title="(in MDAnalysis v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_Residue()</span></code></a></p></li>
<li><p><a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/core/universe.html#MDAnalysis.core.universe.Universe.add_Segment" title="(in MDAnalysis v1.0)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_Segment()</span></code></a></p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="topology_system.html#topology-attributes"><span class="std std-ref">Topology attributes</span></a> for more information on which topology attributes can be added, and <a class="reference internal" href="examples/constructing_universe.html"><span class="doc">examples/constructing_universe.ipynb</span></a> for examples on adding attributes and Segments.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="atomgroup.html" class="btn btn-neutral float-right" title="AtomGroup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples/analysis/volumetric/linear_density.html" class="btn btn-neutral float-left" title="Computing mass and charge density on each axis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, Lily Wang, Rocco Meli, Richard J. Gowers, and Oliver Beckstein.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>