


  
    
  




<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="../../_static/logo/mda_favicon.ico">
</head>

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.3.3. Water Bridge analysis — MDAnalysis.analysis.hydrogenbonds.WaterBridgeAnalysis &mdash; MDAnalysis 2.8.0-dev0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/site.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=a9b57af3"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/js/versions.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 2.8.0-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.3.4. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel (deprecated)" href="hbond_autocorrel_deprecated.html" />
    <link rel="prev" title="4.3.2. Hydrogen bond autocorrelation — MDAnalysis.analysis.hydrogenbonds.hbond_autocorrel" href="hbond_autocorrel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >




  




<a href="../../index.html">
  
    <img src="../../_static/logo/mda_logo.png" class="logo" alt="Logo"/>
</a>


  
  
  
    <div class="version">
      2.8.0-dev0
    </div>
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
    <!-- <p class="caption" role="heading"></p> -->
    <ul>
        
        <li class="toctree-l1"><a class="reference internal" href="http://mdanalysis.org">MDAnalysis</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="http://userguide.mdanalysis.org">User guide</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdakits.mdanalysis.org/">MDAKits</a></li>
        
    </ul>
    
        <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hydrogenbonds.html">4.3.1. Hydrogen Bond Analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.hbond_analysis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hbond_autocorrel.html">4.3.2. Hydrogen bond autocorrelation — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.hbond_autocorrel</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.3.3. Water Bridge analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.WaterBridgeAnalysis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#theory">4.3.3.1. Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-as-network">4.3.3.2. Output as Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-as-timeseries">4.3.3.3. Output as Timeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detection-of-water-bridges">4.3.3.4. Detection of water bridges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-perform-waterbridgeanalysis">4.3.3.5. How to perform <code class="docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-count-by-type">4.3.3.6. Use <code class="docutils literal notranslate"><span class="pre">count_by_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-count-by-time">4.3.3.7. Use <code class="docutils literal notranslate"><span class="pre">count_by_time</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">4.3.3.8. Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hbond_autocorrel_deprecated.html">4.3.4. Hydrogen bond autocorrelation — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_autocorrel</span></code> (deprecated)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#data">4.11. Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">13. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">14. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">15. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">16. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">17. References</a></li>
</ul>

</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../analysis_modules.html"><span class="section-number">4. </span>Analysis modules</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4.3.3. </span>Water Bridge analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.WaterBridgeAnalysis</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/documentation_pages/analysis/wbridge_analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="water-bridge-analysis-mdanalysis-analysis-hydrogenbonds-waterbridgeanalysis">
<span id="module-MDAnalysis.analysis.hydrogenbonds.wbridge_analysis"></span><h1><span class="section-number">4.3.3. </span>Water Bridge analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.WaterBridgeAnalysis</span></code><a class="headerlink" href="#water-bridge-analysis-mdanalysis-analysis-hydrogenbonds-waterbridgeanalysis" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Zhiyi Wu</p>
</dd>
<dt class="field-even">Year<span class="colon">:</span></dt>
<dd class="field-even"><p>2017-2018</p>
</dd>
<dt class="field-odd">Copyright<span class="colon">:</span></dt>
<dd class="field-odd"><p>GNU Public License v3</p>
</dd>
<dt class="field-even">Maintainer<span class="colon">:</span></dt>
<dd class="field-even"><p>Zhiyi Wu &lt;<a class="reference external" href="mailto:zhiyi&#46;wu&#37;&#52;&#48;gtc&#46;ox&#46;ac&#46;uk">zhiyi<span>&#46;</span>wu<span>&#64;</span>gtc<span>&#46;</span>ox<span>&#46;</span>ac<span>&#46;</span>uk</a>&gt;,  <a class="reference external" href="https://github.com/xiki-tempula">&#64;xiki-tempula</a> on GitHub</p>
</dd>
</dl>
<p>Given a <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> (simulation
trajectory with 1 or more frames) measure all water bridges for each
frame between selections 1 and 2.
Water bridge is defined as a bridging water which simultaneously forms
two hydrogen bonds with atoms from both selection 1 and selection 2.</p>
<p>A water bridge can form between two hydrogen bond acceptors.</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O−H···:<sup>-</sup>O<sub>2</sub>C-</p>
<p>A water bridge can also form between two hydrogen bond donors.</p>
<p>e.g. -NH···:O:···HN- (where O is the oxygen of a bridging water)</p>
<p>A hydrogen bond acceptor and another hydrogen bond donor can be bridged by a
water.</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O:···HN- (where H−O is part of <strong>H−O</strong>−H)</p>
<p>A higher order water bridge is defined as more than one water bridging
hydrogen bond acceptor and donor. An example of a second order water bridge:</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O:···H−O:···HN-
(where H−O is part of <strong>H−O</strong>−H)</p>
<p>The following keyword arguments are important to control the behaviour of the
water bridge analysis:</p>
<ul class="simple">
<li><p><em>water_selection</em> (<code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">SOL</span></code>): the selection string for the bridging water</p></li>
<li><p><em>order</em> the maximum number of water bridging both ends</p></li>
<li><p>donor-acceptor <em>distance</em> (Å): 3.0</p></li>
<li><p>Angle <em>cutoff</em> (degrees): 120.0</p></li>
<li><p><em>forcefield</em> to switch between default values for different force fields</p></li>
<li><p><em>donors</em> and <em>acceptors</em> atom types (to add additional atom names)</p></li>
</ul>
<section id="theory">
<h2><span class="section-number">4.3.3.1. </span>Theory<a class="headerlink" href="#theory" title="Link to this heading"></a></h2>
<p>This module attempts to find multi-order water bridge by an approach similar
to breadth-first search, where the first solvation shell of selection 1 is
selected, followed by the selection of the second solvation shell as well as
any hydrogen bonding partner from selection 1. After that, the third solvation
shell, as well as any binding partners from selection 2, are detected. This
process is repeated until the maximum order of water bridges is reached.</p>
</section>
<section id="output-as-network">
<span id="wb-analysis-network"></span><h2><span class="section-number">4.3.3.2. </span>Output as Network<a class="headerlink" href="#output-as-network" title="Link to this heading"></a></h2>
<p>Since the waters connecting the two ends of the selections are by nature a
network. We provide a network representation of the water network. Water bridge
data are returned per frame, which is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.network</span></code></a>. Each frame is represented as a
dictionary, where the keys are the hydrogen bonds originating from selection
1 and the values are new dictionaries representing the hydrogen bonds coming
out of the corresponding molecules making hydrogen bonds with selection 1.</p>
<p>As for the hydrogen bonds which reach the selection 2, the values of the
corresponding keys are None. One example where selection 1 and selection 2 are
joined by one water molecule (A) which also hydrogen bond to another water (B)
which also hydrogen bond to selection 2 would be represented as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># (selection 1)-O:···H-O(water 1):···H-(selection 2)</span>
<span class="c1">#                      |             :</span>
<span class="c1">#                      H·············O-H(water2)</span>
<span class="c1">#                                    H</span>
<span class="p">{(</span><span class="n">sele1_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">water1_donor</span><span class="p">,</span> <span class="n">water1_donor_heavy</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
     <span class="p">{(</span><span class="n">water1_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sele2_donor</span><span class="p">,</span> <span class="n">sele2_donor_heavy</span><span class="p">,</span>
     <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span> <span class="kc">None</span><span class="p">},</span>
     <span class="p">{(</span><span class="n">water1_donor</span><span class="p">,</span> <span class="n">water1_donor_heavy</span><span class="p">,</span> <span class="n">water2_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
     <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
          <span class="p">{(</span><span class="n">water2_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sele2_donor</span><span class="p">,</span> <span class="n">sele2_donor_heavy</span><span class="p">,</span>
          <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span> <span class="kc">None</span><span class="p">}</span>
      <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The atoms are represented by atom index and if the atom is hydrogen bond donor,
it is followed by the index of the corresponding heavy atom
<code class="docutils literal notranslate"><span class="pre">(donor_proton,</span> <span class="pre">donor_heavy_atom)</span></code>.
If the atom is a hydrogen bond acceptor, it is followed by none.</p>
</section>
<section id="output-as-timeseries">
<span id="wb-analysis-timeseries"></span><h2><span class="section-number">4.3.3.3. </span>Output as Timeseries<a class="headerlink" href="#output-as-timeseries" title="Link to this heading"></a></h2>
<p>For lower order water bridges, it might be desirable to represent the
connections as <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.timeseries</span></code></a>. The results
are returned per frame and are a list of hydrogen bonds between the selection
1 or selection 2 and the bridging waters. Due to the complexity of the higher
order water bridge and the fact that one hydrogen bond between two waters can
appear in both third and fourth order water bridge, the hydrogen bonds in the
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.timeseries</span></code></a> attribute are generated in a
depth-first search manner to avoid duplication. Example code of how
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.timeseries</span></code></a> is generated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">network2timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Traverse the network in a depth-first fashion.</span>
<span class="sd">    expand_timeseries will expand the compact representation to the</span>
<span class="sd">    familiar timeseries representation.&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">network</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expand_timeseries</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
            <span class="n">network2timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">timeseries</span><span class="p">)</span>

<span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">network2timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">)</span>
</pre></div>
</div>
<p>An example would be.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="c1"># frame 1</span>
       <span class="p">[</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="p">(</span><span class="o">&lt;</span><span class="n">donor</span> <span class="n">residue</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">residue</span> <span class="n">number</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">atom</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">),</span>
        <span class="p">(</span><span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">residue</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">residue</span> <span class="n">number</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">atom</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">),</span>
         <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span><span class="p">],</span>
       <span class="o">....</span>
    <span class="p">],</span>
    <span class="p">[</span> <span class="c1"># frame 2</span>
      <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="o">...</span>
    <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Using the <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.generate_table()</span></code></a> method one can reformat
the results as a flat “normalised” table that is easier to import into a
database or dataframe for further processing.</p>
</section>
<section id="detection-of-water-bridges">
<h2><span class="section-number">4.3.3.4. </span>Detection of water bridges<a class="headerlink" href="#detection-of-water-bridges" title="Link to this heading"></a></h2>
<p>Water bridges are recorded if a bridging water simultaneously forms
hydrogen bonds with selection 1 and selection 2.</p>
<p>Hydrogen bonds are detected based on a geometric criterion:</p>
<ol class="arabic simple">
<li><p>The distance between acceptor and hydrogen is less than or equal to
<cite>distance</cite> (default is 3 Å).</p></li>
<li><p>The angle between donor-hydrogen-acceptor is greater than or equal to
<cite>angle</cite> (default is 120º).</p></li>
</ol>
<p>The cut-off values <cite>angle</cite> and <cite>distance</cite> can be set as keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a>.</p>
<p>Donor and acceptor heavy atoms are detected from atom names. The current
defaults are appropriate for the CHARMM27 and GLYCAM06 force fields as defined
in Table <a class="reference internal" href="#default-atom-names-for-water-bridge-analysis">Default atom names for water bridge analysis</a>.</p>
<p>Hydrogen atoms bonded to a donor are searched based on its distance to the
donor. The algorithm searches for all hydrogens
(name “H*” or name “[123]H” or type “H”) in the same residue as the donor atom
within a cut-off distance of 1.2 Å.</p>
<span id="default-atom-names-for-water-bridge-analysis"></span><table class="docutils align-default" id="id3">
<caption><span class="caption-text">Default heavy atom names for CHARMM27 force field.</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>group</p></th>
<th class="head"><p>donor</p></th>
<th class="head"><p>acceptor</p></th>
<th class="head"><p>comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>main chain</p></td>
<td><p>N</p></td>
<td><p>O, OC1, OC2</p></td>
<td><p>OC1, OC2 from amber99sb-ildn
(Gromacs)</p></td>
</tr>
<tr class="row-odd"><td><p>water</p></td>
<td><p>OH2, OW</p></td>
<td><p>OH2, OW</p></td>
<td><p>SPC, TIP3P, TIP4P (CHARMM27,Gromacs)</p></td>
</tr>
<tr class="row-even"><td><p>ARG</p></td>
<td><p>NE, NH1, NH2</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ASN</p></td>
<td><p>ND2</p></td>
<td><p>OD1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ASP</p></td>
<td></td>
<td><p>OD1, OD2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CYS</p></td>
<td><p>SG</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CYH</p></td>
<td></td>
<td><p>SG</p></td>
<td><p>possible false positives for CYS</p></td>
</tr>
<tr class="row-odd"><td><p>GLN</p></td>
<td><p>NE2</p></td>
<td><p>OE1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>GLU</p></td>
<td></td>
<td><p>OE1, OE2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>HIS</p></td>
<td><p>ND1, NE2</p></td>
<td><p>ND1, NE2</p></td>
<td><p>presence of H determines if donor</p></td>
</tr>
<tr class="row-even"><td><p>HSD</p></td>
<td><p>ND1</p></td>
<td><p>NE2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>HSE</p></td>
<td><p>NE2</p></td>
<td><p>ND1</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>HSP</p></td>
<td><p>ND1, NE2</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>LYS</p></td>
<td><p>NZ</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>MET</p></td>
<td></td>
<td><p>SD</p></td>
<td><p>see e.g. <a class="footnote-reference brackets" href="#footcite-gregoret1991" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>SER</p></td>
<td><p>OG</p></td>
<td><p>OG</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>THR</p></td>
<td><p>OG1</p></td>
<td><p>OG1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>TRP</p></td>
<td><p>NE1</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>TYR</p></td>
<td><p>OH</p></td>
<td><p>OH</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Heavy atom types for GLYCAM06 force field.</span><a class="headerlink" href="#id4" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>element</p></th>
<th class="head"><p>donor</p></th>
<th class="head"><p>acceptor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>N</p></td>
<td><p>N,NT,N3</p></td>
<td><p>N,NT</p></td>
</tr>
<tr class="row-odd"><td><p>O</p></td>
<td><p>OH,OW</p></td>
<td><p>O,O2,OH,OS,OW,OY</p></td>
</tr>
<tr class="row-even"><td><p>S</p></td>
<td></td>
<td><p>SM</p></td>
</tr>
</tbody>
</table>
<p>Donor and acceptor names for the CHARMM27 force field will also work for e.g.
OPLS/AA or amber (tested in Gromacs). Residue names in the table are for
information only and are not taken into account when determining acceptors and
donors. This can potentially lead to some ambiguity in the assignment of
donors/acceptors for residues such as histidine or cytosine.</p>
<p>For more information about the naming convention in GLYCAM06 have a look at the
<a class="reference external" href="http://glycam.ccrc.uga.edu/documents/FutureNomenclature.htm">Carbohydrate Naming Convention in Glycam</a>.</p>
<p>The lists of donor and acceptor names can be extended by providing lists of
atom names in the <cite>donors</cite> and <cite>acceptors</cite> keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a>. If the lists are entirely inappropriate
(e.g. when analysing simulations done with a force field that uses very
different atom names) then one should either use the value “other” for
<cite>forcefield</cite> to set no default values or derive a new class and set the
default list oneself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WaterBridgeAnalysis_OtherFF</span><span class="p">(</span><span class="n">WaterBridgeAnalysis</span><span class="p">):</span>
      <span class="n">DEFAULT_DONORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
      <span class="n">DEFAULT_ACCEPTORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
</pre></div>
</div>
<p>Then simply use the new class instead of the parent class and call it with
<code class="docutils literal notranslate"><span class="pre">`forcefield`</span> <span class="pre">=</span> <span class="pre">&quot;OtherFF&quot;</span></code>. Please also consider contributing the list of
heavy atom names to MDAnalysis.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-gregoret1991" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Lydia M. Gregoret, Stephen D. Rader, Robert J. Fletterick, and Fred E. Cohen. Hydrogen bonds involving sulfur atoms in proteins. <em>Proteins: Structure, Function, and Bioinformatics</em>, 9(2):99–107, 1991. <a class="reference external" href="https://doi.org/https://doi.org/10.1002/prot.340090204">doi:https://doi.org/10.1002/prot.340090204</a>.</p>
</aside>
</aside>
</div>
</section>
<section id="how-to-perform-waterbridgeanalysis">
<h2><span class="section-number">4.3.3.5. </span>How to perform <code class="docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code><a class="headerlink" href="#how-to-perform-waterbridgeanalysis" title="Link to this heading"></a></h2>
<p>All water bridges between arginine and aspartic acid can be analysed with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.analysis.hydrogenbonds</span> <span class="kn">import</span> <span class="n">WaterBridgeAnalysis</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s1">&#39;topology&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory&#39;</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;resname ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;resname ASP&#39;</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The maximum number of bridging waters detected can be changed using the order
keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;resname ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;resname ASP&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus, a maximum of three bridging waters will be detected.</p>
<p>An example of using the <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a> would be
detecting the percentage of time a certain water bridge exits.</p>
<p>Trajectory <code class="code docutils literal notranslate"><span class="pre">u</span></code> has two frames, where the first frame contains a water
bridge from the oxygen of the first arginine to one of the oxygens in the
carboxylic group of aspartate (ASP3:OD1). In the second frame, the same water
bridge forms but is between the oxygen of the arginine and the other oxygen in
the carboxylic group (ASP3:OD2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># index residue id residue name atom name</span>
<span class="c1">#     0          1          ARG         O</span>
<span class="c1">#     1          2          SOL        OW</span>
<span class="c1">#     2          2          SOL       HW1</span>
<span class="c1">#     3          2          SOL       HW2</span>
<span class="c1">#     4          3          ASP       OD1</span>
<span class="c1">#     5          3          ASP       OD2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span>
</pre></div>
</div>
<p>prints out</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="c1"># frame 1</span>
  <span class="c1"># A water bridge SOL2 links O from ARG1 to the carboxylic group OD1 of ASP3</span>
 <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">),(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW1&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW2&#39;</span><span class="p">),(</span><span class="s1">&#39;ASP&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;OD1&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
 <span class="p">],</span>
  <span class="c1"># frame 2</span>
  <span class="c1"># Another water bridge SOL2 links O from ARG1 to the other oxygen of the</span>
  <span class="c1"># carboxylic group OD2 of ASP3</span>
 <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">),(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW1&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW2&#39;</span><span class="p">),(</span><span class="s1">&#39;ASP&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;OD2&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
 <span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="use-count-by-type">
<span id="wb-count-by-type"></span><h2><span class="section-number">4.3.3.6. </span>Use <code class="docutils literal notranslate"><span class="pre">count_by_type</span></code><a class="headerlink" href="#use-count-by-type" title="Link to this heading"></a></h2>
<p>We can use the <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a> to
generate the frequency of all water bridges in the simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">()</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD1&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD2&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),]</span>
</pre></div>
</div>
<p>You might think that the OD1 and OD2 are the same oxygen and the aspartate has
just flipped and thus, they should be counted as the same type of water bridge.
The type of the water bridge can be customised by supplying an analysis
function to <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<p>The analysis function has two parameters. The current and the output. The
current is a list of hydrogen bonds from selection 1 to selection 2, formatted
in the same fashion as <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.network" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.network</span></code></a>, and an example will
be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="c1"># sele1 acceptor idx,   , water donor index, donor heavy atom idx, dist, ang.</span>
 <span class="p">[</span>                 <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>                 <span class="mi">2</span><span class="p">,</span>                   <span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
<span class="c1"># water donor idx, donor heavy atom idx, sele2 acceptor idx, distance, angle.</span>
 <span class="p">[</span>              <span class="mi">3</span><span class="p">,</span>                    <span class="mi">1</span><span class="p">,</span>                  <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],]</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">current[0]</span></code> is the first hydrogen bond originating from selection 1
and <code class="docutils literal notranslate"><span class="pre">current[-1]</span></code> is the final hydrogen bond ending in selection 2. The
output sums up all the information in the current frame and is a dictionary
with a user-defined key and the value is the weight of the corresponding key.
During the analysis phase, the function analysis iterates through all the water
bridges and modify the output in-place. At the end of the analysis, the keys
from all the frames are collected and the corresponding values will be summed
up and returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be</span>
<span class="sd">    specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds</span>
<span class="sd">          from selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type</span>
<span class="sd">          of the water bridge and the value is the weight of this type of</span>
<span class="sd">          water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.&#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># if the residue name is ASP and the atom name is OD2 or OD1,</span>
    <span class="c1"># the atom name is changed to OD</span>
    <span class="k">if</span> <span class="n">s2_resname</span> <span class="o">==</span> <span class="s1">&#39;ASP&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s2_name</span> <span class="o">==</span> <span class="s1">&#39;OD1&#39;</span> <span class="ow">or</span> <span class="n">s2_name</span> <span class="o">==</span> <span class="s1">&#39;OD2&#39;</span><span class="p">):</span>
        <span class="n">s2_name</span> <span class="o">=</span> <span class="s1">&#39;OD&#39;</span>
    <span class="c1"># setting up the key which defines this type of water bridge.</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span>
    <span class="c1"># The number of this type of water bridge is incremented by 1.</span>
    <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>Note that the result is arranged in the format of
<code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">the</span> <span class="pre">proportion</span> <span class="pre">of</span> <span class="pre">time)</span></code>. When no custom analysis function is supplied
, the key is expanded and is formatted as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>Some people might only interested in contacts between residues and pay no
attention to the details regarding the atom name. However, since multiple water
bridges can exist between two residues, which sometimes can give a result such
that the water bridge between two residues exists 300% of the time. Though this
might be a desirable result for some people, others might want the water bridge
between two residues to be only counted once per frame. This can also be
achieved by supplying an analysis function to
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be specified</span>
<span class="sd">    .</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds</span>
<span class="sd">          from selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type</span>
<span class="sd">          of the water bridge and the value is the weight of this type of</span>
<span class="sd">          water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># s1_name and s2_name are not included in the key</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">)</span>

    <span class="c1"># Each residue is only counted once per frame</span>
    <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>On the other hand, other people may insist that the first order and
second-order water bridges shouldn’t be mixed together, which can also be
achieved by supplying an analysis function to
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be specified</span>
<span class="sd">    .</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds</span>
<span class="sd">          from selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type</span>
<span class="sd">          of the water bridge and the value is the weight of this type of</span>
<span class="sd">          water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># order of the current water bridge is computed</span>
    <span class="n">order_of_water_bridge</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="c1"># and is included in the key</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">order_of_water_bridge</span><span class="p">)</span>
    <span class="c1"># The number of this type of water bridge is incremented by 1.</span>
    <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>The extra number 1 precede the 1.0 indicate that this is a first order water
bridge</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>Some people might not be interested in the interactions related to arginine.
The undesirable interactions can be discarded by supplying an analysis function
to <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be</span>
<span class="sd">    specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds</span>
<span class="sd">          from selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type</span>
<span class="sd">          of the water bridge and the value is the number of this type of</span>
<span class="sd">          water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span>
    <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">s1_resname</span> <span class="o">==</span> <span class="s1">&#39;ARG&#39;</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">)</span>
        <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns nothing in this case</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[,]</span>
</pre></div>
</div>
<p>Additional keywords can be supplied to the analysis function by passing through
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="use-count-by-time">
<span id="wb-count-by-time"></span><h2><span class="section-number">4.3.3.7. </span>Use <code class="docutils literal notranslate"><span class="pre">count_by_time</span></code><a class="headerlink" href="#use-count-by-time" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a> aggregates data across frames, which
might be desirable in some cases but not the others.
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a> provides additional functionality
for aggregating results for each frame.</p>
<p>The default behaviour of <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a> is counting
the number of water bridges from selection 1 to selection 2 for each frame.
Take the previous ASP, ARG salt bridge for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">count_by_time</span><span class="p">()</span>
</pre></div>
</div>
<p>As one water bridge is found in both frames, the method returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">]</span>
</pre></div>
</div>
<p>Similar to <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>
The behaviour of <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a> can also be
modified by supplying an analysis function.</p>
<p>Suppose we want to count</p>
<blockquote>
<div><ul class="simple">
<li><p>the <strong>number</strong> of water molecules involved in bridging selection 1 to
selection 2.</p></li>
<li><p>only if water bridge terminates in atom name <strong>OD1 of ASP</strong>.</p></li>
<li><p>only when water bridge is joined by less than <strong>two</strong> water.</p></li>
</ul>
</div></blockquote>
<p>The analysis function can be written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;This function defines how the counting of water bridge should be</span>
<span class="sd">    specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds</span>
<span class="sd">          from selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type</span>
<span class="sd">          of the water bridge and the value is the number of this type of</span>
<span class="sd">          water  bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span>
    <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span>
    <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span>
    <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># only the residue name is ASP and the atom name is OD1,</span>
    <span class="k">if</span> <span class="n">s2_resname</span> <span class="o">==</span> <span class="s1">&#39;ASP&#39;</span> <span class="ow">and</span> <span class="n">s2_name</span> <span class="o">==</span> <span class="s1">&#39;OD1&#39;</span><span class="p">:</span>
        <span class="c1"># only if the order of water bridge is less than 2</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">current</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># extract all water molecules involved in the water bridge</span>
            <span class="c1"># extract the first water from selection 1</span>
            <span class="n">s1_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">,</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">),</span>
            <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">,</span> <span class="n">to_name</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># extract all the waters between selection 1 and selection 2</span>
            <span class="k">for</span> <span class="n">hbond</span> <span class="ow">in</span> <span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="c1"># decompose the hydrogen bond.</span>
                <span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">,</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">,</span> <span class="n">from_name</span><span class="p">),</span>
                <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">,</span> <span class="n">to_name</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">hbond</span>
                <span class="c1"># add first water</span>
                <span class="n">key1</span> <span class="o">=</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># add second water</span>
                <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">key2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># extract the last water to selection 2</span>
            <span class="n">from_index</span><span class="p">,</span> <span class="n">s2_index</span><span class="p">,</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">,</span> <span class="n">from_name</span><span class="p">),</span>
            <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_time</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),]</span>
</pre></div>
</div>
</section>
<section id="classes">
<h2><span class="section-number">4.3.3.8. </span>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.</span></span><span class="sig-name descname"><span class="pre">WaterBridgeAnalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">universe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'protein'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'not</span> <span class="pre">resname</span> <span class="pre">SOL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'resname</span> <span class="pre">SOL'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection1_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_water_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hydrogen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forcefield</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CHARMM27'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">donors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acceptors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sele1_sele2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hydrogenbonds/wbridge_analysis.html#WaterBridgeAnalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis" title="Link to this definition"></a></dt>
<dd><p>Perform a water bridge analysis</p>
<p>The analysis of the trajectory is performed with the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.run()</span></code> method. The result is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.timeseries</span></code></a>. See
<code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code> for the format.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
<p>Set up the calculation of water bridges between two selections in a
universe.</p>
<p>The timeseries is accessible as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.timeseries</span></code></a>.</p>
<p>If no hydrogen bonds are detected or if the initial check fails, look
at the log output (enable with <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.start_logging()</span></code></a> and set
<cite>verbose</cite> <code class="docutils literal notranslate"><span class="pre">=True</span></code>). It is likely that the default names for donors
and acceptors are not suitable (especially for non-standard
ligands). In this case, either change the <cite>forcefield</cite> or use
customized <cite>donors</cite> and/or <cite>acceptors</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>universe</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – Universe object</p></li>
<li><p><strong>selection1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for first selection [‘protein’]</p></li>
<li><p><strong>selection2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for second selection [‘not resname SOL’]
This string selects everything except water where water is assumed
to have a residue name as SOL.</p></li>
<li><p><strong>water_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Selection string for bridging water selection [‘resname SOL’]
The default selection assumes that the water molecules have residue
name “SOL”. Change it to the appropriate selection for your
specific force field.</p>
<p>However, in theory, this selection can be anything which forms
a hydrogen bond with selection 1 and selection 2.</p>
</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – <p>The maximum number of water bridges linking both selections.
if the order is set to 3, then all the residues linked with less
than three water molecules will be detected. [1]</p>
<p>Computation of high order water bridges can be very time-consuming.
Think carefully before running the calculation, do you really want
to compute the 20th order water bridge between domain A and domain
B or you just want to know the third order water bridge between two
residues.</p>
</p></li>
<li><p><strong>selection1_type</strong> (<em>{&quot;donor&quot;</em><em>, </em><em>&quot;acceptor&quot;</em><em>, </em><em>&quot;both&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Selection 1 can be ‘donor’, ‘acceptor’ or ‘both’. Note that the
value for <cite>selection1_type</cite> automatically determines how
<cite>selection2</cite> handles donors and acceptors: If <cite>selection1</cite> contains
‘both’ then <cite>selection2</cite> will also contain ‘both’. If <cite>selection1</cite>
is set to ‘donor’ then <cite>selection2</cite> is ‘acceptor’ (and vice versa).
[‘both’].</p></li>
<li><p><strong>update_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Update selection 1 and 2 at each frame. Setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the
selection is not static. Selections are filtered first to speed up
performance. Thus, setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> is recommended if contact
surface between selection 1 and selection 2 is constantly
changing. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p></li>
<li><p><strong>update_water_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Update selection of water at each frame. Setting to <code class="docutils literal notranslate"><span class="pre">False</span></code> is
<strong>only</strong> recommended when the total amount of water molecules in
the simulation are small and when water molecules remain static
across the simulation.</p>
<p>However, in normal simulations, only a tiny proportion of water is
engaged in the formation of water bridge. It is recommended to
update the water selection and set keyword <cite>filter_first</cite> to
<code class="docutils literal notranslate"><span class="pre">True</span></code> so as to filter out water not residing between the two
selections. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p>
</p></li>
<li><p><strong>filter_first</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Filter the water selection to only include water within 4 Å +
<cite>order</cite> * (2 Å + <cite>distance</cite>) away from <cite>both</cite> selection 1 and
selection 2.
Selection 1 and selection 2 are both filtered to only include atoms
with the same distance away from the other selection. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p></li>
<li><p><strong>distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Distance cutoff for hydrogen bonds; only interactions with a H-A
distance &lt;= <cite>distance</cite> (and the appropriate D-H-A angle, see
<cite>angle</cite>) are recorded. (Note: <cite>distance_type</cite> can change this to
the D-A distance.) [3.0]</p></li>
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Angle cutoff for hydrogen bonds; an ideal H-bond has an angle of
180º.  A hydrogen bond is only recorded if the D-H-A angle is
&gt;=  <cite>angle</cite>. The default of 120º also finds fairly non-specific
hydrogen interactions and possibly better value is 150º. [120.0]</p></li>
<li><p><strong>forcefield</strong> (<em>{&quot;CHARMM27&quot;</em><em>, </em><em>&quot;GLYCAM06&quot;</em><em>, </em><em>&quot;other&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Name of the forcefield used. Switches between different
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_DONORS</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_ACCEPTORS</span></code></a> values.
[“CHARMM27”]</p></li>
<li><p><strong>donors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H donor atom types (in addition to those in <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_DONORS</span></code></a>).
This shall be the name of the heavy atom that is bonded to the hydrogen.
For example, the oxygen (‘O’) in the hydroxyl group. Must be a sequence.</p></li>
<li><p><strong>acceptors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H acceptor atom types (in addition to those in
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_ACCEPTORS</span></code></a>), must be a
sequence.</p></li>
<li><p><strong>distance_type</strong> (<em>{&quot;hydrogen&quot;</em><em>, </em><em>&quot;heavy&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Measure hydrogen bond lengths between donor and acceptor heavy
atoms (“heavy”) or between donor hydrogen and acceptor heavy
atom (“hydrogen”). If using “heavy” then one should set the
<em>distance</em> cutoff to a higher value such as 3.5 Å. [“hydrogen”]</p></li>
<li><p><strong>output_format</strong> (<em>{&quot;sele1_sele2&quot;</em><em>, </em><em>&quot;donor_acceptor&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Setting the output format for timeseries and table. If set to
“sele1_sele2”, for each hydrogen bond, the one close to selection 1
will be placed before selection 2. If set to “donor_acceptor”, the
donor will be placed before acceptor. “sele1_sele2”]</p></li>
<li><p><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> enables per-frame debug logging. This is
disabled by default because it generates a very large amount of
output in the log file. (Note that a logger must have been started
to see the output, e.g. using <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.start_logging()</span></code></a>.)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Toggle progress output. (Can also be given as keyword argument to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code>.)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In order to speed up processing, atoms are filtered by a coarse
distance criterion before a detailed hydrogen bonding analysis is
performed (<cite>filter_first</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
<p>If selection 1 and selection 2 are very mobile during the simulation
and the contact surface is constantly changing (i.e. residues are
moving farther than 4 Å + <cite>order</cite> * (2 Å + <cite>distance</cite>)), you might
consider setting the <cite>update_selection</cite> keywords to <code class="docutils literal notranslate"><span class="pre">True</span></code>
to ensure correctness.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps">
<span class="sig-name descname"><span class="pre">timesteps</span></span><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps" title="Link to this definition"></a></dt>
<dd><p>List of the times of each timestep. This can be used together with
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> to find the specific
time point of a water bridge existence.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network">
<span class="sig-prename descclassname"><span class="pre">results.</span></span><span class="sig-name descname"><span class="pre">network</span></span><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network" title="Link to this definition"></a></dt>
<dd><p>Network representation of the water network.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.network">
<span class="sig-name descname"><span class="pre">network</span></span><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.network" title="Link to this definition"></a></dt>
<dd><p>Alias to the <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">results.network</span></code></a> attribute.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Will be removed in MDAnalysis 3.0.0. Please use
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">results.network</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.table">
<span class="sig-name descname"><span class="pre">table</span></span><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="Link to this definition"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Will be removed in MDAnalysis 3.0.0. Please generate
the table with <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_table()</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries">
<span class="sig-prename descclassname"><span class="pre">results.</span></span><span class="sig-name descname"><span class="pre">timeseries</span></span><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="Link to this definition"></a></dt>
<dd><p>List of hydrogen bonds between the selection 1 or selection 2
and the bridging waters, for each frame.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries">
<span class="sig-name descname"><span class="pre">timeseries</span></span><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="Link to this definition"></a></dt>
<dd><p>Alias to the <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">results.timeseries</span></code></a> attribute.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Will be removed in MDAnalysis 3.0.0. Please use
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">results.timeseries</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS">
<span class="sig-name descname"><span class="pre">DEFAULT_ACCEPTORS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'CHARMM27':</span> <span class="pre">('OE1',</span> <span class="pre">'OG1',</span> <span class="pre">'OE2',</span> <span class="pre">'SG',</span> <span class="pre">'ND1',</span> <span class="pre">'OD1',</span> <span class="pre">'OH2',</span> <span class="pre">'OD2',</span> <span class="pre">'NE2',</span> <span class="pre">'OG',</span> <span class="pre">'OC2',</span> <span class="pre">'O',</span> <span class="pre">'OC1',</span> <span class="pre">'OW',</span> <span class="pre">'SD',</span> <span class="pre">'OH'),</span> <span class="pre">'GLYCAM06':</span> <span class="pre">('OY',</span> <span class="pre">'O2',</span> <span class="pre">'NT',</span> <span class="pre">'O',</span> <span class="pre">'OW',</span> <span class="pre">'OS',</span> <span class="pre">'OH',</span> <span class="pre">'SM',</span> <span class="pre">'N'),</span> <span class="pre">'other':</span> <span class="pre">()}</span></em><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS" title="Link to this definition"></a></dt>
<dd><p>default atom names that are treated as hydrogen <em>acceptors</em>
(see <a class="reference internal" href="#default-atom-names-for-water-bridge-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a>);
use the keyword <cite>acceptors</cite> to add a list of additional acceptor names.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS">
<span class="sig-name descname"><span class="pre">DEFAULT_DONORS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'CHARMM27':</span> <span class="pre">('OH2',</span> <span class="pre">'NH1',</span> <span class="pre">'OG1',</span> <span class="pre">'NE2',</span> <span class="pre">'SG',</span> <span class="pre">'OG',</span> <span class="pre">'NZ',</span> <span class="pre">'NE',</span> <span class="pre">'NE1',</span> <span class="pre">'NH2',</span> <span class="pre">'OW',</span> <span class="pre">'ND2',</span> <span class="pre">'ND1',</span> <span class="pre">'OH',</span> <span class="pre">'N'),</span> <span class="pre">'GLYCAM06':</span> <span class="pre">('N3',</span> <span class="pre">'OW',</span> <span class="pre">'NT',</span> <span class="pre">'OH',</span> <span class="pre">'N'),</span> <span class="pre">'other':</span> <span class="pre">()}</span></em><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS" title="Link to this definition"></a></dt>
<dd><p>default heavy atom names whose hydrogens are treated as <em>donors</em>
(see <a class="reference internal" href="#default-atom-names-for-water-bridge-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a>);
use the keyword <cite>donors</cite> to add a list of additional donor names.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time">
<span class="sig-name descname"><span class="pre">count_by_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hydrogenbonds/wbridge_analysis.html#WaterBridgeAnalysis.count_by_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="Link to this definition"></a></dt>
<dd><p>Counts the number of water bridges per timestep.</p>
<p>The counting behaviour can be adjusted by supplying analysis_func.
See <a class="reference internal" href="#wb-count-by-time"><span class="std std-ref">Use count_by_time</span></a> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>counts</strong> – Returns a time series <code class="docutils literal notranslate"><span class="pre">N(t)</span></code> where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the total
number of observed water bridges at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type">
<span class="sig-name descname"><span class="pre">count_by_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hydrogenbonds/wbridge_analysis.html#WaterBridgeAnalysis.count_by_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="Link to this definition"></a></dt>
<dd><p>Counts the frequency of water bridge of a specific type.</p>
<p>If one atom <em>A</em> from <em>selection 1</em> is linked to atom <em>B</em> from
<em>selection 2</em> through one or more bridging waters, an entity will be
created and the proportion of time that this linkage exists in the
whole simulation will be calculated.</p>
<p>The identification of a specific type of water bridge can be modified
by supplying the analysis_func function. See <a class="reference internal" href="#wb-count-by-type"><span class="std std-ref">Use count_by_type</span></a>
for detail.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>counts</strong> – Returns a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> containing atom indices for <em>A</em> and
<em>B</em>, residue names, residue numbers, atom names (for both A and B)
and the fraction of the total time during which the water bridge
was detected. This method returns None if method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.run()</span></code> was not executed first.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table">
<span class="sig-name descname"><span class="pre">generate_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hydrogenbonds/wbridge_analysis.html#WaterBridgeAnalysis.generate_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="Link to this definition"></a></dt>
<dd><p>Generate a normalised table of the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_format</strong> (<em>{'sele1_sele2'</em><em>, </em><em>'donor_acceptor'}</em>) – The output format of the <cite>table</cite> can be changed a fashion similar
to <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.timeseries</span></code></a> by changing the
labels of the columns of the participating atoms.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>table</strong> (<em>numpy.rec.recarray</em>) – A “tidy” table with one hydrogen bond per row, labeled according to
<cite>output_format</cite> and containing information of atom_1, atom_2,
distance, and angle.</p></li>
<li><p><em>.. versionchanged:: 2.0.0</em> – Return the generated table (as well as storing it as <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>).</p></li>
<li><p><em>.. deprecated:: 2.0.0</em> – In release 3.0.0, <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_table()</span></code></a> will _only_ return the
table and no longer store it in <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.r_cov">
<span class="sig-name descname"><span class="pre">r_cov</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'N':</span> <span class="pre">1.31,</span> <span class="pre">'O':</span> <span class="pre">1.31,</span> <span class="pre">'P':</span> <span class="pre">1.58,</span> <span class="pre">'S':</span> <span class="pre">1.55}</span></em><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.r_cov" title="Link to this definition"></a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.defaultdict</span></code></a> of covalent radii of common donors
(used in :meth`_get_bonded_hydrogens_list` to check if a hydrogen is
sufficiently close to its donor heavy atom). Values are stored for
N, O, P, and S. Any other heavy atoms are assumed to have hydrogens
covalently bound at a maximum distance of 1.5 Å.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps_by_type">
<span class="sig-name descname"><span class="pre">timesteps_by_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hydrogenbonds/wbridge_analysis.html#WaterBridgeAnalysis.timesteps_by_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps_by_type" title="Link to this definition"></a></dt>
<dd><p>Frames during which each water bridges existed, sorted by each water
bridges.</p>
<p>Processes <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.results.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.results.network</span></code></a> and returns a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> containing atom indices, residue names, residue
numbers (from selection 1 and selection 2) and each timestep at which
the water bridge was detected.</p>
<p>Similar to <a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hydrogenbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a>, the behavior can be
adjusted by supplying an analysis_func.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hbond_autocorrel.html" class="btn btn-neutral float-left" title="4.3.2. Hydrogen bond autocorrelation — MDAnalysis.analysis.hydrogenbonds.hbond_autocorrel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hbond_autocorrel_deprecated.html" class="btn btn-neutral float-right" title="4.3.4. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel (deprecated)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2005-2024, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Henok Ademtew, Shobhit Agarwal, Aya M. Alaa, Irfan Alibay, Kazi Shudipto Amin, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Patricio Barletta, Leonardo Barneschi, Jonathan Barnoud, Estefania Barreto-Ojeda, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Kavya Bisht, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Kevin Boyd, Meet Brijwani, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, Yantong Cai, David Caplan, Yuanyu Chang, Pratham Chauhan, Matthieu Chavent, Haochuan Chen, Xu Hong Chen, Kathleen Clark, Jennifer A Clark, Orion Cohen, Charlie Cook, Ruggero Cortini, Nicholas Craven, Ramon Crehuet, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Bradley Dice, Jan Domanski, David L. Dotson, Mark D. Driver, Ali Ehlen, Daniel J. Evans, Shujie Fan, Bjarne Feddersen, Lennard van der Feltz, Jake Fennick, Philip Fowler, Guillaume Fraux, Anirvinya G, Michael Gecht, Ahmed Salah Ghoneim, Mikhail Glagolev, William Glass, Jenna M. Swarthout Goddard, Joseph Goose, Alexander Gorfer, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Pratik Gupta, Sumit Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Edis Jakupovic, Joe Jordan, Henrik Jäger, Uma D Kadam, Aditya Kamath, Jon Kapla, Ian M. Kenney, Aditya Keshari, Haleema Khan, Navya Khare, Utsav Khatu, Andrew William King, Henry Kobin, Abhishek A. Kognole, Kosuke Kudo, Atharva Kulkarni, Manish Kumar, Mohit Kumar, Shubham Kumar, Alia Lescoulie, Zhenbo Li, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Shaivi Malik, Egor Marin, Domenico Marson, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Marcelo C. R. Melo, Dominik &#39;Rathann&#39; Mierzejewski, David Minh, Geongi Moon, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Meghan Osato, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Dimitrios Papageorgiou, Rafael R. Pappalardo, Vishal Parmar, Danny Parton, Shakul Pathak, Christian Pfaendner, Joshua L. Phillips, Marcelo D. Poleto, Hannah Pollak, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Andrea Rizzi, Xiaoxu Ruan, Carlos Yanez S., Utkarsh Saxena, Moritz Schaeffler, Alexander Schlaich, Marcello Sega, Ricky Sexton, Sean L. Seyler, Faraaz Shah, Sulay Shah, Abhishek Shandilya, Shubham Sharma, Rishabh Shukla, Karthikeyan Singaravelan, Tamandeep Singh, Brigitta Sipőcz, Paul Smith, Andy Somogyi, Caio S. Souza, David van der Spoel, Shantanu Srivastava, Lukas Stelzl, Jan Stevens, Gorman Stock, Johannes Stöckelmaier, Fenil Suchak, Ayush Suhane, Filip T. Szczypiński, Sukeerti T, Matthijs Tadema, Joao Miguel Correia Teixeira, Paarth Thadani, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Zaheer Timol, Wiep van der Toorn, Mieczyslaw Torchala, Aditi Tripathi, Heet Vekariya, Mark Verma, Josh Vermaas, Isaac Virshup, Lily Wang, Nestor Wendt, Lawson Woods, Zhiyi Wu, Tengyu Xie, Zhuyi Xue, Mingyi Xue, Alexander Yang, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Raymond Zhao, Yuxuan Zhuang, and Oliver Beckstein.</p>
  </div>

  

<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        2.8.0-dev0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>