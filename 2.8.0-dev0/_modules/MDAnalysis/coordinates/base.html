


  
    
  




<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="shortcut icon" href="../../../_static/logo/mda_favicon.ico">
</head>

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MDAnalysis.coordinates.base &mdash; MDAnalysis 2.8.0-dev0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/site.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=a9b57af3"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/js/versions.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 2.8.0-dev0 documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >




  




<a href="../../../index.html">
  
    <img src="../../../_static/logo/mda_logo.png" class="logo" alt="Logo"/>
</a>


  
  
  
    <div class="version">
      2.8.0-dev0
    </div>
  



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>
<div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
    <!-- <p class="caption" role="heading"></p> -->
    <ul>
        
        <li class="toctree-l1"><a class="reference internal" href="http://mdanalysis.org">MDAnalysis</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="http://userguide.mdanalysis.org">User guide</a></li>
        
        <li class="toctree-l1"><a class="reference internal" href="https://mdakits.mdanalysis.org/">MDAKits</a></li>
        
    </ul>
    
        <p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/lib_modules.html">13. Library functions — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/version.html">14. Version information for MDAnalysis - <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/units.html">15. Constants and unit conversion — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/exceptions.html">16. Custom exceptions and warnings — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../documentation_pages/references.html">17. References</a></li>
</ul>

</div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MDAnalysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">MDAnalysis.coordinates.base</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for MDAnalysis.coordinates.base</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- Mode: python; tab-width: 4; indent-tabs-mode:nil; coding:utf-8 -*-</span>
<span class="c1"># vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4</span>

<span class="c1"># MDAnalysis --- https://www.mdanalysis.org</span>
<span class="c1"># Copyright (c) 2006-2017 The MDAnalysis Development Team and contributors</span>
<span class="c1"># (see the file AUTHORS for the full list of names)</span>
<span class="c1">#</span>
<span class="c1"># Released under the GNU Public Licence, v2 or any higher version</span>
<span class="c1">#</span>
<span class="c1"># Please cite your use of MDAnalysis in published work:</span>
<span class="c1">#</span>
<span class="c1"># R. J. Gowers, M. Linke, J. Barnoud, T. J. E. Reddy, M. N. Melo, S. L. Seyler,</span>
<span class="c1"># D. L. Dotson, J. Domanski, S. Buchoux, I. M. Kenney, and O. Beckstein.</span>
<span class="c1"># MDAnalysis: A Python package for the rapid analysis of molecular dynamics</span>
<span class="c1"># simulations. In S. Benthall and S. Rostrup editors, Proceedings of the 15th</span>
<span class="c1"># Python in Science Conference, pages 102-109, Austin, TX, 2016. SciPy.</span>
<span class="c1"># doi: 10.25080/majora-629e541a-00e</span>
<span class="c1">#</span>
<span class="c1"># N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and O. Beckstein.</span>
<span class="c1"># MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations.</span>
<span class="c1"># J. Comput. Chem. 32 (2011), 2319--2327, doi:10.1002/jcc.21787</span>
<span class="c1">#</span>


<span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">Base classes --- :mod:`MDAnalysis.coordinates.base`</span>
<span class="sd">===================================================</span>

<span class="sd">Derive, FrameIterator, Reader and Writer classes from the classes</span>
<span class="sd">in this module. The derived classes must follow the :ref:`Trajectory API`.</span>


<span class="sd">.. _FrameIterators:</span>

<span class="sd">FrameIterators</span>
<span class="sd">--------------</span>

<span class="sd">FrameIterators are &quot;sliced trajectories&quot; (a trajectory is a</span>
<span class="sd">:ref:`Reader &lt;Readers&gt;`) that can be iterated over. They are typically</span>
<span class="sd">created by slicing a trajectory or by fancy-indexing of a trajectory</span>
<span class="sd">with an array of frame numbers or a boolean mask of all frames.</span>

<span class="sd">Iterator classes used by the by the :class:`ProtoReader`:</span>

<span class="sd">.. autoclass:: FrameIteratorBase</span>

<span class="sd">.. autoclass:: FrameIteratorSliced</span>

<span class="sd">.. autoclass:: FrameIteratorAll</span>

<span class="sd">.. autoclass:: FrameIteratorIndices</span>


<span class="sd">.. _ReadersBase:</span>

<span class="sd">Readers</span>
<span class="sd">-------</span>

<span class="sd">Readers know how to take trajectory data in a given format and present it in a</span>
<span class="sd">common API to the user in MDAnalysis. There are two types of readers:</span>

<span class="sd">1. Readers for *multi frame trajectories*, i.e., file formats that typically</span>
<span class="sd">   contain many frames. These readers are typically derived from</span>
<span class="sd">   :class:`ReaderBase`.</span>

<span class="sd">2. Readers for *single frame formats*: These file formats only contain a single</span>
<span class="sd">   coordinate set. These readers are derived from</span>
<span class="sd">   :class:`SingleFrameReaderBase`.</span>

<span class="sd">The underlying low-level readers handle closing of files in different</span>
<span class="sd">ways. Typically, the MDAnalysis readers try to ensure that files are always</span>
<span class="sd">closed when a reader instance is garbage collected, which relies on</span>
<span class="sd">implementing a :meth:`~ReaderBase.__del__` method. However, in some cases, this</span>
<span class="sd">is not necessary (for instance, for the single frame formats) and then such a</span>
<span class="sd">method can lead to undesirable side effects (such as memory leaks). In this</span>
<span class="sd">case, :class:`ProtoReader` should be used.</span>


<span class="sd">.. autoclass:: ReaderBase</span>
<span class="sd">   :members:</span>
<span class="sd">   :inherited-members:</span>

<span class="sd">.. autoclass:: SingleFrameReaderBase</span>
<span class="sd">   :members:</span>
<span class="sd">   :inherited-members:</span>

<span class="sd">.. autoclass:: ProtoReader</span>
<span class="sd">   :members:</span>



<span class="sd">.. _WritersBase:</span>

<span class="sd">Writers</span>
<span class="sd">-------</span>

<span class="sd">Writers know how to write information in a :class:`Timestep` to a trajectory</span>
<span class="sd">file.</span>

<span class="sd">.. autoclass:: WriterBase</span>
<span class="sd">   :members:</span>
<span class="sd">   :inherited-members:</span>

<span class="sd">Converters</span>
<span class="sd">----------</span>
<span class="sd">Converters output information to other libraries.</span>

<span class="sd">.. deprecated:: 2.7.0</span>
<span class="sd">    All converter code has been moved to :mod:`MDAnalysis.converters` and will</span>
<span class="sd">    be removed from the :mod:`MDAnalysis.coordinates.base` module in 3.0.0.</span>

<span class="sd">.. autoclass:: ConverterBase</span>
<span class="sd">   :members:</span>
<span class="sd">   :inherited-members:</span>

<span class="sd">Helper classes</span>
<span class="sd">--------------</span>

<span class="sd">The following classes contain basic functionality that all readers and</span>
<span class="sd">writers share.</span>

<span class="sd">.. autoclass:: IOBase</span>
<span class="sd">   :members:</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>

<span class="kn">from</span> <span class="nn">.timestep</span> <span class="kn">import</span> <span class="n">Timestep</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_READERS</span><span class="p">,</span> <span class="n">_READER_HINTS</span><span class="p">,</span>
    <span class="n">_SINGLEFRAME_WRITERS</span><span class="p">,</span>
    <span class="n">_MULTIFRAME_WRITERS</span><span class="p">,</span>
    <span class="n">_CONVERTERS</span><span class="p">,</span>  <span class="c1"># remove in 3.0.0 (Issue #3404)</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">units</span>
<span class="kn">from</span> <span class="nn">..auxiliary.base</span> <span class="kn">import</span> <span class="n">AuxReader</span>
<span class="kn">from</span> <span class="nn">..auxiliary.core</span> <span class="kn">import</span> <span class="n">auxreader</span>
<span class="kn">from</span> <span class="nn">..auxiliary.core</span> <span class="kn">import</span> <span class="n">get_auxreader_for</span>
<span class="kn">from</span> <span class="nn">..auxiliary</span> <span class="kn">import</span> <span class="n">_AUXREADERS</span>
<span class="kn">from</span> <span class="nn">..lib.util</span> <span class="kn">import</span> <span class="n">asiterable</span><span class="p">,</span> <span class="n">Namespace</span><span class="p">,</span> <span class="n">store_init_arguments</span>
<span class="kn">from</span> <span class="nn">..lib.util</span> <span class="kn">import</span> <span class="n">NamedStream</span>


<div class="viewcode-block" id="FrameIteratorBase">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.FrameIteratorBase">[docs]</a>
<span class="k">class</span> <span class="nc">FrameIteratorBase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base iterable over the frames of a trajectory.</span>

<span class="sd">    A frame iterable has a length that can be accessed with the :func:`len`</span>
<span class="sd">    function, and can be indexed similarly to a full trajectory. When indexed,</span>
<span class="sd">    indices are resolved relative to the iterable and not relative to the</span>
<span class="sd">    trajectory.</span>

<span class="sd">    .. versionadded:: 0.19.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trajectory</span> <span class="o">=</span> <span class="n">trajectory</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_avoid_bool_list</span><span class="p">(</span><span class="n">frames</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">frames</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frames</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trajectory</span></div>



<div class="viewcode-block" id="FrameIteratorSliced">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.FrameIteratorSliced">[docs]</a>
<span class="k">class</span> <span class="nc">FrameIteratorSliced</span><span class="p">(</span><span class="n">FrameIteratorBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterable over the frames of a trajectory on the basis of a slice.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajectory: ProtoReader</span>
<span class="sd">        The trajectory over which to iterate.</span>
<span class="sd">    frames: slice</span>
<span class="sd">        A slice to select the frames of interest.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    FrameIteratorBase</span>

<span class="sd">    .. versionadded:: 0.19.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">,</span> <span class="n">frames</span><span class="p">):</span>
        <span class="c1"># It would be easier to store directly a range object, as it would</span>
        <span class="c1"># store its parameters in a single place, calculate its length, and</span>
        <span class="c1"># take care of most the indexing. Though, doing so is not compatible</span>
        <span class="c1"># with python 2 where xrange (or range with six) is only an iterator.</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FrameIteratorSliced</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="n">trajectory</span><span class="o">.</span><span class="n">check_slice_indices</span><span class="p">(</span>
            <span class="n">frames</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">frames</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">frames</span><span class="o">.</span><span class="n">step</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">range_length</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">):</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">rewind</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="o">-</span><span class="n">length</span> <span class="o">&lt;</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;Index </span><span class="si">{}</span><span class="s1"> is out of range of the range of length </span><span class="si">{}</span><span class="s1">.&#39;</span>
                                 <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">length</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="n">frame</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">frame</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">_read_frame_with_aux</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">step</span> <span class="o">=</span> <span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
            <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">frame</span><span class="o">.</span><span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
            <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">frame</span><span class="o">.</span><span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">last</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="n">range_length</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">step</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">last</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">stop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>

            <span class="n">new_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
            <span class="n">frame_iterator</span> <span class="o">=</span> <span class="n">FrameIteratorSliced</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">new_slice</span><span class="p">)</span>
            <span class="c1"># The __init__ of FrameIteratorSliced does some conversion between</span>
            <span class="c1"># the way indices are handled in slices and the way they are</span>
            <span class="c1"># handled by range. We need to overwrite this conversion as we</span>
            <span class="c1"># already use the logic for range.</span>
            <span class="n">frame_iterator</span><span class="o">.</span><span class="n">_start</span> <span class="o">=</span> <span class="n">start</span>
            <span class="n">frame_iterator</span><span class="o">.</span><span class="n">_stop</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">frame_iterator</span><span class="o">.</span><span class="n">_step</span> <span class="o">=</span> <span class="n">step</span>
            <span class="k">return</span> <span class="n">frame_iterator</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Indexing with a lists of bools does not behave the same in all</span>
            <span class="c1"># version of numpy.</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avoid_bool_list</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)))[</span><span class="n">frame</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">FrameIteratorIndices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">frames</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step</span></div>



<div class="viewcode-block" id="FrameIteratorAll">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.FrameIteratorAll">[docs]</a>
<span class="k">class</span> <span class="nc">FrameIteratorAll</span><span class="p">(</span><span class="n">FrameIteratorBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterable over all the frames of a trajectory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajectory: ProtoReader</span>
<span class="sd">        The trajectory over which to iterate.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    FrameIteratorBase</span>

<span class="sd">    .. versionadded:: 0.19.0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FrameIteratorAll</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_frames</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span></div>



<div class="viewcode-block" id="FrameIteratorIndices">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.FrameIteratorIndices">[docs]</a>
<span class="k">class</span> <span class="nc">FrameIteratorIndices</span><span class="p">(</span><span class="n">FrameIteratorBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterable over the frames of a trajectory listed in a sequence of indices.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trajectory: ProtoReader</span>
<span class="sd">        The trajectory over which to iterate.</span>
<span class="sd">    frames: sequence</span>
<span class="sd">        A sequence of indices.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    FrameIteratorBase</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">,</span> <span class="n">frames</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FrameIteratorIndices</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">frames</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Frames indices must be integers.&quot;</span><span class="p">)</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">trajectory</span><span class="o">.</span><span class="n">_apply_limits</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_frames</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">_read_frame_with_aux</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">rewind</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">_read_frame_with_aux</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avoid_bool_list</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">)[</span><span class="n">frame</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">FrameIteratorIndices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">frames</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frames</span></div>



<div class="viewcode-block" id="IOBase">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase">[docs]</a>
<span class="k">class</span> <span class="nc">IOBase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class bundling common functionality for trajectory I/O.</span>

<span class="sd">    .. versionchanged:: 0.8</span>
<span class="sd">       Added context manager protocol.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: dict with units of of *time* and *length* (and *velocity*, *force*,</span>
    <span class="c1">#: ... for formats that support it)</span>
    <span class="n">units</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;velocity&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

<div class="viewcode-block" id="IOBase.convert_pos_from_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_pos_from_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_pos_from_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion of coordinate array x from native units to base units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like</span>
<span class="sd">          Positions to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input `x` is modified in place and also returned.</span>
<span class="sd">        In-place operations improve performance because allocating new arrays</span>
<span class="sd">        is avoided.</span>


<span class="sd">        .. versionchanged:: 0.7.5</span>
<span class="sd">           Keyword `inplace` can be set to ``False`` so that a</span>
<span class="sd">           modified copy is returned *unless* no conversion takes</span>
<span class="sd">           place, in which case the reference to the unmodified `x` is</span>
<span class="sd">           returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span><span class="s1">&#39;length&#39;</span><span class="p">,</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">],</span> <span class="s1">&#39;Angstrom&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">x</span>
        <span class="n">x</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">x</span></div>


<div class="viewcode-block" id="IOBase.convert_velocities_from_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_velocities_from_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_velocities_from_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion of velocities array *v* from native to base units</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : array_like</span>
<span class="sd">          Velocities to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input *v* is modified in place and also returned.</span>
<span class="sd">        In-place operations improve performance because allocating new arrays</span>
<span class="sd">        is avoided.</span>


<span class="sd">        .. versionadded:: 0.7.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">],</span> <span class="s1">&#39;Angstrom/ps&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">v</span>
        <span class="n">v</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">v</span></div>


<div class="viewcode-block" id="IOBase.convert_forces_from_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_forces_from_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_forces_from_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion of forces array *force* from native to base units</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : array_like</span>
<span class="sd">          Forces to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input *force* is modified in place and also returned.</span>
<span class="sd">        In-place operations improve performance because allocating new arrays</span>
<span class="sd">        is avoided.</span>

<span class="sd">        .. versionadded:: 0.7.7</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">],</span> <span class="s1">&#39;kJ/(mol*Angstrom)&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">force</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">force</span>
        <span class="n">force</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">force</span></div>


<div class="viewcode-block" id="IOBase.convert_time_from_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_time_from_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_time_from_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert time *t* from native units to base units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : array_like</span>
<span class="sd">          Time values to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input `t` is modified in place and also returned</span>
<span class="sd">        (although note that scalar values `t` are passed by value in Python and</span>
<span class="sd">        hence an in-place modification has no effect on the caller.)  In-place</span>
<span class="sd">        operations improve performance because allocating new arrays is</span>
<span class="sd">        avoided.</span>


<span class="sd">        .. versionchanged:: 0.7.5</span>
<span class="sd">           Keyword `inplace` can be set to ``False`` so that a</span>
<span class="sd">           modified copy is returned *unless* no conversion takes</span>
<span class="sd">           place, in which case the reference to the unmodified `x` is</span>
<span class="sd">           returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="s1">&#39;ps&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">t</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="IOBase.convert_pos_to_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_pos_to_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_pos_to_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion of coordinate array `x` from base units to native units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like</span>
<span class="sd">          Positions to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input `x` is modified in place and also returned.</span>
<span class="sd">        In-place operations improve performance because allocating new arrays</span>
<span class="sd">        is avoided.</span>


<span class="sd">        .. versionchanged:: 0.7.5</span>
<span class="sd">           Keyword `inplace` can be set to ``False`` so that a</span>
<span class="sd">           modified copy is returned *unless* no conversion takes</span>
<span class="sd">           place, in which case the reference to the unmodified `x` is</span>
<span class="sd">           returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;Angstrom&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">x</span>
        <span class="n">x</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">x</span></div>


<div class="viewcode-block" id="IOBase.convert_velocities_to_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_velocities_to_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_velocities_to_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion of coordinate array `v` from base to native units</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        v : array_like</span>
<span class="sd">          Velocities to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input `v` is modified in place and also returned.</span>
<span class="sd">        In-place operations improve performance because allocating new arrays</span>
<span class="sd">        is avoided.</span>


<span class="sd">        .. versionadded:: 0.7.5</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;speed&#39;</span><span class="p">,</span> <span class="s1">&#39;Angstrom/ps&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;velocity&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">v</span>
        <span class="n">v</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">v</span></div>


<div class="viewcode-block" id="IOBase.convert_forces_to_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_forces_to_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_forces_to_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Conversion of force array *force* from base to native units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : array_like</span>
<span class="sd">          Forces to transform</span>
<span class="sd">        inplace : bool (optional)</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input `force` is modified in place and also returned.</span>
<span class="sd">        In-place operations improve performance because allocating new arrays</span>
<span class="sd">        is avoided.</span>


<span class="sd">        .. versionadded:: 0.7.7</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;force&#39;</span><span class="p">,</span> <span class="s1">&#39;kJ/(mol*Angstrom)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">force</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">force</span>
        <span class="n">force</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">force</span></div>


<div class="viewcode-block" id="IOBase.convert_time_to_native">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.convert_time_to_native">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_time_to_native</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert time *t* from base units to native units.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : array_like</span>
<span class="sd">          Time values to transform</span>
<span class="sd">        inplace : bool, optional</span>
<span class="sd">          Whether to modify the array inplace, overwriting previous data</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        By default, the input *t* is modified in place and also</span>
<span class="sd">        returned. (Also note that scalar values *t* are passed by</span>
<span class="sd">        value in Python and hence an in-place modification has no</span>
<span class="sd">        effect on the caller.)</span>

<span class="sd">        .. versionchanged:: 0.7.5</span>
<span class="sd">           Keyword *inplace* can be set to ``False`` so that a</span>
<span class="sd">           modified copy is returned *unless* no conversion takes</span>
<span class="sd">           place, in which case the reference to the unmodified *x* is</span>
<span class="sd">           returned.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">get_conversion_factor</span><span class="p">(</span>
            <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">t</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">t</span> <span class="o">*=</span> <span class="n">f</span>
        <span class="k">return</span> <span class="n">t</span></div>


<div class="viewcode-block" id="IOBase.close">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.IOBase.close">[docs]</a>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Close the trajectory file.&quot;&quot;&quot;</span>
        <span class="k">pass</span> <span class="c1"># pylint: disable=unnecessary-pass</span></div>


    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">exc_tb</span><span class="p">):</span>
        <span class="c1"># see http://docs.python.org/2/library/stdtypes.html#typecontextmanager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># do not suppress exceptions</span></div>



<span class="k">class</span> <span class="nc">_Readermeta</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Automatic Reader registration metaclass</span>

<span class="sd">    .. versionchanged:: 1.0.0</span>
<span class="sd">       Added _format_hint functionality</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Auto register upon class creation</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classdict</span><span class="p">):</span>
        <span class="nb">type</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classdict</span><span class="p">)</span>  <span class="c1"># pylint: disable=non-parent-init-called</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">asiterable</span><span class="p">(</span><span class="n">classdict</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">fmt_name</span> <span class="ow">in</span> <span class="n">fmt</span><span class="p">:</span>
                <span class="n">fmt_name</span> <span class="o">=</span> <span class="n">fmt_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="n">_READERS</span><span class="p">[</span><span class="n">fmt_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>

                <span class="k">if</span> <span class="s1">&#39;_format_hint&#39;</span> <span class="ow">in</span> <span class="n">classdict</span><span class="p">:</span>
                    <span class="c1"># isn&#39;t bound yet, so access __func__</span>
                    <span class="n">_READER_HINTS</span><span class="p">[</span><span class="n">fmt_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">classdict</span><span class="p">[</span><span class="s1">&#39;_format_hint&#39;</span><span class="p">]</span><span class="o">.</span><span class="vm">__func__</span>


<div class="viewcode-block" id="ProtoReader">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader">[docs]</a>
<span class="k">class</span> <span class="nc">ProtoReader</span><span class="p">(</span><span class="n">IOBase</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_Readermeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for Readers, without a :meth:`__del__` method.</span>

<span class="sd">    Extends :class:`IOBase` with most attributes and methods of a generic</span>
<span class="sd">    Reader, with the exception of a :meth:`__del__` method. It should be used</span>
<span class="sd">    as base for Readers that do not need :meth:`__del__`, especially since</span>
<span class="sd">    having even an empty :meth:`__del__` might lead to memory leaks.</span>

<span class="sd">    See the :ref:`Trajectory API` definition in</span>
<span class="sd">    :mod:`MDAnalysis.coordinates.__init__` for the required attributes and</span>
<span class="sd">    methods.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`ReaderBase`</span>


<span class="sd">    .. versionchanged:: 0.11.0</span>
<span class="sd">       Frames now 0-based instead of 1-based</span>
<span class="sd">    .. versionchanged:: 2.0.0</span>
<span class="sd">       Now supports (un)pickle. Upon unpickling,</span>
<span class="sd">       the current timestep is retained by reconstrunction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: The appropriate Timestep class, e.g.</span>
    <span class="c1">#: :class:`MDAnalysis.coordinates.xdrfile.XTC.Timestep` for XTC.</span>
    <span class="n">_Timestep</span> <span class="o">=</span> <span class="n">Timestep</span>
    <span class="n">_transformations</span><span class="p">:</span> <span class="nb">list</span>
    <span class="n">_auxs</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="n">_filename</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">n_frames</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># initialise list to store added auxiliary readers in</span>
        <span class="c1"># subclasses should now call super</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transformations</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span>

<div class="viewcode-block" id="ProtoReader.parse_n_atoms">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.parse_n_atoms">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse_n_atoms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read the coordinate file and deduce the number of atoms</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n_atoms : int</span>
<span class="sd">          the number of atoms in the coordinate file</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">          when the number of atoms can&#39;t be deduced</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> cannot deduce the number of atoms&quot;</span>
                                  <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>


<div class="viewcode-block" id="ProtoReader.next">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.next">[docs]</a>
    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timestep</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward one step to next frame.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_next_timestep</span><span class="p">()</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">EOFError</span><span class="p">,</span> <span class="ne">IOError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rewind</span><span class="p">()</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span> <span class="kn">from</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">reader</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="p">[</span><span class="n">auxname</span><span class="p">]</span><span class="o">.</span><span class="n">update_ts</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

            <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_transformations</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ts</span></div>


    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timestep</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward one step to next frame when using the `next` builtin.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<div class="viewcode-block" id="ProtoReader.rewind">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.rewind">[docs]</a>
    <span class="k">def</span> <span class="nf">rewind</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timestep</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Position at beginning of trajectory&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reopen</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dt</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time between two trajectory frames in picoseconds.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">dt</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">totaltime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Total length of the trajectory</span>

<span class="sd">        The time is calculated as ``(n_frames - 1) * dt``, i.e., we assume that</span>
<span class="sd">        the first frame no time as elapsed. Thus, a trajectory with two frames will</span>
<span class="sd">        be considered to have a length of a single time step `dt` and a</span>
<span class="sd">        &quot;trajectory&quot; with a single frame will be reported as length 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Frame number of the current time step.</span>

<span class="sd">        This is a simple short cut to :attr:`Timestep.frame`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">frame</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time of the current frame in MDAnalysis time units (typically ps).</span>

<span class="sd">        This is either read straight from the Timestep, or calculated as</span>
<span class="sd">        time = :attr:`Timestep.frame` * :attr:`Timestep.dt`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">time</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Makes a reader effectively commpatible with a FrameIteratorBase</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="ProtoReader.Writer">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.Writer">[docs]</a>
    <span class="k">def</span> <span class="nf">Writer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A trajectory writer with the same properties as this trajectory.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Sorry, there is no Writer for this format in MDAnalysis. &quot;</span>
            <span class="s2">&quot;Please file an enhancement request at &quot;</span>
            <span class="s2">&quot;https://github.com/MDAnalysis/mdanalysis/issues&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProtoReader.OtherWriter">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.OtherWriter">[docs]</a>
    <span class="k">def</span> <span class="nf">OtherWriter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a writer appropriate for *filename*.</span>

<span class="sd">        Sets the default keywords *start*, *step* and *dt* (if</span>
<span class="sd">        available). *n_atoms* is always set from :attr:`Reader.n_atoms`.</span>


<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`Reader.Writer` and :func:`MDAnalysis.Writer`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n_atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>  <span class="c1"># essential</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">_read_next_timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Example from DCDReader:</span>
        <span class="c1">#     if ts is None:</span>
        <span class="c1">#         ts = self.ts</span>
        <span class="c1">#     ts.frame = self._read_next_frame(etc)</span>
        <span class="c1">#     return ts</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Iterate over trajectory frames. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reopen</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">_reopen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Should position Reader to just before first frame</span>

<span class="sd">        Calling next after this should return the first frame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span> <span class="c1"># pylint: disable=unnecessary-pass</span>

    <span class="k">def</span> <span class="nf">_apply_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">frame</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">frame</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Index </span><span class="si">{}</span><span class="s2"> exceeds length of trajectory (</span><span class="si">{}</span><span class="s2">).&quot;</span>
                             <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">frame</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Timestep corresponding to *frame*.</span>

<span class="sd">        If `frame` is a integer then the corresponding frame is</span>
<span class="sd">        returned. Negative numbers are counted from the end.</span>

<span class="sd">        If frame is a :class:`slice` then an iterator is returned that</span>
<span class="sd">        allows iteration over that part of the trajectory.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        *frame* is a 0-based frame index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_limits</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_frame_with_aux</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)):</span>
                <span class="c1"># Avoid having list of bools</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
                <span class="c1"># Convert bool array to int array</span>
                <span class="n">frame</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))[</span><span class="n">frame</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">FrameIteratorIndices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_slice_indices</span><span class="p">(</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">stop</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">and</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">FrameIteratorAll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">FrameIteratorSliced</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Trajectories must be an indexed using an integer,&quot;</span>
                            <span class="s2">&quot; slice or list of indices&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move to *frame* and fill timestep with data.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> does not support direct frame indexing.&quot;</span>
                        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="c1"># Example implementation in the DCDReader:</span>
        <span class="c1"># self._jump_to_frame(frame)</span>
        <span class="c1"># ts = self.ts</span>
        <span class="c1"># ts.frame = self._read_next_frame(ts._x, ts._y, ts._z,</span>
        <span class="c1">#                                  ts.dimensions, 1)</span>
        <span class="c1"># return ts</span>

    <span class="k">def</span> <span class="nf">_read_frame_with_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move to *frame*, updating ts with trajectory, transformations and auxiliary data.&quot;&quot;&quot;</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>  <span class="c1"># pylint: disable=assignment-from-no-return</span>
        <span class="k">for</span> <span class="n">aux</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_list</span><span class="p">:</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="p">[</span><span class="n">aux</span><span class="p">]</span><span class="o">.</span><span class="n">update_ts</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_transformations</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ts</span>

    <span class="k">def</span> <span class="nf">_sliced_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator for slicing a trajectory.</span>

<span class="sd">        *start* *stop* and *step* are 3 integers describing the slice.</span>
<span class="sd">        Error checking is not done past this point.</span>

<span class="sd">        A :exc:`NotImplementedError` is raised if random access to</span>
<span class="sd">        frames is not implemented.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># override with an appropriate implementation e.g. using self[i] might</span>
        <span class="c1"># be much slower than skipping steps in a next() loop</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_frame_with_aux</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rewind</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># if _read_frame not implemented</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> does not support slicing.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>

<div class="viewcode-block" id="ProtoReader.check_slice_indices">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.check_slice_indices">[docs]</a>
    <span class="k">def</span> <span class="nf">check_slice_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check frame indices are valid and clip to fit trajectory.</span>

<span class="sd">        The usage follows standard Python conventions for :func:`range` but see</span>
<span class="sd">        the warning below.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start : int or None</span>
<span class="sd">          Starting frame index (inclusive). ``None`` corresponds to the default</span>
<span class="sd">          of 0, i.e., the initial frame.</span>
<span class="sd">        stop : int or None</span>
<span class="sd">          Last frame index (exclusive). ``None`` corresponds to the default</span>
<span class="sd">          of n_frames, i.e., it includes the last frame of the trajectory.</span>
<span class="sd">        step : int or None</span>
<span class="sd">          step size of the slice, ``None`` corresponds to the default of 1, i.e,</span>
<span class="sd">          include every frame in the range `start`, `stop`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        start, stop, step : tuple (int, int, int)</span>
<span class="sd">          Integers representing the slice</span>

<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        The returned values `start`, `stop` and `step` give the expected result</span>
<span class="sd">        when passed in :func:`range` but gives unexpected behavior when passed</span>
<span class="sd">        in a :class:`slice` when ``stop=None`` and ``step=-1``</span>

<span class="sd">        This can be a problem for downstream processing of the output from this</span>
<span class="sd">        method. For example, slicing of trajectories is implemented by passing</span>
<span class="sd">        the values returned by :meth:`check_slice_indices` to :func:`range` ::</span>

<span class="sd">          range(start, stop, step)</span>

<span class="sd">        and using them as the indices to randomly seek to. On the other hand,</span>
<span class="sd">        in :class:`MDAnalysis.analysis.base.AnalysisBase` the values returned</span>
<span class="sd">        by :meth:`check_slice_indices` are used to splice the trajectory by</span>
<span class="sd">        creating a :class:`slice` instance ::</span>

<span class="sd">          slice(start, stop, step)</span>

<span class="sd">        This creates a discrepancy because these two lines are not equivalent::</span>

<span class="sd">            range(10, -1, -1)             # [10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0]</span>
<span class="sd">            range(10)[slice(10, -1, -1)]  # []</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">slice_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">:</span> <span class="n">stop</span><span class="p">,</span> <span class="s1">&#39;step&#39;</span><span class="p">:</span> <span class="n">step</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">varname</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">slice_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>
                <span class="n">slice_dict</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">var</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> is not an integer&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">varname</span><span class="p">))</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">slice_dict</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">slice_dict</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">slice_dict</span><span class="p">[</span><span class="s1">&#39;step&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Step size is zero&quot;</span><span class="p">)</span>

        <span class="n">nframes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">nframes</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">+=</span> <span class="n">nframes</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">&gt;=</span> <span class="n">nframes</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">nframes</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">nframes</span> <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">stop</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">+=</span> <span class="n">nframes</span>

        <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">stop</span> <span class="o">&gt;</span> <span class="n">nframes</span><span class="p">:</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">nframes</span>

        <span class="k">return</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span></div>


    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;&lt;</span><span class="si">{cls}</span><span class="s2"> </span><span class="si">{fname}</span><span class="s2"> with </span><span class="si">{nframes}</span><span class="s2"> frames of </span><span class="si">{natoms}</span><span class="s2"> atoms&gt;&quot;</span>
                <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">fname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span>
            <span class="n">nframes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">,</span>
            <span class="n">natoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>
        <span class="p">))</span>

<div class="viewcode-block" id="ProtoReader.timeseries">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.timeseries">[docs]</a>
    <span class="k">def</span> <span class="nf">timeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;AtomGroup&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">atomgroup</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;Atomgroup&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">step</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">order</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;fac&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a subset of coordinate data for an AtomGroup</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        asel : AtomGroup (optional)</span>
<span class="sd">            The :class:`~MDAnalysis.core.groups.AtomGroup` to read the</span>
<span class="sd">            coordinates from. Defaults to ``None``, in which case the full set</span>
<span class="sd">            of coordinate data is returned.</span>

<span class="sd">            .. deprecated:: 2.7.0</span>
<span class="sd">                asel argument will be renamed to atomgroup in 3.0.0</span>

<span class="sd">        atomgroup: AtomGroup (optional)</span>
<span class="sd">            Same as `asel`, will replace `asel` in 3.0.0</span>
<span class="sd">        start :  int (optional)</span>
<span class="sd">            Begin reading the trajectory at frame index `start` (where 0 is the</span>
<span class="sd">            index of the first frame in the trajectory); the default</span>
<span class="sd">            ``None`` starts at the beginning.</span>
<span class="sd">        stop : int (optional)</span>
<span class="sd">            End reading the trajectory at frame index `stop`-1, i.e, `stop` is</span>
<span class="sd">            excluded. The trajectory is read to the end with the default</span>
<span class="sd">            ``None``.</span>
<span class="sd">        step : int (optional)</span>
<span class="sd">            Step size for reading; the default ``None`` is equivalent to 1 and</span>
<span class="sd">            means to read every frame.</span>
<span class="sd">        order : str (optional)</span>
<span class="sd">            the order/shape of the return data array, corresponding</span>
<span class="sd">            to (a)tom, (f)rame, (c)oordinates all six combinations</span>
<span class="sd">            of &#39;a&#39;, &#39;f&#39;, &#39;c&#39; are allowed ie &quot;fac&quot; - return array</span>
<span class="sd">            where the shape is (frame, number of atoms,</span>
<span class="sd">            coordinates)</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :class:`MDAnalysis.coordinates.memory`</span>


<span class="sd">        .. versionadded:: 2.4.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">asel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;asel argument to timeseries will be renamed to&quot;</span>
                <span class="s2">&quot;&#39;atomgroup&#39; in 3.0, see #3911&quot;</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">atomgroup</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot provide both asel and atomgroup kwargs&quot;</span><span class="p">)</span>
            <span class="n">atomgroup</span> <span class="o">=</span> <span class="n">asel</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_slice_indices</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="n">nframes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">atomgroup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atomgroup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Timeseries requires at least one atom to analyze&quot;</span><span class="p">)</span>
            <span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">atomgroup</span><span class="o">.</span><span class="n">indices</span>
            <span class="n">natoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_numbers</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>
            <span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">natoms</span><span class="p">)</span>

        <span class="c1"># allocate output array in &#39;fac&#39; order</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nframes</span><span class="p">,</span> <span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">:</span><span class="n">step</span><span class="p">]):</span>
            <span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">atom_numbers</span><span class="p">]</span>

        <span class="c1"># switch axes around</span>
        <span class="n">default_order</span> <span class="o">=</span> <span class="s1">&#39;fac&#39;</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">!=</span> <span class="n">default_order</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">newidx</span> <span class="o">=</span> <span class="p">[</span><span class="n">default_order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized order key in </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">, &quot;</span>
                                 <span class="s2">&quot;must be permutation of &#39;fac&#39;&quot;</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">newidx</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Repeated or missing keys passed to argument &quot;</span>
                          <span class="sa">f</span><span class="s2">&quot;`order`: </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">, each key must be used once&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coordinates</span></div>


<span class="c1"># TODO: Change order of aux_spec and auxdata for 3.0 release, cf. Issue #3811</span>
<div class="viewcode-block" id="ProtoReader.add_auxiliary">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.add_auxiliary">[docs]</a>
    <span class="k">def</span> <span class="nf">add_auxiliary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">aux_spec</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">auxdata</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AuxReader</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add auxiliary data to be read alongside trajectory.</span>

<span class="sd">        Auxiliary data may be any data timeseries from the trajectory</span>
<span class="sd">        additional to that read in by the trajectory reader. *auxdata* can</span>
<span class="sd">        be an :class:`~MDAnalysis.auxiliary.base.AuxReader` instance, or the</span>
<span class="sd">        data itself as e.g. a filename; in the latter case an appropriate</span>
<span class="sd">        :class:`~MDAnalysis.auxiliary.base.AuxReader` is guessed from the</span>
<span class="sd">        data/file format. An appropriate `format` may also be directly provided</span>
<span class="sd">        as a key word argument.</span>

<span class="sd">        On adding, the AuxReader is initially matched to the current timestep</span>
<span class="sd">        of the trajectory, and will be updated when the trajectory timestep</span>
<span class="sd">        changes (through a call to :meth:`next()` or jumping timesteps with</span>
<span class="sd">        ``trajectory[i]``).</span>

<span class="sd">        The representative value(s) of the auxiliary data for each timestep (as</span>
<span class="sd">        calculated by the :class:`~MDAnalysis.auxiliary.base.AuxReader`) are</span>
<span class="sd">        stored in the current timestep in the ``ts.aux`` namespace under</span>
<span class="sd">        *aux_spec*; e.g. to add additional pull force data stored in</span>
<span class="sd">        pull-force.xvg::</span>

<span class="sd">            u = MDAnalysis.Universe(PDB, XTC)</span>
<span class="sd">            u.trajectory.add_auxiliary(&#39;pull&#39;, &#39;pull-force.xvg&#39;)</span>

<span class="sd">        The representative value for the current timestep may then be accessed</span>
<span class="sd">        as ``u.trajectory.ts.aux.pull`` or ``u.trajectory.ts.aux[&#39;pull&#39;]``.</span>


<span class="sd">        The following applies to energy readers like the</span>
<span class="sd">        :class:`~MDAnalysis.auxiliary.EDR.EDRReader`.</span>

<span class="sd">        All data that is present in the (energy) file can be added by omitting</span>
<span class="sd">        `aux_spec` like so::</span>

<span class="sd">            u.trajectory.add_auxiliary(auxdata=&quot;ener.edr&quot;)</span>

<span class="sd">        *aux_spec* is expected to be a dictionary that maps the desired</span>
<span class="sd">        attribute name in the ``ts.aux`` namespace to the precise data to be</span>
<span class="sd">        added as identified by a :attr:`data_selector`::</span>

<span class="sd">            term_dict = {&quot;temp&quot;: &quot;Temperature&quot;, &quot;epot&quot;: &quot;Potential&quot;}</span>
<span class="sd">            u.trajectory.add_auxiliary(term_dict, &quot;ener.edr&quot;)</span>

<span class="sd">        Adding this data can be useful, for example, to filter trajectory</span>
<span class="sd">        frames based on non-coordinate data like the potential energy of each</span>
<span class="sd">        time step. Trajectory slicing allows working on a subset of frames::</span>

<span class="sd">            selected_frames = np.array([ts.frame for ts in u.trajectory</span>
<span class="sd">                                        if ts.aux.epot &lt; some_threshold])</span>
<span class="sd">            subset = u.trajectory[selected_frames]</span>


<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`remove_auxiliary`</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Auxiliary data is assumed to be time-ordered, with no duplicates. See</span>
<span class="sd">        the :ref:`Auxiliary API`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auxdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No input `auxdata` specified, but it needs &quot;</span>
                             <span class="s2">&quot;to be provided.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">auxdata</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">_AUXREADERS</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="c1"># i.e. if auxdata is a file, not an instance of an AuxReader</span>
            <span class="n">reader_type</span> <span class="o">=</span> <span class="n">get_auxreader_for</span><span class="p">(</span><span class="n">auxdata</span><span class="p">)</span>
            <span class="n">auxreader</span> <span class="o">=</span> <span class="n">reader_type</span><span class="p">(</span><span class="n">auxdata</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">auxreader</span> <span class="o">=</span> <span class="n">auxdata</span>
        <span class="n">auxreader</span><span class="o">.</span><span class="n">attach_auxiliary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aux_spec</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProtoReader.remove_auxiliary">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.remove_auxiliary">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_auxiliary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear data and close the :class:`~MDAnalysis.auxiliary.base.AuxReader`</span>
<span class="sd">        for the auxiliary *auxname*.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`add_auxiliary`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">del</span> <span class="n">aux</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">auxname</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aux_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Lists the names of added auxiliary data. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_check_for_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Check for the existance of an auxiliary *auxname*. If present,</span>
<span class="sd">        return the AuxReader; if not, raise ValueError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auxname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="p">[</span><span class="n">auxname</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No auxiliary named </span><span class="si">{name}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">auxname</span><span class="p">))</span>

<div class="viewcode-block" id="ProtoReader.next_as_aux">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.next_as_aux">[docs]</a>
    <span class="k">def</span> <span class="nf">next_as_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Move to the next timestep for which there is at least one step from</span>
<span class="sd">        the auxiliary *auxname* within the cutoff specified in *auxname*.</span>

<span class="sd">        This allows progression through the trajectory without encountering</span>
<span class="sd">        ``NaN`` representative values (unless these are specifically part of the</span>
<span class="sd">        auxiliary data).</span>

<span class="sd">        If the auxiliary cutoff is not set, where auxiliary steps are less frequent</span>
<span class="sd">        (``auxiliary.dt &gt; trajectory.dt``), this allows progression at the</span>
<span class="sd">        auxiliary pace (rounded to nearest timestep); while if the auxiliary</span>
<span class="sd">        steps are more frequent, this will work the same as calling</span>
<span class="sd">        :meth:`next()`.</span>

<span class="sd">        See the :ref:`Auxiliary API`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`iter_as_aux`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span>
        <span class="c1"># catch up auxiliary if it starts earlier than trajectory</span>
        <span class="k">while</span> <span class="n">aux</span><span class="o">.</span><span class="n">step_to_frame</span><span class="p">(</span><span class="n">aux</span><span class="o">.</span><span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">aux</span><span class="p">)</span>
        <span class="c1"># find the next frame that&#39;ll have a representative value</span>
        <span class="n">next_frame</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">next_nonempty_frame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">next_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># no more frames with corresponding auxiliary values; stop iteration</span>
            <span class="k">raise</span> <span class="ne">StopIteration</span>
        <span class="c1"># some readers set self._frame to -1, rather than self.frame, on</span>
        <span class="c1"># _reopen; catch here or doesn&#39;t read first frame</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">!=</span> <span class="n">next_frame</span> <span class="ow">or</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_frame&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1"># iterate trajectory until frame is reached</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ts</span></div>


<div class="viewcode-block" id="ProtoReader.iter_as_aux">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.iter_as_aux">[docs]</a>
    <span class="k">def</span> <span class="nf">iter_as_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate through timesteps for which there is at least one assigned</span>
<span class="sd">        step from the auxiliary *auxname* within the cutoff specified in *auxname*.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`next_as_aux`</span>
<span class="sd">        :meth:`iter_auxiliary`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reopen</span><span class="p">()</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">_restart</span><span class="p">()</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_as_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">return</span></div>


<div class="viewcode-block" id="ProtoReader.iter_auxiliary">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.iter_auxiliary">[docs]</a>
    <span class="k">def</span> <span class="nf">iter_auxiliary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">selected</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Iterate through the auxiliary *auxname* independently of the trajectory.</span>

<span class="sd">        Will iterate over the specified steps of the auxiliary (defaults to all</span>
<span class="sd">        steps). Allows to access all values in an auxiliary, including those out</span>
<span class="sd">        of the time range of the trajectory, without having to also iterate</span>
<span class="sd">        through the trajectory.</span>

<span class="sd">        After interation, the auxiliary will be repositioned at the current step.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auxname : str</span>
<span class="sd">            Name of the auxiliary to iterate over.</span>
<span class="sd">        (start, stop, step) : optional</span>
<span class="sd">            Options for iterating over a slice of the auxiliary.</span>
<span class="sd">        selected : lst | ndarray, optional</span>
<span class="sd">            List of steps to iterate over.</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        :class:`~MDAnalysis.auxiliary.base.AuxStep` object</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`iter_as_aux`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selected</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="n">selected</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selection</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">aux</span><span class="p">[</span><span class="n">selection</span><span class="p">]:</span>
            <span class="k">yield</span> <span class="n">i</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">read_ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProtoReader.get_aux_attribute">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.get_aux_attribute">[docs]</a>
    <span class="k">def</span> <span class="nf">get_aux_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">attrname</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the value of *attrname* from the auxiliary *auxname*</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auxname : str</span>
<span class="sd">            Name of the auxiliary to get value for</span>
<span class="sd">        attrname : str</span>
<span class="sd">            Name of gettable attribute in the auxiliary reader</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`set_aux_attribute`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">attrname</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProtoReader.set_aux_attribute">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.set_aux_attribute">[docs]</a>
    <span class="k">def</span> <span class="nf">set_aux_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">attrname</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Set the value of *attrname* in the auxiliary *auxname*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auxname : str</span>
<span class="sd">            Name of the auxiliary to alter</span>
<span class="sd">        attrname : str</span>
<span class="sd">            Name of settable attribute in the auxiliary reader</span>
<span class="sd">        new</span>
<span class="sd">            New value to try set *attrname* to</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`get_aux_attribute`</span>
<span class="sd">        :meth:`rename_aux` - to change the *auxname* attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrname</span> <span class="o">==</span> <span class="s1">&#39;auxname&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rename_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">attrname</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProtoReader.rename_aux">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.rename_aux">[docs]</a>
    <span class="k">def</span> <span class="nf">rename_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Change the name of the auxiliary *auxname* to *new*.</span>

<span class="sd">        Provided there is not already an auxiliary named *new*, the auxiliary</span>
<span class="sd">        name will be changed in ts.aux namespace, the trajectory&#39;s</span>
<span class="sd">        list of added auxiliaries, and in the auxiliary reader itself.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        auxname : str</span>
<span class="sd">             Name of the auxiliary to rename</span>
<span class="sd">        new : str</span>
<span class="sd">             New name to try set</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">             If the name *new* is already in use by an existing auxiliary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_aux</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_list</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Auxiliary data with name </span><span class="si">{name}</span><span class="s2"> already &quot;</span>
                             <span class="s2">&quot;exists&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">new</span><span class="p">))</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">auxname</span> <span class="o">=</span> <span class="n">new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="p">[</span><span class="n">new</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">auxname</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="p">[</span><span class="n">auxname</span><span class="p">])</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">auxname</span><span class="p">)</span></div>


<div class="viewcode-block" id="ProtoReader.get_aux_descriptions">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.get_aux_descriptions">[docs]</a>
    <span class="k">def</span> <span class="nf">get_aux_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auxnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get descriptions to allow reloading the specified auxiliaries.</span>

<span class="sd">        If no auxnames are provided, defaults to the full list of added</span>
<span class="sd">        auxiliaries.</span>

<span class="sd">        Passing the resultant description to ``add_auxiliary()`` will allow</span>
<span class="sd">        recreation of the auxiliary. e.g., to duplicate all auxiliaries into a</span>
<span class="sd">        second trajectory::</span>

<span class="sd">           descriptions = trajectory_1.get_aux_descriptions()</span>
<span class="sd">           for aux in descriptions:</span>
<span class="sd">               trajectory_2.add_auxiliary(**aux)</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            List of dictionaries of the args/kwargs describing each auxiliary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :meth:`MDAnalysis.auxiliary.base.AuxReader.get_description`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auxnames</span><span class="p">:</span>
            <span class="n">auxnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_list</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="p">[</span><span class="n">aux</span><span class="p">]</span><span class="o">.</span><span class="n">get_description</span><span class="p">()</span> <span class="k">for</span> <span class="n">aux</span> <span class="ow">in</span> <span class="n">auxnames</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">descriptions</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Returns the list of transformations&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformations</span>

    <span class="nd">@transformations</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transformations</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transformations</span> <span class="o">=</span> <span class="n">transformations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Transformations are already set&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="ProtoReader.add_transformations">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ProtoReader.add_transformations">[docs]</a>
    <span class="k">def</span> <span class="nf">add_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">transformations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add all transformations to be applied to the trajectory.</span>

<span class="sd">        This function take as list of transformations as an argument. These</span>
<span class="sd">        transformations are functions that will be called by the Reader and given</span>
<span class="sd">        a :class:`Timestep` object as argument, which will be transformed and returned</span>
<span class="sd">        to the Reader.</span>
<span class="sd">        The transformations can be part of the :mod:`~MDAnalysis.transformations`</span>
<span class="sd">        module, or created by the user, and are stored as a list `transformations`.</span>
<span class="sd">        This list can only be modified once, and further calls of this function will</span>
<span class="sd">        raise an exception.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">          u = MDAnalysis.Universe(topology, coordinates)</span>
<span class="sd">          workflow = [some_transform, another_transform, this_transform]</span>
<span class="sd">          u.trajectory.add_transformations(*workflow)</span>

<span class="sd">        The transformations are applied in the order given in the list</span>
<span class="sd">        `transformations`, i.e., the first transformation is the first</span>
<span class="sd">        or innermost one to be applied to the :class:`Timestep`. The</span>
<span class="sd">        example above would be equivalent to</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">          for ts in u.trajectory:</span>
<span class="sd">             ts = this_transform(another_transform(some_transform(ts)))</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transform_list : list</span>
<span class="sd">            list of all the transformations that will be applied to the coordinates</span>
<span class="sd">            in the order given in the list</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :mod:`MDAnalysis.transformations`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span> <span class="o">=</span> <span class="n">transformations</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">errmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Can&#39;t add transformations again. Please create a new &quot;</span>
                      <span class="s2">&quot;Universe object&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_transformations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="p">)</span></div>



        <span class="c1"># call reader here to apply the newly added transformation on the</span>
        <span class="c1"># current loaded frame?</span>

    <span class="k">def</span> <span class="nf">_apply_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies all the transformations given by the user &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ts</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span></div>



<div class="viewcode-block" id="ReaderBase">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ReaderBase">[docs]</a>
<span class="k">class</span> <span class="nc">ReaderBase</span><span class="p">(</span><span class="n">ProtoReader</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for trajectory readers that extends :class:`ProtoReader` with a</span>
<span class="sd">    :meth:`__del__` method.</span>

<span class="sd">    New Readers should subclass :class:`ReaderBase` and properly implement a</span>
<span class="sd">    :meth:`close` method, to ensure proper release of resources (mainly file</span>
<span class="sd">    handles). Readers that are inherently safe in this regard should subclass</span>
<span class="sd">    :class:`ProtoReader` instead.</span>

<span class="sd">    See the :ref:`Trajectory API` definition in for the required attributes and</span>
<span class="sd">    methods.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`ProtoReader`</span>


<span class="sd">    .. versionchanged:: 0.11.0</span>
<span class="sd">       Most of the base Reader class definitions were offloaded to</span>
<span class="sd">       :class:`ProtoReader` so as to allow the subclassing of ReaderBases without a</span>
<span class="sd">       :meth:`__del__` method.  Created init method to create common</span>
<span class="sd">       functionality, all ReaderBase subclasses must now :func:`super` through this</span>
<span class="sd">       class.  Added attribute :attr:`_ts_kwargs`, which is created in init.</span>
<span class="sd">       Provides kwargs to be passed to :class:`Timestep`</span>
<span class="sd">    .. versionchanged:: 1.0</span>
<span class="sd">       Removed deprecated flags functionality, use convert_units kwarg instead</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@store_init_arguments</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">convert_units</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ReaderBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">NamedStream</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_units</span> <span class="o">=</span> <span class="n">convert_units</span>

        <span class="n">ts_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;time_offset&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">att</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ts_kwargs</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ts_kwargs</span> <span class="o">=</span> <span class="n">ts_kwargs</span>

<div class="viewcode-block" id="ReaderBase.copy">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ReaderBase.copy">[docs]</a>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return independent copy of this Reader.</span>

<span class="sd">        New Reader will have its own file handle and can seek/iterate</span>
<span class="sd">        independently of the original.</span>

<span class="sd">        Will also copy the current state of the Timestep held in the original</span>
<span class="sd">        Reader.</span>


<span class="sd">        .. versionchanged:: 2.2.0</span>
<span class="sd">           Arguments used to construct the reader are correctly captured and</span>
<span class="sd">           passed to the creation of the new class. Previously the only</span>
<span class="sd">           ``n_atoms`` was passed to class copies, leading to a class created</span>
<span class="sd">           with default parameters which may differ from the original class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="n">new</span><span class="o">.</span><span class="n">add_transformations</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">)</span>
        <span class="c1"># seek the new reader to the same frame we started with</span>
        <span class="n">new</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>
        <span class="c1"># then copy over the current Timestep in case it has</span>
        <span class="c1"># been modified since initial load</span>
        <span class="n">new</span><span class="o">.</span><span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">auxread</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">auxname</span><span class="p">,</span> <span class="n">auxread</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">new</span></div>


    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">aux</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="p">[</span><span class="n">aux</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<span class="k">class</span> <span class="nc">_Writermeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="c1"># Auto register this format upon class creation</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classdict</span><span class="p">):</span>
        <span class="nb">type</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classdict</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># grab the string which describes this format</span>
            <span class="c1"># could be either &#39;PDB&#39; or [&#39;PDB&#39;, &#39;ENT&#39;] for multiple formats</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">asiterable</span><span class="p">(</span><span class="n">classdict</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># not required however</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># does the Writer support single and multiframe writing?</span>
            <span class="n">single</span> <span class="o">=</span> <span class="n">classdict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;singleframe&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">multi</span> <span class="o">=</span> <span class="n">classdict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;multiframe&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">single</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fmt</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                    <span class="n">_SINGLEFRAME_WRITERS</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
            <span class="k">if</span> <span class="n">multi</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fmt</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                    <span class="n">_MULTIFRAME_WRITERS</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>


<div class="viewcode-block" id="WriterBase">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.WriterBase">[docs]</a>
<span class="k">class</span> <span class="nc">WriterBase</span><span class="p">(</span><span class="n">IOBase</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_Writermeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for trajectory writers.</span>

<span class="sd">    See :ref:`Trajectory API` definition in for the required attributes and</span>
<span class="sd">    methods.</span>


<span class="sd">    .. versionchanged:: 2.0.0</span>
<span class="sd">       Deprecated :func:`write_next_timestep` has now been removed, please use</span>
<span class="sd">       :func:`write` instead.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="WriterBase.convert_dimensions_to_unitcell">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.WriterBase.convert_dimensions_to_unitcell">[docs]</a>
    <span class="k">def</span> <span class="nf">convert_dimensions_to_unitcell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read dimensions from timestep *ts* and return appropriate unitcell.</span>

<span class="sd">        The default is to return ``[A,B,C,alpha,beta,gamma]``; if this</span>
<span class="sd">        is not appropriate then this method has to be overriden.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># override if the native trajectory format does NOT use</span>
        <span class="c1"># [A,B,C,alpha,beta,gamma]</span>
        <span class="k">if</span> <span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">lengths</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lengths</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="n">lengths</span> <span class="o">=</span> <span class="n">lengths</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">lengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_pos_to_native</span><span class="p">(</span><span class="n">lengths</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lengths</span><span class="p">,</span> <span class="n">angles</span><span class="p">])</span></div>


<div class="viewcode-block" id="WriterBase.write">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.WriterBase.write">[docs]</a>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write current timestep, using the supplied `obj`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : :class:`~MDAnalysis.core.groups.AtomGroup` or :class:`~MDAnalysis.core.universe.Universe`</span>
<span class="sd">            write coordinate information associate with `obj`</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The size of the `obj` must be the same as the number of atoms provided</span>
<span class="sd">        when setting up the trajectory.</span>


<span class="sd">        .. versionchanged:: 2.0.0</span>
<span class="sd">           Deprecated support for Timestep argument to write has now been</span>
<span class="sd">           removed. Use AtomGroup or Universe as an input instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_next_frame</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&lt; </span><span class="si">{0!s}</span><span class="s2"> </span><span class="si">{1!r}</span><span class="s2"> for </span><span class="si">{2:d}</span><span class="s2"> atoms &gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="c1"># no trajectory loaded yet or a Writer that does not need e.g.</span>
            <span class="c1"># self.n_atoms</span>
            <span class="k">return</span> <span class="s2">&quot;&lt; </span><span class="si">{0!s}</span><span class="s2"> </span><span class="si">{1!r}</span><span class="s2"> &gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

<div class="viewcode-block" id="WriterBase.has_valid_coordinates">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.WriterBase.has_valid_coordinates">[docs]</a>
    <span class="k">def</span> <span class="nf">has_valid_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criteria</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns ``True`` if all values are within limit values of their formats.</span>

<span class="sd">        Due to rounding, the test is asymmetric (and *min* is supposed to be negative)::</span>

<span class="sd">            min &lt; x &lt;= max</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        criteria : dict</span>
<span class="sd">            dictionary containing the *max* and *min* values in native units</span>
<span class="sd">        x : numpy.ndarray</span>
<span class="sd">            ``(x, y, z)`` coordinates of atoms selected to be written out</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">criteria</span><span class="p">[</span><span class="s2">&quot;min&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">criteria</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">])</span></div>
</div>



<div class="viewcode-block" id="SingleFrameReaderBase">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase">[docs]</a>
<span class="k">class</span> <span class="nc">SingleFrameReaderBase</span><span class="p">(</span><span class="n">ProtoReader</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for Readers that only have one frame.</span>

<span class="sd">    To use this base class, define the method :meth:`_read_first_frame` to</span>
<span class="sd">    read from file `self.filename`.  This should populate the attribute</span>
<span class="sd">    `self.ts` with a :class:`Timestep` object.</span>

<span class="sd">    .. versionadded:: 0.10.0</span>
<span class="sd">    .. versionchanged:: 0.11.0</span>
<span class="sd">       Added attribute &quot;_ts_kwargs&quot; for subclasses</span>
<span class="sd">       Keywords &quot;dt&quot; and &quot;time_offset&quot; read into _ts_kwargs</span>
<span class="sd">    .. versionchanged:: 2.2.0</span>
<span class="sd">       Calling `__iter__` now rewinds the reader before yielding a</span>
<span class="sd">       :class:`Timestep` object (fixing behavior that was not</span>
<span class="sd">       well defined previously).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_err</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> only contains a single frame&quot;</span>

    <span class="nd">@store_init_arguments</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">convert_units</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SingleFrameReaderBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">convert_units</span> <span class="o">=</span> <span class="n">convert_units</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_atom</span> <span class="o">=</span> <span class="n">n_atoms</span>

        <span class="n">ts_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;time_offset&#39;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">att</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ts_kwargs</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ts_kwargs</span> <span class="o">=</span> <span class="n">ts_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_first_frame</span><span class="p">()</span>

<div class="viewcode-block" id="SingleFrameReaderBase.copy">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase.copy">[docs]</a>
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return independent copy of this Reader.</span>

<span class="sd">        New Reader will have its own file handle and can seek/iterate</span>
<span class="sd">        independently of the original.</span>

<span class="sd">        Will also copy the current state of the Timestep held in the original</span>
<span class="sd">        Reader.</span>


<span class="sd">        .. versionchanged:: 2.2.0</span>
<span class="sd">           Arguments used to construct the reader are correctly captured and</span>
<span class="sd">           passed to the creation of the new class. Previously the only</span>
<span class="sd">           ``n_atoms`` was passed to class copies, leading to a class created</span>
<span class="sd">           with default parameters which may differ from the original class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>

        <span class="n">new</span><span class="o">.</span><span class="n">ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">auxread</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">new</span><span class="o">.</span><span class="n">add_auxiliary</span><span class="p">(</span><span class="n">auxname</span><span class="p">,</span> <span class="n">auxread</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="c1"># since the transformations have already been applied to the frame</span>
        <span class="c1"># simply copy the property</span>
        <span class="n">new</span><span class="o">.</span><span class="n">transformations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span>

        <span class="k">return</span> <span class="n">new</span></div>


    <span class="k">def</span> <span class="nf">_read_first_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
        <span class="c1"># Override this in subclasses to create and fill a Timestep</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="SingleFrameReaderBase.rewind">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase.rewind">[docs]</a>
    <span class="k">def</span> <span class="nf">rewind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_first_frame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">auxname</span><span class="p">,</span> <span class="n">auxread</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auxs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts</span> <span class="o">=</span> <span class="n">auxread</span><span class="o">.</span><span class="n">update_ts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SingleFrameReaderBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_apply_transformations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_reopen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="SingleFrameReaderBase.next">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase.next">[docs]</a>
    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">StopIteration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span></div>


    <span class="k">def</span> <span class="nf">_read_next_timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rewind</span><span class="p">()</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">_read_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">frame</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_err</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ts</span>

<div class="viewcode-block" id="SingleFrameReaderBase.close">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase.close">[docs]</a>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># all single frame readers should use context managers to access</span>
        <span class="c1"># self.filename. Explicitly setting it to the null action in case</span>
        <span class="c1"># the IOBase.close method is ever changed from that.</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="SingleFrameReaderBase.add_transformations">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase.add_transformations">[docs]</a>
    <span class="k">def</span> <span class="nf">add_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">transformations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Add all transformations to be applied to the trajectory.</span>

<span class="sd">        This function take as list of transformations as an argument. These</span>
<span class="sd">        transformations are functions that will be called by the Reader and given</span>
<span class="sd">        a :class:`Timestep` object as argument, which will be transformed and returned</span>
<span class="sd">        to the Reader.</span>
<span class="sd">        The transformations can be part of the :mod:`~MDAnalysis.transformations`</span>
<span class="sd">        module, or created by the user, and are stored as a list `transformations`.</span>
<span class="sd">        This list can only be modified once, and further calls of this function will</span>
<span class="sd">        raise an exception.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">          u = MDAnalysis.Universe(topology, coordinates)</span>
<span class="sd">          workflow = [some_transform, another_transform, this_transform]</span>
<span class="sd">          u.trajectory.add_transformations(*workflow)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transform_list : list</span>
<span class="sd">            list of all the transformations that will be applied to the coordinates</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        :mod:`MDAnalysis.transformations`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Overrides :meth:`~MDAnalysis.coordinates.base.ProtoReader.add_transformations`</span>
        <span class="c1">#to avoid unintended behaviour where the coordinates of each frame are transformed</span>
        <span class="c1">#multiple times when iterating over the trajectory.</span>
        <span class="c1">#In this method, the trajectory is modified all at once and once only.</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">SingleFrameReaderBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_transformations</span><span class="p">(</span><span class="o">*</span><span class="n">transformations</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ts</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ts</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_apply_transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Applies the transformations to the timestep.&quot;&quot;&quot;</span>
        <span class="c1"># Overrides :meth:`~MDAnalysis.coordinates.base.ProtoReader.add_transformations`</span>
        <span class="c1"># to avoid applying the same transformations multiple times on each frame</span>

        <span class="k">return</span> <span class="n">ts</span></div>



<span class="k">def</span> <span class="nf">range_length</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">step</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">stop</span><span class="p">):</span>
        <span class="c1"># We go from a lesser number to a larger one.</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">stop</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">//</span> <span class="n">step</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">step</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">stop</span><span class="p">):</span>
        <span class="c1"># We count backward from a larger number to a lesser one.</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stop</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="o">-</span><span class="n">step</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The range is empty.</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="c1"># Verbatim copy of code from converters/base.py</span>
<span class="c1"># Needed to avoid circular imports before removal in</span>
<span class="c1"># MDAnalysis 3.0.0</span>
<span class="c1"># Remove in 3.0.0</span>
<span class="k">class</span> <span class="nc">_Convertermeta</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
    <span class="c1"># Auto register upon class creation</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classdict</span><span class="p">):</span>
        <span class="nb">type</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">classdict</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">asiterable</span><span class="p">(</span><span class="n">classdict</span><span class="p">[</span><span class="s1">&#39;lib&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fmt</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="n">_CONVERTERS</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>


<span class="c1"># Verbatim copy of code from converters/base.py</span>
<span class="c1"># Needed to avoid circular imports before removal in</span>
<span class="c1"># MDAnalysis 3.0.0</span>
<span class="c1"># Remove in 3.0.0</span>
<div class="viewcode-block" id="ConverterBase">
<a class="viewcode-back" href="../../../documentation_pages/coordinates/base.html#MDAnalysis.coordinates.base.ConverterBase">[docs]</a>
<span class="k">class</span> <span class="nc">ConverterBase</span><span class="p">(</span><span class="n">IOBase</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">_Convertermeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for converting to other libraries.</span>

<span class="sd">    .. deprecated:: 2.7.0</span>
<span class="sd">        This class has been moved to</span>
<span class="sd">        :class:`MDAnalysis.converters.base.ConverterBase` and will be removed</span>
<span class="sd">        from :mod:`MDAnalysis.coordinates.base` in 3.0.0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">wmsg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;ConverterBase moved from coordinates.base.&quot;</span>
                <span class="s2">&quot;ConverterBase to converters.base.ConverterBase &quot;</span>
                <span class="s2">&quot;and will be removed from coordinates.base &quot;</span>
                <span class="s2">&quot;in MDAnalysis release 3.0.0&quot;</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">wmsg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">{cls}</span><span class="s2">&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2005-2024, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Henok Ademtew, Shobhit Agarwal, Aya M. Alaa, Irfan Alibay, Kazi Shudipto Amin, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Patricio Barletta, Leonardo Barneschi, Jonathan Barnoud, Estefania Barreto-Ojeda, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Kavya Bisht, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Kevin Boyd, Meet Brijwani, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, Yantong Cai, David Caplan, Yuanyu Chang, Pratham Chauhan, Matthieu Chavent, Haochuan Chen, Xu Hong Chen, Kathleen Clark, Jennifer A Clark, Orion Cohen, Charlie Cook, Ruggero Cortini, Nicholas Craven, Ramon Crehuet, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Bradley Dice, Jan Domanski, David L. Dotson, Mark D. Driver, Ali Ehlen, Daniel J. Evans, Shujie Fan, Bjarne Feddersen, Lennard van der Feltz, Jake Fennick, Philip Fowler, Guillaume Fraux, Anirvinya G, Michael Gecht, Ahmed Salah Ghoneim, Mikhail Glagolev, William Glass, Jenna M. Swarthout Goddard, Joseph Goose, Alexander Gorfer, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Pratik Gupta, Sumit Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Edis Jakupovic, Joe Jordan, Henrik Jäger, Uma D Kadam, Aditya Kamath, Jon Kapla, Ian M. Kenney, Aditya Keshari, Haleema Khan, Navya Khare, Utsav Khatu, Andrew William King, Henry Kobin, Abhishek A. Kognole, Kosuke Kudo, Atharva Kulkarni, Manish Kumar, Mohit Kumar, Shubham Kumar, Alia Lescoulie, Zhenbo Li, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Shaivi Malik, Egor Marin, Domenico Marson, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Marcelo C. R. Melo, Dominik &#39;Rathann&#39; Mierzejewski, David Minh, Geongi Moon, Sampurna Mukherjee, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Meghan Osato, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Dimitrios Papageorgiou, Rafael R. Pappalardo, Vishal Parmar, Danny Parton, Shakul Pathak, Christian Pfaendner, Joshua L. Phillips, Marcelo D. Poleto, Hannah Pollak, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Andrea Rizzi, Xiaoxu Ruan, Carlos Yanez S., Utkarsh Saxena, Moritz Schaeffler, Alexander Schlaich, Marcello Sega, Ricky Sexton, Sean L. Seyler, Faraaz Shah, Sulay Shah, Abhishek Shandilya, Shubham Sharma, Rishabh Shukla, Karthikeyan Singaravelan, Tamandeep Singh, Brigitta Sipőcz, Paul Smith, Andy Somogyi, Caio S. Souza, David van der Spoel, Shantanu Srivastava, Lukas Stelzl, Jan Stevens, Gorman Stock, Philipp Stärk, Johannes Stöckelmaier, Fenil Suchak, Ayush Suhane, Filip T. Szczypiński, Sukeerti T, Matthijs Tadema, Joao Miguel Correia Teixeira, Paarth Thadani, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Zaheer Timol, Wiep van der Toorn, Mieczyslaw Torchala, Aditi Tripathi, Heet Vekariya, Mark Verma, Josh Vermaas, Isaac Virshup, Lily Wang, Leon Wehrhan, Nestor Wendt, Lawson Woods, Zhiyi Wu, Tengyu Xie, Zhuyi Xue, Mingyi Xue, Alexander Yang, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Raymond Zhao, Yuxuan Zhuang, and Oliver Beckstein.</p>
  </div>

  

<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        2.8.0-dev0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>