<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.1. Coordinate/Trajectory Readers and Writers — MDAnalysis.coordinates &mdash; MDAnalysis 0.9.2 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.9.2 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.9.2 documentation" href="../../index.html" />
    <link rel="up" title="5. Coordinates modules" href="../coordinates_modules.html" />
    <link rel="next" title="5.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD" href="CRD.html" />
    <link rel="prev" title="5. Coordinates modules" href="../coordinates_modules.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CRD.html" title="5.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../coordinates_modules.html" title="5. Coordinates modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.9.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../coordinates_modules.html" accesskey="U">5. Coordinates modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.1. Coordinate/Trajectory Readers and Writers  &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.coordinates</span></code></a><ul>
<li><a class="reference internal" href="#using-readers">5.1.1. Using Readers</a></li>
<li><a class="reference internal" href="#using-writers">5.1.2. Using Writers</a></li>
<li><a class="reference internal" href="#supported-coordinate-formats">5.1.3. Supported coordinate formats</a></li>
<li><a class="reference internal" href="#trajectory-api">5.1.4. Trajectory API</a><ul>
<li><a class="reference internal" href="#history">5.1.4.1. History</a></li>
<li><a class="reference internal" href="#registry">5.1.4.2. Registry</a></li>
<li><a class="reference internal" href="#timestep-class">5.1.4.3. Timestep class</a><ul>
<li><a class="reference internal" href="#methods">5.1.4.3.1. Methods</a></li>
<li><a class="reference internal" href="#attributes">5.1.4.3.2. Attributes</a></li>
<li><a class="reference internal" href="#private-attributes">5.1.4.3.3. Private attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trajectory-reader-class">5.1.4.4. Trajectory Reader class</a><ul>
<li><a class="reference internal" href="#id11">5.1.4.4.1. Methods</a></li>
<li><a class="reference internal" href="#id12">5.1.4.4.2. Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trajectory-writer-class">5.1.4.5. Trajectory Writer class</a><ul>
<li><a class="reference internal" href="#id13">5.1.4.5.1. Methods</a></li>
<li><a class="reference internal" href="#id14">5.1.4.5.2. Attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#single-frame-writer-class">5.1.4.6. Single Frame Writer class</a><ul>
<li><a class="reference internal" href="#id15">5.1.4.6.1. Methods</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#reader-writer-registry">5.1.5. Reader/Writer registry</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../coordinates_modules.html"
                        title="previous chapter">5. Coordinates modules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="CRD.html"
                        title="next chapter">5.2. CRD structure files in MDAnalysis &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.coordinates.CRD</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/coordinates/init.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.coordinates.__init__"></span><div class="section" id="coordinate-trajectory-readers-and-writers-mdanalysis-coordinates">
<h1>5.1. Coordinate/Trajectory Readers and Writers  &#8212; <code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates</span></code><a class="headerlink" href="#coordinate-trajectory-readers-and-writers-mdanalysis-coordinates" title="Permalink to this headline">¶</a></h1>
<p>The coordinates submodule contains code to read coordinates, either
single frames (e.g. the PDB module) or trajectories (such as the DCD
reader). All readers are supposed to expose a <code class="xref py py-class docutils literal"><span class="pre">Reader</span></code> object
that presents a common <a class="reference internal" href="#trajectory-api">Trajectory API</a> to other code.</p>
<p>The <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> contains the API
entry point attribute</p>
<blockquote>
<div><code class="xref py py-attr docutils literal"><span class="pre">Universe.trajectory</span></code></div></blockquote>
<p>that points to the actual <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Reader" title="MDAnalysis.coordinates.base.Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a>
object; all Readers are supposed to be accessible through this entry
point in the same manner (&#8220;<a class="reference external" href="http://c2.com/cgi/wiki?DuckTyping">duck typing</a>&#8221;).</p>
<p>In order to <strong>write coordinates</strong>, a factory function is provided
(<a class="reference internal" href="core.html#MDAnalysis.coordinates.core.writer" title="MDAnalysis.coordinates.core.writer"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.coordinates.core.writer()</span></code></a>) which is made available
as <code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.Writer()</span></code>) that returns a <em>Writer</em> appropriate for
the desired file format (as indicated by the filename
suffix). Furthermore, a trajectory
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Reader" title="MDAnalysis.coordinates.base.Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a> can also have a method
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Reader.Writer" title="MDAnalysis.coordinates.base.Reader.Writer"><code class="xref py py-meth docutils literal"><span class="pre">Writer()</span></code></a> that returns an
appropriate <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Writer" title="MDAnalysis.coordinates.base.Writer"><code class="xref py py-class docutils literal"><span class="pre">Writer</span></code></a> for the file
format of the trajectory.</p>
<p>In analogy to <a class="reference internal" href="core.html#MDAnalysis.coordinates.core.writer" title="MDAnalysis.coordinates.core.writer"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.coordinates.core.writer()</span></code></a>, there is
also a <a class="reference internal" href="core.html#MDAnalysis.coordinates.core.reader" title="MDAnalysis.coordinates.core.reader"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.coordinates.core.reader()</span></code></a> function available
to return a trajectory <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Reader" title="MDAnalysis.coordinates.base.Reader"><code class="xref py py-class docutils literal"><span class="pre">Reader</span></code></a>
instance although this is often not needed because the
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> class can choose an
appropriate reader automatically.</p>
<div class="section" id="using-readers">
<h2>5.1.1. Using Readers<a class="headerlink" href="#using-readers" title="Permalink to this headline">¶</a></h2>
<p>Normally, one does not explicitly need to select a reader. This is handled
automatically when creating a <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> and
the appropriate reader for the file type is selected (typically by the file
extension but this choice can be overriden with the <code class="docutils literal"><span class="pre">format</span></code> argument to
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>).</p>
</div>
<div class="section" id="using-writers">
<h2>5.1.2. Using Writers<a class="headerlink" href="#using-writers" title="Permalink to this headline">¶</a></h2>
<p>A typical approach is to generate a new trajectory from an old one, e.g. to
only keep the protein:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB</span><span class="p">,</span> <span class="n">XTC</span><span class="p">)</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">selectAtoms</span><span class="p">(</span><span class="s">&quot;protein&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Writer</span><span class="p">(</span><span class="s">&quot;protein.xtc&quot;</span><span class="p">,</span> <span class="n">protein</span><span class="o">.</span><span class="n">numberOfAtoms</span><span class="p">())</span> <span class="k">as</span> <span class="n">W</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
        <span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <code class="xref py py-func docutils literal"><span class="pre">with()</span></code> statement will automatically close the trajectory when
the last frame has been written.</p>
</div>
<div class="section" id="supported-coordinate-formats">
<h2>5.1.3. Supported coordinate formats<a class="headerlink" href="#supported-coordinate-formats" title="Permalink to this headline">¶</a></h2>
<p>The table below lists the coordinate file formats understood by MDAnalysis. The
emphasis is on formats that are used in popular molecular dynamics codes. By
default, MDAnalysis figures out formats by looking at the extension. Thus, a
DCD file always has to end with &#8221;.dcd&#8221; to be recognized as such unless the
format is explicitly specified with the <em>format</em> keyword to
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> or
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe.load_new" title="MDAnalysis.core.AtomGroup.Universe.load_new"><code class="xref py py-meth docutils literal"><span class="pre">load_new()</span></code></a>.  A number of files are
also recognized when they are compressed with <strong class="program">gzip</strong> or
<strong class="program">bzip2</strong> such as &#8221;.xyz.bz2&#8221;.</p>
<table border="1" class="docutils" id="id16">
<span id="id1"></span><caption><span class="caption-text">Table of supported coordinate formats</span><a class="headerlink" href="#id16" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="17%" />
<col width="13%" />
<col width="8%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">extension</th>
<th class="head">IO</th>
<th class="head">remarks</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CHARMM,
NAMD</td>
<td>dcd</td>
<td>r/w</td>
<td>standard CHARMM binary trajectory; endianness is
autodetected. Fixed atoms may not be handled
correctly (requires testing). Module
<a class="reference internal" href="DCD.html#module-MDAnalysis.coordinates.DCD" title="MDAnalysis.coordinates.DCD"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.DCD</span></code></a></td>
</tr>
<tr class="row-odd"><td>LAMMPS</td>
<td>dcd</td>
<td>r/w</td>
<td>CHARMM-style binary trajectory; endianness is
autodetected. Units are appropriate for LAMMPS.
Module <a class="reference internal" href="LAMMPS.html#module-MDAnalysis.coordinates.LAMMPS" title="MDAnalysis.coordinates.LAMMPS"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.LAMMPS</span></code></a></td>
</tr>
<tr class="row-even"><td>LAMMPS <a class="footnote-reference" href="#a" id="id2">[1]</a></td>
<td>data</td>
<td>r</td>
<td>Single frame of coordinates read from .data files</td>
</tr>
<tr class="row-odd"><td>Gromacs</td>
<td>xtc</td>
<td>r/w</td>
<td>Compressed (lossy) xtc trajectory format. Module
<a class="reference internal" href="XTC.html#module-MDAnalysis.coordinates.XTC" title="MDAnalysis.coordinates.XTC"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.XTC</span></code></a></td>
</tr>
<tr class="row-even"><td>Gromacs</td>
<td>trr</td>
<td>r/w</td>
<td>Full precision trr trajectory. Coordinates and
velocities are processed. Module
<a class="reference internal" href="TRR.html#module-MDAnalysis.coordinates.TRR" title="MDAnalysis.coordinates.TRR"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.TRR</span></code></a></td>
</tr>
<tr class="row-odd"><td>XYZ <a class="footnote-reference" href="#a" id="id3">[1]</a></td>
<td>xyz</td>
<td>r/w</td>
<td>Generic white-space separate XYZ format; can be
compressed (gzip or bzip2). Module
<a class="reference internal" href="XYZ.html#module-MDAnalysis.coordinates.XYZ" title="MDAnalysis.coordinates.XYZ"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.XYZ</span></code></a></td>
</tr>
<tr class="row-even"><td>GAMESS</td>
<td>gms,
log,
out</td>
<td>r</td>
<td>Generic semi-formatted GAMESS output log; can be
compressed (gzip or bzip2). Module
<a class="reference internal" href="GMS.html#module-MDAnalysis.coordinates.GMS" title="MDAnalysis.coordinates.GMS"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.GMS</span></code></a></td>
</tr>
<tr class="row-odd"><td>AMBER</td>
<td>trj,
mdcrd</td>
<td>r</td>
<td>formatted (ASCII) trajectories; the presence of a
periodic box is autodetected (<em>experimental</em>).
Module <a class="reference internal" href="TRJ.html#module-MDAnalysis.coordinates.TRJ" title="MDAnalysis.coordinates.TRJ"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.TRJ</span></code></a></td>
</tr>
<tr class="row-even"><td>AMBER</td>
<td>ncdf</td>
<td>r/w</td>
<td>binary (NetCDF) trajectories are fully supported with
optional <a class="reference external" href="https://github.com/Unidata/netcdf4-python">netcdf4-python</a> module (coordinates and
velocities). Module <a class="reference internal" href="TRJ.html#module-MDAnalysis.coordinates.TRJ" title="MDAnalysis.coordinates.TRJ"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.TRJ</span></code></a></td>
</tr>
<tr class="row-odd"><td>Brookhaven
<a class="footnote-reference" href="#a" id="id4">[1]</a></td>
<td>pdb</td>
<td>r/w</td>
<td>a simplified PDB format (as used in MD simulations)
is read by default; the full format can be read by
supplying the <cite>permissive=False</cite> flag to
<code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.Universe</span></code>. Multiple frames (MODEL)
are supported but require the <em>multiframe</em> keyword.
Module <a class="reference internal" href="PDB.html#module-MDAnalysis.coordinates.PDB" title="MDAnalysis.coordinates.PDB"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.PDB</span></code></a></td>
</tr>
<tr class="row-even"><td>XPDB</td>
<td>pdb</td>
<td>r</td>
<td>Extended PDB format (can use 5-digit residue
numbers). To use, specify the format &#8220;XPBD&#8221;
explicitly: <code class="docutils literal"><span class="pre">Universe(...,</span> <span class="pre">format=&quot;XPDB&quot;)</span></code>.
Module <a class="reference internal" href="PDB.html#module-MDAnalysis.coordinates.PDB" title="MDAnalysis.coordinates.PDB"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.PDB</span></code></a></td>
</tr>
<tr class="row-odd"><td>PDBQT <a class="footnote-reference" href="#a" id="id5">[1]</a></td>
<td>pdbqt</td>
<td>r/w</td>
<td>file format used by AutoDock with atom types <em>t</em>
and partial charges <em>q</em>. Module:
<a class="reference internal" href="PDBQT.html#module-MDAnalysis.coordinates.PDBQT" title="MDAnalysis.coordinates.PDBQT"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.PDBQT</span></code></a></td>
</tr>
<tr class="row-even"><td>PQR <a class="footnote-reference" href="#a" id="id6">[1]</a></td>
<td>pqr</td>
<td>r/w</td>
<td>PDB-like but whitespace-separated files with charge
and radius information. Module
<a class="reference internal" href="PQR.html#module-MDAnalysis.coordinates.PQR" title="MDAnalysis.coordinates.PQR"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.PQR</span></code></a></td>
</tr>
<tr class="row-odd"><td>GROMOS96
<a class="footnote-reference" href="#a" id="id7">[1]</a></td>
<td>gro</td>
<td>r/w</td>
<td>basic GROMOS96 format (velocities as well). Module
<a class="reference internal" href="GRO.html#module-MDAnalysis.coordinates.GRO" title="MDAnalysis.coordinates.GRO"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.GRO</span></code></a></td>
</tr>
<tr class="row-even"><td>CHARMM
CARD <a class="footnote-reference" href="#a" id="id8">[1]</a></td>
<td>crd</td>
<td>r/w</td>
<td>&#8220;CARD&#8221; coordinate output from CHARMM; deals with
either standard or EXTended format. Module
<a class="reference internal" href="CRD.html#module-MDAnalysis.coordinates.CRD" title="MDAnalysis.coordinates.CRD"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.CRD</span></code></a></td>
</tr>
<tr class="row-odd"><td>DESRES <a class="footnote-reference" href="#a" id="id9">[1]</a></td>
<td>dms</td>
<td>r</td>
<td>DESRES Molecular Structure file format reader.
Module <a class="reference internal" href="DMS.html#module-MDAnalysis.coordinates.DMS" title="MDAnalysis.coordinates.DMS"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.DMS</span></code></a></td>
</tr>
<tr class="row-even"><td>IBIsCO/YASP</td>
<td>trz</td>
<td>r/w</td>
<td>Binary IBIsCO or YASP trajectories Module
<a class="reference internal" href="TRZ.html#module-MDAnalysis.coordinates.TRZ" title="MDAnalysis.coordinates.TRZ"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.TRZ</span></code></a></td>
</tr>
<tr class="row-odd"><td>MOL2</td>
<td>mol2</td>
<td>r/w</td>
<td>Text-based Tripos molecular structure format
<a class="reference internal" href="MOL2.html#module-MDAnalysis.coordinates.MOL2" title="MDAnalysis.coordinates.MOL2"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.MOL2</span></code></a></td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id4">3</a>, <a class="fn-backref" href="#id5">4</a>, <a class="fn-backref" href="#id6">5</a>, <a class="fn-backref" href="#id7">6</a>, <a class="fn-backref" href="#id8">7</a>, <a class="fn-backref" href="#id9">8</a>)</em> This format can also be used to provide basic <em>topology</em>
information (i.e. the list of atoms); it is possible to create a
full <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-mod docutils literal"><span class="pre">Universe</span></code></a> by simply
providing a file of this format: <code class="docutils literal"><span class="pre">u</span> <span class="pre">=</span> <span class="pre">Universe(filename)</span></code></td></tr>
</tbody>
</table>
</div>
<div class="section" id="trajectory-api">
<span id="id10"></span><h2>5.1.4. Trajectory API<a class="headerlink" href="#trajectory-api" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Trajectory API</strong> defines how classes have to be structured that allow
reading and writing of coordinate files. By following the API it is possible to
seamlessly enhance the I/O capabilities of MDAnalysis. The actual underlying
I/O code can be written in C or python or a mixture thereof.</p>
<p>Typically, each format resides in its own module, named by the format specifier
(and using upper case by convention).</p>
<p>Reader and Writer classes are derived from base classes in
<a class="reference internal" href="base.html#module-MDAnalysis.coordinates.base" title="MDAnalysis.coordinates.base"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.base</span></code></a>.</p>
<div class="section" id="history">
<h3>5.1.4.1. History<a class="headerlink" href="#history" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>2010-04-30 Draft [orbeckst]</li>
<li>2010-08-20 added single frame writers to API [orbeckst]</li>
<li>2010-10-09 added write() method to Writers [orbeckst]</li>
<li>2010-10-19 use close() instead of close_trajectory() [orbeckst]</li>
<li>2010-10-30 clarified Writer write() methods (see also <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/49">Issue 49</a>)</li>
<li>2011-02-01 extended call signatur of Reader class</li>
<li>2011-03-30 optional Writer() method for Readers</li>
<li>2011-04-18 added time and frame managed attributes to Reader</li>
<li>2011-04-20 added volume to Timestep</li>
<li>2012-02-11 added _velocities to Timestep</li>
<li>2012-05-24 multiframe keyword to distinguish trajectory from single frame writers</li>
<li>2012-06-04 missing implementations of Reader.__getitem__ should raise <code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></li>
<li>2013-08-02 Readers/Writers must conform to the Python <a class="reference external" href="http://docs.python.org/2/reference/datamodel.html#context-managers">Context Manager</a> API</li>
<li>2015-01-15 Timestep._init_unitcell() method added</li>
</ul>
</div>
<div class="section" id="registry">
<h3>5.1.4.2. Registry<a class="headerlink" href="#registry" title="Permalink to this headline">¶</a></h3>
<p>In various places, MDAnalysis tries to automatically select appropriate formats
(e.g. by looking at file extensions). In order to allow it to choose the
correct format, all I/O classes must be registered in one of three dictionaries
with the format (typically the file extension in upper case):</p>
<ul class="simple">
<li>Trajectory reader classes must be added to
<code class="xref py py-data docutils literal"><span class="pre">MDAnalysis.coordinates._trajectory_readers</span></code>.</li>
<li>Trajectory writer classes must be added to
<code class="xref py py-data docutils literal"><span class="pre">MDAnalysis.coordinates._trajectory_writers</span></code>.</li>
<li>Single-frame writer classes must be added to to
<code class="xref py py-data docutils literal"><span class="pre">MDAnalysis.coordinates._frame_writers</span></code>.</li>
</ul>
</div>
<div class="section" id="timestep-class">
<h3>5.1.4.3. Timestep class<a class="headerlink" href="#timestep-class" title="Permalink to this headline">¶</a></h3>
<p>A Timestep instance holds data for the current frame. It is updated whenever a
new frame of the trajectory is read.</p>
<p>Timestep classes are derived from
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Timestep</span></code></a>, which is the primary
implementation example (and used directly for the DCDReader).</p>
<div class="section" id="methods">
<h4>5.1.4.3.1. Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">__init__(arg)</span></code></dt>
<dd><p class="first">depending on the type of <em>arg</em>, Timestep instances are created in
different ways:</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">int</span></code></dt>
<dd>empty Timestep for <em>arg</em> atoms (allocate arrays etc)</dd>
<dt><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></dt>
<dd>makes a deep copy of the <em>arg</em></dd>
<dt><a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.ndarray</span></code></a></dt>
<dd>update the Timesteps positions array with the contents of <em>arg</em></dd>
</dl>
</div></blockquote>
<p class="last">Anything else raises an exception; in particular it is not possible to
create a &#8220;empty&#8221; <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> instance.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">__getitem__(atoms)</span></code></dt>
<dd>position(s) of atoms; can be a slice or numpy array and then returns
coordinate array</dd>
<dt><code class="docutils literal"><span class="pre">__len__()</span></code></dt>
<dd>number of coordinates (atoms) in the frame</dd>
<dt><code class="docutils literal"><span class="pre">__iter__()</span></code></dt>
<dd>iterator over all coordinates</dd>
<dt><code class="docutils literal"><span class="pre">copy()</span></code></dt>
<dd>deep copy of the instance</dd>
<dt><code class="docutils literal"><span class="pre">_init_unitcell</span></code></dt>
<dd>hook that returns empty data structure for the unitcell representation
of this particular file format; called from within <code class="docutils literal"><span class="pre">__init__()</span></code> to
initialize <code class="xref py py-attr docutils literal"><span class="pre">Timestep._unitcell</span></code>.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="attributes">
<h4>5.1.4.3.2. Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">numatoms</span></code></dt>
<dd>number of atoms in the frame</dd>
<dt><code class="docutils literal"><span class="pre">frame</span></code></dt>
<dd>current frame number (1-based)</dd>
<dt><code class="docutils literal"><span class="pre">dimensions</span></code></dt>
<dd><p class="first">system box dimensions (<cite>x, y, z, alpha, beta, gamma</cite>)
(typically implemented as a property because it needs to translate whatever is in the
underlying <code class="xref py py-class docutils literal"><span class="pre">_unitcell</span></code> attribute. Also
comes with a setter that takes a MDAnalysis box so that one can do</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Timestep</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">]</span>
</pre></div>
</div>
<p class="last">which then converts automatically to the underlying representation and stores it
in <code class="xref py py-attr docutils literal"><span class="pre">Timestep._unitcell</span></code>.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">volume</span></code></dt>
<dd>system box volume (derived as the determinant of the box vectors of <code class="docutils literal"><span class="pre">dimensions</span></code>)</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="private-attributes">
<h4>5.1.4.3.3. Private attributes<a class="headerlink" href="#private-attributes" title="Permalink to this headline">¶</a></h4>
<p>These attributes are set directly by the underlying trajectory
readers. Normally the user should not have to directly access those (although in
some cases it is convenient to directly use <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep._pos" title="MDAnalysis.coordinates.base.Timestep._pos"><code class="xref py py-class docutils literal"><span class="pre">_pos</span></code></a>).</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">_pos</span></code></dt>
<dd>raw coordinates, a <code class="xref py py-class docutils literal"><span class="pre">numpy.float32</span></code> array; <code class="docutils literal"><span class="pre">X</span> <span class="pre">=</span> <span class="pre">_pos[:,0],</span> <span class="pre">Y</span> <span class="pre">=</span>
<span class="pre">_pos[:,1],</span> <span class="pre">Z</span> <span class="pre">=</span> <span class="pre">_pos[:,2]</span></code></dd>
<dt><code class="docutils literal"><span class="pre">_unitcell</span></code></dt>
<dd><p class="first">native unit cell description; the format depends on the
underlying trajectory format. A user should use the
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-class docutils literal"><span class="pre">dimensions</span></code></a>
attribute to access the data in a canonical format instead of
accessing <code class="xref py py-class docutils literal"><span class="pre">Timestep._unitcell</span></code> directly.</p>
<p class="last">The method <code class="xref py py-meth docutils literal"><span class="pre">Timestep._init_unitcell()</span></code> is a hook to initialize
this attribute.</p>
</dd>
</dl>
</div></blockquote>
<p>Optional attributes (only implemented by some readers); if an optional
attribute does not exist, a <code class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></code> is raised and the calling
code should handle this gracefully.</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">_velocities</span></code></dt>
<dd>raw velocities, a <code class="xref py py-class docutils literal"><span class="pre">numpy.float32</span></code> array containing velocities
(similar to <code class="docutils literal"><span class="pre">_pos</span></code>)</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="trajectory-reader-class">
<h3>5.1.4.4. Trajectory Reader class<a class="headerlink" href="#trajectory-reader-class" title="Permalink to this headline">¶</a></h3>
<p>Trajectory readers are derived from <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Reader" title="MDAnalysis.coordinates.base.Reader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Reader</span></code></a>.
Typically, many methods and attributes are overriden.</p>
<div class="section" id="id11">
<h4>5.1.4.4.1. Methods<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="DCD.html#MDAnalysis.coordinates.DCD.DCDReader" title="MDAnalysis.coordinates.DCD.DCDReader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.DCD.DCDReader</span></code></a> class is the primary
implementation example.</p>
<p><strong>Mandatory methods</strong></p>
<p>The following methods must be implemented in a Reader class.</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">__init__(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd><p class="first">open <em>filename</em>; other <em>kwargs</em> are processed as needed and the
Reader is free to ignore them. Typically, MDAnalysis supplies as
much information as possible to the Reader in <cite>kwargs</cite>; at the moment the
following data are supplied in keywords when a trajectory is loaded from
within <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.Universe</span></code>:</p>
<blockquote class="last">
<div><ul class="simple">
<li><em>numatoms</em>: the number of atoms (known from the topology)</li>
</ul>
</div></blockquote>
</dd>
<dt><code class="docutils literal"><span class="pre">__iter__()</span></code></dt>
<dd><p class="first">allow iteration from beginning to end:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">trajectory</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">ts</span><span class="o">.</span><span class="n">frame</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">close()</span></code></dt>
<dd>close the file and cease I/O</dd>
<dt><code class="docutils literal"><span class="pre">__del__()</span></code></dt>
<dd>ensure that the trajectory is closed</dd>
<dt><code class="docutils literal"><span class="pre">next()</span></code></dt>
<dd>advance to next time step or raise <code class="xref py py-exc docutils literal"><span class="pre">IOError</span></code> when moving
past the last frame</dd>
<dt><code class="docutils literal"><span class="pre">rewind()</span></code></dt>
<dd>reposition to first frame</dd>
<dt><code class="docutils literal"><span class="pre">__entry__()</span></code></dt>
<dd>entry method of a <a class="reference external" href="http://docs.python.org/2/reference/datamodel.html#context-managers">Context Manager</a> (returns self)</dd>
<dt><code class="docutils literal"><span class="pre">__exit__()</span></code></dt>
<dd>exit method of a <a class="reference external" href="http://docs.python.org/2/reference/datamodel.html#context-managers">Context Manager</a>, should call <code class="docutils literal"><span class="pre">close()</span></code>.</dd>
</dl>
</div></blockquote>
<p><strong>Optional methods</strong></p>
<p>Not all trajectory formats support the following methods, either because the
data are not available or the methods have not been implemented. Code should
deal with missing methods gracefully.</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">__len__()</span></code></dt>
<dd>number of frames in trajectory</dd>
<dt><code class="docutils literal"><span class="pre">__getitem__(arg)</span></code></dt>
<dd><p class="first">advance to time step <cite>arg</cite> = <cite>frame</cite> and return <code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code>; or if <cite>arg</cite> is a
slice, then return an iterator over that part of the trajectory.</p>
<p>The first functionality allows one to randomly access frames in the
trajectory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">314</span><span class="p">]</span>
</pre></div>
</div>
<p>would load frame 314 into the current <code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code>.</p>
<p>Using slices allows iteration over parts of a trajectory</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">2000</span><span class="p">]:</span>
    <span class="n">process_frame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>   <span class="c"># do something</span>
</pre></div>
</div>
<p>or skipping frames</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1000</span><span class="p">::</span><span class="mi">100</span><span class="p">]:</span>
    <span class="n">process_frame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>   <span class="c"># do something</span>
</pre></div>
</div>
<p>The last example starts reading the trajectory at frame 1000 and
reads every 100th frame until the end.</p>
<p>The performance of the <code class="docutils literal"><span class="pre">__getitem__()</span></code> method depends on the underlying
trajectory reader and if it can implement random access to frames. In many
cases this is not easily (or reliably) implementable and thus one is
restricted to sequential iteration.</p>
<p>If the Reader is not able to provide random access to frames then it
should raise <code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code> on indexing. It is possible to partially
implement <code class="docutils literal"><span class="pre">__getitem__</span></code> (as done on
<code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Reader.__getitem__</span></code> where slicing the
full trajectory is equivalent to
<code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Reader.__iter__</span></code> (which is always
implemented) and other slices raise <code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code>.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">__getitem__</span></code> uses 0-based indices for frames so that indexing and
slicing works exactly as in Python. However, the <code class="docutils literal"><span class="pre">Timestep.frame</span></code>
attribute (the &#8220;frame number&#8221;) is 1-based. Thus, the first frame in a
trajectory can be accessed as <code class="docutils literal"><span class="pre">trajectory[0]</span></code> (frame index 0) and the
corresponding frame number is 1 (<code class="docutils literal"><span class="pre">trajectory.ts.frame</span> <span class="pre">==</span> <span class="pre">1</span></code>).</p>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">Writer(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd><p class="first">returns a <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Writer" title="MDAnalysis.coordinates.base.Writer"><code class="xref py py-class docutils literal"><span class="pre">Writer</span></code></a> which is set up with
the same parameters as the trajectory that is being read (e.g. time step,
length etc), which facilitates copying and simple on-the-fly manipulation.</p>
<p>If no Writer is defined then a <code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code> is raised.</p>
<p class="last">The <em>kwargs</em> can be used to customize the Writer as they are typically
passed through to the init method of the Writer, with sensible defaults
filled in; the actual keyword arguments depend on the Writer.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">timeseries(atomGroup,</span> <span class="pre">[start[,stop[,skip[,format]]]])</span></code></dt>
<dd>returns a subset of coordinate data</dd>
<dt><code class="docutils literal"><span class="pre">correl(timeseriesCollection[,start[,stop[,skip]]])</span></code></dt>
<dd>populate a <a class="reference internal" href="../core/Timeseries.html#MDAnalysis.core.Timeseries.TimeseriesCollection" title="MDAnalysis.core.Timeseries.TimeseriesCollection"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.Timeseries.TimeseriesCollection</span></code></a> object
with observable timeseries computed from the trajectory</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="id12">
<h4>5.1.4.4.2. Attributes<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">filename</span></code></dt>
<dd>filename of the trajectory</dd>
<dt><code class="docutils literal"><span class="pre">numatoms</span></code></dt>
<dd>number of atoms (coordinate sets) in a frame (constant)</dd>
<dt><code class="docutils literal"><span class="pre">numframes</span></code></dt>
<dd>total number of frames (if known) &#8211; <code class="docutils literal"><span class="pre">None</span></code> if not known</dd>
<dt><code class="docutils literal"><span class="pre">fixed</span></code></dt>
<dd>bool, saying if there are fixed atoms (e.g. dcds)</dd>
<dt><code class="docutils literal"><span class="pre">skip</span></code></dt>
<dd>step size for iterating through the trajectory [1]</dd>
<dt><code class="docutils literal"><span class="pre">skip_timestep</span></code></dt>
<dd>number of integrator steps between frames + 1 (i.e.
the stride at which the MD simulation was sampled)</dd>
<dt><code class="docutils literal"><span class="pre">delta</span></code></dt>
<dd>integrator time step (in native units); hence the &#8220;length&#8221;
of a trajctory frame is  <code class="docutils literal"><span class="pre">skip_timestep*delta</span></code> time units</dd>
<dt><code class="docutils literal"><span class="pre">periodic</span></code></dt>
<dd>contains box information for periodic boundary conditions</dd>
<dt><code class="docutils literal"><span class="pre">ts</span></code></dt>
<dd>the <code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code> object; typically customized for each
trajectory format and derived from <code class="xref py py-class docutils literal"><span class="pre">base.Timestep</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">units</span></code></dt>
<dd>dictionary with keys <em>time</em>, <em>length</em>, <em>speed</em>, <em>force</em> and the
appropriate unit (e.g. &#8216;AKMA&#8217; and &#8216;Angstrom&#8217; for Charmm dcds, &#8216;ps&#8217; and
&#8216;nm&#8217; for Gromacs trajectories, <code class="docutils literal"><span class="pre">None</span></code> and &#8216;Angstrom&#8217; for PDB).
Any field not used should be set to <code class="docutils literal"><span class="pre">None</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">format</span></code></dt>
<dd>string that identifies the file format, e.g. &#8220;DCD&#8221;, &#8220;PDB&#8221;, &#8220;CRD&#8221;, &#8220;XTC&#8221;,
&#8220;TRR&#8221;; this is typically the file extension in upper case.</dd>
<dt><code class="docutils literal"><span class="pre">dt</span></code></dt>
<dd>time between frames in ps; a managed attribute (read only) that computes
on the fly <code class="docutils literal"><span class="pre">skip_timestep</span> <span class="pre">*</span> <span class="pre">delta</span></code> and converts to the MDAnalysis base
unit for time (pico seconds by default)</dd>
<dt><code class="docutils literal"><span class="pre">totaltime</span></code></dt>
<dd>total length of the trajectory = <code class="docutils literal"><span class="pre">numframes</span> <span class="pre">*</span> <span class="pre">dt</span></code></dd>
<dt><code class="docutils literal"><span class="pre">time</span></code></dt>
<dd>time of the current time step, in MDAnalysis time units (ps)</dd>
<dt><code class="docutils literal"><span class="pre">frame</span></code></dt>
<dd>frame number of the current time step (1-based)</dd>
</dl>
</div></blockquote>
<p><strong>Optional attributes</strong></p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">compressed</span></code></dt>
<dd>string that identifies the compression (e.g. &#8220;gz&#8221; or &#8220;bz2&#8221;) or <code class="docutils literal"><span class="pre">None</span></code>.</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="trajectory-writer-class">
<h3>5.1.4.5. Trajectory Writer class<a class="headerlink" href="#trajectory-writer-class" title="Permalink to this headline">¶</a></h3>
<p>Trajectory writers are derived from
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Writer" title="MDAnalysis.coordinates.base.Writer"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.base.Writer</span></code></a>. They are used to write
multiple frames to a trajectory file. Every time the
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Writer.write" title="MDAnalysis.coordinates.base.Writer.write"><code class="xref py py-meth docutils literal"><span class="pre">write()</span></code></a> method is called,
another frame is appended to the trajectory.</p>
<p>Typically, many methods and attributes are overriden.</p>
<p>Signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">W</span> <span class="o">=</span> <span class="n">TrajectoryWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">numatoms</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write_next_timestep</span><span class="p">(</span><span class="n">Timestep</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AtomGroup</span><span class="p">)</span>   <span class="c"># write a selection</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Universe</span><span class="p">)</span>    <span class="c"># write a whole universe</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Timestep</span><span class="p">)</span>    <span class="c"># same as write_next_timestep()</span>
</pre></div>
</div>
<div class="section" id="id13">
<h4>5.1.4.5.1. Methods<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">__init__(filename,numatoms[,start[,step[,delta[,remarks]]]])</span></code></dt>
<dd>opens <em>filename</em> and writes header if required by format</dd>
<dt><code class="docutils literal"><span class="pre">write(obj)</span></code></dt>
<dd>write Timestep data in <em>obj</em></dd>
<dt><code class="docutils literal"><span class="pre">write_next_timestep([timestep])</span></code></dt>
<dd>write data in <em>timestep</em> to trajectory file</dd>
<dt><code class="docutils literal"><span class="pre">convert_dimensions_to_unitcell(timestep)</span></code></dt>
<dd>take the dimensions from the timestep and convert to the native
unitcell representation of the format</dd>
<dt><code class="docutils literal"><span class="pre">close()</span></code></dt>
<dd>close file and finish I/O</dd>
<dt><code class="docutils literal"><span class="pre">__del__()</span></code></dt>
<dd>ensures that close() is called</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="id14">
<h4>5.1.4.5.2. Attributes<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">filename</span></code></dt>
<dd>name of the trajectory file</dd>
<dt><code class="docutils literal"><span class="pre">start,</span> <span class="pre">stop,</span> <span class="pre">step</span></code></dt>
<dd>first and last frame number (1-based) and step</dd>
<dt><code class="docutils literal"><span class="pre">units</span></code></dt>
<dd>dictionary with keys <em>time</em>, <em>length</em>, <em>speed</em>, <em>force</em> and the
appropriate unit (e.g. &#8216;AKMA&#8217; and &#8216;Angstrom&#8217; for Charmm dcds, &#8216;ps&#8217; and
&#8216;nm&#8217; for Gromacs trajectories, <code class="docutils literal"><span class="pre">None</span></code> and &#8216;Angstrom&#8217; for PDB).
Any field not used should be set to <code class="docutils literal"><span class="pre">None</span></code>.</dd>
<dt><code class="docutils literal"><span class="pre">format</span></code></dt>
<dd>string that identifies the file format, e.g. &#8220;DCD&#8221;, &#8220;PDB&#8221;, &#8220;CRD&#8221;, &#8220;XTC&#8221;,
&#8220;TRR&#8221;</dd>
</dl>
</div></blockquote>
<p><strong>Optional</strong></p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">ts</span></code></dt>
<dd><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code> instance</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="single-frame-writer-class">
<h3>5.1.4.6. Single Frame Writer class<a class="headerlink" href="#single-frame-writer-class" title="Permalink to this headline">¶</a></h3>
<p>A single frame writer is a special case of a trajectory writer in that it
writes only a single coordinate frame to a file, for instance, a pdb or gro
file. Unlike trajectory formats, which only contains coordinates, <em>single
frame</em> formats contain much more information (e.g. atom and residue names and
numbers) and hence it is possible to write selections of atoms in a meaningful
way.</p>
<p>Signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">W</span> <span class="o">=</span> <span class="n">FrameWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AtomGroup</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Universe</span><span class="p">)</span>
</pre></div>
</div>
<p>The blanket <em>kwargs</em> is required so that one can pass the same kind of
arguments (filename and numatoms) as for the Trajectory writers. In
this way, the simple <a class="reference internal" href="core.html#MDAnalysis.coordinates.core.writer" title="MDAnalysis.coordinates.core.writer"><code class="xref py py-func docutils literal"><span class="pre">writer()</span></code></a>
factory function can be used for all writers.</p>
<div class="section" id="id15">
<h4>5.1.4.6.1. Methods<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal"><span class="pre">__init__(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd>opens <em>filename</em> for writing; <cite>kwargs</cite> are typically ignored</dd>
<dt><code class="docutils literal"><span class="pre">write(obj)</span></code></dt>
<dd>writes the object <em>obj</em>, containing a
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> group of atoms (typically
obtained from a selection) or <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a>
to the file and closes the file</dd>
</dl>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Trajectory and Frame writers can be used in almost exactly the same
manner with the one difference that Frame writers cannot deal with
raw <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> objects.</p>
</div>
</div>
</div>
</div>
<div class="section" id="reader-writer-registry">
<h2>5.1.5. Reader/Writer registry<a class="headerlink" href="#reader-writer-registry" title="Permalink to this headline">¶</a></h2>
<p>The following data structures connect reader/writer classes to their
format identifiers. They are documented for programmers who want to
enhance MDAnalysis; the casual user is unlikely to access them
directly.</p>
<p>Some formats can either write single frames or trajectories (such as
PDB). In theses cases, the kind of writer is selected with the
<em>multiframe</em> keyword to <code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.coordinates.core.get_writer()</span></code>
(or the writer itself).</p>
<dl class="data">
<dt id="MDAnalysis.coordinates.__init__._trajectory_readers">
<code class="descclassname">MDAnalysis.coordinates.__init__.</code><code class="descname">_trajectory_readers</code><em class="property"> = {'CHAIN': &lt;class 'MDAnalysis.coordinates.base.ChainReader'&gt;, 'XPDB': &lt;class 'MDAnalysis.coordinates.PDB.ExtendedPDBReader'&gt;, 'TRJ': &lt;class 'MDAnalysis.coordinates.TRJ.TRJReader'&gt;, 'TRZ': &lt;class 'MDAnalysis.coordinates.TRZ.TRZReader'&gt;, 'MDCRD': &lt;class 'MDAnalysis.coordinates.TRJ.TRJReader'&gt;, 'LAMMPS': &lt;class 'MDAnalysis.coordinates.LAMMPS.DCDReader'&gt;, 'DCD': &lt;class 'MDAnalysis.coordinates.DCD.DCDReader'&gt;, 'PDB': &lt;class 'MDAnalysis.coordinates.PDB.PDBReader'&gt;, 'PDBQT': &lt;class 'MDAnalysis.coordinates.PDBQT.PDBQTReader'&gt;, 'MOL2': &lt;class 'MDAnalysis.coordinates.MOL2.MOL2Reader'&gt;, 'PQR': &lt;class 'MDAnalysis.coordinates.PQR.PQRReader'&gt;, 'DMS': &lt;class 'MDAnalysis.coordinates.DMS.DMSReader'&gt;, 'XTC': &lt;class 'MDAnalysis.coordinates.xdrfile.XTC.XTCReader'&gt;, 'CRD': &lt;class 'MDAnalysis.coordinates.CRD.CRDReader'&gt;, 'GMS': &lt;class 'MDAnalysis.coordinates.GMS.GMSReader'&gt;, 'GRO': &lt;class 'MDAnalysis.coordinates.GRO.GROReader'&gt;, 'TRR': &lt;class 'MDAnalysis.coordinates.xdrfile.TRR.TRRReader'&gt;, 'DATA': &lt;class 'MDAnalysis.coordinates.LAMMPS.DATAReader'&gt;, 'XYZ': &lt;class 'MDAnalysis.coordinates.XYZ.XYZReader'&gt;, 'NCDF': &lt;class 'MDAnalysis.coordinates.TRJ.NCDFReader'&gt;}</em><a class="headerlink" href="#MDAnalysis.coordinates.__init__._trajectory_readers" title="Permalink to this definition">¶</a></dt>
<dd><p>standard trajectory readers (dict with identifier as key and reader class as value)</p>
</dd></dl>

<dl class="data">
<dt id="MDAnalysis.coordinates.__init__._topology_coordinates_readers">
<code class="descclassname">MDAnalysis.coordinates.__init__.</code><code class="descname">_topology_coordinates_readers</code><em class="property"> = {'PDBQT': &lt;class 'MDAnalysis.coordinates.PDBQT.PDBQTReader'&gt;, 'XPDB': &lt;class 'MDAnalysis.coordinates.PDB.ExtendedPDBReader'&gt;, 'DMS': &lt;class 'MDAnalysis.coordinates.DMS.DMSReader'&gt;, 'PQR': &lt;class 'MDAnalysis.coordinates.PQR.PQRReader'&gt;, 'CRD': &lt;class 'MDAnalysis.coordinates.CRD.CRDReader'&gt;, 'GMS': &lt;class 'MDAnalysis.coordinates.GMS.GMSReader'&gt;, 'GRO': &lt;class 'MDAnalysis.coordinates.GRO.GROReader'&gt;, 'MOL2': &lt;class 'MDAnalysis.coordinates.MOL2.MOL2Reader'&gt;, 'DATA': &lt;class 'MDAnalysis.coordinates.LAMMPS.DATAReader'&gt;, 'PDB': &lt;class 'MDAnalysis.coordinates.PDB.PrimitivePDBReader'&gt;}</em><a class="headerlink" href="#MDAnalysis.coordinates.__init__._topology_coordinates_readers" title="Permalink to this definition">¶</a></dt>
<dd><p>readers of files that contain both topology/atom data and coordinates
(currently only the keys are used)</p>
</dd></dl>

<dl class="data">
<dt id="MDAnalysis.coordinates.__init__._trajectory_readers_permissive">
<code class="descclassname">MDAnalysis.coordinates.__init__.</code><code class="descname">_trajectory_readers_permissive</code><em class="property"> = {'TRJ': &lt;class 'MDAnalysis.coordinates.TRJ.TRJReader'&gt;, 'MDCRD': &lt;class 'MDAnalysis.coordinates.TRJ.TRJReader'&gt;, 'TRZ': &lt;class 'MDAnalysis.coordinates.TRZ.TRZReader'&gt;, 'XTC': &lt;class 'MDAnalysis.coordinates.xdrfile.XTC.XTCReader'&gt;, 'CRD': &lt;class 'MDAnalysis.coordinates.CRD.CRDReader'&gt;, 'GMS': &lt;class 'MDAnalysis.coordinates.GMS.GMSReader'&gt;, 'GRO': &lt;class 'MDAnalysis.coordinates.GRO.GROReader'&gt;, 'TRR': &lt;class 'MDAnalysis.coordinates.xdrfile.TRR.TRRReader'&gt;, 'DATA': &lt;class 'MDAnalysis.coordinates.LAMMPS.DATAReader'&gt;, 'PDB': &lt;class 'MDAnalysis.coordinates.PDB.PrimitivePDBReader'&gt;, 'XPDB': &lt;class 'MDAnalysis.coordinates.PDB.ExtendedPDBReader'&gt;, 'LAMMPS': &lt;class 'MDAnalysis.coordinates.LAMMPS.DCDReader'&gt;, 'CHAIN': &lt;class 'MDAnalysis.coordinates.base.ChainReader'&gt;, 'DCD': &lt;class 'MDAnalysis.coordinates.DCD.DCDReader'&gt;, 'PDBQT': &lt;class 'MDAnalysis.coordinates.PDBQT.PDBQTReader'&gt;, 'PQR': &lt;class 'MDAnalysis.coordinates.PQR.PQRReader'&gt;, 'DMS': &lt;class 'MDAnalysis.coordinates.DMS.DMSReader'&gt;, 'XYZ': &lt;class 'MDAnalysis.coordinates.XYZ.XYZReader'&gt;, 'MOL2': &lt;class 'MDAnalysis.coordinates.MOL2.MOL2Reader'&gt;, 'NCDF': &lt;class 'MDAnalysis.coordinates.TRJ.NCDFReader'&gt;}</em><a class="headerlink" href="#MDAnalysis.coordinates.__init__._trajectory_readers_permissive" title="Permalink to this definition">¶</a></dt>
<dd><p>hack: readers that ignore most errors (permissive=True); at the moment
the same as <a class="reference internal" href="#MDAnalysis.coordinates.__init__._trajectory_readers" title="MDAnalysis.coordinates.__init__._trajectory_readers"><code class="xref py py-data docutils literal"><span class="pre">_trajectory_readers</span></code></a> with the exception of the
the PDB reader (<a class="reference internal" href="PDB.html#MDAnalysis.coordinates.PDB.PDBReader" title="MDAnalysis.coordinates.PDB.PDBReader"><code class="xref py py-class docutils literal"><span class="pre">PDBReader</span></code></a> is replaced by</p>
</dd></dl>

<dl class="data">
<dt id="MDAnalysis.coordinates.__init__._compressed_formats">
<code class="descclassname">MDAnalysis.coordinates.__init__.</code><code class="descname">_compressed_formats</code><em class="property"> = ['XYZ', 'TRJ', 'MDCRD', 'PQR', 'PDBQT']</em><a class="headerlink" href="#MDAnalysis.coordinates.__init__._compressed_formats" title="Permalink to this definition">¶</a></dt>
<dd><p>formats of readers that can also handle gzip or bzip2 compressed files</p>
</dd></dl>

<dl class="data">
<dt id="MDAnalysis.coordinates.__init__._frame_writers">
<code class="descclassname">MDAnalysis.coordinates.__init__.</code><code class="descname">_frame_writers</code><em class="property"> = {'XYZ': &lt;class 'MDAnalysis.coordinates.XYZ.XYZWriter'&gt;, 'PDBQT': &lt;class 'MDAnalysis.coordinates.PDBQT.PDBQTWriter'&gt;, 'MOL2': &lt;class 'MDAnalysis.coordinates.MOL2.MOL2Writer'&gt;, 'PQR': &lt;class 'MDAnalysis.coordinates.PQR.PQRWriter'&gt;, 'CRD': &lt;class 'MDAnalysis.coordinates.CRD.CRDWriter'&gt;, 'GRO': &lt;class 'MDAnalysis.coordinates.GRO.GROWriter'&gt;, 'PDB': &lt;class 'MDAnalysis.coordinates.PDB.PrimitivePDBWriter'&gt;}</em><a class="headerlink" href="#MDAnalysis.coordinates.__init__._frame_writers" title="Permalink to this definition">¶</a></dt>
<dd><p>frame writers: export to single frame formats such as PDB, gro, crd
Signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">W</span> <span class="o">=</span> <span class="n">FrameWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AtomGroup</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="data">
<dt id="MDAnalysis.coordinates.__init__._trajectory_writers">
<code class="descclassname">MDAnalysis.coordinates.__init__.</code><code class="descname">_trajectory_writers</code><em class="property"> = {'MOL2': &lt;class 'MDAnalysis.coordinates.MOL2.MOL2Writer'&gt;, 'TRZ': &lt;class 'MDAnalysis.coordinates.TRZ.TRZWriter'&gt;, 'XTC': &lt;class 'MDAnalysis.coordinates.xdrfile.XTC.XTCWriter'&gt;, 'XYZ': &lt;class 'MDAnalysis.coordinates.XYZ.XYZWriter'&gt;, 'LAMMPS': &lt;class 'MDAnalysis.coordinates.LAMMPS.DCDWriter'&gt;, 'DCD': &lt;class 'MDAnalysis.coordinates.DCD.DCDWriter'&gt;, 'TRR': &lt;class 'MDAnalysis.coordinates.xdrfile.TRR.TRRWriter'&gt;, 'PDB': &lt;class 'MDAnalysis.coordinates.PDB.MultiPDBWriter'&gt;, 'NCDF': &lt;class 'MDAnalysis.coordinates.TRJ.NCDFWriter'&gt;}</em><a class="headerlink" href="#MDAnalysis.coordinates.__init__._trajectory_writers" title="Permalink to this definition">¶</a></dt>
<dd><p>trajectory writers: export frames, typically only saving coordinates
Signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">W</span> <span class="o">=</span> <span class="n">TrajectoryWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">numatoms</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write_next_timestep</span><span class="p">(</span><span class="n">TimeStep</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Timestep</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AtomGroup</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Universe</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="CRD.html" title="5.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD"
             >next</a> |</li>
        <li class="right" >
          <a href="../coordinates_modules.html" title="5. Coordinates modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.9.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../coordinates_modules.html" >5. Coordinates modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Danny Parton, Joshua L. Phillips, Tyler Reddy, Paul Rigor, Andy Somogyi,
    Lukas Stelzl, Zhuyi Xue, and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>