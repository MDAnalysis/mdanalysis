<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.3. DCD trajectory I/O — MDAnalysis.coordinates.DCD &mdash; MDAnalysis 0.11.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.11.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.11.0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.11.0 documentation" href="../../index.html" />
    <link rel="up" title="5. Coordinates modules" href="../coordinates_modules.html" />
    <link rel="next" title="5.4. DL_Poly format reader MDAnalysis.coordinates.DLPoly" href="DLPoly.html" />
    <link rel="prev" title="5.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD" href="CRD.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="DLPoly.html" title="5.4. DL_Poly format reader MDAnalysis.coordinates.DLPoly"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="CRD.html" title="5.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.11.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../coordinates_modules.html" accesskey="U">5. Coordinates modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.3. DCD trajectory I/O  &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.coordinates.DCD</span></code></a><ul>
<li><a class="reference internal" href="#classes">5.3.1. Classes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="CRD.html"
                        title="previous chapter">5.2. CRD structure files in MDAnalysis &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.coordinates.CRD</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="DLPoly.html"
                        title="next chapter">5.4. DL_Poly format reader <code class="docutils literal"><span class="pre">MDAnalysis.coordinates.DLPoly</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/coordinates/DCD.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.coordinates.DCD"></span><div class="section" id="dcd-trajectory-i-o-mdanalysis-coordinates-dcd">
<h1>5.3. DCD trajectory I/O  &#8212; <a class="reference internal" href="#module-MDAnalysis.coordinates.DCD" title="MDAnalysis.coordinates.DCD"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.DCD</span></code></a><a class="headerlink" href="#dcd-trajectory-i-o-mdanalysis-coordinates-dcd" title="Permalink to this headline">¶</a></h1>
<p>Classes to read and write DCD binary trajectories, the format used by
CHARMM, NAMD, and also LAMMPS. Trajectories can be read regardless of
system-endianness as this is auto-detected.</p>
<p>Generally, DCD trajectories produced by any code can be read (with the
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDReader" title="MDAnalysis.coordinates.DCD.DCDReader"><code class="xref py py-class docutils literal"><span class="pre">DCDReader</span></code></a>) although there can be issues with the unitcell
(simulation box) representation (see
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.dimensions" title="MDAnalysis.coordinates.DCD.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">Timestep.dimensions</span></code></a>). DCDs can also be written but the
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDWriter" title="MDAnalysis.coordinates.DCD.DCDWriter"><code class="xref py py-class docutils literal"><span class="pre">DCDWriter</span></code></a> follows recent NAMD/VMD convention for the unitcell
but still writes AKMA time. Reading and writing these trajectories
within MDAnalysis will work seamlessly but if you process those
trajectories with other tools you might need to watch out that time
and unitcell dimensions are correctly interpreted.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The DCD file format is not well defined. In particular, NAMD and
CHARMM use it differently. Currently, MDAnalysis tries to guess the
correct <strong>format for the unitcell representation</strong> but it can be
wrong. <strong>Check the unitcell dimensions</strong>, especially for triclinic
unitcells (see <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/187">Issue 187</a> and <a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.dimensions" title="MDAnalysis.coordinates.DCD.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">Timestep.dimensions</span></code></a>). A
second potential issue are the units of time which are AKMA for the
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDReader" title="MDAnalysis.coordinates.DCD.DCDReader"><code class="xref py py-class docutils literal"><span class="pre">DCDReader</span></code></a> (following CHARMM) but ps for NAMD. As a
workaround one can employ the configurable
<a class="reference internal" href="LAMMPS.html#MDAnalysis.coordinates.LAMMPS.DCDReader" title="MDAnalysis.coordinates.LAMMPS.DCDReader"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.coordinates.LAMMPS.DCDReader</span></code></a> for NAMD
trajectories.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="LAMMPS.html#module-MDAnalysis.coordinates.LAMMPS" title="MDAnalysis.coordinates.LAMMPS"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.coordinates.LAMMPS</span></code></a> module provides
a more flexible DCD reader/writer.</p>
</div>
<p>The classes in this module are the reference implementations for the
Trajectory API.</p>
<div class="section" id="classes">
<h2>5.3.1. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.coordinates.DCD.Timestep">
<em class="property">class </em><code class="descclassname">MDAnalysis.coordinates.DCD.</code><code class="descname">Timestep</code><span class="sig-paren">(</span><em>n_atoms</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#Timestep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Timestep, representing a frame of a trajectory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first docutils">
<dt><em>n_atoms</em></dt>
<dd><p class="first last">The total number of atoms this Timestep describes</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Keywords:</th><td class="field-body"><dl class="first last docutils">
<dt><em>positions</em></dt>
<dd><p class="first last">Whether this Timestep has position information [<code class="docutils literal"><span class="pre">True</span></code>]</p>
</dd>
<dt><em>velocities</em></dt>
<dd><p class="first last">Whether this Timestep has velocity information [<code class="docutils literal"><span class="pre">False</span></code>]</p>
</dd>
<dt><em>forces</em></dt>
<dd><p class="first last">Whether this Timestep has force information [<code class="docutils literal"><span class="pre">False</span></code>]</p>
</dd>
<dt><em>dt</em></dt>
<dd><p class="first last">The time difference between frames (ps).  If <a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.time" title="MDAnalysis.coordinates.DCD.Timestep.time"><code class="xref py py-attr docutils literal"><span class="pre">time</span></code></a>
is set, then <cite>dt</cite> will be ignored.</p>
</dd>
<dt><em>time_offset</em></dt>
<dd><p class="first last">The starting time from which to calculate time (ps)</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Added keywords for positions, velocities and forces
Can add and remove position/velocity/force information by using
the has_* attribute</p>
</div>
<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.Timestep.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/base.html#Timestep.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an independent (&#8220;deep&#8221;) copy of the whole <a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep" title="MDAnalysis.coordinates.DCD.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.Timestep.copy_slice">
<code class="descname">copy_slice</code><span class="sig-paren">(</span><em>sel</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/base.html#Timestep.copy_slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.copy_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a new Timestep containing a subset of the original Timestep.</p>
<p><code class="docutils literal"><span class="pre">ts.copy_slice(slice(start,</span> <span class="pre">stop,</span> <span class="pre">skip))</span></code>
<code class="docutils literal"><span class="pre">ts.copy_slice([list</span> <span class="pre">of</span> <span class="pre">indices])</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A Timestep object of the same type containing all header
information and all atom information relevant to the selection.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The selection must be a 0 based slice or array of the atom indices
in this Timestep</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.8.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Reworked to follow new Timestep API.  Now will strictly only
copy official attributes of the Timestep.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.dimensions">
<code class="descname">dimensions</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>unitcell dimensions (<em>A</em>, <em>B</em>, <em>C</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em>)</p>
<p>lengths <em>A</em>, <em>B</em>, <em>C</em> are in the MDAnalysis length unit (Å), and
angles are in degrees.</p>
<p><a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.dimensions" title="MDAnalysis.coordinates.DCD.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">dimensions</span></code></a> is read-only because it transforms the actual format
of the unitcell (which differs between different trajectory formats) to
the representation described here, which is used everywhere in
MDAnalysis.</p>
<p>The ordering of the angles in the unitcell is the same as in recent
versions of VMD&#8217;s <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/plugins/doxygen/dcdplugin_8c-source.html#l00947">DCDplugin</a> (2013), namely the <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/plugins/molfile/dcdplugin.html">X-PLOR DCD format</a>:
The original unitcell is read as <code class="docutils literal"><span class="pre">[A,</span> <span class="pre">gamma,</span> <span class="pre">B,</span> <span class="pre">beta,</span> <span class="pre">alpha,</span> <span class="pre">C]</span></code> from
the DCD file (actually, the direction cosines are stored instead of the
angles but the underlying C code already does this conversion); if any
of these values are &lt; 0 or if any of the angles are &gt; 180 degrees then
it is assumed it is a new-style CHARMM unitcell (at least since c36b2)
in which box vectors were recorded.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The DCD format is not well defined. Check your unit cell
dimensions carefully, especially when using triclinic
boxes. Different software packages implement different conventions
and MDAnalysis is currently implementing the newer NAMD/VMD convention
and tries to guess the new CHARMM one. Old CHARMM trajectories might
give wrong unitcell values. For more details see <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/187">Issue 187</a>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>Unitcell is now interpreted in the newer NAMD DCD format as <code class="docutils literal"><span class="pre">[A,</span>
<span class="pre">gamma,</span> <span class="pre">B,</span> <span class="pre">beta,</span> <span class="pre">alpha,</span> <span class="pre">C]</span></code> instead of the old MDAnalysis/CHARMM
ordering <code class="docutils literal"><span class="pre">[A,</span> <span class="pre">alpha,</span> <span class="pre">B,</span> <span class="pre">beta,</span> <span class="pre">gamma,</span> <span class="pre">C]</span></code>. We attempt to detect the
new CHARMM DCD unitcell format (see <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/187">Issue 187</a> for a discussion).</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.dt">
<code class="descname">dt</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>The time difference in ps between timesteps</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This defaults to 1.0 ps in the absence of time data</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.forces">
<code class="descname">forces</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.forces" title="Permalink to this definition">¶</a></dt>
<dd><p>A record of the forces of all atoms in this Timestep</p>
<p>Setting this attribute will add forces to the Timestep if they
weren&#8217;t originally present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A numpy.ndarray of shape (n_atoms, 3) of force data for each
atom</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.NoDataError</span></code></dt>
<dd><p class="first last">When the Timestep does not contain force information</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.Timestep.from_coordinates">
<code class="descname">from_coordinates</code><span class="sig-paren">(</span><em>positions</em>, <em>velocities=None</em>, <em>forces=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/base.html#Timestep.from_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.from_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of this Timestep, from coordinate data</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.Timestep.from_timestep">
<code class="descname">from_timestep</code><span class="sig-paren">(</span><em>other</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/base.html#Timestep.from_timestep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.from_timestep" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a copy of another Timestep, in the format of this Timestep</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.has_forces">
<code class="descname">has_forces</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.has_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean of whether this Timestep has force data</p>
<p>This can be changed to <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code> to allocate space for
or remove the data.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.has_positions">
<code class="descname">has_positions</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.has_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean of whether this Timestep has position data</p>
<p>This can be changed to <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code> to allocate space for
or remove the data.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.has_velocities">
<code class="descname">has_velocities</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.has_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>A boolean of whether this Timestep has velocity data</p>
<p>This can be changed to <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code> to allocate space for
or remove the data.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.n_atoms">
<code class="descname">n_atoms</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>A read only view of the number of atoms this Timestep has</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Changed to read only property</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.positions">
<code class="descname">positions</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>A record of the positions of all atoms in this Timestep</p>
<p>Setting this attribute will add positions to the Timestep if they
weren&#8217;t originally present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A numpy.ndarray of shape (n_atoms, 3) of position data for each
atom</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.exceptions.NoDataError</span></code></a></dt>
<dd><p class="first last">If the Timestep has no position data</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Now can raise NoDataError when no position data present</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.time">
<code class="descname">time</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.time" title="Permalink to this definition">¶</a></dt>
<dd><p>The time in ps of this timestep</p>
<p>This is calculated as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">time</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;time_offset&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
<p>Or, if the trajectory doesn&#8217;t provide time information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">time</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;time_offset&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">ts</span><span class="o">.</span><span class="n">frame</span> <span class="o">*</span> <span class="n">ts</span><span class="o">.</span><span class="n">dt</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.triclinic_dimensions">
<code class="descname">triclinic_dimensions</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.triclinic_dimensions" title="Permalink to this definition">¶</a></dt>
<dd><p>The unitcell dimensions represented as triclinic vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A (3, 3) numpy.ndarray of unit cell vectors</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">array([ 13.,  14.,  15.,  90.,  90.,  90.], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">triclinic_dimensions</span>
<span class="go">array([[ 13.,   0.,   0.],</span>
<span class="go">       [  0.,  14.,   0.],</span>
<span class="go">       [  0.,   0.,  15.]], dtype=float32)</span>
</pre></div>
</div>
<p>Setting the attribute also works:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">triclinic_dimensions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span>
<span class="go">array([ 15.        ,  15.81138802,  16.58312416,  67.58049774,</span>
<span class="go">        72.45159912,  71.56504822], dtype=float32)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../lib/mdamath.html#MDAnalysis.lib.mdamath.triclinic_vectors" title="MDAnalysis.lib.mdamath.triclinic_vectors"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.lib.mdamath.triclinic_vectors()</span></code></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.velocities">
<code class="descname">velocities</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>A record of the velocities of all atoms in this Timestep</p>
<p>Setting this attribute will add velocities to the Timestep if they
weren&#8217;t originally present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A numpy.ndarray of shape (n_atoms, 3) of velocity data for each
atom</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.exceptions.NoDataError</span></code></a></dt>
<dd><p class="first last">When the Timestep does not contain velocity information</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.Timestep.volume">
<code class="descname">volume</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.Timestep.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>volume of the unitcell</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.coordinates.DCD.DCDReader">
<em class="property">class </em><code class="descclassname">MDAnalysis.coordinates.DCD.</code><code class="descname">DCDReader</code><span class="sig-paren">(</span><em>dcdfilename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDReader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads from a DCD file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Data:</th><td class="field-body"><dl class="first docutils">
<dt>ts</dt>
<dd><p class="first last"><a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep" title="MDAnalysis.coordinates.DCD.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> object containing coordinates of current frame</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Methods:</th><td class="field-body"><dl class="first last docutils">
<dt><code class="docutils literal"><span class="pre">dcd</span> <span class="pre">=</span> <span class="pre">DCD(dcdfilename)</span></code></dt>
<dd><p class="first last">open dcd file and read header</p>
</dd>
<dt><code class="docutils literal"><span class="pre">len(dcd)</span></code></dt>
<dd><p class="first last">return number of frames in dcd</p>
</dd>
<dt><code class="docutils literal"><span class="pre">for</span> <span class="pre">ts</span> <span class="pre">in</span> <span class="pre">dcd:</span></code></dt>
<dd><p class="first last">iterate through trajectory</p>
</dd>
<dt><code class="docutils literal"><span class="pre">for</span> <span class="pre">ts</span> <span class="pre">in</span> <span class="pre">dcd[start:stop:skip]:</span></code></dt>
<dd><p class="first last">iterate through a trajectory</p>
</dd>
<dt><code class="docutils literal"><span class="pre">dcd[i]</span></code></dt>
<dd><p class="first last">random access into the trajectory (i corresponds to frame number)</p>
</dd>
<dt><code class="docutils literal"><span class="pre">data</span> <span class="pre">=</span> <span class="pre">dcd.timeseries(...)</span></code></dt>
<dd><p class="first last">retrieve a subset of coordinate information for a group of atoms</p>
</dd>
<dt><code class="docutils literal"><span class="pre">data</span> <span class="pre">=</span> <span class="pre">dcd.correl(...)</span></code></dt>
<dd><p class="first last">populate a <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.Timeseries.Collection</span></code> object with computed timeseries</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The DCD file format is not well defined. In particular, NAMD
and CHARMM use it differently. Currently, MDAnalysis tries to
guess the correct format for the unitcell representation but it
can be wrong. <strong>Check the unitcell dimensions</strong>, especially for
triclinic unitcells (see <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/187">Issue 187</a> and
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.dimensions" title="MDAnalysis.coordinates.DCD.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">Timestep.dimensions</span></code></a>). A second potential issue are the
units of time (TODO).</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>The underlying DCD reader (written in C and derived from the
catdcd/molfile plugin code of VMD) is now reading the unitcell in
NAMD ordering: <code class="docutils literal"><span class="pre">[A,</span> <span class="pre">B,</span> <span class="pre">C,</span> <span class="pre">sin(gamma),</span> <span class="pre">sin(beta),</span>
<span class="pre">sin(alpha)]</span></code>. See <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/187">Issue 187</a> for further details.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Frames now 0-based instead of 1-based
Native frame number read into ts._frame
Removed skip keyword and functionality</p>
</div>
<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.OtherWriter">
<code class="descname">OtherWriter</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.OtherWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a writer appropriate for <em>filename</em>.</p>
<p>Sets the default keywords <em>start</em>, <em>step</em> and <em>dt</em> (if
available). <em>n_atoms</em> is always set from <code class="xref py py-attr docutils literal"><span class="pre">Reader.n_atoms</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal"><span class="pre">Reader.Writer()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.Writer()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.Writer">
<code class="descname">Writer</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDReader.Writer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.Writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DCDWriter for <em>filename</em> with the same parameters as this DCD.</p>
<p>All values can be changed through keyword arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first docutils">
<dt><em>filename</em></dt>
<dd><p class="first last">filename of the output DCD trajectory</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Keywords:</th><td class="field-body"><dl class="first docutils">
<dt><em>n_atoms</em></dt>
<dd><p class="first last">number of atoms</p>
</dd>
<dt><em>start</em></dt>
<dd><p class="first last">number of the first recorded MD step</p>
</dd>
<dt><em>step</em></dt>
<dd><p class="first last">indicate that <em>step</em> MD steps (!) make up one trajectory frame</p>
</dd>
<dt><em>delta</em></dt>
<dd><p class="first last">MD integrator time step (!), in AKMA units</p>
</dd>
<dt><em>dt</em></dt>
<dd><p class="first last"><strong>Override</strong> <em>step</em> and <em>delta</em> so that the DCD records that <em>dt</em> ps
lie between two frames. (It sets <em>step</em> = 1 and <em>delta</em> = <code class="docutils literal"><span class="pre">AKMA(dt)</span></code>.)
The default is <code class="docutils literal"><span class="pre">None</span></code>, in which case <em>step</em> and <em>delta</em> are used.</p>
</dd>
<dt><em>remarks</em></dt>
<dd><p class="first last">string that is stored in the DCD header [XXX &#8211; max length?]</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDWriter" title="MDAnalysis.coordinates.DCD.DCDWriter"><code class="xref py py-class docutils literal"><span class="pre">DCDWriter</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The keyword arguments set the low-level attributes of the DCD
according to the CHARMM format. The time between two frames would be
<em>delta</em> * <em>step</em> !</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDWriter" title="MDAnalysis.coordinates.DCD.DCDWriter"><code class="xref py py-class docutils literal"><span class="pre">DCDWriter</span></code></a> has detailed argument description</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_forces_from_native">
<code class="descname">convert_forces_from_native</code><span class="sig-paren">(</span><em>force</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_forces_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of forces array <em>force</em> from native units to base units.</p>
<p>By default, the input <em>force</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.7.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_forces_to_native">
<code class="descname">convert_forces_to_native</code><span class="sig-paren">(</span><em>force</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_forces_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of force array <em>force</em> from base units to native units.</p>
<p>By default, the input <em>force</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.7.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_pos_from_native">
<code class="descname">convert_pos_from_native</code><span class="sig-paren">(</span><em>x</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_pos_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of coordinate array x from native units to base units.</p>
<p>By default, the input <em>x</em> is modified in place and also returned.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_pos_to_native">
<code class="descname">convert_pos_to_native</code><span class="sig-paren">(</span><em>x</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_pos_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>Conversion of coordinate array x from base units to native units.</p>
<p>By default, the input <em>x</em> is modified in place and also returned.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_time_from_native">
<code class="descname">convert_time_from_native</code><span class="sig-paren">(</span><em>t</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_time_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert time <em>t</em> from native units to base units.</p>
<p>By default, the input <em>t</em> is modified in place and also
returned (although note that scalar values <em>t</em> are passed by
value in Python and hence an in-place modification has no
effect on the caller.)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_time_to_native">
<code class="descname">convert_time_to_native</code><span class="sig-paren">(</span><em>t</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_time_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert time <em>t</em> from base units to native units.</p>
<p>By default, the input <em>t</em> is modified in place and also
returned. (Also note that scalar values <em>t</em> are passed by
value in Python and hence an in-place modification has no
effect on the caller.)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_velocities_from_native">
<code class="descname">convert_velocities_from_native</code><span class="sig-paren">(</span><em>v</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_velocities_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of velocities array <em>v</em> from native units to base units.</p>
<p>By default, the input <em>v</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.5.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.convert_velocities_to_native">
<code class="descname">convert_velocities_to_native</code><span class="sig-paren">(</span><em>v</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.convert_velocities_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of coordinate array <em>v</em> from base units to native units.</p>
<p>By default, the input <em>v</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.5.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.correl">
<code class="descname">correl</code><span class="sig-paren">(</span><em>timeseries</em>, <em>start=0</em>, <em>stop=-1</em>, <em>skip=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDReader.correl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.correl" title="Permalink to this definition">¶</a></dt>
<dd><p>Populate a TimeseriesCollection object with timeseries computed from the trajectory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first last docutils">
<dt><em>timeseries</em></dt>
<dd><p class="first last"><a class="reference internal" href="../core/Timeseries.html#MDAnalysis.core.Timeseries.TimeseriesCollection" title="MDAnalysis.core.Timeseries.TimeseriesCollection"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.Timeseries.TimeseriesCollection</span></code></a></p>
</dd>
<dt><em>start, stop, skip</em></dt>
<dd><p class="first last">subset of trajectory to use, with start and stop being inclusive</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.frame">
<code class="descname">frame</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Frame number of the current time step.</p>
<p>This is a simple short cut to <code class="xref py py-attr docutils literal"><span class="pre">Timestep.frame</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.next">
<code class="descname">next</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.next" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward one step to next frame.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.rewind">
<code class="descname">rewind</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.rewind" title="Permalink to this definition">¶</a></dt>
<dd><p>Position at beginning of trajectory</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.time">
<code class="descname">time</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time of the current frame in MDAnalysis time units (typically ps).</p>
<p>This is either read straight from the Timestep, or calculated as
time = <code class="xref py py-attr docutils literal"><span class="pre">Timestep.frame</span></code> * <a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.dt" title="MDAnalysis.coordinates.DCD.Timestep.dt"><code class="xref py py-attr docutils literal"><span class="pre">Timestep.dt</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.timeseries">
<code class="descname">timeseries</code><span class="sig-paren">(</span><em>asel</em>, <em>start=0</em>, <em>stop=-1</em>, <em>skip=1</em>, <em>format=u'afc'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDReader.timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a subset of coordinate data for an AtomGroup</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first last docutils">
<dt><em>asel</em></dt>
<dd><p class="first last"><a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> object</p>
</dd>
<dt><em>start, stop, skip</em></dt>
<dd><p class="first last">range of trajectory to access, start and stop are inclusive</p>
</dd>
<dt><em>format</em></dt>
<dd><p class="first last">the order/shape of the return data array, corresponding
to (a)tom, (f)rame, (c)oordinates all six combinations
of &#8216;a&#8217;, &#8216;f&#8217;, &#8216;c&#8217; are allowed ie &#8220;fac&#8221; - return array
where the shape is (frame, number of atoms,
coordinates)</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.coordinates.DCD.DCDReader.totaltime">
<code class="descname">totaltime</code><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDReader.totaltime" title="Permalink to this definition">¶</a></dt>
<dd><p>Total length of the trajectory n_frames * dt.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter">
<em class="property">class </em><code class="descclassname">MDAnalysis.coordinates.DCD.</code><code class="descname">DCDWriter</code><span class="sig-paren">(</span><em>filename</em>, <em>n_atoms</em>, <em>start=0</em>, <em>step=1</em>, <em>delta=20.45482949774598</em>, <em>dt=None</em>, <em>remarks=u'Created by DCDWriter'</em>, <em>convert_units=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDWriter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes to a DCD file</p>
<p>Typical usage:</p>
<div class="highlight-python"><div class="highlight"><pre>with DCDWriter(&quot;new.dcd&quot;, u.atoms.n_atoms) as w:
    for ts in u.trajectory
        w.write_next_timestep(ts)
</pre></div>
</div>
<p>Keywords are available to set some of the low-level attributes of the DCD.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Methods:</th><td class="field-body"><code class="docutils literal"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">DCDWriter(dcdfilename,</span> <span class="pre">n_atoms,</span> <span class="pre">start,</span> <span class="pre">step,</span> <span class="pre">delta,</span> <span class="pre">remarks)</span></code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Writer will write the <strong>unit cell information</strong> to the DCD in a
format compatible with NAMD and older CHARMM versions, namely the unit
cell lengths in Angstrom and the angle cosines (see
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep" title="MDAnalysis.coordinates.DCD.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a>). Newer versions of CHARMM (at least c36b2) store the
matrix of the box vectors. Writing this matrix to a DCD is currently not
supported (although reading is supported with the
<a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDReader" title="MDAnalysis.coordinates.DCD.DCDReader"><code class="xref py py-class docutils literal"><span class="pre">DCDReader</span></code></a>); instead the angle cosines are written,
which <em>might make the DCD file unusable in CHARMM itself</em>. See
<a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/187">Issue 187</a> for further information.</p>
<p class="last">The writing behavior of the <a class="reference internal" href="#MDAnalysis.coordinates.DCD.DCDWriter" title="MDAnalysis.coordinates.DCD.DCDWriter"><code class="xref py py-class docutils literal"><span class="pre">DCDWriter</span></code></a> is identical to
that of the DCD molfile plugin of VMD with the exception that
by default it will use AKMA time units.</p>
</div>
<p>Create a new DCDWriter</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first last docutils">
<dt><em>filename</em></dt>
<dd><p class="first last">name of output file</p>
</dd>
<dt><em>n_atoms</em></dt>
<dd><p class="first last">number of atoms in dcd file</p>
</dd>
<dt><em>start</em></dt>
<dd><p class="first last">starting timestep</p>
</dd>
<dt><em>step</em></dt>
<dd><p class="first last">skip between subsequent timesteps (indicate that <em>step</em> MD
integrator steps (!) make up one trajectory frame); default is 1.</p>
</dd>
<dt><em>delta</em></dt>
<dd><p class="first last">timestep (MD integrator time step (!), in AKMA units); default is
20.45482949774598 (corresponding to 1 ps).</p>
</dd>
<dt><em>remarks</em></dt>
<dd><p class="first last">comments to annotate dcd file</p>
</dd>
<dt><em>dt</em></dt>
<dd><p class="first last"><strong>Override</strong> <em>step</em> and <em>delta</em> so that the DCD records that <em>dt</em> ps
lie between two frames. (It sets <em>step</em> = 1 and <em>delta</em> = <code class="docutils literal"><span class="pre">AKMA(dt)</span></code>.)
The default is <code class="docutils literal"><span class="pre">None</span></code>, in which case <em>step</em> and <em>delta</em> are used.</p>
</dd>
<dt><em>convert_units</em></dt>
<dd><p class="first last">units are converted to the MDAnalysis base format; <code class="docutils literal"><span class="pre">None</span></code> selects
the value of <code class="xref py py-data docutils literal"><span class="pre">MDAnalysis.core.flags</span></code> [&#8216;convert_lengths&#8217;].
(see <a class="reference internal" href="../core/init.html#flags-label"><span>Flags</span></a>)</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The keyword arguments set the low-level attributes of the DCD
according to the CHARMM format. The time between two frames would be
<em>delta</em> * <em>step</em> ! For convenience, one can alternatively supply the
<em>dt</em> keyword (see above) to just tell the writer that it should
record &#8220;There are dt ps between each frame&#8221;.</p>
</div>
<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDWriter.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close trajectory and flush buffers.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_dimensions_to_unitcell">
<code class="descname">convert_dimensions_to_unitcell</code><span class="sig-paren">(</span><em>ts, _ts_order=[0, 2, 5, 4, 3, 1]</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDWriter.convert_dimensions_to_unitcell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_dimensions_to_unitcell" title="Permalink to this definition">¶</a></dt>
<dd><p>Read dimensions from timestep <em>ts</em> and return appropriate native unitcell.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep.dimensions" title="MDAnalysis.coordinates.DCD.Timestep.dimensions"><code class="xref py py-attr docutils literal"><span class="pre">Timestep.dimensions</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_forces_from_native">
<code class="descname">convert_forces_from_native</code><span class="sig-paren">(</span><em>force</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_forces_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of forces array <em>force</em> from native units to base units.</p>
<p>By default, the input <em>force</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.7.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_forces_to_native">
<code class="descname">convert_forces_to_native</code><span class="sig-paren">(</span><em>force</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_forces_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of force array <em>force</em> from base units to native units.</p>
<p>By default, the input <em>force</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.7.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_pos_from_native">
<code class="descname">convert_pos_from_native</code><span class="sig-paren">(</span><em>x</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_pos_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of coordinate array x from native units to base units.</p>
<p>By default, the input <em>x</em> is modified in place and also returned.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_pos_to_native">
<code class="descname">convert_pos_to_native</code><span class="sig-paren">(</span><em>x</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_pos_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>Conversion of coordinate array x from base units to native units.</p>
<p>By default, the input <em>x</em> is modified in place and also returned.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_time_from_native">
<code class="descname">convert_time_from_native</code><span class="sig-paren">(</span><em>t</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_time_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert time <em>t</em> from native units to base units.</p>
<p>By default, the input <em>t</em> is modified in place and also
returned (although note that scalar values <em>t</em> are passed by
value in Python and hence an in-place modification has no
effect on the caller.)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_time_to_native">
<code class="descname">convert_time_to_native</code><span class="sig-paren">(</span><em>t</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_time_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert time <em>t</em> from base units to native units.</p>
<p>By default, the input <em>t</em> is modified in place and also
returned. (Also note that scalar values <em>t</em> are passed by
value in Python and hence an in-place modification has no
effect on the caller.)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Keyword <em>inplace</em> can be set to <code class="docutils literal"><span class="pre">False</span></code> so that a
modified copy is returned <em>unless</em> no conversion takes
place, in which case the reference to the unmodified <em>x</em> is
returned.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_velocities_from_native">
<code class="descname">convert_velocities_from_native</code><span class="sig-paren">(</span><em>v</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_velocities_from_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of velocities array <em>v</em> from native units to base units.</p>
<p>By default, the input <em>v</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.5.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.convert_velocities_to_native">
<code class="descname">convert_velocities_to_native</code><span class="sig-paren">(</span><em>v</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.convert_velocities_to_native" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place conversion of coordinate array <em>v</em> from base units to native units.</p>
<p>By default, the input <em>v</em> is modified in place and also returned.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.5.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.has_valid_coordinates">
<code class="descname">has_valid_coordinates</code><span class="sig-paren">(</span><em>criteria</em>, <em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.has_valid_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if all values are within limit values of their formats.</p>
<p>Due to rounding, the test is asymmetric (and <em>min</em> is supposed to be negative):</p>
<blockquote>
<div>min &lt; x &lt;= max</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first docutils">
<dt><em>criteria</em></dt>
<dd><p class="first last">dictionary containing the <em>max</em> and <em>min</em> values in native units</p>
</dd>
<dt><em>x</em></dt>
<dd><p class="first last"><code class="xref py py-class docutils literal"><span class="pre">np.ndarray</span></code> of <code class="docutils literal"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z)</span></code> coordinates of atoms selected to be written out.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write current timestep, using the supplied <em>obj</em>.</p>
<p>The argument should be a <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a> or
a <code class="xref py py-class docutils literal"><span class="pre">Universe</span></code> or a <a class="reference internal" href="#MDAnalysis.coordinates.DCD.Timestep" title="MDAnalysis.coordinates.DCD.Timestep"><code class="xref py py-class docutils literal"><span class="pre">Timestep</span></code></a> instance.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The size of the <em>obj</em> must be the same as the number of atom
provided when setting up the trajectory.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.coordinates.DCD.DCDWriter.write_next_timestep">
<code class="descname">write_next_timestep</code><span class="sig-paren">(</span><em>ts=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/coordinates/DCD.html#DCDWriter.write_next_timestep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.coordinates.DCD.DCDWriter.write_next_timestep" title="Permalink to this definition">¶</a></dt>
<dd><p>write a new timestep to the dcd file</p>
<p><em>ts</em> - timestep object containing coordinates to be written to dcd file</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.5: </span>Raises <code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code> instead of generic <code class="xref py py-exc docutils literal"><span class="pre">Exception</span></code>
if wrong number of atoms supplied and <code class="xref py py-exc docutils literal"><span class="pre">NoDataError</span></code>
if no coordinates to be written.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="DLPoly.html" title="5.4. DL_Poly format reader MDAnalysis.coordinates.DLPoly"
             >next</a> |</li>
        <li class="right" >
          <a href="CRD.html" title="5.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.11.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../coordinates_modules.html" >5. Coordinates modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Gorman Stock, Isaac Virshup,
    Zhuyi Xue, Carlos Yáñez S.,
    and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>