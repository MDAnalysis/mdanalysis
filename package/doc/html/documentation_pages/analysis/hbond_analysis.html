<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.2.1. Hydrogen Bond analysis — MDAnalysis.analysis.hbonds.hbond_analysis &mdash; MDAnalysis 0.11.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.11.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.11.0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.11.0 documentation" href="../../index.html" />
    <link rel="up" title="3. Analysis modules" href="../analysis_modules.html" />
    <link rel="next" title="3.2.2. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel" href="hbond_autocorrel.html" />
    <link rel="prev" title="3.1.5. Calculating path similarity — MDAnalysis.analysis.psa" href="psa.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hbond_autocorrel.html" title="3.2.2. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="psa.html" title="3.1.5. Calculating path similarity — MDAnalysis.analysis.psa"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.11.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" accesskey="U">3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.2.1. Hydrogen Bond analysis &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></a><ul>
<li><a class="reference internal" href="#output">3.2.1.1. Output</a></li>
<li><a class="reference internal" href="#detection-of-hydrogen-bonds">3.2.1.2. Detection of hydrogen bonds</a></li>
<li><a class="reference internal" href="#example">3.2.1.3. Example</a></li>
<li><a class="reference internal" href="#classes">3.2.1.4. Classes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="psa.html"
                        title="previous chapter">3.1.5. Calculating path similarity &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.psa</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hbond_autocorrel.html"
                        title="next chapter">3.2.2. Hydrogen bond autocorrelation &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.hbond_autocorrel</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/analysis/hbond_analysis.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.hbonds.hbond_analysis"></span><div class="section" id="hydrogen-bond-analysis-mdanalysis-analysis-hbonds-hbond-analysis">
<h1>3.2.1. Hydrogen Bond analysis &#8212; <a class="reference internal" href="#module-MDAnalysis.analysis.hbonds.hbond_analysis" title="MDAnalysis.analysis.hbonds.hbond_analysis"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></a><a class="headerlink" href="#hydrogen-bond-analysis-mdanalysis-analysis-hbonds-hbond-analysis" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">David Caplan, Lukas Grossar, Oliver Beckstein</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2010-2012</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
</tbody>
</table>
<p>Given a <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.Universe" title="MDAnalysis.core.AtomGroup.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> (simulation
trajectory with 1 or more frames) measure all hydrogen bonds for each
frame between selections 1 and 2.</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a> class is modeled after the <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/plugins/hbonds/">VMD
HBONDS plugin</a>.</p>
<dl class="docutils">
<dt>Options:</dt>
<dd><ul class="first last simple">
<li><em>update_selections</em> (<code class="docutils literal"><span class="pre">True</span></code>): update selections at each frame?</li>
<li><em>selection_1_type</em> (&#8220;both&#8221;): selection 1 is the: &#8220;donor&#8221;, &#8220;acceptor&#8221;, &#8220;both&#8221;</li>
<li>donor-acceptor <em>distance</em> (Å): 3.0</li>
<li>Angle <em>cutoff</em> (degrees): 120.0</li>
<li><em>forcefield</em> to switch between default values for different force fields</li>
<li><em>donors</em> and <em>acceptors</em> atom types (to add additional atom names)</li>
</ul>
</dd>
</dl>
<div class="section" id="output">
<span id="analysis-output"></span><h2>3.2.1.1. Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>The results are</dt>
<dd><ul class="first last simple">
<li>the <strong>identities</strong> of donor and acceptor heavy-atoms,</li>
<li>the <strong>distance</strong> between the heavy atom acceptor atom and the hydrogen atom
that is bonded to the heavy atom donor,</li>
<li>the <strong>angle</strong> donor-hydrogen-acceptor angle (180º is linear).</li>
</ul>
</dd>
</dl>
<p>Hydrogen bond data are returned per frame, which is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a> (In the following description, <code class="docutils literal"><span class="pre">#</span></code>
indicates comments that are not part of the output.):</p>
<div class="highlight-python"><div class="highlight"><pre>results = [
    [ # frame 1
       [ # hbond 1
          &lt;donor index&gt;, &lt;acceptor index&gt;, &lt;donor string&gt;, &lt;acceptor string&gt;, &lt;distance&gt;, &lt;angle&gt;
       ],
       [ # hbond 2
          &lt;donor index&gt;, &lt;acceptor index&gt;, &lt;donor string&gt;, &lt;acceptor string&gt;, &lt;distance&gt;, &lt;angle&gt;
       ],
       ....
    ],
    [ # frame 2
      [ ... ], [ ... ], ...
    ],
    ...
]
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For historic reasons, the <em>donor index</em> and <em>acceptor index</em> are a 1-based
indices. To get the <code class="xref py py-attr docutils literal"><span class="pre">Atom.index</span></code> (the 0-based index typically used in
MDAnalysis simply subtract 1. For instance, to find an atom in
<code class="xref py py-attr docutils literal"><span class="pre">Universe.atoms</span></code> by <em>index</em> from the output one would use
<code class="docutils literal"><span class="pre">u.atoms[index-1]</span></code>.</p>
</div>
<p>Using the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis.generate_table()</span></code></a> method one can reformat
the results as a flat &#8220;normalised&#8221; table that is easier to import into a
database for further processing. <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.save_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.save_table"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis.save_table()</span></code></a> saves
the table to a pickled file. The table itself is a <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a>.</p>
</div>
<div class="section" id="detection-of-hydrogen-bonds">
<h2>3.2.1.2. Detection of hydrogen bonds<a class="headerlink" href="#detection-of-hydrogen-bonds" title="Permalink to this headline">¶</a></h2>
<p>Hydrogen bonds are recorded based on a geometric criterion:</p>
<ol class="arabic simple">
<li>The distance between acceptor and hydrogen is less than or equal to
<em>distance</em> (default is 3 Å).</li>
<li>The angle between donor-hydrogen-acceptor is greater than or equal to
<em>angle</em> (default is 120º).</li>
</ol>
<p>The cut-off values <em>angle</em> and <em>distance</em> can be set as keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a>.</p>
<p>Donor and acceptor heavy atoms are detected from atom names. The current
defaults are appropriate for the CHARMM27 and GLYCAM06 force fields as defined
in Table <a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis">Default atom names for hydrogen bonding analysis</a>.</p>
<p>Hydrogen atoms bonded to a donor are searched with one of two algorithms,
selected with the <em>detect_hydrogens</em> keyword.</p>
<p><em>distance</em></p>
<blockquote>
<div>Searches for all hydrogens (name &#8220;H*&#8221; or name &#8220;[123]H&#8221; or type &#8220;H&#8221;) in the
same residue as the donor atom within a cut-off distance of 1.2 Å.</div></blockquote>
<p><em>heuristic</em></p>
<blockquote>
<div>Looks at the next three atoms in the list of atoms following the donor and
selects any atom whose name matches (name &#8220;H*&#8221; or name &#8220;[123]H&#8221;). For</div></blockquote>
<p>The <em>distance</em> search is more rigorous but slower and is set as the
default. Until release 0.7.6, only the heuristic search was implemented.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Distance search added (see
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis._get_bonded_hydrogens_dist()</span></code></a>) and heuristic
search improved (<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis._get_bonded_hydrogens_list()</span></code></a>)</p>
</div>
<table border="1" class="docutils" id="id2">
<span id="default-atom-names-for-hydrogen-bonding-analysis"></span><caption><span class="caption-text">Default heavy atom names for CHARMM27 force field.</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="19%" />
<col width="15%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">group</th>
<th class="head">donor</th>
<th class="head">acceptor</th>
<th class="head">comments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>main chain</td>
<td>N</td>
<td>O</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>water</td>
<td>OH2, OW</td>
<td>OH2, OW</td>
<td>SPC, TIP3P, TIP4P (CHARMM27,Gromacs)</td>
</tr>
<tr class="row-even"><td>ARG</td>
<td>NE, NH1, NH2</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>ASN</td>
<td>ND2</td>
<td>OD1</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>ASP</td>
<td>&nbsp;</td>
<td>OD1, OD2</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>CYS</td>
<td>SG</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>CYH</td>
<td>&nbsp;</td>
<td>SG</td>
<td>possible false positives for CYS</td>
</tr>
<tr class="row-odd"><td>GLN</td>
<td>NE2</td>
<td>OE1</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>GLU</td>
<td>&nbsp;</td>
<td>OE1, OE2</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>HIS</td>
<td>ND1, NE2</td>
<td>ND1, NE2</td>
<td>presence of H determines if donor</td>
</tr>
<tr class="row-even"><td>HSD</td>
<td>ND1</td>
<td>NE2</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>HSE</td>
<td>NE2</td>
<td>ND1</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>HSP</td>
<td>ND1, NE2</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>LYS</td>
<td>NZ</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>MET</td>
<td>&nbsp;</td>
<td>SD</td>
<td>see e.g. <a class="reference internal" href="#gregoret1991" id="id1">[Gregoret1991]</a></td>
</tr>
<tr class="row-odd"><td>SER</td>
<td>OG</td>
<td>OG</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>THR</td>
<td>OG1</td>
<td>OG1</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>TRP</td>
<td>NE1</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>TYR</td>
<td>OH</td>
<td>OH</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Heavy atom types for GLYCAM06 force field.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="28%" />
<col width="28%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">element</th>
<th class="head">donor</th>
<th class="head">acceptor</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>N</td>
<td>N,NT,N3</td>
<td>N,NT</td>
</tr>
<tr class="row-odd"><td>O</td>
<td>OH,OW</td>
<td>O,O2,OH,OS,OW,OY</td>
</tr>
<tr class="row-even"><td>S</td>
<td>&nbsp;</td>
<td>SM</td>
</tr>
</tbody>
</table>
<p>Donor and acceptor names for the CHARMM27 force field will also work for e.g.
OPLS/AA (tested in Gromacs). Residue names in the table are for information
only and are not taken into account when determining acceptors and donors.
This can potentially lead to some ambiguity in the assignment of
donors/acceptors for residues such as histidine or cytosine.</p>
<p>For more information about the naming convention in GLYCAM06 have a look at the
<cite>Carbohydrate Naming Convention in Glycam</cite>.</p>
<p>The lists of donor and acceptor names can be extended by providing lists of
atom names in the <em>donors</em> and <em>acceptors</em> keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a>. If the lists are entirely inappropriate
(e.g. when analysing simulations done with a force field that uses very
different atom names) then one should either use the value &#8220;other&#8221; for <em>forcefield</em>
to set no default values, or derive a new class and set the default list oneself:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">HydrogenBondAnalysis_OtherFF</span><span class="p">(</span><span class="n">HydrogenBondAnalysis</span><span class="p">):</span>
      <span class="n">DEFAULT_DONORS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
      <span class="n">DEFAULT_ACCEPTORS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
</pre></div>
</div>
<p>Then simply use the new class instead of the parent class and call it with
<em>forcefield</em> = &#8220;OtherFF&#8221;. Please also consider to contribute the list of heavy
atom names to MDAnalysis.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="gregoret1991" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Gregoret1991]</a></td><td>L.M. Gregoret, S.D. Rader, R.J. Fletterick, and
F.E. Cohen. Hydrogen bonds involving sulfur atoms in proteins. Proteins,
9(2):99–107, 1991. <a class="reference external" href="http://dx.doi.org/10.1002/prot.340090204">10.1002/prot.340090204</a>.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="example">
<h2>3.2.1.3. Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>All protein-water hydrogen bonds can be analysed with</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">MDAnalysis.analysis.hbonds</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span> <span class="n">PDB</span><span class="p">,</span> <span class="n">permissive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">hbonds</span><span class="o">.</span><span class="n">HydrogenBondAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s">&#39;protein&#39;</span><span class="p">,</span> <span class="s">&#39;resname TIP3&#39;</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">120.0</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The results are stored as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>; see <a class="reference internal" href="#analysis-output"><span>Output</span></a>
for the format and further options.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the way <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a> is implemented, it is
more efficient to have the second selection (<em>selection2</em>) be the
<em>larger</em> group, e.g. the water when looking at water-protein
H-bonds or the whole protein when looking at ligand-protein
interactions.</p>
</div>
</div>
<div class="section" id="classes">
<h2>3.2.1.4. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.hbonds.hbond_analysis.</code><code class="descname">HydrogenBondAnalysis</code><span class="sig-paren">(</span><em>universe</em>, <em>selection1='protein'</em>, <em>selection2='all'</em>, <em>selection1_type='both'</em>, <em>update_selection1=True</em>, <em>update_selection2=True</em>, <em>filter_first=True</em>, <em>distance_type='hydrogen'</em>, <em>distance=3.0</em>, <em>angle=120.0</em>, <em>forcefield='CHARMM27'</em>, <em>donors=None</em>, <em>acceptors=None</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>verbose=False</em>, <em>detect_hydrogens='distance'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a hydrogen bond analysis</p>
<p>The analysis of the trajectory is performed with the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis.run()</span></code></a> method. The result is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>. See
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> for the format.</p>
<p>The default atom names are taken from the CHARMM 27 force field files, which
will also work for e.g. OPLS/AA in Gromacs, and GLYCAM06.</p>
<dl class="docutils">
<dt><em>Donors</em> (associated hydrogens are deduced from topology)</dt>
<dd><dl class="first last docutils">
<dt><em>CHARMM 27</em></dt>
<dd>N of the main chain, water OH2/OW, ARG NE/NH1/NH2, ASN ND2, HIS ND1/NE2,
SER OG, TYR OH, CYS SG, THR OG1, GLN NE2, LYS NZ, TRP NE1</dd>
<dt><em>GLYCAM06</em></dt>
<dd>N,NT,N3,OH,OW</dd>
</dl>
</dd>
<dt><em>Acceptors</em></dt>
<dd><dl class="first last docutils">
<dt><em>CHARMM 27</em></dt>
<dd>O of the main chain, water OH2/OW, ASN OD1, ASP OD1/OD2, CYH SG, GLN OE1,
GLU OE1/OE2, HIS ND1/NE2, MET SD, SER OG, THR OG1, TYR OH</dd>
<dt><em>GLYCAM06</em></dt>
<dd>N,NT,O,O2,OH,OS,OW,OY,P,S,SM</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Table <a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis"><span>Default heavy atom names for CHARMM27 force field.</span></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>DEFAULT_DONORS/ACCEPTORS is now embedded in a dict to switch between
default values for different force fields.</p>
</div>
<p>Set up calculation of hydrogen bonds between two selections in a universe.</p>
<p>The timeseries is accessible as the attribute <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>.</p>
<p>Some initial checks are performed. If there are no atoms selected by
<em>selection1</em> or <em>selection2</em> or if no donor hydrogens or acceptor atoms
are found then a <code class="xref py py-exc docutils literal"><span class="pre">SelectionError</span></code> is raised for any selection that
does <em>not</em> update (<em>update_selection1</em> and <em>update_selection2</em>
keywords). For selections that are set to update, only a warning is
logged because it is assumed that the selection might contain atoms at
a later frame (e.g. for distance based selections).</p>
<p>If no hydrogen bonds are detected or if the initial check fails, look
at the log output (enable with <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.start_logging()</span></code></a> and set
<em>verbose</em> = <code class="docutils literal"><span class="pre">True</span></code>). It is likely that the default names for donors
and acceptors are not suitable (especially for non-standard
ligands). In this case, either change the <em>forcefield</em> or use
customized <em>donors</em> and/or <em>acceptors</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In order to speed up processing, atoms are filtered by a coarse
distance criterion before a detailed hydrogen bonding analysis is
performed (<em>filter_first</em> = <code class="docutils literal"><span class="pre">True</span></code>). If one of your selections is
e.g. the solvent then <em>update_selection1</em> (or <em>update_selection2</em>)
must also be <code class="docutils literal"><span class="pre">True</span></code> so that the list of candidate atoms is updated
at each step: this is now the default.</p>
<p class="last">If your selections will essentially remain the same for all time
steps (i.e. residues are not moving farther than 3 x <em>distance</em>), for
instance, if no water or large conformational changes are involved
or if the optimization is disabled (<em>filter_first</em> = <code class="docutils literal"><span class="pre">False</span></code>) then
you can improve performance by setting the <em>update_selection</em>
keywords to <code class="docutils literal"><span class="pre">False</span></code>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><dl class="first docutils">
<dt><em>universe</em></dt>
<dd><p class="first last">Universe object</p>
</dd>
<dt><em>selection1</em></dt>
<dd><p class="first last">Selection string for first selection [&#8216;protein&#8217;]</p>
</dd>
<dt><em>selection2</em></dt>
<dd><p class="first last">Selection string for second selection [&#8216;all&#8217;]</p>
</dd>
<dt><em>selection1_type</em></dt>
<dd><p class="first last">Selection 1 can be &#8216;donor&#8217;, &#8216;acceptor&#8217; or &#8216;both&#8217;. Note that the
value for <em>selection1_type</em> automatically determines how
<em>selection2</em> handles donors and acceptors: If <em>selection1</em> contains
&#8216;both&#8217; then <em>selection2</em> will also contain <em>both</em>. If <em>selection1</em>
is set to &#8216;donor&#8217; then <em>selection2</em> is &#8216;acceptor&#8217; (and vice versa).
[&#8216;both&#8217;].</p>
</dd>
<dt><em>update_selection1</em></dt>
<dd><p class="first last">Update selection 1 at each frame? [<code class="docutils literal"><span class="pre">False</span></code>]</p>
</dd>
<dt><em>update_selection2</em></dt>
<dd><p class="first last">Update selection 2 at each frame? [<code class="docutils literal"><span class="pre">False</span></code>]</p>
</dd>
<dt><em>filter_first</em></dt>
<dd><p class="first last">Filter selection 2 first to only atoms 3*distance away [<code class="docutils literal"><span class="pre">True</span></code>]</p>
</dd>
<dt><em>distance</em></dt>
<dd><p class="first last">Distance cutoff for hydrogen bonds; only interactions with a H-A distance
&lt;= <em>distance</em> (and the appropriate D-H-A angle, see <em>angle</em>) are
recorded. (Note: <em>distance_type</em> can change this to the D-A distance.) [3.0]</p>
</dd>
<dt><em>angle</em></dt>
<dd><p class="first last">Angle cutoff for hydrogen bonds; an ideal H-bond has an angle of
180º.  A hydrogen bond is only recorded if the D-H-A angle is
&gt;=  <em>angle</em>. The default of 120º also finds fairly non-specific
hydrogen interactions and a possibly better value is 150º. [120.0]</p>
</dd>
<dt><em>forcefield</em></dt>
<dd><p class="first last">Name of the forcefield used. Switches between different
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS"><code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_DONORS</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS"><code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_ACCEPTORS</span></code></a> values.
Available values: &#8220;CHARMM27&#8221;, &#8220;GLYCAM06&#8221;, &#8220;other&#8221; [&#8220;CHARMM27&#8221;]</p>
</dd>
<dt><em>donors</em></dt>
<dd><p class="first last">Extra H donor atom types (in addition to those in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS"><code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_DONORS</span></code></a>), must be a sequence.</p>
</dd>
<dt><em>acceptors</em></dt>
<dd><p class="first last">Extra H acceptor atom types (in addition to those in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS"><code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_ACCEPTORS</span></code></a>), must be a sequence.</p>
</dd>
<dt><em>start</em></dt>
<dd><p class="first last">starting frame-index for analysis, <code class="docutils literal"><span class="pre">None</span></code> is the first one, 0.
<em>start</em> and <em>stop</em> are 0-based frame indices and are used to slice
the trajectory (if supported) [<code class="docutils literal"><span class="pre">None</span></code>]</p>
</dd>
<dt><em>stop</em></dt>
<dd><p class="first last">last trajectory frame for analysis, <code class="docutils literal"><span class="pre">None</span></code> is the last one [<code class="docutils literal"><span class="pre">None</span></code>]</p>
</dd>
<dt><em>step</em></dt>
<dd><p class="first last">read every <em>step</em> between <em>start</em> and <em>stop</em>, <code class="docutils literal"><span class="pre">None</span></code> selects 1.
Note that not all trajectory readers perform well with a step different
from 1 [<code class="docutils literal"><span class="pre">None</span></code>]</p>
</dd>
<dt><em>verbose</em></dt>
<dd><p class="first last">If set to <code class="docutils literal"><span class="pre">True</span></code> enables per-frame debug logging. This is disabled
by default because it generates a very large amount of output in
the log file. (Note that a logger must have been started to see
the output, e.g. using <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.start_logging()</span></code></a>.)</p>
</dd>
<dt><em>detect_hydrogens</em></dt>
<dd><p class="first last">Determine the algorithm to find hydrogens connected to donor
atoms. Can be &#8220;distance&#8221; (default; finds all hydrogens in the
donor&#8217;s residue within a cutoff of the donor) or &#8220;heuristic&#8221;
(looks for the next few atoms in the atom list). &#8220;distance&#8221; should
always give the correct answer but &#8220;heuristic&#8221; is faster,
especially when the donor list is updated each
for each frame. [&#8220;distance&#8221;]</p>
</dd>
<dt><em>distance_type</em></dt>
<dd><p class="first last">Measure hydrogen bond lengths between donor and acceptor heavy
attoms (&#8220;heavy&#8221;) or between donor hydrogen and acceptor heavy
atom (&#8220;hydrogen&#8221;). If using &#8220;heavy&#8221; then one should set the <em>distance</em>
cutoff to a higher value such as 3.5 Å. [&#8220;hydrogen&#8221;]</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">SelectionError</span></code> is raised for each static selection without
the required donors and/or acceptors.</p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>New <em>verbose</em> keyword (and per-frame debug logging disabled by
default).</p>
<p>New <em>detect_hydrogens</em> keyword to switch between two different
algorithms to detect hydrogens bonded to donor. &#8220;distance&#8221; is a new,
rigorous distance search within the residue of the donor atom,
&#8220;heuristic&#8221; is the previous list scan (improved with an additional
distance check).</p>
<p>New <em>forcefield</em> keyword to switch between different values of
DEFAULT_DONORS/ACCEPTORS to accomodate different force fields.
Also has an option &#8220;other&#8221; for no default values.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>The new default for <em>update_selection1</em> and <em>update_selection2</em> is now
<code class="docutils literal"><span class="pre">True</span></code> (see <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/138">Issue 138</a>). Set to <code class="docutils literal"><span class="pre">False</span></code> if your selections only
need to be determined once (will increase performance).</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>New keyword <em>distance_type</em> to select between calculation between
heavy atoms or hydrogen-acceptor. It defaults to the previous
behavior (i.e. &#8220;hydrogen&#8221;).</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Initial checks for selections that potentially raise <code class="xref py py-exc docutils literal"><span class="pre">SelectionError</span></code>.</p>
</div>
<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps">
<code class="descname">timesteps</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of the times of each timestep. This can be used together with
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> to find the specific time point
of a hydrogen bond existence, or see <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries">
<code class="descname">timeseries</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Results of the hydrogen bond analysis, stored for each frame. In
the following description, # indicates comments that are not
part of the output:</p>
<div class="highlight-python"><div class="highlight"><pre>results = [
    [ # frame 1
       [ # hbond 1
          &lt;donor index&gt;, &lt;acceptor index&gt;, &lt;donor string&gt;, &lt;acceptor string&gt;, &lt;distance&gt;, &lt;angle&gt;
       ],
       [ # hbond 2
          &lt;donor index&gt;, &lt;acceptor index&gt;, &lt;donor string&gt;, &lt;acceptor string&gt;, &lt;distance&gt;, &lt;angle&gt;
       ],
       ....
    ],
    [ # frame 2
      [ ... ], [ ... ], ...
    ],
    ...
]
</pre></div>
</div>
<p>The time of each step is not stored with each hydrogen bond frame but in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps"><code class="xref py py-attr docutils literal"><span class="pre">timesteps</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <em>index</em> is a 1-based index. To get the <code class="xref py py-attr docutils literal"><span class="pre">Atom.index</span></code> (the
0-based index typically used in MDAnalysis simply subtract 1. For
instance, to find an atom in <code class="xref py py-attr docutils literal"><span class="pre">Universe.atoms</span></code> by <em>index</em> one
would use <code class="docutils literal"><span class="pre">u.atoms[index-1]</span></code>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table">
<code class="descname">table</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="Permalink to this definition">¶</a></dt>
<dd><p>A normalised table of the data in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>, generated by
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis.generate_table()</span></code></a>. It is a
<a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> with the following columns:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li>&#8220;time&#8221;</li>
<li>&#8220;donor_idx&#8221;</li>
<li>&#8220;acceptor_idx&#8221;</li>
<li>&#8220;donor_resnm&#8221;</li>
<li>&#8220;donor_resid&#8221;</li>
<li>&#8220;donor_atom&#8221;</li>
<li>&#8220;acceptor_resnm&#8221;</li>
<li>&#8220;acceptor_resid&#8221;</li>
<li>&#8220;acceptor_atom&#8221;</li>
<li>&#8220;distance&#8221;</li>
<li>&#8220;angle&#8221;</li>
</ol>
</div></blockquote>
<p>It takes up more space than
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> but it is easier to
analyze and to import into databases (e.g. using <a class="reference external" href="http://pypi.python.org/pypi/RecSQL">recsql</a>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <em>index</em> is a 1-based index. To get the <code class="xref py py-attr docutils literal"><span class="pre">Atom.index</span></code> (the
0-based index typically used in MDAnalysis simply subtract 1. For
instance, to find an atom in <code class="xref py py-attr docutils literal"><span class="pre">Universe.atoms</span></code> by <em>index</em> one
would use <code class="docutils literal"><span class="pre">u.atoms[index-1]</span></code>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens">
<code class="descname">_get_bonded_hydrogens</code><span class="sig-paren">(</span><em>atom</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis._get_bonded_hydrogens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens" title="Permalink to this definition">¶</a></dt>
<dd><p>Find hydrogens bonded to <em>atom</em>.</p>
<p>This method is typically not called by a user but it is documented to
facilitate understanding of the internals of
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of hydrogens (can be a
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">AtomGroup</span></code></a>) or empty list
<code class="docutils literal"><span class="pre">[]</span></code> if none were found.</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist"><code class="xref py py-meth docutils literal"><span class="pre">_get_bonded_hydrogens_dist()</span></code></a> and <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list"><code class="xref py py-meth docutils literal"><span class="pre">_get_bonded_hydrogens_list()</span></code></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Can switch algorithm by using the <em>detect_hydrogens</em> keyword to the
constructor. <em>kwargs</em> can be used to supply arguments for algorithm.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist">
<code class="descname">_get_bonded_hydrogens_dist</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis._get_bonded_hydrogens_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Find hydrogens bonded within <em>cutoff</em> to <em>atom</em>.</p>
<ul class="simple">
<li>hydrogens are detected by either name (&#8220;H*&#8221;, &#8220;[123]H*&#8221;) or type
(&#8220;H&#8221;); this is not fool-proof as the atom type is not always a
character but the name pattern should catch most typical occurrences.</li>
<li>The distance from <em>atom</em> is calculated for all hydrogens in the
residue and only those within a cutoff are kept. The cutoff depends
on the heavy atom (more precisely, on its element, which is taken as
the first letter of its name <code class="docutils literal"><span class="pre">atom.name[0]</span></code>) and is parameterized
in <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.r_cov</span></code></a>. If no match is found then the
default of 1.5 Å is used.</li>
</ul>
<p>The performance of this implementation could be improved once the
topology always contains bonded information; it currently uses the
selection parser with an &#8220;around&#8221; selection.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.6.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list">
<code class="descname">_get_bonded_hydrogens_list</code><span class="sig-paren">(</span><em>atom</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis._get_bonded_hydrogens_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Find &#8220;bonded&#8221; hydrogens to the donor <em>atom</em>.</p>
<p>At the moment this relies on the <strong>assumption</strong> that the
hydrogens are listed directly after the heavy atom in the
topology. If this is not the case then this function will
fail.</p>
<p>Hydrogens are detected by name <code class="docutils literal"><span class="pre">H*</span></code>, <code class="docutils literal"><span class="pre">[123]H*</span></code> and they have to be
within a maximum distance from the heavy atom. The cutoff distance
depends on the heavy atom and is parameterized in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.r_cov</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Added detection of <code class="docutils literal"><span class="pre">[123]H</span></code> and additional check that a
selected hydrogen is bonded to the donor atom (i.e. its
distance to the donor is less than the covalent radius
stored in <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.r_cov</span></code></a> or the default
1.5 Å).</p>
<p>Changed name to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list"><code class="xref py py-meth docutils literal"><span class="pre">_get_bonded_hydrogens_list()</span></code></a>
and added <em>kwargs</em> so that it can be used instead of
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist"><code class="xref py py-meth docutils literal"><span class="pre">_get_bonded_hydrogens_dist()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS">
<code class="descname">DEFAULT_ACCEPTORS</code><em class="property"> = {'GLYCAM06': ('SM', 'OH', 'NT', 'O', 'N', 'OY', 'OW', 'OS', 'O2'), 'other': (), 'CHARMM27': ('OH', 'OG', 'OD1', 'OD2', 'OG1', 'O', 'ND1', 'NE2', 'OE2', 'OW', 'SG', 'OE1', 'OH2', 'SD')}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default atom names that are treated as hydrogen <em>acceptors</em>
(see <a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis"><span>Default heavy atom names for CHARMM27 force field.</span></a>)
Use the keyword <em>acceptors</em> to add a list of additional acceptor names.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS">
<code class="descname">DEFAULT_DONORS</code><em class="property"> = {'GLYCAM06': ('OW', 'N3', 'NT', 'OH', 'N'), 'other': (), 'CHARMM27': ('OH', 'OG', 'NE2', 'OG1', 'NE', 'N', 'ND1', 'NZ', 'NH1', 'NH2', 'OW', 'ND2', 'SG', 'OH2', 'NE1')}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the keyword <em>donors</em> to add a list of additional donor names.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.calc_angle">
<code class="descname">calc_angle</code><span class="sig-paren">(</span><em>d</em>, <em>h</em>, <em>a</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.calc_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.calc_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the angle (in degrees) between two atoms with H at apex.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.calc_eucl_distance">
<code class="descname">calc_eucl_distance</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.calc_eucl_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.calc_eucl_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Euclidean distance between two atoms.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_time">
<code class="descname">count_by_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.count_by_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of hydrogen bonds per timestep.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a class:<cite>numpy.recarray</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_type">
<code class="descname">count_by_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.count_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the frequency of hydrogen bonds of a specific type.</p>
<p>Processes <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a> and returns
a <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> containing atom indices, residue
names, residue numbers (for donors and acceptors) and the
fraction of the total time during which the hydrogen bond was
detected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a class:<cite>numpy.recarray</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table">
<code class="descname">generate_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.generate_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a normalised table of the results.</p>
<p>The table is stored as a <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> in the
attribute <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a> and can be used
with e.g. <a class="reference external" href="http://pypi.python.org/pypi/RecSQL">recsql</a>.</p>
<dl class="docutils">
<dt>Columns:</dt>
<dd><ol class="first last arabic simple" start="0">
<li>&#8220;time&#8221;</li>
<li>&#8220;donor_idx&#8221;</li>
<li>&#8220;acceptor_idx&#8221;</li>
<li>&#8220;donor_resnm&#8221;</li>
<li>&#8220;donor_resid&#8221;</li>
<li>&#8220;donor_atom&#8221;</li>
<li>&#8220;acceptor_resnm&#8221;</li>
<li>&#8220;acceptor_resid&#8221;</li>
<li>&#8220;acceptor_atom&#8221;</li>
<li>&#8220;distance&#8221;</li>
<li>&#8220;angle&#8221;</li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov">
<code class="descname">r_cov</code><em class="property"> = defaultdict(&lt;function &lt;lambda&gt; at 0x2af820fdac08&gt;, {'P': 1.58, 'S': 1.55, 'O': 1.31, 'N': 1.31})</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="http://docs.python.org/library/collections.html#collections.defaultdict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">collections.defaultdict</span></code></a> of covalent radii of common donors
(used in :meth`_get_bonded_hydrogens_list` to check if a hydrogen is
sufficiently close to its donor heavy atom). Values are stored for
N, O, P, and S. Any other heavy atoms are assumed to have hydrogens
covalently bound at a maximum distance of 1.5 Å.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze trajectory and produce timeseries.</p>
<p>Stores the hydrogen bond data per frame as
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a> (see there for output
format).</p>
<p>The method accepts a number of keywords, amongst them <em>quiet</em> (default
<code class="docutils literal"><span class="pre">False</span></code>), which silences the porgress output (see
<a class="reference internal" href="../lib/log.html#MDAnalysis.lib.log.ProgressMeter" title="MDAnalysis.lib.log.ProgressMeter"><code class="xref py py-class docutils literal"><span class="pre">ProgressMeter</span></code></a>) and <em>verbose</em> (which can
be used to change the value provided with the class constructor).</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">HydrogenBondAnalysis.generate_table()</span></code></a> for processing
the data into a different format.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Results are not returned, only stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> and duplicate hydrogen bonds
are removed from output (can be suppressed with <em>remove_duplicates</em> =
<code class="docutils literal"><span class="pre">False</span></code>)</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Accept <em>quiet</em> keyword. Analysis will now proceed through frames even if
no donors or acceptors were found in a particular frame.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.save_table">
<code class="descname">save_table</code><span class="sig-paren">(</span><em>filename='hbond_table.pickle'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.save_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.save_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a> to a pickled file.</p>
<p>Load with</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">cPickle</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="http://docs.python.org/library/pickle.html#module-cPickle" title="(in Python v2.7)"><code class="xref py py-mod docutils literal"><span class="pre">cPickle</span></code></a> module and <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps_by_type">
<code class="descname">timesteps_by_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.timesteps_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Frames during which each hydrogen bond existed, sorted by hydrogen bond.</p>
<p>Processes <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a> and returns
a <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.9)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> containing atom indices, residue
names, residue numbers (for donors and acceptors) and a list
of timesteps at which the hydrogen bond was detected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a class:<cite>numpy.recarray</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hbond_autocorrel.html" title="3.2.2. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel"
             >next</a> |</li>
        <li class="right" >
          <a href="psa.html" title="3.1.5. Calculating path similarity — MDAnalysis.analysis.psa"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.11.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" >3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Gorman Stock, Isaac Virshup,
    Zhuyi Xue, Carlos Yáñez S.,
    and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>