<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MDAnalysis.core.Timeseries &mdash; MDAnalysis 0.11.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.11.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.11.0 documentation"
          href="../../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.11.0 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MDAnalysis 0.11.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for MDAnalysis.core.Timeseries</h1><div class="highlight"><pre>
<span class="c"># -*- Mode: python; tab-width: 4; indent-tabs-mode:nil; coding:utf-8 -*-</span>
<span class="c"># vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4 fileencoding=utf-8</span>
<span class="c">#</span>
<span class="c"># MDAnalysis --- http://www.MDAnalysis.org</span>
<span class="c"># Copyright (c) 2006-2015 Naveen Michaud-Agrawal, Elizabeth J. Denning, Oliver Beckstein</span>
<span class="c"># and contributors (see AUTHORS for the full list)</span>
<span class="c">#</span>
<span class="c"># Released under the GNU Public Licence, v2 or any higher version</span>
<span class="c">#</span>
<span class="c"># Please cite your use of MDAnalysis in published work:</span>
<span class="c">#</span>
<span class="c"># N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and O. Beckstein.</span>
<span class="c"># MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations.</span>
<span class="c"># J. Comput. Chem. 32 (2011), 2319--2327, doi:10.1002/jcc.21787</span>
<span class="c">#</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Compute observable timeseries from trajectories --- :mod:`MDAnalysis.core.Timeseries`</span>
<span class="sd">=======================================================================================</span>

<span class="sd">The collection of timeseries (such as :class:`Atom`, :class:`Bond`,</span>
<span class="sd">:class:`Dihedral`...)  can be computed from a trajectory in one go, foregoing</span>
<span class="sd">the need to iterate through the trajectory frame by frame in python. Inspired</span>
<span class="sd">by CHARMM&#39;s correl command.</span>

<span class="sd">The disadvantage is that the timeseries &#39;plugins&#39; must be implemented</span>
<span class="sd">in C-code. Hence not all trajectory readers (see :mod:`MDAnalysis.coordinates`)</span>
<span class="sd">support them.</span>


<span class="sd">Basic classes</span>
<span class="sd">-------------</span>

<span class="sd">.. autoclass:: Timeseries</span>
<span class="sd">   :members:</span>

<span class="sd">.. autoclass:: TimeseriesCollection</span>
<span class="sd">   :members:</span>


<span class="sd">Timeseries of observables</span>
<span class="sd">-------------------------</span>

<span class="sd">.. autoclass:: Atom</span>
<span class="sd">.. autoclass:: Bond</span>
<span class="sd">.. autoclass:: Angle</span>
<span class="sd">.. autoclass:: Dihedral</span>
<span class="sd">.. autoclass:: Distance</span>
<span class="sd">.. autoclass:: CenterOfGeometry</span>
<span class="sd">.. autoclass:: CenterOfMass</span>
<span class="sd">.. autoclass:: WaterDipole</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">AtomGroup</span>


<div class="viewcode-block" id="TimeseriesCollection"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.TimeseriesCollection">[docs]</a><span class="k">class</span> <span class="nc">TimeseriesCollection</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A collection of timeseries objects.</span>

<span class="sd">    The collection of timeseries (such as Atom, Bond, Dihedral...)  can be</span>
<span class="sd">    computed from a trajectory in one go, foregoing the need to iterate through</span>
<span class="sd">    the trajectory frame by frame in python. Inspired by CHARMM&#39;s correl</span>
<span class="sd">    command.</span>

<span class="sd">    The disadvantage is that the timeseries &#39;plugins&#39; must be implemented in</span>
<span class="sd">    C-code. ::</span>

<span class="sd">       collection = TimeseriesCollection()</span>
<span class="sd">       collection.addTimeseries(Timeseries.Atom(...)) - add a new Timeseries object</span>
<span class="sd">       collection.compute(...)                        - compute the collection of timeseries from the trajectory</span>
<span class="sd">       collection.clear()                             - clear the collection</span>
<span class="sd">       collection[i]                                  - access the i&#39;th timeseries</span>
<span class="sd">       len(collection)                                - return the number of Timeseries added to the collection</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39;s&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">return</span> <span class="s">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&#39; with </span><span class="si">%d</span><span class="s"> timeseries object</span><span class="si">%s</span><span class="s">&gt;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">suffix</span><span class="p">)</span>

<div class="viewcode-block" id="TimeseriesCollection.addTimeseries"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.TimeseriesCollection.addTimeseries">[docs]</a>    <span class="k">def</span> <span class="nf">addTimeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ts</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;add a Timeseries object to the collection&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">Timeseries</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Can only add Timeseries objects to TimeseriesCollection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TimeseriesCollection.clear"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.TimeseriesCollection.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;clear the timeseries collection&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>
</div>
<div class="viewcode-block" id="TimeseriesCollection.compute"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.TimeseriesCollection.compute">[docs]</a>    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trj</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Iterate through the trajectory *trj* and compute the time series.</span>

<span class="sd">         *trj*</span>
<span class="sd">            dcd trajectory object (i.e. :attr:`Universe.trajectory`)</span>

<span class="sd">         *start, stop, skip*</span>
<span class="sd">            Frames to calculate parts of the trajectory. It is important to</span>
<span class="sd">            note that *start* and *stop* are inclusive</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">trj</span><span class="o">.</span><span class="n">correl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">skip</span><span class="p">)</span>
        <span class="c"># Now remap the timeseries data to each timeseries</span>
        <span class="n">typestr</span> <span class="o">=</span> <span class="s">&quot;|f8&quot;</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="n">finish</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">getDataSize</span><span class="p">()</span>
            <span class="n">datasize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">getFormatCode</span><span class="p">())</span>
            <span class="n">subarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">start</span> <span class="o">+</span> <span class="n">finish</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">datasize</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">subarray</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">datasize</span><span class="p">,</span> <span class="n">subarray</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">datasize</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">__data__</span> <span class="o">=</span> <span class="n">subarray</span>
            <span class="n">t</span><span class="o">.</span><span class="n">__array_interface__</span> <span class="o">=</span> <span class="n">subarray</span><span class="o">.</span><span class="n">__array_interface__</span>
            <span class="n">start</span> <span class="o">+=</span> <span class="n">finish</span>
</div>
    <span class="k">def</span> <span class="nf">_getAtomList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atomlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atomlist</span> <span class="o">+=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getAtomList</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atomlist</span>

    <span class="k">def</span> <span class="nf">_getFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">ts</span><span class="o">.</span><span class="n">getFormatCode</span><span class="p">()</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_getBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;_atomlist&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getAtomList</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atomlist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lowerb</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atomlist</span><span class="p">)</span>
            <span class="n">upperb</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atomlist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lowerb</span> <span class="o">=</span> <span class="n">upperb</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">lowerb</span><span class="p">,</span> <span class="n">upperb</span>

    <span class="k">def</span> <span class="nf">_getDataSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">ts</span><span class="o">.</span><span class="n">getDataSize</span><span class="p">()</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_getAtomCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">atomCounts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="n">atomCounts</span> <span class="o">+=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getAtomCounts</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">atomCounts</span>

    <span class="k">def</span> <span class="nf">_getAuxData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">auxData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
            <span class="n">auxData</span> <span class="o">+=</span> <span class="n">ts</span><span class="o">.</span><span class="n">getAuxData</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">auxData</span>

</div>
<div class="viewcode-block" id="Timeseries"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.Timeseries">[docs]</a><span class="k">class</span> <span class="nc">Timeseries</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Base timeseries class - define subclasses for specific timeseries computations</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">dsize</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">AtomGroup</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">atoms</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">Atom</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">atoms</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Invalid atoms passed to </span><span class="si">%s</span><span class="s"> timeseries&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dsize</span> <span class="o">=</span> <span class="n">dsize</span>

    <span class="c"># Properties</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;shape tuple of the underlying numpy array&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data__</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data__</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data__</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;__data__&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&#39; timeseries object is populated with data&gt;</span><span class="se">\n</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> \
                                                   <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__data__</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span> <span class="o">+</span> <span class="s">&#39; timeseries object is not populated with data&gt;&#39;</span>

    <span class="k">def</span> <span class="nf">getAtomList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getFormatCode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span>

    <span class="k">def</span> <span class="nf">getDataSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dsize</span>

    <span class="k">def</span> <span class="nf">getNumAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>

    <span class="k">def</span> <span class="nf">getAtomCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getAuxData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="mf">0.</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>

</div>
<div class="viewcode-block" id="Atom"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.Atom">[docs]</a><span class="k">class</span> <span class="nc">Atom</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns coordinate data for an atom or group of atoms ::</span>

<span class="sd">           t = Atom(code, atoms)</span>

<span class="sd">        *code*</span>
<span class="sd">          is one of &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, or &#39;v&#39; (&#39;vector&#39;, which returns all three</span>
<span class="sd">          dimensions)</span>

<span class="sd">        *atoms*</span>
<span class="sd">          can be a single :class:`~MDAnalysis.core.AtomGroup.Atom` object,</span>
<span class="sd">          a list of :class:`~MDAnalysis.core.AtomGroup.Atom` objects, or an</span>
<span class="sd">          :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Bad code&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="s">&#39;v&#39;</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">AtomGroup</span><span class="p">):</span>
            <span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">AtomGroup</span><span class="o">.</span><span class="n">Atom</span><span class="p">):</span>
            <span class="n">n_atoms</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Invalid atoms passed to </span><span class="si">%s</span><span class="s"> timeseries&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span> <span class="o">*</span> <span class="n">n_atoms</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">n_atoms</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAtomCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>

</div>
<div class="viewcode-block" id="Bond"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.Bond">[docs]</a><span class="k">class</span> <span class="nc">Bond</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns a timeseries for a bond</span>

<span class="sd">           t = Bond(atoms)</span>

<span class="sd">        *atoms* must contain 2 :class:`~MDAnalysis.core.AtomGroup.Atom` instances, either as a list or an</span>
<span class="sd">        :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Bond timeseries requires a 2 atom selection&quot;</span><span class="p">)</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Angle"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.Angle">[docs]</a><span class="k">class</span> <span class="nc">Angle</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns a timeseries for an angle</span>

<span class="sd">           t = Angle(atoms)</span>

<span class="sd">        atoms must contain 3 :class:`~MDAnalysis.core.AtomGroup.Atom` instances, either as a list or an</span>
<span class="sd">        :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Angle timeseries requires a 3 atom selection&quot;</span><span class="p">)</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Dihedral"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.Dihedral">[docs]</a><span class="k">class</span> <span class="nc">Dihedral</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns a timeseries for a dihedral angle</span>

<span class="sd">           t = Dihedral(atoms)</span>

<span class="sd">        atoms must contain 4 :class:`~MDAnalysis.core.AtomGroup.Atom` objects, either as a list or an</span>
<span class="sd">        :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Dihedral timeseries requires a 4 atom selection&quot;</span><span class="p">)</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;h&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Distance"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.Distance">[docs]</a><span class="k">class</span> <span class="nc">Distance</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns distances between 2 atoms</span>

<span class="sd">           t = Distance(code, atoms)</span>

<span class="sd">        code is one of &#39;d&#39; (distance vector), or &#39;r&#39; (scalar distance)</span>
<span class="sd">        atoms must contain 2 :class:`~MDAnalysis.core.AtomGroup.Atom` objects, either as a list or an</span>
<span class="sd">        :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Bad code&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="s">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Distance timeseries requires a 2 atom selection&quot;</span><span class="p">)</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="CenterOfGeometry"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.CenterOfGeometry">[docs]</a><span class="k">class</span> <span class="nc">CenterOfGeometry</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns the center of geometry of a group of atoms</span>

<span class="sd">           t = CenterOfGeometry(atoms)</span>

<span class="sd">        *atoms* can be a list of :class:`~MDAnalysis.core.AtomGroup.Atom`</span>
<span class="sd">        objects, or a :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAuxData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_atoms</span>

</div>
<div class="viewcode-block" id="CenterOfMass"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.CenterOfMass">[docs]</a><span class="k">class</span> <span class="nc">CenterOfMass</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a timeseries that returns the center of mass of a group of atoms</span>

<span class="sd">           t = CenterOfMass(atoms)</span>

<span class="sd">        *atoms* can be a list of :class:`~MDAnalysis.core.AtomGroup.Atom`</span>
<span class="sd">        objects or a :class:`~MDAnalysis.core.AtomGroup.AtomGroup`</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;m&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAuxData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="WaterDipole"><a class="viewcode-back" href="../../../documentation_pages/core/Timeseries.html#MDAnalysis.core.Timeseries.WaterDipole">[docs]</a><span class="k">class</span> <span class="nc">WaterDipole</span><span class="p">(</span><span class="n">Timeseries</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;Create a Timeseries that returns a timeseries for the bisector vector of a 3-site water</span>

<span class="sd">           d = WaterDipole(atoms)</span>

<span class="sd">        *atoms* must contain 3 :class:`~MDAnalysis.core.AtomGroup.Atom`</span>
<span class="sd">        objects, either as a list or an</span>
<span class="sd">        :class:`~MDAnalysis.core.AtomGroup.AtomGroup`; the first one *must* be</span>
<span class="sd">        the oxygen, the other two are the hydrogens.</span>

<span class="sd">        The vector ``d``, multiplied by the partial charge on the oxygen atom</span>
<span class="sd">        (e.g. *q* = -0.0.834 for TIP3P water), gives the actual dipole moment.</span>

<span class="sd">        The vector is calculated from the positions of the oxygen atom</span>
<span class="sd">        (:math:`\mathbf{x}_{\text{O}}`) and the two hydrogen atoms</span>
<span class="sd">        (:math:`\mathbf{x}_{\text{H}_1}`, :math:`\mathbf{x}_{\text{H}_2}`) as</span>

<span class="sd">        .. math::</span>

<span class="sd">           \mathbf{d} = \mathbf{x}_{\text{O}} - \frac{1}{2}(\mathbf{x}_{\text{H}_1} + \mathbf{x}_{\text{H}_2})</span>

<span class="sd">        and the dipole moment vector is</span>

<span class="sd">         .. math::</span>

<span class="sd">           \boldsymbol{\mu} = q_{\text{O}} \mathbf{d}</span>

<span class="sd">        .. Note::</span>

<span class="sd">           This will only work for water models that have half of the oxygen</span>
<span class="sd">           charge on each hydrogen. The vector :math:`\mathbf{d}` has the</span>
<span class="sd">           opposite direction of the dipole moment; multiplying with the oxygen</span>
<span class="sd">           charge (:math:`q_{\text{O}}&lt;0`) will flip the direction and produce</span>
<span class="sd">           the correct orientation.</span>

<span class="sd">           There are no sanity checks; *if the first atom in a water</span>
<span class="sd">           molecule is not oxygen then results will be wrong.*</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;WaterDipole timeseries requires a 3 atom selection&quot;</span><span class="p">)</span>
        <span class="n">Timeseries</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MDAnalysis 0.11.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Gorman Stock, Isaac Virshup,
    Zhuyi Xue, Carlos Yáñez S.,
    and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>