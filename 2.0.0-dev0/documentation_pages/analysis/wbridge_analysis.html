

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.3.4. Water Bridge analysis — MDAnalysis.analysis.hbonds.WaterBridgeAnalysis &mdash; MDAnalysis 2.0.0-dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="../../_static/js/versions.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 2.0.0-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.4.1. HOLE analysis — MDAnalysis.analysis.hole2" href="hole2.html" />
    <link rel="prev" title="4.3.3. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel" href="hbond_autocorrel.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/mdanalysis-logo-thin.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.0.0-dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hydrogenbonds.html">4.3.1. Hydrogen Bond Analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.hbond_analysis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hbond_analysis.html">4.3.2. Hydrogen Bond analysis (Deprecated) — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hbond_autocorrel.html">4.3.3. Hydrogen bond autocorrelation — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_autocorrel</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.3.4. Water Bridge analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.WaterBridgeAnalysis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#theory">4.3.4.1. Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-as-network">4.3.4.2. Output as Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-as-timeseries">4.3.4.3. Output as Timeseries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detection-of-water-bridges">4.3.4.4. Detection of water bridges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-perform-waterbridgeanalysis">4.3.4.5. How to perform WaterBridgeAnalysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-count-by-type">4.3.4.6. Use count_by_type</a></li>
<li class="toctree-l4"><a class="reference internal" href="#use-count-by-time">4.3.4.7. Use count_by_time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">4.3.4.8. Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#data">4.11. Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">13. Library functions — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">14. Version information for MDAnalysis - <code class="docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">15. Constants and unit conversion — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">16. Custom exceptions and warnings — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">17. References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../analysis_modules.html">4. Analysis modules</a> &raquo;</li>
        
      <li>4.3.4. Water Bridge analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.WaterBridgeAnalysis</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/documentation_pages/analysis/wbridge_analysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-MDAnalysis.analysis.hbonds.wbridge_analysis"></span><div class="section" id="water-bridge-analysis-mdanalysis-analysis-hbonds-waterbridgeanalysis">
<h1>4.3.4. Water Bridge analysis — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.WaterBridgeAnalysis</span></code><a class="headerlink" href="#water-bridge-analysis-mdanalysis-analysis-hbonds-waterbridgeanalysis" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Zhiyi Wu</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2017-2018</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
<tr class="field-even field"><th class="field-name">Maintainer:</th><td class="field-body">Zhiyi Wu &lt;<a class="reference external" href="mailto:zhiyi&#46;wu&#37;&#52;&#48;gtc&#46;ox&#46;ac&#46;uk">zhiyi<span>&#46;</span>wu<span>&#64;</span>gtc<span>&#46;</span>ox<span>&#46;</span>ac<span>&#46;</span>uk</a>&gt;,  <a class="reference external" href="https://github.com/xiki-tempula">&#64;xiki-tempula</a> on GitHub</td>
</tr>
</tbody>
</table>
<p>Given a <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> (simulation
trajectory with 1 or more frames) measure all water bridges for each
frame between selections 1 and 2.
Water bridge is defined as a bridging water which simultaneously forms
two hydrogen bonds with atoms from both selection 1 and selection 2.</p>
<p>A water bridge can form between two hydrogen bond acceptors.</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O−H···:<sup>-</sup>O<sub>2</sub>C-</p>
<p>A water bridge can also form between two hydrogen bond donors.</p>
<p>e.g. -NH···:O:···HN- (where O is the oxygen of a bridging water)</p>
<p>A hydrogen bond acceptor and another hydrogen bond donor can be bridged by a
water.</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O:···HN- (where H−O is part of <strong>H−O</strong>−H)</p>
<p>A higher order water bridge is defined as more than one water bridging
hydrogen bond acceptor and donor. An example of a second order water bridge:</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O:···H−O:···HN- (where H−O is part of <strong>H−O</strong>−H)</p>
<p>The following keyword arguments are important to control the behaviour of the
water bridge analysis:</p>
<blockquote>
<div><ul class="simple">
<li><em>water_selection</em> (<code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">SOL</span></code>): the selection string for the bridging
water</li>
<li><em>order</em> the maximum number of water bridging both ends</li>
<li>donor-acceptor <em>distance</em> (Å): 3.0</li>
<li>Angle <em>cutoff</em> (degrees): 120.0</li>
<li><em>forcefield</em> to switch between default values for different force fields</li>
<li><em>donors</em> and <em>acceptors</em> atom types (to add additional atom names)</li>
</ul>
</div></blockquote>
<div class="section" id="theory">
<h2>4.3.4.1. Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h2>
<p>This module attempts to find multi-order water bridge by an approach similar
to breadth-first search, where the first solvation shell of selection 1 is
selected, followed by the selection of the second solvation shell as well as
any hydrogen bonding partner from selection 1. After that, the third solvation
shell, as well as any binding partners from selection 2, are detected. This
process is repeated until the maximum order of water bridges is reached.</p>
</div>
<div class="section" id="output-as-network">
<span id="wb-analysis-network"></span><h2>4.3.4.2. Output as Network<a class="headerlink" href="#output-as-network" title="Permalink to this headline">¶</a></h2>
<p>Since the waters connecting the two ends of the selections are by nature a network.
We provide a network representation of the water network. Water bridge data are
returned per frame, which is stored in <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.network" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.network</span></code></a>. Each
frame is represented as a dictionary, where the keys are the hydrogen bonds
originating from selection 1 and the values are new dictionaries representing
the hydrogen bonds coming out of the corresponding molecules making hydrogen bonds
with selection 1.</p>
<p>As for the hydrogen bonds which reach the selection 2, the values of the
corresponding keys are None. One example where selection 1 and selection 2 are
joined by one water molecule (A) which also hydrogen bond to another water (B)
which also hydrogen bond to selection 2 would be represented as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># (selection 1)-O:···H-O(water 1):···H-(selection 2)</span>
<span class="c1">#                      |             :</span>
<span class="c1">#                      H·············O-H(water2)</span>
<span class="c1">#                                    H</span>
<span class="p">{(</span><span class="n">sele1_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">water1_donor</span><span class="p">,</span> <span class="n">water1_donor_heavy</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
     <span class="p">{(</span><span class="n">water1_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sele2_donor</span><span class="p">,</span> <span class="n">sele2_donor_heavy</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span> <span class="kc">None</span><span class="p">},</span>
     <span class="p">{(</span><span class="n">water1_donor</span><span class="p">,</span> <span class="n">water1_donor_heavy</span><span class="p">,</span> <span class="n">water2_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
          <span class="p">{(</span><span class="n">water2_acceptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sele2_donor</span><span class="p">,</span> <span class="n">sele2_donor_heavy</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span> <span class="kc">None</span><span class="p">}</span>
      <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The atoms are represented by atom index and if the atom is hydrogen bond donor,
it is followed by the index of the corresponding heavy atom
<code class="docutils literal notranslate"><span class="pre">(donor_proton,</span> <span class="pre">donor_heavy_atom)</span></code>.
If the atom is a hydrogen bond acceptor, it is followed by none.</p>
</div>
<div class="section" id="output-as-timeseries">
<span id="wb-analysis-timeseries"></span><h2>4.3.4.3. Output as Timeseries<a class="headerlink" href="#output-as-timeseries" title="Permalink to this headline">¶</a></h2>
<p>For lower order water bridges, it might be desirable to represent the connections as
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>. The results are returned per frame and
are a list of hydrogen bonds between the selection 1 or selection 2 and the
bridging waters. Due to the complexity of the higher order water bridge and the
fact that one hydrogen bond between two waters can appear in both third and
fourth order water bridge, the hydrogen bonds in the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a> attribute are generated in a depth-first
search manner to avoid duplication. Example code of how
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a> is generated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">network2timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Traverse the network in a depth-first fashion.</span>
<span class="sd">    expand_timeseries will expand the compact representation to the familiar</span>
<span class="sd">    timeseries representation.&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">network</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">network</span><span class="p">:</span>
            <span class="n">timeseries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expand_timeseries</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
            <span class="n">network2timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">[</span><span class="n">node</span><span class="p">],</span> <span class="n">timeseries</span><span class="p">)</span>

<span class="n">timeseries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">network2timeseries</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">)</span>
</pre></div>
</div>
<p>The list is formatted similar to the <a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>
except that the atom identifier is expressed as (residue name, residue number,
atom name). An example would be.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="c1"># frame 1</span>
       <span class="p">[</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="p">(</span><span class="o">&lt;</span><span class="n">donor</span> <span class="n">residue</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">residue</span> <span class="n">number</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">atom</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">),</span>
        <span class="p">(</span><span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">residue</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">residue</span> <span class="n">number</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">atom</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">),</span>
         <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span><span class="p">],</span>
       <span class="o">....</span>
    <span class="p">],</span>
    <span class="p">[</span> <span class="c1"># frame 2</span>
      <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="o">...</span>
    <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Using the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.generate_table()</span></code></a> method one can reformat
the results as a flat “normalised” table that is easier to import into a
database or dataframe for further processing.</p>
</div>
<div class="section" id="detection-of-water-bridges">
<h2>4.3.4.4. Detection of water bridges<a class="headerlink" href="#detection-of-water-bridges" title="Permalink to this headline">¶</a></h2>
<p>Water bridges are recorded if a bridging water simultaneously forms
hydrogen bonds with selection 1 and selection 2.</p>
<p>Hydrogen bonds are detected as is described in <a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>, see <a class="reference internal" href="hbond_analysis.html#detection-of-hydrogen-bonds"><span class="std std-ref">Detection of hydrogen bonds</span></a>.</p>
<p>The lists of donor and acceptor names can be extended by providing lists of
atom names in the <cite>donors</cite> and <cite>acceptors</cite> keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a>. If the lists are entirely inappropriate
(e.g. when analysing simulations done with a force field that uses very
different atom names) then one should either use the value “other” for
<cite>forcefield</cite> to set no default values or derive a new class and set the
default list oneself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WaterBridgeAnalysis_OtherFF</span><span class="p">(</span><span class="n">WaterBridgeAnalysis</span><span class="p">):</span>
      <span class="n">DEFAULT_DONORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
      <span class="n">DEFAULT_ACCEPTORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
</pre></div>
</div>
<p>Then simply use the new class instead of the parent class and call it with
<code class="docutils literal notranslate"><span class="pre">`forcefield`</span> <span class="pre">=</span> <span class="pre">&quot;OtherFF&quot;</span></code>. Please also consider contributing the list of heavy
atom names to MDAnalysis.</p>
</div>
<div class="section" id="how-to-perform-waterbridgeanalysis">
<h2>4.3.4.5. How to perform WaterBridgeAnalysis<a class="headerlink" href="#how-to-perform-waterbridgeanalysis" title="Permalink to this headline">¶</a></h2>
<p>All water bridges between arginine and aspartic acid can be analysed with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">import</span> <span class="nn">MDAnalysis.analysis.hbonds</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s1">&#39;topology&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory&#39;</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">hbonds</span><span class="o">.</span><span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;resname ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;resname ASP&#39;</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The maximum number of bridging waters detected can be changed using the order keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">hbonds</span><span class="o">.</span><span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;resname ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;resname ASP&#39;</span><span class="p">,</span>
                                                   <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus, a maximum of three bridging waters will be detected.</p>
<p>An example of using the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a> would be
detecting the percentage of time a certain water bridge exits.</p>
<p>Trajectory <code class="code docutils literal notranslate"><span class="pre">u</span></code> has two frames, where the first frame contains a water
bridge from the oxygen of the first arginine to one of the oxygens in the carboxylic
group of aspartate (ASP3:OD1). In the second frame, the same water bridge forms but
is between the oxygen of the arginine and the other oxygen in the carboxylic
group (ASP3:OD2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># index residue id residue name atom name</span>
<span class="c1">#     0          1          ARG         O</span>
<span class="c1">#     1          2          SOL        OW</span>
<span class="c1">#     2          2          SOL       HW1</span>
<span class="c1">#     3          2          SOL       HW2</span>
<span class="c1">#     4          3          ASP       OD1</span>
<span class="c1">#     5          3          ASP       OD2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span>
</pre></div>
</div>
<p>prints out.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="c1"># frame 1</span>
  <span class="c1"># A water bridge SOL2 links O from ARG1 to the carboxylic group OD1 of ASP3</span>
 <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">),(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW1&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW2&#39;</span><span class="p">),(</span><span class="s1">&#39;ASP&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;OD1&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
 <span class="p">],</span>
  <span class="c1"># frame 2</span>
  <span class="c1"># Another water bridge SOL2 links O from ARG1 to the other oxygen of the</span>
  <span class="c1"># carboxylic group OD2 of ASP3</span>
 <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>  <span class="s1">&#39;O&#39;</span><span class="p">),(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW1&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,(</span><span class="s1">&#39;SOL&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;HW2&#39;</span><span class="p">),(</span><span class="s1">&#39;ASP&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;OD2&#39;</span><span class="p">),</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
 <span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="use-count-by-type">
<span id="wb-count-by-type"></span><h2>4.3.4.6. Use count_by_type<a class="headerlink" href="#use-count-by-type" title="Permalink to this headline">¶</a></h2>
<p>We can use the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a> to
generate the frequence of all water bridges in the simulation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">()</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD1&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
 <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD2&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),]</span>
</pre></div>
</div>
<p>You might think that the OD1 and OD2 are the same oxygen and the aspartate has just flipped
and thus, they should be counted as the same type of water bridge. The type of the water
bridge can be customised by supplying an analysis function to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<p>The analysis function has two parameters. The current and the output. The current is a list
of hydrogen bonds from selection 1 to selection 2, formatted in the same fashion as
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.network" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.network"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.network</span></code></a>, and an example will be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="c1"># sele1 acceptor idx,     , water donor index, donor heavy atom idx, dist, ang.</span>
 <span class="p">[</span>                   <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>                 <span class="mi">2</span><span class="p">,</span>                     <span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
  <span class="c1"># water donor idx, donor heavy atom idx, sele2 acceptor idx, distance, angle.</span>
 <span class="p">[</span>                 <span class="mi">3</span><span class="p">,</span>                   <span class="mi">1</span><span class="p">,</span>                  <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],]</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">current[0]</span></code> is the first hydrogen bond originating from selection 1 and <code class="docutils literal notranslate"><span class="pre">current[-1]</span></code> is
the final hydrogen bond ending in selection 2. The output sums up all the information in the
current frame and is a dictionary with a user-defined key and the value is the weight of the
corresponding key. During the analysis phase, the function analysis iterates through all the
water bridges and modify the output in-place. At the end of the analysis, the keys from
all the frames are collected and the corresponding values will be summed up and returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds from</span>
<span class="sd">          selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type of</span>
<span class="sd">          the water bridge and the value is the weight of this type of water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.&#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># if the residue name is ASP and the atom name is OD2 or OD1,</span>
    <span class="c1"># the atom name is changed to OD</span>
    <span class="k">if</span> <span class="n">s2_resname</span> <span class="o">==</span> <span class="s1">&#39;ASP&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">s2_name</span> <span class="o">==</span> <span class="s1">&#39;OD1&#39;</span> <span class="ow">or</span> <span class="n">s2_name</span> <span class="o">==</span> <span class="s1">&#39;OD2&#39;</span><span class="p">):</span>
        <span class="n">s2_name</span> <span class="o">=</span> <span class="s1">&#39;OD&#39;</span>
    <span class="c1"># setting up the key which defines this type of water bridge.</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span>
    <span class="c1"># The number of this type of water bridge is incremented by 1.</span>
    <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>Note that the result is arranged in the format of <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">the</span> <span class="pre">proportion</span> <span class="pre">of</span> <span class="pre">time)</span></code>. When no
custom analysis function is supplied, the key is expanded for backward compatibility. So
that when the same code is executed, the result returned will be the same as the result
given since version 0.17.0 and the same as the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.count_by_type()</span></code>.</p>
<p>Some people might only interested in contacts between residues and pay no attention
to the details regarding the atom name. However, since multiple water bridges can
exist between two residues, which sometimes can give a result such that the water
bridge between two residues exists 300% of the time. Though this might be a desirable
result for some people, others might want the water bridge between two residues to be
only counted once per frame. This can also be achieved by supplying an analysis function
to <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds from</span>
<span class="sd">          selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type of</span>
<span class="sd">          the water bridge and the value is the weight of this type of water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># s1_name and s2_name are not included in the key</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">)</span>

    <span class="c1"># Each residue is only counted once per frame</span>
    <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>On the other hand, other people may insist that the first order and second-order water
bridges shouldn’t be mixed together, which can also be achieved by supplying an analysis
function to <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds from</span>
<span class="sd">          selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type of</span>
<span class="sd">          the water bridge and the value is the weight of this type of water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="c1"># order of the current water bridge is computed</span>
    <span class="n">order_of_water_bridge</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">current</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="c1"># and is included in the key</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">order_of_water_bridge</span><span class="p">)</span>
    <span class="c1"># The number of this type of water bridge is incremented by 1.</span>
    <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>The extra number 1 precede the 1.0 indicate that this is a first order water bridge</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[((</span><span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">),]</span>
</pre></div>
</div>
<p>Some people might not be interested in the interactions related to arginine. The undesirable
interactions can be discarded by supplying an analysis function to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This function defines how the type of water bridge should be specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds from</span>
<span class="sd">          selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type of</span>
<span class="sd">          the water bridge and the value is the number of this type of water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">s1_resname</span> <span class="o">==</span> <span class="s1">&#39;ARG&#39;</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">)</span>
        <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns nothing in this case</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[,]</span>
</pre></div>
</div>
<p>Additional keywords can be supplied to the analysis function by passing through
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="o">...</span>
<span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="use-count-by-time">
<span id="wb-count-by-time"></span><h2>4.3.4.7. Use count_by_time<a class="headerlink" href="#use-count-by-time" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a> aggregates data across frames, which
might be desirable in some cases but not the others. <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a>
provides additional functionality for aggregating results for each frame.</p>
<p>The default behaviour of <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a> is counting the number of
water bridges from selection 1 to selection 2 for each frame. Take the previous ASP, ARG salt
bridge for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">count_by_time</span><span class="p">()</span>
</pre></div>
</div>
<p>As one water bridge is found in both frames, the method returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">]</span>
</pre></div>
</div>
<p>Similar to <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a>
The behaviour of <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a> can also be modified by supplying
an analysis function.</p>
<p>Suppose we want to count</p>
<blockquote>
<div><ul class="simple">
<li>the <strong>number</strong> of water molecules involved in bridging selection 1 to selection 2.</li>
<li>only if water bridge terminates in atom name <strong>OD1 of ASP</strong>.</li>
<li>only when water bridge is joined by less than <strong>two</strong> water.</li>
</ul>
</div></blockquote>
<p>The analysis function can be written as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This function defines how the counting of water bridge should be specified.</span>

<span class="sd">      Parameters</span>
<span class="sd">      ----------</span>
<span class="sd">      current : list</span>
<span class="sd">          The current water bridge being analysed is a list of hydrogen bonds from</span>
<span class="sd">          selection 1 to selection 2.</span>
<span class="sd">      output : dict</span>
<span class="sd">          A dictionary which is modified in-place where the key is the type of</span>
<span class="sd">          the water bridge and the value is the number of this type of water bridge.</span>
<span class="sd">      u : MDAnalysis.universe</span>
<span class="sd">          The current Universe for looking up atoms.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># decompose the first hydrogen bond.</span>
    <span class="n">sele1_index</span><span class="p">,</span> <span class="n">sele1_heavy_index</span><span class="p">,</span> <span class="n">atom2</span><span class="p">,</span> <span class="n">heavy_atom2</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># decompose the last hydrogen bond.</span>
    <span class="n">atom1</span><span class="p">,</span> <span class="n">heavy_atom1</span><span class="p">,</span> <span class="n">sele2_index</span><span class="p">,</span> <span class="n">sele2_heavy_index</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># expand the atom index to the resname, resid, atom names</span>
    <span class="n">sele1</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele1_index</span><span class="p">]</span>
    <span class="n">sele2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">sele2_index</span><span class="p">]</span>
    <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele1</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele1</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sele2</span><span class="o">.</span><span class="n">resname</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">sele2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># only the residue name is ASP and the atom name is OD1,</span>
    <span class="k">if</span> <span class="n">s2_resname</span> <span class="o">==</span> <span class="s1">&#39;ASP&#39;</span> <span class="ow">and</span> <span class="n">s2_name</span> <span class="o">==</span> <span class="s1">&#39;OD1&#39;</span><span class="p">:</span>
        <span class="c1"># only if the order of water bridge is less than 2</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">current</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># extract all water molecules involved in the water bridge</span>
            <span class="c1"># extract the first water from selection 1</span>
            <span class="n">s1_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">,</span> <span class="p">(</span><span class="n">s1_resname</span><span class="p">,</span> <span class="n">s1_resid</span><span class="p">,</span> <span class="n">s1_name</span><span class="p">),</span>
            <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">,</span> <span class="n">to_name</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># extract all the waters between selection 1 and selection 2</span>
            <span class="k">for</span> <span class="n">hbond</span> <span class="ow">in</span> <span class="n">current</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="c1"># decompose the hydrogen bond.</span>
                <span class="n">from_index</span><span class="p">,</span> <span class="n">to_index</span><span class="p">,</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">,</span> <span class="n">from_name</span><span class="p">),</span>
                <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">,</span> <span class="n">to_name</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">hbond</span>
                <span class="c1"># add first water</span>
                <span class="n">key1</span> <span class="o">=</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">key1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># add second water</span>
                <span class="n">key2</span> <span class="o">=</span> <span class="p">(</span><span class="n">to_resname</span><span class="p">,</span> <span class="n">to_resid</span><span class="p">)</span>
                <span class="n">output</span><span class="p">[</span><span class="n">key2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># extract the last water to selection 2</span>
            <span class="n">from_index</span><span class="p">,</span> <span class="n">s2_index</span><span class="p">,</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">,</span> <span class="n">from_name</span><span class="p">),</span>
            <span class="p">(</span><span class="n">s2_resname</span><span class="p">,</span> <span class="n">s2_resid</span><span class="p">,</span> <span class="n">s2_name</span><span class="p">),</span> <span class="n">dist</span><span class="p">,</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">current</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">from_resname</span><span class="p">,</span> <span class="n">from_resid</span><span class="p">)</span>
            <span class="n">output</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">w</span><span class="o">.</span><span class="n">count_by_time</span><span class="p">(</span><span class="n">analysis_func</span><span class="o">=</span><span class="n">analysis</span><span class="p">)</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),]</span>
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>4.3.4.8. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.hbonds.wbridge_analysis.</code><code class="descname">WaterBridgeAnalysis</code><span class="sig-paren">(</span><em>universe</em>, <em>selection1='protein'</em>, <em>selection2='not resname SOL'</em>, <em>water_selection='resname SOL'</em>, <em>order=1</em>, <em>selection1_type='both'</em>, <em>update_selection=False</em>, <em>update_water_selection=True</em>, <em>filter_first=True</em>, <em>distance_type='hydrogen'</em>, <em>distance=3.0</em>, <em>angle=120.0</em>, <em>forcefield='CHARMM27'</em>, <em>donors=None</em>, <em>acceptors=None</em>, <em>output_format='sele1_sele2'</em>, <em>debug=None</em>, <em>verbose=False</em>, <em>pbc=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a water bridge analysis</p>
<p>The analysis of the trajectory is performed with the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.run()</span></code> method. The result is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>. See
<code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code> for the format.</p>
<p><a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaterBridgeAnalysis</span></code></a> uses the same default atom names as
<a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>,
see <a class="reference internal" href="hbond_analysis.html#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.17.0.</span></p>
</div>
<p>Set up the calculation of water bridges between two selections in a
universe.</p>
<p>The timeseries is accessible as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>.</p>
<p>If no hydrogen bonds are detected or if the initial check fails, look
at the log output (enable with <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.start_logging()</span></code></a> and set
<cite>verbose</cite> <code class="docutils literal notranslate"><span class="pre">=True</span></code>). It is likely that the default names for donors
and acceptors are not suitable (especially for non-standard
ligands). In this case, either change the <cite>forcefield</cite> or use
customized <cite>donors</cite> and/or <cite>acceptors</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>universe</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – Universe object</li>
<li><strong>selection1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for first selection [‘protein’]</li>
<li><strong>selection2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for second selection [‘not resname SOL’]
This string selects everything except water where water is assumed
to have a residue name as SOL.</li>
<li><strong>water_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Selection string for bridging water selection [‘resname SOL’]
The default selection assumes that the water molecules have residue
name “SOL”. Change it to the appropriate selection for your
specific force field.</p>
<p>However, in theory, this selection can be anything which forms
a hydrogen bond with selection 1 and selection 2.</p>
</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – <p>The maximum number of water bridges linking both selections.
if the order is set to 3, then all the residues linked with less than
three water molecules will be detected. [1]</p>
<p>Computation of high order water bridges can be very time-consuming.
Think carefully before running the calculation, do you really want
to compute the 20th order water bridge between domain A and domain B
or you just want to know the third order water bridge between two residues.</p>
</li>
<li><strong>selection1_type</strong> (<em>{&quot;donor&quot;</em><em>, </em><em>&quot;acceptor&quot;</em><em>, </em><em>&quot;both&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Selection 1 can be ‘donor’, ‘acceptor’ or ‘both’. Note that the
value for <cite>selection1_type</cite> automatically determines how
<cite>selection2</cite> handles donors and acceptors: If <cite>selection1</cite> contains
‘both’ then <cite>selection2</cite> will also contain ‘both’. If <cite>selection1</cite>
is set to ‘donor’ then <cite>selection2</cite> is ‘acceptor’ (and vice versa).
[‘both’].</li>
<li><strong>update_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Update selection 1 and 2 at each frame. Setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> if the
selection is not static. Selections are filtered first to speed up
performance. Thus, setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> is recommended if contact
surface between selection 1 and selection 2 is constantly
changing. [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>update_water_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Update selection of water at each frame. Setting to <code class="docutils literal notranslate"><span class="pre">False</span></code> is
<strong>only</strong> recommended when the total amount of water molecules in the
simulation are small and when water molecules remain static across
the simulation.</p>
<p>However, in normal simulations, only a tiny proportion of water is
engaged in the formation of water bridge. It is recommended to
update the water selection and set keyword <cite>filter_first</cite> to
<code class="docutils literal notranslate"><span class="pre">True</span></code> so as to filter out water not residing between the two
selections. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p>
</li>
<li><strong>filter_first</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Filter the water selection to only include water within 4 Å + <cite>order</cite> *
(2 Å + <cite>distance</cite>) away from <cite>both</cite> selection 1 and selection 2.
Selection 1 and selection 2 are both filtered to only include atoms
with the same distance away from the other selection. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Distance cutoff for hydrogen bonds; only interactions with a H-A
distance &lt;= <cite>distance</cite> (and the appropriate D-H-A angle, see
<cite>angle</cite>) are recorded. (Note: <cite>distance_type</cite> can change this to
the D-A distance.) [3.0]</li>
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Angle cutoff for hydrogen bonds; an ideal H-bond has an angle of
180º.  A hydrogen bond is only recorded if the D-H-A angle is
&gt;=  <cite>angle</cite>. The default of 120º also finds fairly non-specific
hydrogen interactions and possibly better value is 150º. [120.0]</li>
<li><strong>forcefield</strong> (<em>{&quot;CHARMM27&quot;</em><em>, </em><em>&quot;GLYCAM06&quot;</em><em>, </em><em>&quot;other&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Name of the forcefield used. Switches between different
<code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_DONORS</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_ACCEPTORS</span></code> values.
[“CHARMM27”]</li>
<li><strong>donors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H donor atom types (in addition to those in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_DONORS</span></code>), must be a sequence.</li>
<li><strong>acceptors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H acceptor atom types (in addition to those in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_ACCEPTORS</span></code>), must be a
sequence.</li>
<li><strong>distance_type</strong> (<em>{&quot;hydrogen&quot;</em><em>, </em><em>&quot;heavy&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Measure hydrogen bond lengths between donor and acceptor heavy
atoms (“heavy”) or between donor hydrogen and acceptor heavy
atom (“hydrogen”). If using “heavy” then one should set the
<em>distance</em> cutoff to a higher value such as 3.5 Å. [“hydrogen”]</li>
<li><strong>output_format</strong> (<em>{&quot;sele1_sele2&quot;</em><em>, </em><em>&quot;donor_acceptor&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Setting the output format for timeseries and table. If set to
“sele1_sele2”, for each hydrogen bond, the one close to selection 1
will be placed before selection 2. If set to “donor_acceptor”, the
donor will be placed before acceptor. “sele1_sele2”]</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> enables per-frame debug logging. This is disabled
by default because it generates a very large amount of output in
the log file. (Note that a logger must have been started to see
the output, e.g. using <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.start_logging()</span></code></a>.)</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Toggle progress output. (Can also be given as keyword argument to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code>.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In order to speed up processing, atoms are filtered by a coarse
distance criterion before a detailed hydrogen bonding analysis is
performed (<cite>filter_first</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
<p>If selection 1 and selection 2 are very mobile during the simulation
and the contact surface is constantly changing (i.e. residues are
moving farther than 4 Å + <cite>order</cite> * (2 Å + <cite>distance</cite>)), you might
consider setting the <cite>update_selection</cite> keywords to <code class="docutils literal notranslate"><span class="pre">True</span></code>
to ensure correctness.</p>
<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps">
<code class="descname">timesteps</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of the times of each timestep. This can be used together with
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> to find the specific time point
of a water bridge existence.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS">
<code class="descname">DEFAULT_ACCEPTORS</code><em class="property"> = {'CHARMM27': ('SG', 'OG1', 'O', 'OC1', 'NE2', 'OH', 'ND1', 'OD1', 'OD2', 'OW', 'OE1', 'OH2', 'OE2', 'SD', 'OG', 'OC2'), 'GLYCAM06': ('OY', 'O', 'OS', 'OH', 'SM', 'NT', 'N', 'O2', 'OW'), 'other': ()}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_ACCEPTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default atom names that are treated as hydrogen <em>acceptors</em>
(see <a class="reference internal" href="hbond_analysis.html#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a>);
use the keyword <cite>acceptors</cite> to add a list of additional acceptor names.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS">
<code class="descname">DEFAULT_DONORS</code><em class="property"> = {'CHARMM27': ('SG', 'OG1', 'NE2', 'NE', 'ND1', 'OH', 'NH2', 'OW', 'N', 'OH2', 'NH1', 'NE1', 'OG', 'NZ', 'ND2'), 'GLYCAM06': ('N3', 'OH', 'NT', 'OW', 'N'), 'other': ()}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.DEFAULT_DONORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default heavy atom names whose hydrogens are treated as <em>donors</em>
(see <a class="reference internal" href="hbond_analysis.html#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a>);
use the keyword <cite>donors</cite> to add a list of additional donor names.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time">
<code class="descname">count_by_time</code><span class="sig-paren">(</span><em>analysis_func=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.count_by_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of water bridges per timestep.</p>
<p>The counting behaviour can be adjusted by supplying analysis_func.
See <a class="reference internal" href="#wb-count-by-time"><span class="std std-ref">Use count_by_time</span></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>counts</strong> – Returns a time series <code class="docutils literal notranslate"><span class="pre">N(t)</span></code> where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the total
number of observed water bridges at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type">
<code class="descname">count_by_type</code><span class="sig-paren">(</span><em>analysis_func=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.count_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the frequency of water bridge of a specific type.</p>
<p>If one atom <em>A</em> from <em>selection 1</em> is linked to atom <em>B</em> from
<em>selection 2</em> through one or more bridging waters, an entity will be created and
the proportion of time that this linkage exists in the whole simulation
will be calculated.</p>
<p>The identification of a specific type of water bridge can be modified by
supplying the analysis_func function. See <a class="reference internal" href="#wb-count-by-type"><span class="std std-ref">Use count_by_type</span></a>
for detail.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>counts</strong> – Returns a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> containing atom indices for <em>A</em> and
<em>B</em>, residue names, residue numbers, atom names (for both A and B) and
the fraction of the total time during which the water bridge was
detected. This method returns None if method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.run()</span></code> was not executed first.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table">
<code class="descname">generate_table</code><span class="sig-paren">(</span><em>output_format=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.generate_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a normalised table of the results.</p>
<p>The table is stored as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a> in the
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code>.</p>
<p>The output format of <code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code> can also be
changed using output_format in a fashion similar to <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.network">
<code class="descname">network</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.network" title="Permalink to this definition">¶</a></dt>
<dd><p>Network representation of the water network.</p>
<p>The output is generated per frame as is explained in <a class="reference internal" href="#wb-analysis-network"><span class="std std-ref">Output as Network</span></a>.
Each hydrogen bond has a compact representation of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">sele1_acceptor_idx</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sele2_donor_idx</span><span class="p">,</span> <span class="n">donor_heavy_idx</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">]</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">sele1_donor_idx</span><span class="p">,</span> <span class="n">donor_heavy_idx</span><span class="p">,</span> <span class="n">sele1_acceptor_idx</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">angle</span><span class="p">]</span>
</pre></div>
</div>
<p>The donor_heavy_idx is the heavy atom bonding to the proton and atoms
can be retrived from the universe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atom</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.20.0.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.r_cov">
<code class="descname">r_cov</code><em class="property"> = {'N': 1.31, 'O': 1.31, 'P': 1.58, 'S': 1.55}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.r_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.defaultdict</span></code></a> of covalent radii of common donors
(used in :meth`_get_bonded_hydrogens_list` to check if a hydrogen is
sufficiently close to its donor heavy atom). Values are stored for
N, O, P, and S. Any other heavy atoms are assumed to have hydrogens
covalently bound at a maximum distance of 1.5 Å.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries">
<code class="descname">timeseries</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Time series of water bridges.</p>
<p>The output is generated per frame as is explained in <a class="reference internal" href="#wb-analysis-timeseries"><span class="std std-ref">Output as Timeseries</span></a>.
The format of output can be changed via the output_format selection.
If <code class="docutils literal notranslate"><span class="pre">output_format=&quot;sele1_sele2&quot;</span></code>, the hydrogen bond forms a directional
link from selection 1 to selection 2. If <code class="docutils literal notranslate"><span class="pre">output_format=&quot;donor_acceptor&quot;</span></code>,
for each hydrogen bond, the donor is always written before the acceptor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To find an acceptor atom in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Universe.atoms</span></code> by
<em>index</em> one would use <code class="docutils literal notranslate"><span class="pre">u.atoms[acceptor_index]</span></code>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> is a managed attribute and it is generated
from the underlying data in <code class="xref py py-attr docutils literal notranslate"><span class="pre">_network</span></code> every time the
attribute is accessed. It is therefore costly to call and if
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> is needed repeatedly it is recommended that you
assign to a variable:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">timeseries</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps_by_type">
<code class="descname">timesteps_by_type</code><span class="sig-paren">(</span><em>analysis_func=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.timesteps_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Frames during which each water bridges existed, sorted by each water bridges.</p>
<p>Processes <code class="xref py py-attr docutils literal notranslate"><span class="pre">WaterBridgeAnalysis._network</span></code> and returns a
<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> containing atom indices, residue names, residue
numbers (from selection 1 and selection 2) and each timestep at which the
water bridge was detected.</p>
<p>Similar to <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a>, the behavior can be adjusted by
supplying an analysis_func.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>data</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hole2.html" class="btn btn-neutral float-right" title="4.4.1. HOLE analysis — MDAnalysis.analysis.hole2" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hbond_autocorrel.html" class="btn btn-neutral float-left" title="4.3.3. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2005-2020, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Yuanyu Chang, Matthieu Chavent, Kathleen Clark, Charlie Cook, Ruggero Cortini, Nicholas Craven, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Guillaume Fraux, William Glass, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Edis Jakupovic, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik &#39;Rathann&#39; Mierzejewski, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Shakul Pathak, Joshua L. Phillips, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Andrea Rizzi, Carlos Yanez S., Utkarsh Saxena, Marcello Sega, Sean L. Seyler, Faraaz Shah, Abhishek Shandilya, Shubham Sharma, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Matthijs Tadema, Joao Miguel Correia Teixeira, Xiki Tempula, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Wiep van der Toorn, Mieczyslaw Torchala, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Yuxuan Zhuang, and Oliver Beckstein

    </p>
  </div>
 
<div class="footer"><p>Please see
    our <a href="https://www.mdanalysis.org/pages/privacy/">Privacy Policy</a>
    to learn how <a href="https://www.mdanalysis.org">MDAnalysis</a> collects data.</p>
    <script data-goatcounter="https://mdanalysis.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</div>


</footer>

        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        2.0.0-dev0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>