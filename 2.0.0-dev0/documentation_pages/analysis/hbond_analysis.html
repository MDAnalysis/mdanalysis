

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.3.2. Hydrogen Bond analysis (Deprecated) — MDAnalysis.analysis.hbonds.hbond_analysis &mdash; MDAnalysis 2.0.0-dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="../../_static/js/versions.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 2.0.0-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.3.3. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel" href="hbond_autocorrel.html" />
    <link rel="prev" title="4.3.1. Hydrogen Bond Analysis — MDAnalysis.analysis.hydrogenbonds.hbond_analysis" href="hydrogenbonds.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/mdanalysis-logo-thin.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.0.0-dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hydrogenbonds.html">4.3.1. Hydrogen Bond Analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.hbond_analysis</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.3.2. Hydrogen Bond analysis (Deprecated) — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#output">4.3.2.1. Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detection-of-hydrogen-bonds">4.3.2.2. Detection of hydrogen bonds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-perform-hydrogenbondanalysis">4.3.2.3. How to perform HydrogenBondAnalysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">4.3.2.4. Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hbond_autocorrel.html">4.3.3. Hydrogen bond autocorrelation — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_autocorrel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="wbridge_analysis.html">4.3.4. Water Bridge analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.WaterBridgeAnalysis</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#data">4.11. Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">13. Library functions — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">14. Version information for MDAnalysis - <code class="docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">15. Constants and unit conversion — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">16. Custom exceptions and warnings — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">17. References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../analysis_modules.html">4. Analysis modules</a> &raquo;</li>
        
      <li>4.3.2. Hydrogen Bond analysis (Deprecated) — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/documentation_pages/analysis/hbond_analysis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-MDAnalysis.analysis.hbonds.hbond_analysis"></span><div class="section" id="hydrogen-bond-analysis-deprecated-mdanalysis-analysis-hbonds-hbond-analysis">
<h1>4.3.2. Hydrogen Bond analysis (Deprecated) — <a class="reference internal" href="#module-MDAnalysis.analysis.hbonds.hbond_analysis" title="MDAnalysis.analysis.hbonds.hbond_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></a><a class="headerlink" href="#hydrogen-bond-analysis-deprecated-mdanalysis-analysis-hbonds-hbond-analysis" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">David Caplan, Lukas Grossar, Oliver Beckstein</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2010-2017</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>..Warning:</dt>
<dd>This module is deprecated and will be removed in version 2.0.
Please use <a class="reference internal" href="hydrogenbonds.html#module-MDAnalysis.analysis.hydrogenbonds.hbond_analysis" title="MDAnalysis.analysis.hydrogenbonds.hbond_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hydrogenbonds.hbond_analysis</span></code></a> instead.</dd>
</dl>
<p>Given a <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> (simulation
trajectory with 1 or more frames) measure all hydrogen bonds for each
frame between selections 1 and 2.</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a> class is modeled after the <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/plugins/hbonds/">VMD
HBONDS plugin</a>.</p>
<dl class="docutils">
<dt>Options:</dt>
<dd><ul class="first last simple">
<li><em>update_selections</em> (<code class="docutils literal notranslate"><span class="pre">True</span></code>): update selections at each frame?</li>
<li><em>selection_1_type</em> (“both”): selection 1 is the: “donor”, “acceptor”, “both”</li>
<li>donor-acceptor <em>distance</em> (Å): 3.0</li>
<li>Angle <em>cutoff</em> (degrees): 120.0</li>
<li><em>forcefield</em> to switch between default values for different force fields</li>
<li><em>donors</em> and <em>acceptors</em> atom types (to add additional atom names)</li>
</ul>
</dd>
</dl>
<div class="section" id="output">
<span id="analysis-output"></span><h2>4.3.2.1. Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>The results are</dt>
<dd><ul class="first last simple">
<li>the <strong>identities</strong> of donor and acceptor heavy-atoms,</li>
<li>the <strong>distance</strong> between the heavy atom acceptor atom and the hydrogen atom
that is bonded to the heavy atom donor,</li>
<li>the <strong>angle</strong> donor-hydrogen-acceptor angle (180º is linear).</li>
</ul>
</dd>
</dl>
<p>Hydrogen bond data are returned per frame, which is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a> (In the following description, <code class="docutils literal notranslate"><span class="pre">#</span></code>
indicates comments that are not part of the output.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="c1"># frame 1</span>
       <span class="p">[</span> <span class="c1"># hbond 1</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="p">[</span> <span class="c1"># hbond 2</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="o">....</span>
    <span class="p">],</span>
    <span class="p">[</span> <span class="c1"># frame 2</span>
      <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="o">...</span>
    <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Using the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.generate_table()</span></code></a> method one can reformat
the results as a flat “normalised” table that is easier to import into a
database or dataframe for further processing. The table itself is a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a>.</p>
</div>
<div class="section" id="detection-of-hydrogen-bonds">
<span id="id1"></span><h2>4.3.2.2. Detection of hydrogen bonds<a class="headerlink" href="#detection-of-hydrogen-bonds" title="Permalink to this headline">¶</a></h2>
<p>Hydrogen bonds are recorded based on a geometric criterion:</p>
<ol class="arabic simple">
<li>The distance between acceptor and hydrogen is less than or equal to
<cite>distance</cite> (default is 3 Å).</li>
<li>The angle between donor-hydrogen-acceptor is greater than or equal to
<cite>angle</cite> (default is 120º).</li>
</ol>
<p>The cut-off values <cite>angle</cite> and <cite>distance</cite> can be set as keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>.</p>
<p>Donor and acceptor heavy atoms are detected from atom names. The current
defaults are appropriate for the CHARMM27 and GLYCAM06 force fields as defined
in Table <a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis">Default atom names for hydrogen bonding analysis</a>.</p>
<p>Hydrogen atoms bonded to a donor are searched with one of two algorithms,
selected with the <cite>detect_hydrogens</cite> keyword.</p>
<dl class="docutils">
<dt>“distance”</dt>
<dd>Searches for all hydrogens (name “H*” or name “[123]H” or type “H”) in the
same residue as the donor atom within a cut-off distance of 1.2 Å.</dd>
<dt>“heuristic”</dt>
<dd>Looks at the next three atoms in the list of atoms following the donor and
selects any atom whose name matches (name “H*” or name “[123]H”). For</dd>
</dl>
<p>The “distance” search is more rigorous but slower and is set as the
default. Until release 0.7.6, only the heuristic search was implemented.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Distance search added (see
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis._get_bonded_hydrogens_dist()</span></code></a>) and heuristic
search improved (<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis._get_bonded_hydrogens_list()</span></code></a>)</p>
</div>
<span id="default-atom-names-for-hydrogen-bonding-analysis"></span><table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Default heavy atom names for CHARMM27 force field.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="19%" />
<col width="15%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">group</th>
<th class="head">donor</th>
<th class="head">acceptor</th>
<th class="head">comments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>main chain</td>
<td>N</td>
<td>O, OC1, OC2</td>
<td>OC1, OC2 from amber99sb-ildn
(Gromacs)</td>
</tr>
<tr class="row-odd"><td>water</td>
<td>OH2, OW</td>
<td>OH2, OW</td>
<td>SPC, TIP3P, TIP4P (CHARMM27,Gromacs)</td>
</tr>
<tr class="row-even"><td>ARG</td>
<td>NE, NH1, NH2</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>ASN</td>
<td>ND2</td>
<td>OD1</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>ASP</td>
<td>&#160;</td>
<td>OD1, OD2</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>CYS</td>
<td>SG</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>CYH</td>
<td>&#160;</td>
<td>SG</td>
<td>possible false positives for CYS</td>
</tr>
<tr class="row-odd"><td>GLN</td>
<td>NE2</td>
<td>OE1</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>GLU</td>
<td>&#160;</td>
<td>OE1, OE2</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>HIS</td>
<td>ND1, NE2</td>
<td>ND1, NE2</td>
<td>presence of H determines if donor</td>
</tr>
<tr class="row-even"><td>HSD</td>
<td>ND1</td>
<td>NE2</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>HSE</td>
<td>NE2</td>
<td>ND1</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>HSP</td>
<td>ND1, NE2</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>LYS</td>
<td>NZ</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>MET</td>
<td>&#160;</td>
<td>SD</td>
<td>see e.g. <a class="reference internal" href="#gregoret1991" id="id2">[Gregoret1991]</a></td>
</tr>
<tr class="row-odd"><td>SER</td>
<td>OG</td>
<td>OG</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>THR</td>
<td>OG1</td>
<td>OG1</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>TRP</td>
<td>NE1</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>TYR</td>
<td>OH</td>
<td>OH</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="id4">
<caption><span class="caption-text">Heavy atom types for GLYCAM06 force field.</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="28%" />
<col width="28%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">element</th>
<th class="head">donor</th>
<th class="head">acceptor</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>N</td>
<td>N,NT,N3</td>
<td>N,NT</td>
</tr>
<tr class="row-odd"><td>O</td>
<td>OH,OW</td>
<td>O,O2,OH,OS,OW,OY</td>
</tr>
<tr class="row-even"><td>S</td>
<td>&#160;</td>
<td>SM</td>
</tr>
</tbody>
</table>
<p>Donor and acceptor names for the CHARMM27 force field will also work for e.g.
OPLS/AA (tested in Gromacs). Residue names in the table are for information
only and are not taken into account when determining acceptors and donors.
This can potentially lead to some ambiguity in the assignment of
donors/acceptors for residues such as histidine or cytosine.</p>
<p>For more information about the naming convention in GLYCAM06 have a look at the
<a class="reference external" href="http://glycam.ccrc.uga.edu/documents/FutureNomenclature.htm">Carbohydrate Naming Convention in Glycam</a>.</p>
<p>The lists of donor and acceptor names can be extended by providing lists of
atom names in the <cite>donors</cite> and <cite>acceptors</cite> keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>. If the lists are entirely inappropriate
(e.g. when analysing simulations done with a force field that uses very
different atom names) then one should either use the value “other” for <cite>forcefield</cite>
to set no default values, or derive a new class and set the default list oneself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">HydrogenBondAnalysis_OtherFF</span><span class="p">(</span><span class="n">HydrogenBondAnalysis</span><span class="p">):</span>
      <span class="n">DEFAULT_DONORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
      <span class="n">DEFAULT_ACCEPTORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
</pre></div>
</div>
<p>Then simply use the new class instead of the parent class and call it with
<cite>forcefield</cite> = “OtherFF”. Please also consider to contribute the list of heavy
atom names to MDAnalysis.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="gregoret1991" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Gregoret1991]</a></td><td>L.M. Gregoret, S.D. Rader, R.J. Fletterick, and
F.E. Cohen. Hydrogen bonds involving sulfur atoms in proteins. Proteins,
9(2):99–107, 1991. <a class="reference external" href="http://dx.doi.org/10.1002/prot.340090204">10.1002/prot.340090204</a>.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="how-to-perform-hydrogenbondanalysis">
<h2>4.3.2.3. How to perform HydrogenBondAnalysis<a class="headerlink" href="#how-to-perform-hydrogenbondanalysis" title="Permalink to this headline">¶</a></h2>
<p>All protein-water hydrogen bonds can be analysed with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">import</span> <span class="nn">MDAnalysis.analysis.hbonds</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s1">&#39;topology&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory&#39;</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">hbonds</span><span class="o">.</span><span class="n">HydrogenBondAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="s1">&#39;resname HOH&#39;</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">120.0</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Due to the way <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a> is implemented, it is
more efficient to have the second selection (<cite>selection2</cite>) be the
<em>larger</em> group, e.g. the water when looking at water-protein
H-bonds or the whole protein when looking at ligand-protein
interactions.</p>
</div>
<p>The results are stored as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>; see <a class="reference internal" href="#analysis-output"><span class="std std-ref">Output</span></a> for the
format and further options.</p>
<p>A number of convenience functions are provided to process the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> according to varying criteria:</p>
<dl class="docutils">
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_time" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_time"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_time()</span></code></a></dt>
<dd>time series of the number of hydrogen bonds per time step</dd>
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">count_by_type()</span></code></a></dt>
<dd>data structure with the frequency of each observed hydrogen bond</dd>
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps_by_type" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps_by_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">timesteps_by_type()</span></code></a></dt>
<dd>data structure with a list of time steps for each observed hydrogen bond</dd>
</dl>
<p>For further data analysis it is convenient to process the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> data into a normalized table with the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_table()</span></code></a> method, which creates a new data
structure <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.table</span></code></a> that contains one row for each
observation of a hydrogen bond:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">.</span><span class="n">generate_table</span><span class="p">()</span>
</pre></div>
</div>
<p>This table can then be easily turned into, e.g., a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">pandas.DataFrame</a>, and
further analyzed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, plotting a histogram of the hydrogen bond angles and lengths is as
simple as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="s2">&quot;distance&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>4.3.2.4. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.hbonds.hbond_analysis.</code><code class="descname">HydrogenBondAnalysis</code><span class="sig-paren">(</span><em>universe</em>, <em>selection1='protein'</em>, <em>selection2='all'</em>, <em>selection1_type='both'</em>, <em>update_selection1=True</em>, <em>update_selection2=True</em>, <em>filter_first=True</em>, <em>distance_type='hydrogen'</em>, <em>distance=3.0</em>, <em>angle=120.0</em>, <em>forcefield='CHARMM27'</em>, <em>donors=None</em>, <em>acceptors=None</em>, <em>debug=False</em>, <em>detect_hydrogens='distance'</em>, <em>verbose=False</em>, <em>pbc=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a hydrogen bond analysis</p>
<p>The analysis of the trajectory is performed with the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.run()</span></code></a> method. The result is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>. See
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> for the format.</p>
<p>The default atom names are taken from the CHARMM 27 force field files, which
will also work for e.g. OPLS/AA in Gromacs, and GLYCAM06.</p>
<dl class="docutils">
<dt><em>Donors</em> (associated hydrogens are deduced from topology)</dt>
<dd><dl class="first last docutils">
<dt><em>CHARMM 27</em></dt>
<dd>N of the main chain, water OH2/OW, ARG NE/NH1/NH2, ASN ND2, HIS ND1/NE2,
SER OG, TYR OH, CYS SG, THR OG1, GLN NE2, LYS NZ, TRP NE1</dd>
<dt><em>GLYCAM06</em></dt>
<dd>N,NT,N3,OH,OW</dd>
</dl>
</dd>
<dt><em>Acceptors</em></dt>
<dd><dl class="first last docutils">
<dt><em>CHARMM 27</em></dt>
<dd>O of the main chain, water OH2/OW, ASN OD1, ASP OD1/OD2, CYH SG, GLN OE1,
GLU OE1/OE2, HIS ND1/NE2, MET SD, SER OG, THR OG1, TYR OH</dd>
<dt><em>GLYCAM06</em></dt>
<dd>N,NT,O,O2,OH,OS,OW,OY,P,S,SM</dd>
<dt><em>amber99sb-ildn(Gromacs)</em></dt>
<dd>OC1, OC2 of the main chain</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>DEFAULT_DONORS/ACCEPTORS is now embedded in a dict to switch between
default values for different force fields.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 1.0.0: </span>Added autocorrelation (MDAnalysis.lib.correlations.py) for calculating hydrogen bond lifetime
<code class="docutils literal notranslate"><span class="pre">save_table()</span></code> method has been removed. You can use <code class="docutils literal notranslate"><span class="pre">np.save()</span></code> or
<code class="docutils literal notranslate"><span class="pre">cPickle.dump()</span></code> on <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.table</span></code></a> instead.</p>
</div>
<p>Set up calculation of hydrogen bonds between two selections in a universe.</p>
<p>The timeseries is accessible as the attribute <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>.</p>
<p>Some initial checks are performed. If there are no atoms selected by
<cite>selection1</cite> or <cite>selection2</cite> or if no donor hydrogens or acceptor atoms
are found then a <code class="xref py py-exc docutils literal notranslate"><span class="pre">SelectionError</span></code> is raised for any selection that
does <em>not</em> update (<cite>update_selection1</cite> and <cite>update_selection2</cite>
keywords). For selections that are set to update, only a warning is
logged because it is assumed that the selection might contain atoms at
a later frame (e.g. for distance based selections).</p>
<p>If no hydrogen bonds are detected or if the initial check fails, look
at the log output (enable with <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.start_logging()</span></code></a> and set
<cite>verbose</cite> <code class="docutils literal notranslate"><span class="pre">=True</span></code>). It is likely that the default names for donors
and acceptors are not suitable (especially for non-standard
ligands). In this case, either change the <cite>forcefield</cite> or use
customized <cite>donors</cite> and/or <cite>acceptors</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>universe</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – Universe object</li>
<li><strong>selection1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for first selection [‘protein’]</li>
<li><strong>selection2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for second selection [‘all’]</li>
<li><strong>selection1_type</strong> (<em>{&quot;donor&quot;</em><em>, </em><em>&quot;acceptor&quot;</em><em>, </em><em>&quot;both&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Selection 1 can be ‘donor’, ‘acceptor’ or ‘both’. Note that the
value for <cite>selection1_type</cite> automatically determines how
<cite>selection2</cite> handles donors and acceptors: If <cite>selection1</cite> contains
‘both’ then <cite>selection2</cite> will also contain ‘both’. If <cite>selection1</cite>
is set to ‘donor’ then <cite>selection2</cite> is ‘acceptor’ (and vice versa).
[‘both’].</li>
<li><strong>update_selection1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Update selection 1 at each frame? Setting to <code class="docutils literal notranslate"><span class="pre">False</span></code> is recommended
for any static selection to increase performance. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>update_selection2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Update selection 2 at each frame? Setting to <code class="docutils literal notranslate"><span class="pre">False</span></code> is recommended
for any static selection to increase performance. [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>filter_first</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Filter selection 2 first to only atoms 3 * <cite>distance</cite> away [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Distance cutoff for hydrogen bonds; only interactions with a H-A distance
&lt;= <cite>distance</cite> (and the appropriate D-H-A angle, see <cite>angle</cite>) are
recorded. (Note: <cite>distance_type</cite> can change this to the D-A distance.) [3.0]</li>
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Angle cutoff for hydrogen bonds; an ideal H-bond has an angle of
180º.  A hydrogen bond is only recorded if the D-H-A angle is
&gt;=  <cite>angle</cite>. The default of 120º also finds fairly non-specific
hydrogen interactions and a possibly better value is 150º. [120.0]</li>
<li><strong>forcefield</strong> (<em>{&quot;CHARMM27&quot;</em><em>, </em><em>&quot;GLYCAM06&quot;</em><em>, </em><em>&quot;other&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Name of the forcefield used. Switches between different
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_DONORS</span></code></a> and
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_ACCEPTORS</span></code></a> values.
[“CHARMM27”]</li>
<li><strong>donors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H donor atom types (in addition to those in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_DONORS</span></code></a>), must be a sequence.</li>
<li><strong>acceptors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H acceptor atom types (in addition to those in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DEFAULT_ACCEPTORS</span></code></a>), must be a sequence.</li>
<li><strong>detect_hydrogens</strong> (<em>{&quot;distance&quot;</em><em>, </em><em>&quot;heuristic&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Determine the algorithm to find hydrogens connected to donor
atoms. Can be “distance” (default; finds all hydrogens in the
donor’s residue within a cutoff of the donor) or “heuristic”
(looks for the next few atoms in the atom list). “distance” should
always give the correct answer but “heuristic” is faster,
especially when the donor list is updated each
for each frame. [“distance”]</li>
<li><strong>distance_type</strong> (<em>{&quot;hydrogen&quot;</em><em>, </em><em>&quot;heavy&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Measure hydrogen bond lengths between donor and acceptor heavy
attoms (“heavy”) or between donor hydrogen and acceptor heavy
atom (“hydrogen”). If using “heavy” then one should set the <em>distance</em>
cutoff to a higher value such as 3.5 Å. [“hydrogen”]</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> enables per-frame debug logging. This is disabled
by default because it generates a very large amount of output in
the log file. (Note that a logger must have been started to see
the output, e.g. using <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.start_logging()</span></code></a>.) [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Toggle progress output. (Can also be given as keyword argument to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a>.)</li>
<li><strong>pbc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Whether to consider periodic boundaries in calculations [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">SelectionError</span></code> – is raised for each static selection without the required
donors and/or acceptors.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In order to speed up processing, atoms are filtered by a coarse
distance criterion before a detailed hydrogen bonding analysis is
performed (<cite>filter_first</cite> = <code class="docutils literal notranslate"><span class="pre">True</span></code>). If one of your selections is
e.g. the solvent then <cite>update_selection1</cite> (or <cite>update_selection2</cite>) must
also be <code class="docutils literal notranslate"><span class="pre">True</span></code> so that the list of candidate atoms is updated at each
step: this is now the default.</p>
<p>If your selections will essentially remain the same for all time steps
(i.e. residues are not moving farther than 3 x <cite>distance</cite>), for
instance, if neither water nor large conformational changes are
involved or if the optimization is disabled (<cite>filter_first</cite> =
<code class="docutils literal notranslate"><span class="pre">False</span></code>) then you can improve performance by setting the
<cite>update_selection1</cite> and/or <cite>update_selection2</cite> keywords to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>New <cite>verbose</cite> keyword (and per-frame debug logging disabled by
default).</p>
<p>New <cite>detect_hydrogens</cite> keyword to switch between two different
algorithms to detect hydrogens bonded to donor. “distance” is a new,
rigorous distance search within the residue of the donor atom,
“heuristic” is the previous list scan (improved with an additional
distance check).</p>
<p>New <cite>forcefield</cite> keyword to switch between different values of
DEFAULT_DONORS/ACCEPTORS to accomodate different force fields.
Also has an option “other” for no default values.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.8: </span>The new default for <cite>update_selection1</cite> and <cite>update_selection2</cite> is now
<code class="docutils literal notranslate"><span class="pre">True</span></code> (see <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/138">Issue 138</a>). Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if your selections only
need to be determined once (will increase performance).</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.9.0: </span>New keyword <cite>distance_type</cite> to select between calculation between
heavy atoms or hydrogen-acceptor. It defaults to the previous
behavior (i.e. “hydrogen”).</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Initial checks for selections that potentially raise <code class="xref py py-exc docutils literal notranslate"><span class="pre">SelectionError</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.17.0: </span>use 0-based indexing</p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16: </span>The previous <cite>verbose</cite> keyword argument was replaced by
<cite>debug</cite>. Note that the <cite>verbose</cite> keyword argument is now
consistently used to toggle progress meters throughout the library.</p>
</div>
<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps">
<code class="descname">timesteps</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of the times of each timestep. This can be used together with
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> to find the specific time point
of a hydrogen bond existence, or see <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table">
<code class="descname">table</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="Permalink to this definition">¶</a></dt>
<dd><p>A normalised table of the data in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>, generated by
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.generate_table()</span></code></a>. It is a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a> with the following columns:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li>“time”</li>
<li>“donor_index”</li>
<li>“acceptor_index”</li>
<li>“donor_resnm”</li>
<li>“donor_resid”</li>
<li>“donor_atom”</li>
<li>“acceptor_resnm”</li>
<li>“acceptor_resid”</li>
<li>“acceptor_atom”</li>
<li>“distance”</li>
<li>“angle”</li>
</ol>
</div></blockquote>
<p>It takes up more space than <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> but
it is easier to analyze and to import into databases or dataframes.</p>
<p class="rubric">Example</p>
<p>For example, to create a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">pandas.DataFrame</a> from <code class="docutils literal notranslate"><span class="pre">h.table</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.17.0: </span>The 1-based donor and acceptor indices (<em>donor_idx</em> and
<em>acceptor_idx</em>) are deprecated in favor of 0-based indices.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens">
<code class="descname">_get_bonded_hydrogens</code><span class="sig-paren">(</span><em>atom</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis._get_bonded_hydrogens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens" title="Permalink to this definition">¶</a></dt>
<dd><p>Find hydrogens bonded to <cite>atom</cite>.</p>
<p>This method is typically not called by a user but it is documented to
facilitate understanding of the internals of
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom</strong> (<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><em>groups.Atom</em></a>) – heavy atom</li>
<li><strong>**kwargs</strong> – passed through to the calculation method that was selected with
the <cite>detect_hydrogens</cite> kwarg of <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>hydrogen_atoms</strong> – list of hydrogens (can be a <a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>)
or empty list <code class="docutils literal notranslate"><span class="pre">[]</span></code> if none were found.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a> or []</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_bonded_hydrogens_dist()</span></code></a>, <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_bonded_hydrogens_list()</span></code></a></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Can switch algorithm by using the <cite>detect_hydrogens</cite> keyword to the
constructor. <em>kwargs</em> can be used to supply arguments for algorithm.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist">
<code class="descname">_get_bonded_hydrogens_dist</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis._get_bonded_hydrogens_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Find hydrogens bonded within cutoff to <cite>atom</cite>.</p>
<p>Hydrogens are detected by either name (“H*”, “[123]H*”) or type (“H”);
this is not fool-proof as the atom type is not always a character but
the name pattern should catch most typical occurrences.</p>
<p>The distance from <cite>atom</cite> is calculated for all hydrogens in the residue
and only those within a cutoff are kept. The cutoff depends on the
heavy atom (more precisely, on its element, which is taken as the first
letter of its name <code class="docutils literal notranslate"><span class="pre">atom.name[0]</span></code>) and is parameterized in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.r_cov</span></code></a>. If no match is found then the
default of 1.5 Å is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom</strong> (<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><em>groups.Atom</em></a>) – heavy atom</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>hydrogen_atoms</strong> – list of hydrogens (can be a <a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>)
or empty list <code class="docutils literal notranslate"><span class="pre">[]</span></code> if none were found.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a> or []</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The performance of this implementation could be improved once the
topology always contains bonded information; it currently uses the
selection parser with an “around” selection.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.7.6.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list">
<code class="descname">_get_bonded_hydrogens_list</code><span class="sig-paren">(</span><em>atom</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis._get_bonded_hydrogens_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Find “bonded” hydrogens to the donor <em>atom</em>.</p>
<p>At the moment this relies on the <strong>assumption</strong> that the
hydrogens are listed directly after the heavy atom in the
topology. If this is not the case then this function will
fail.</p>
<p>Hydrogens are detected by name <code class="docutils literal notranslate"><span class="pre">H*</span></code>, <code class="docutils literal notranslate"><span class="pre">[123]H*</span></code> and they have to be
within a maximum distance from the heavy atom. The cutoff distance
depends on the heavy atom and is parameterized in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.r_cov</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom</strong> (<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.Atom" title="MDAnalysis.core.groups.Atom"><em>groups.Atom</em></a>) – heavy atom</li>
<li><strong>**kwargs</strong> – ignored</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>hydrogen_atoms</strong> – list of hydrogens (can be a <a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a>)
or empty list <code class="docutils literal notranslate"><span class="pre">[]</span></code> if none were found.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup">AtomGroup</a> or []</p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Added detection of <code class="docutils literal notranslate"><span class="pre">[123]H</span></code> and additional check that a
selected hydrogen is bonded to the donor atom (i.e. its
distance to the donor is less than the covalent radius
stored in <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.r_cov</span></code></a> or the default
1.5 Å).</p>
<p>Changed name to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_bonded_hydrogens_list()</span></code></a>
and added <em>kwargs</em> so that it can be used instead of
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis._get_bonded_hydrogens_dist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_bonded_hydrogens_dist()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS">
<code class="descname">DEFAULT_ACCEPTORS</code><em class="property"> = {'CHARMM27': ('OG1', 'ND1', 'SD', 'O', 'OG', 'OH2', 'OW', 'OC1', 'OC2', 'OD1', 'SG', 'OE1', 'NE2', 'OH', 'OE2', 'OD2'), 'GLYCAM06': ('O', 'OS', 'NT', 'OW', 'OH', 'OY', 'SM', 'O2', 'N'), 'other': ()}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_ACCEPTORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default atom names that are treated as hydrogen <em>acceptors</em>
(see <a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a>);
use the keyword <cite>acceptors</cite> to add a list of additional acceptor names.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS">
<code class="descname">DEFAULT_DONORS</code><em class="property"> = {'CHARMM27': ('OG1', 'ND1', 'NZ', 'NH1', 'NE', 'OH2', 'NH2', 'OW', 'ND2', 'SG', 'OG', 'NE2', 'NE1', 'OH', 'N'), 'GLYCAM06': ('NT', 'OW', 'OH', 'N3', 'N'), 'other': ()}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.DEFAULT_DONORS" title="Permalink to this definition">¶</a></dt>
<dd><p>default heavy atom names whose hydrogens are treated as <em>donors</em>
(see <a class="reference internal" href="#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a>);
use the keyword <cite>donors</cite> to add a list of additional donor names.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.autocorrelation">
<code class="descname">autocorrelation</code><span class="sig-paren">(</span><em>tau_max=20</em>, <em>window_step=1</em>, <em>intermittency=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.autocorrelation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes and returns the autocorrelation (HydrogenBondLifetimes ) on the computed hydrogen bonds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>window_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Jump every <cite>step</cite>-th frame. This is compatible but independant of the taus used.
Note that <cite>step</cite> and <cite>tau_max</cite> work consistently with intermittency.</li>
<li><strong>tau_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Survival probability is calculated for the range 1 &lt;= <cite>tau</cite> &lt;= <cite>tau_max</cite></li>
<li><strong>intermittency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The maximum number of consecutive frames for which a bond can disappear but be counted as present if it
returns at the next frame. An intermittency of <cite>0</cite> is equivalent to a continuous autocorrelation, which does
not allow for the hydrogen bond disappearance. For example, for <cite>intermittency=2</cite>, any given hbond may
disappear for up to two consecutive frames yet be treated as being present at all frames.
The default is continuous (0).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>tau_timeseries</strong> (<em>list</em>) – tau from 1 to <cite>tau_max</cite>. Saved in the field tau_timeseries.</li>
<li><strong>timeseries</strong> (<em>list</em>) – autcorrelation value for each value of <cite>tau</cite>. Saved in the field timeseries.</li>
<li><strong>timeseries_data</strong> (<em>list</em>) – raw datapoints from which the average is taken (timeseries).
Time dependancy and distribution can be extracted.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_time">
<code class="descname">count_by_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.count_by_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the number of hydrogen bonds per timestep.</p>
<p>Processes <code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis._timeseries</span></code> into the time series
<code class="docutils literal notranslate"><span class="pre">N(t)</span></code> where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the total number of observed hydrogen bonds at
time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>counts</strong> – The resulting array can be thought of as rows <code class="docutils literal notranslate"><span class="pre">(time,</span> <span class="pre">N)</span></code> where
<code class="docutils literal notranslate"><span class="pre">time</span></code> is the time (in ps) of the time step and <code class="docutils literal notranslate"><span class="pre">N</span></code> is the
total number of hydrogen bonds.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)">numpy.recarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_type">
<code class="descname">count_by_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.count_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.count_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the frequency of hydrogen bonds of a specific type.</p>
<p>Processes <code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis._timeseries</span></code> and returns a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a> containing atom indices, residue names, residue
numbers (for donors and acceptors) and the fraction of the total time
during which the hydrogen bond was detected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>counts</strong> – Each row of the array contains data to define a unique hydrogen
bond together with the frequency (fraction of the total time) that
it has been observed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)">numpy.recarray</a></td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.17.0: </span>The 1-based indices “donor_idx” and “acceptor_idx” are being
deprecated in favor of zero-based indices.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table">
<code class="descname">generate_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.generate_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a normalised table of the results.</p>
<p>The table is stored as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a> in the
attribute <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.table()</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov">
<code class="descname">r_cov</code><em class="property"> = {'N': 1.31, 'O': 1.31, 'P': 1.58, 'S': 1.55}</em><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.r_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.defaultdict</span></code></a> of covalent radii of common donors
(used in :meth`_get_bonded_hydrogens_list` to check if a hydrogen is
sufficiently close to its donor heavy atom). Values are stored for
N, O, P, and S. Any other heavy atoms are assumed to have hydrogens
covalently bound at a maximum distance of 1.5 Å.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>verbose=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze trajectory and produce timeseries.</p>
<p>Stores the hydrogen bond data per frame as
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a> (see there for output
format).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – starting frame-index for analysis, <code class="docutils literal notranslate"><span class="pre">None</span></code> is the first one, 0.
<cite>start</cite> and <cite>stop</cite> are 0-based frame indices and are used to slice
the trajectory (if supported) [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</li>
<li><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – last trajectory frame for analysis, <code class="docutils literal notranslate"><span class="pre">None</span></code> is the last one [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – read every <cite>step</cite> between <cite>start</cite> (included) and <cite>stop</cite> (excluded),
<code class="docutils literal notranslate"><span class="pre">None</span></code> selects 1. [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – toggle progress meter output
<a class="reference internal" href="../lib/log.html#MDAnalysis.lib.log.ProgressBar" title="MDAnalysis.lib.log.ProgressBar"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProgressBar</span></code></a> [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – enable detailed logging of debugging information; this can create
<em>very big</em> log files so it is disabled (<code class="docutils literal notranslate"><span class="pre">False</span></code>) by default; setting
<cite>debug</cite> toggles the debug status for <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">HydrogenBondAnalysis</span></code></a>,
namely the value of <code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.debug</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>remove_duplicates</strong> (<em>bool (optional)</em>) – duplicate hydrogen bonds are removed from output if set to the
default value <code class="docutils literal notranslate"><span class="pre">True</span></code>; normally, this should not be changed.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.generate_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HydrogenBondAnalysis.generate_table()</span></code></a></dt>
<dd>processing the data into a different format.</dd>
</dl>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.7.6: </span>Results are not returned, only stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> and duplicate hydrogen bonds
are removed from output (can be suppressed with <cite>remove_duplicates</cite> =
<code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.11.0: </span>Accept <cite>quiet</cite> keyword. Analysis will now proceed through frames even if
no donors or acceptors were found in a particular frame.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16: </span>The <cite>quiet</cite> keyword argument is deprecated in favor of the <cite>verbose</cite>
one. Previous use of <cite>verbose</cite> now corresponds to the new keyword
argument <cite>debug</cite>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries">
<code class="descname">timeseries</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Time series of hydrogen bonds.</p>
<p>The results of the hydrogen bond analysis can be accessed as a <cite>list</cite> of <cite>list</cite> of <cite>list</cite>:</p>
<ol class="arabic simple">
<li><cite>timeseries[i]</cite>: data for the i-th trajectory frame (at time
<cite>timesteps[i]</cite>, see <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timesteps</span></code></a>)</li>
<li><cite>timeseries[i][j]</cite>: j-th hydrogen bond that was detected at the i-th
frame.</li>
<li><code class="docutils literal notranslate"><span class="pre">donor_index,</span> <span class="pre">acceptor_index,</span>
<span class="pre">donor_name_str,</span> <span class="pre">acceptor_name_str,</span> <span class="pre">distance,</span> <span class="pre">angle</span> <span class="pre">=</span>
<span class="pre">timeseries[i][j]</span></code>: structure of one hydrogen bond data item</li>
</ol>
<p>In the following description, <code class="docutils literal notranslate"><span class="pre">#</span></code> indicates comments that are not
part of the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="c1"># frame 1</span>
       <span class="p">[</span> <span class="c1"># hbond 1</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="p">[</span> <span class="c1"># hbond 2</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="o">....</span>
    <span class="p">],</span>
    <span class="p">[</span> <span class="c1"># frame 2</span>
      <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="o">...</span>
    <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The time of each step is not stored with each hydrogen bond frame but in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timesteps</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>For instance, to find an acceptor atom in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Universe.atoms</span></code> by
<em>index</em> one would use <code class="docutils literal notranslate"><span class="pre">u.atoms[acceptor_index]</span></code>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> is a managed attribute and it is generated
from the underlying data in <code class="xref py py-attr docutils literal notranslate"><span class="pre">_timeseries</span></code> every time the
attribute is accessed. It is therefore costly to call and if
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> is needed repeatedly it is recommended that you
assign to a variable:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">HydrogenBondAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">h</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">timeseries</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a></dt>
<dd>structured array of the data</dd>
</dl>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.16.1: </span><a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal notranslate"><span class="pre">timeseries</span></code></a> has become a managed attribute and is generated from the stored
<code class="xref py py-attr docutils literal notranslate"><span class="pre">_timeseries</span></code> when needed. <code class="xref py py-attr docutils literal notranslate"><span class="pre">_timeseries</span></code> contains the donor atom and
acceptor atom specifiers as tuples <cite>(resname, resid, atomid)</cite> instead of strings.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.17.0: </span>The 1-based indices “donor_idx” and “acceptor_idx” are being
removed in favor of the 0-based indices “donor_index” and
“acceptor_index”.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps_by_type">
<code class="descname">timesteps_by_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/hbond_analysis.html#HydrogenBondAnalysis.timesteps_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timesteps_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Frames during which each hydrogen bond existed, sorted by hydrogen bond.</p>
<p>Processes <code class="xref py py-attr docutils literal notranslate"><span class="pre">HydrogenBondAnalysis._timeseries</span></code> and returns a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a> containing atom indices, residue names, residue
numbers (for donors and acceptors) and each timestep at which the
hydrogen bond was detected.</p>
<p>In principle, this is the same as <a class="reference internal" href="#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.table"><code class="xref py py-attr docutils literal notranslate"><span class="pre">table</span></code></a>
but sorted by hydrogen bond and with additional data for the
<em>donor_heavy_atom</em> and angle and distance omitted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>data</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.19)">numpy.recarray</a></td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.17.0: </span>The 1-based indices “donor_idx” and “acceptor_idx” are being
replaced in favor of zero-based indices.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hbond_autocorrel.html" class="btn btn-neutral float-right" title="4.3.3. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hydrogenbonds.html" class="btn btn-neutral float-left" title="4.3.1. Hydrogen Bond Analysis — MDAnalysis.analysis.hydrogenbonds.hbond_analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2005-2020, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Yuanyu Chang, Matthieu Chavent, Kathleen Clark, Charlie Cook, Ruggero Cortini, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Guillaume Fraux, William Glass, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik &#39;Rathann&#39; Mierzejewski, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Shakul Pathak, Joshua L. Phillips, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Andrea Rizzi, Carlos Yanez S., Utkarsh Saxena, Marcello Sega, Sean L. Seyler, Faraaz Shah, Abhishek Shandilya, Shubham Sharma, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Matthijs Tadema, Joao Miguel Correia Teixeira, Xiki Tempula, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Wiep van der Toorn, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Yuxuan Zhuang, and Oliver Beckstein

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        2.0.0-dev0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>