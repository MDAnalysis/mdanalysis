
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>4.3.3. Water Bridge analysis — MDAnalysis.analysis.hbonds.WaterBridgeAnalysis &#8212; MDAnalysis 0.18.1-dev documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.18.1-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.18.1-dev documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.4.1. Generation and Analysis of HOLE pore profiles — MDAnalysis.analysis.hole" href="hole.html" />
    <link rel="prev" title="4.3.2. Hydrogen bond autocorrelation — MDAnalysis.analysis.hbonds.hbond_autocorrel" href="hbond_autocorrel.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.hbonds.wbridge_analysis"></span><div class="section" id="water-bridge-analysis-mdanalysis-analysis-hbonds-waterbridgeanalysis">
<h1>4.3.3. Water Bridge analysis — <code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.WaterBridgeAnalysis</span></code><a class="headerlink" href="#water-bridge-analysis-mdanalysis-analysis-hbonds-waterbridgeanalysis" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Zhiyi Wu</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2017</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
<tr class="field-even field"><th class="field-name">Maintainer:</th><td class="field-body">Zhiyi Wu &lt;<a class="reference external" href="mailto:zhiyi&#46;wu&#37;&#52;&#48;gtc&#46;ox&#46;ac&#46;uk">zhiyi<span>&#46;</span>wu<span>&#64;</span>gtc<span>&#46;</span>ox<span>&#46;</span>ac<span>&#46;</span>uk</a>&gt;,  <a class="reference external" href="https://github.com/xiki-tempula">&#64;xiki-tempula</a> on GitHub</td>
</tr>
</tbody>
</table>
<p>Given a <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal"><span class="pre">Universe</span></code></a> (simulation
trajectory with 1 or more frames) measure all water bridges for each
frame between selections 1 and 2.
Water bridge is defined as a bridging water which simultaneously forms
two hydrogen bonds with atoms from both selection 1 and selection 2.</p>
<p>A water bridge can form between two hydrogen bond acceptors.</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O−H···:<sup>-</sup>O<sub>2</sub>C-</p>
<p>A water bridge can also form between two hydrogen bond donors.</p>
<p>e.g. -NH···:O:···HN- (where O is the oxygen of a bridging water)</p>
<p>A hydrogen bond acceptor and another hydrogen bond donor can be bridged by a
water.</p>
<p>e.g. -CO<sub>2</sub><sup>-</sup>:···H−O:···HN- (where H−O is part of <strong>H−O</strong>−H)</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal"><span class="pre">WaterBridgeAnalysis</span></code></a> class is modeled after the  <a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a>.</p>
<p>The following keyword arguments are important to control the behavior of the
water bridge analysis:</p>
<blockquote>
<div><ul class="simple">
<li><em>water_selection</em> (<code class="docutils literal"><span class="pre">resname</span> <span class="pre">SOL</span></code>): the selection string for the bridging
water</li>
<li>donor-acceptor <em>distance</em> (Å): 3.0</li>
<li>Angle <em>cutoff</em> (degrees): 120.0</li>
<li><em>forcefield</em> to switch between default values for different force fields</li>
<li><em>donors</em> and <em>acceptors</em> atom types (to add additional atom names)</li>
</ul>
</div></blockquote>
<div class="section" id="output">
<span id="wb-analysis-output"></span><h2>4.3.3.1. Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h2>
<p>The results are a list of hydrogen bonds between the selection 1 or selection 2
and the bridging water.</p>
<p>Each list is formated similar to the <a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">HydrogenBondAnalysis.timeseries</span></code></a>
and contains</p>
<blockquote>
<div><ul class="simple">
<li>the <strong>identities</strong> of donor and acceptor heavy-atoms,</li>
<li>the <strong>distance</strong> between the heavy atom acceptor atom and the hydrogen atom</li>
<li>the <strong>angle</strong> donor-hydrogen-acceptor angle (180º is linear).</li>
</ul>
</div></blockquote>
<p>Water bridge data are returned per frame, which is stored in <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a> (In the following description, <code class="docutils literal"><span class="pre">#</span></code>
indicates comments that are not part of the output.):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="c1"># frame 1</span>
       <span class="c1"># hbonds linking the selection 1 and selection 2 to the bridging</span>
       <span class="c1"># water 1</span>
       <span class="p">[</span> <span class="c1"># hbond 1 from selection 1 to the bridging water 1</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="p">[</span> <span class="c1"># hbond 2 from selection 1 to the bridging water 1</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="p">[</span> <span class="c1"># hbond 1 from selection 2 to the bridging water 1</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="p">[</span> <span class="c1"># hbond 2 from selection 2 to the bridging water 1</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>

       <span class="c1"># hbonds linking the selection 1 and selection 2 to the bridging</span>
       <span class="c1"># water 2</span>
       <span class="p">[</span> <span class="c1"># hbond 1 from selection 1 to the bridging water 2</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="p">[</span> <span class="c1"># hbond 1 from selection 2 to the bridging water 2</span>
          <span class="o">&lt;</span><span class="n">donor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">index</span> <span class="p">(</span><span class="mi">0</span><span class="o">-</span><span class="n">based</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">donor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">acceptor</span> <span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
          <span class="o">&lt;</span><span class="n">distance</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">angle</span><span class="o">&gt;</span>
       <span class="p">],</span>
       <span class="o">....</span>
    <span class="p">],</span>
    <span class="p">[</span> <span class="c1"># frame 2</span>
      <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span> <span class="o">...</span>
    <span class="p">],</span>
    <span class="o">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Using the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.generate_table()</span></code></a> method one can reformat
the results as a flat “normalised” table that is easier to import into a
database or dataframe for further processing.
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.save_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.save_table"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.save_table()</span></code></a> saves the table to a pickled file. The
table itself is a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a>.</p>
</div>
<div class="section" id="detection-of-water-bridges">
<h2>4.3.3.2. Detection of water bridges<a class="headerlink" href="#detection-of-water-bridges" title="Permalink to this headline">¶</a></h2>
<p>Water bridges are recorded if a bridging water simultaneously forms two
hydrogen bonds with selection 1 and selection 2.</p>
<p>Hydrogen bonds are detected as is described in <a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a>, see <a class="reference internal" href="hbond_analysis.html#detection-of-hydrogen-bonds"><span class="std std-ref">Detection of hydrogen bonds</span></a>.</p>
<p>The lists of donor and acceptor names can be extended by providing lists of
atom names in the <cite>donors</cite> and <cite>acceptors</cite> keywords to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal"><span class="pre">WaterBridgeAnalysis</span></code></a>. If the lists are entirely inappropriate
(e.g. when analysing simulations done with a force field that uses very
different atom names) then one should either use the value “other” for
<cite>forcefield</cite> to set no default values, or derive a new class and set the
default list oneself:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WaterBridgeAnalysis_OtherFF</span><span class="p">(</span><span class="n">WaterBridgeAnalysis</span><span class="p">):</span>
      <span class="n">DEFAULT_DONORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
      <span class="n">DEFAULT_ACCEPTORS</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;OtherFF&quot;</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="o">...</span><span class="p">]))}</span>
</pre></div>
</div>
<p>Then simply use the new class instead of the parent class and call it with
<cite>forcefield</cite> = “OtherFF”. Please also consider contributing the list of heavy
atom names to MDAnalysis.</p>
</div>
<div class="section" id="how-to-perform-waterbridgeanalysis">
<h2>4.3.3.3. How to perform WaterBridgeAnalysis<a class="headerlink" href="#how-to-perform-waterbridgeanalysis" title="Permalink to this headline">¶</a></h2>
<p>All water bridges between arginine and aspartic acid can be analysed with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span>
<span class="kn">import</span> <span class="nn">MDAnalysis.analysis.hbonds</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s1">&#39;topology&#39;</span><span class="p">,</span> <span class="s1">&#39;trajectory&#39;</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">hbonds</span><span class="o">.</span><span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;resname ARG&#39;</span><span class="p">,</span> <span class="s1">&#39;resname ASP&#39;</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The results are stored as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>; see <a class="reference internal" href="#wb-analysis-output"><span class="std std-ref">Output</span></a> for the
format.</p>
<p>An example of using the <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> would be
detecting the percentage of time a certain water bridge exits.</p>
<p>Trajectory <code class="code docutils literal"><span class="pre">u</span></code> has two frames, where the first frame contains a water
bridge from the oxygen of the first arginine to the oxygen of the third
aspartate. No water bridge is detected in the second frame.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">timeseries</span><span class="p">)</span>
</pre></div>
</div>
<p>prints out (the comments are not part of the data structure but are added here
for clarity):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="c1"># frame 1</span>
  <span class="c1"># A water bridge SOL2 links O from ARG1 and ASP3</span>
 <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;ARG1:O&#39;</span><span class="p">,</span>  <span class="s1">&#39;SOL2:HW1&#39;</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;SOL2:HW2&#39;</span><span class="p">,</span><span class="s1">&#39;ASP3:O&#39;</span><span class="p">,</span>  <span class="mf">3.0</span><span class="p">,</span><span class="mi">180</span><span class="p">],</span>
 <span class="p">],</span>
  <span class="c1"># frame 2</span>
  <span class="c1"># No water bridge detected</span>
 <span class="p">[]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>To calculate the percentage, we can iterate through <code class="code docutils literal"><span class="pre">w.timeseries</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">water_bridge_presence</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">w</span><span class="o">.</span><span class="n">timeseries</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">frame</span><span class="p">:</span>
        <span class="n">water_bridge_presence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">water_bridge_presence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">p_bridge</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">water_bridge_presence</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">water_bridge_presence</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fraction of time with water bridge present: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_bridge</span><span class="p">))</span>
</pre></div>
</div>
<p>In the example above, <code class="code docutils literal"><span class="pre">p_bridge</span></code> would become 0.5, i.e., for 50% of the
trajectory a water bridge was detected between the selected residues.</p>
<p>Alternatively, <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type"><code class="xref py py-meth docutils literal"><span class="pre">count_by_type()</span></code></a> can also be used to
generate the frequence of all water bridges in the simulation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">count_by_type</span><span class="p">()</span>
</pre></div>
</div>
<p>Returns</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
</pre></div>
</div>
<p>For further data analysis, it is convenient to process the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> data into a normalized table with the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">generate_table()</span></code></a> method, which creates a new data
structure <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.table</span></code></a> that contains one row for each
observation of a hydrogen bond:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">generate_table</span><span class="p">()</span>
</pre></div>
</div>
<p>This table can then be easily turned into, e.g., a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">pandas.DataFrame</a>, and
further analyzed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>4.3.3.4. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.hbonds.wbridge_analysis.</code><code class="descname">WaterBridgeAnalysis</code><span class="sig-paren">(</span><em>universe</em>, <em>selection1='protein'</em>, <em>selection2='not resname SOL'</em>, <em>water_selection='resname SOL'</em>, <em>selection1_type='both'</em>, <em>update_selection1=False</em>, <em>update_selection2=False</em>, <em>update_water_selection=True</em>, <em>filter_first=True</em>, <em>distance_type='hydrogen'</em>, <em>distance=3.0</em>, <em>angle=120.0</em>, <em>forcefield='CHARMM27'</em>, <em>donors=None</em>, <em>acceptors=None</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>debug=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a water bridge analysis</p>
<p>The analysis of the trajectory is performed with the
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.run()</span></code></a> method. The result is stored in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>. See
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a> for the format.</p>
<p><a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal"><span class="pre">WaterBridgeAnalysis</span></code></a> uses the same default atom names as
<a class="reference internal" href="hbond_analysis.html#MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis" title="MDAnalysis.analysis.hbonds.hbond_analysis.HydrogenBondAnalysis"><code class="xref py py-class docutils literal"><span class="pre">HydrogenBondAnalysis</span></code></a>,
see <a class="reference internal" href="hbond_analysis.html#default-atom-names-for-hydrogen-bonding-analysis"><span class="std std-ref">Default heavy atom names for CHARMM27 force field.</span></a></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.17.0.</span></p>
</div>
<p>Set up the calculation of water bridges between two selections in a
universe.</p>
<p>The timeseries is accessible as the attribute
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>.</p>
<p>If no hydrogen bonds are detected or if the initial check fails, look
at the log output (enable with <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.start_logging()</span></code></a> and set
<cite>verbose</cite> <code class="docutils literal"><span class="pre">=True</span></code>). It is likely that the default names for donors
and acceptors are not suitable (especially for non-standard
ligands). In this case, either change the <cite>forcefield</cite> or use
customized <cite>donors</cite> and/or <cite>acceptors</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>universe</strong> (<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><em>Universe</em></a>) – Universe object</li>
<li><strong>selection1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for first selection [‘protein’]</li>
<li><strong>selection2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – Selection string for second selection [‘not resname SOL’]
This string selects everything except water where water is assumed
to have a residue name as SOL.</li>
<li><strong>water_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Selection string for bridging water selection [‘resname SOL’]
The default selection assumes that the water molecules have residue
name “SOL”. Change it to the appropriate selection for your
specific force field.</p>
<p>However, in theory this selection can be anything which forms
hydrogen bond with selection 1 and selection 2.</p>
</li>
<li><strong>selection1_type</strong> (<em>{&quot;donor&quot;</em><em>, </em><em>&quot;acceptor&quot;</em><em>, </em><em>&quot;both&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Selection 1 can be ‘donor’, ‘acceptor’ or ‘both’. Note that the
value for <cite>selection1_type</cite> automatically determines how
<cite>selection2</cite> handles donors and acceptors: If <cite>selection1</cite> contains
‘both’ then <cite>selection2</cite> will also contain ‘both’. If <cite>selection1</cite>
is set to ‘donor’ then <cite>selection2</cite> is ‘acceptor’ (and vice versa).
[‘both’].</li>
<li><strong>update_selection1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Update selection 1 at each frame. Setting to <code class="docutils literal"><span class="pre">True</span></code> if the
selection is not static. Selection 1 is filtered first to speed up
performance. Thus, setting to <code class="docutils literal"><span class="pre">True</span></code> is recommended if contact
surface between selection 1 and selection 2 is constantly
changing. [<code class="docutils literal"><span class="pre">False</span></code>]</li>
<li><strong>update_selection2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Similiar to <em>update_selection1</em> but is acted upon selection 2.
[<code class="docutils literal"><span class="pre">False</span></code>]</li>
<li><strong>update_water_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Update selection of water at each frame. Setting to <code class="docutils literal"><span class="pre">False</span></code> is
<strong>only</strong> recommended when the total amount of water molecules in the
simulation are small and when water molecules remain static across
the simulation.</p>
<p>However, in normal simulations, only a tiny proportion of water is
engaged in the formation of water bridge. It is recommended to
update the water selection and set keyword <cite>filter_first</cite> to
<code class="docutils literal"><span class="pre">True</span></code> so as to filter out water not residing between the two
selections. [<code class="docutils literal"><span class="pre">True</span></code>]</p>
</li>
<li><strong>filter_first</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Filter the water selection to only include water within 3 *
<cite>distance</cite> away from <cite>both</cite> selection 1 and selection 2.
Selection 1 and selection 2 are both filtered to only include atoms
3 * <cite>distance</cite> away from the other selection. [<code class="docutils literal"><span class="pre">True</span></code>]</li>
<li><strong>distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Distance cutoff for hydrogen bonds; only interactions with a H-A
distance &lt;= <cite>distance</cite> (and the appropriate D-H-A angle, see
<cite>angle</cite>) are recorded. (Note: <cite>distance_type</cite> can change this to
the D-A distance.) [3.0]</li>
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – Angle cutoff for hydrogen bonds; an ideal H-bond has an angle of
180º.  A hydrogen bond is only recorded if the D-H-A angle is
&gt;=  <cite>angle</cite>. The default of 120º also finds fairly non-specific
hydrogen interactions and a possibly better value is 150º. [120.0]</li>
<li><strong>forcefield</strong> (<em>{&quot;CHARMM27&quot;</em><em>, </em><em>&quot;GLYCAM06&quot;</em><em>, </em><em>&quot;other&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Name of the forcefield used. Switches between different
<code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_DONORS</span></code> and
<code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_ACCEPTORS</span></code> values.
[“CHARMM27”]</li>
<li><strong>donors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H donor atom types (in addition to those in
<code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_DONORS</span></code>), must be a sequence.</li>
<li><strong>acceptors</strong> (<em>sequence</em><em> (</em><em>optional</em><em>)</em>) – Extra H acceptor atom types (in addition to those in
<code class="xref py py-attr docutils literal"><span class="pre">DEFAULT_ACCEPTORS</span></code>), must be a
sequence.</li>
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – starting frame-index for analysis, <code class="docutils literal"><span class="pre">None</span></code> is the first one, 0.
<cite>start</cite> and <cite>stop</cite> are 0-based frame indices and are used to slice
the trajectory (if supported) [<code class="docutils literal"><span class="pre">None</span></code>]</li>
<li><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – last trajectory frame for analysis, <code class="docutils literal"><span class="pre">None</span></code> is the last one
[<code class="docutils literal"><span class="pre">None</span></code>]</li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – read every <cite>step</cite> between <cite>start</cite> (included) and <cite>stop</cite> (excluded),
<code class="docutils literal"><span class="pre">None</span></code> selects 1. [<code class="docutils literal"><span class="pre">None</span></code>]</li>
<li><strong>distance_type</strong> (<em>{&quot;hydrogen&quot;</em><em>, </em><em>&quot;heavy&quot;}</em><em> (</em><em>optional</em><em>)</em>) – Measure hydrogen bond lengths between donor and acceptor heavy
attoms (“heavy”) or between donor hydrogen and acceptor heavy
atom (“hydrogen”). If using “heavy” then one should set the
<em>distance</em> cutoff to a higher value such as 3.5 Å. [“hydrogen”]</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – If set to <code class="docutils literal"><span class="pre">True</span></code> enables per-frame debug logging. This is disabled
by default because it generates a very large amount of output in
the log file. (Note that a logger must have been started to see
the output, e.g. using <a class="reference internal" href="../lib/log.html#MDAnalysis.start_logging" title="MDAnalysis.start_logging"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.start_logging()</span></code></a>.)</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – Toggle progress output. (Can also be given as keyword argument to
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run"><code class="xref py py-meth docutils literal"><span class="pre">run()</span></code></a>.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>In order to speed up processing, atoms are filtered by a coarse
distance criterion before a detailed hydrogen bonding analysis is
performed (<cite>filter_first</cite> = <code class="docutils literal"><span class="pre">True</span></code>).</p>
<p>If selection 1 and selection 2 are very mobile during the simulation
and the contact surface is constantly changing (i.e. residues are
moving farther than 3 x <cite>distance</cite>), you might consider setting the
<cite>update_selection1</cite> and <cite>update_selection2</cite> keywords to <code class="docutils literal"><span class="pre">True</span></code> to
ensure correctness.</p>
<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps">
<code class="descname">timesteps</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timesteps" title="Permalink to this definition">¶</a></dt>
<dd><p>List of the times of each timestep. This can be used together with
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> to find the specific time point
of a water bridge existence, or see <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table">
<code class="descname">table</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="Permalink to this definition">¶</a></dt>
<dd><p>A normalised table of the data in
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a>, generated by
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.generate_table()</span></code></a>. It is a
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> with the following columns:</p>
<blockquote>
<div><ol class="arabic simple" start="0">
<li>“time”</li>
<li>“donor_index”</li>
<li>“acceptor_index”</li>
<li>“donor_resnm”</li>
<li>“donor_resid”</li>
<li>“donor_atom”</li>
<li>“acceptor_resnm”</li>
<li>“acceptor_resid”</li>
<li>“acceptor_atom”</li>
<li>“distance”</li>
<li>“angle”</li>
</ol>
</div></blockquote>
<p>It takes up more space than <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> but
it is easier to analyze and to import into databases or dataframes.</p>
<p class="rubric">Example</p>
<p>For example, to create a <a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">pandas.DataFrame</a> from <code class="docutils literal"><span class="pre">h.table</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type">
<code class="descname">count_by_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.count_by_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.count_by_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the frequency of water bridge of a specific type.</p>
<p>If one atom <em>A</em> from <em>selection 1</em> is linked to atom <em>B</em> from
<em>selection 2</em> through a bridging water, an entity will be created and
the proportion of time that this linkage exists in the whole simulation
will be calculated.</p>
<p>Returns a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> containing atom indices for <em>A</em> and
<em>B</em>, residue names, residue numbers, atom names (for both A and B) and
the fraction of the total time during which the water bridge was
detected. This method returns None if method
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.run()</span></code></a> was not executed first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>counts</strong> – Each row of the array contains data to define a unique water
bridge together with the frequency (fraction of the total time)
that it has been observed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.14)">numpy.recarray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table">
<code class="descname">generate_table</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.generate_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a normalised table of the results.</p>
<p>The table is stored as a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal"><span class="pre">numpy.recarray</span></code></a> in the
attribute <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.table()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyze trajectory and produce timeseries.</p>
<p>Stores the water bridge data per frame as
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.timeseries</span></code></a> (see there for output
format).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – toggle progress meter output
<a class="reference internal" href="../lib/log.html#MDAnalysis.lib.log.ProgressMeter" title="MDAnalysis.lib.log.ProgressMeter"><code class="xref py py-class docutils literal"><span class="pre">ProgressMeter</span></code></a> [<code class="docutils literal"><span class="pre">True</span></code>]</li>
<li><strong>debug</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – enable detailed logging of debugging information; this can create
<em>very big</em> log files so it is disabled (<code class="docutils literal"><span class="pre">False</span></code>) by default;
setting <cite>debug</cite> toggles the debug status for
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis"><code class="xref py py-class docutils literal"><span class="pre">WaterBridgeAnalysis</span></code></a>, namely the value of
<code class="xref py py-attr docutils literal"><span class="pre">WaterBridgeAnalysis.debug</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">WaterBridgeAnalysis.generate_table()</span></code></a></dt>
<dd>processing the data into a different format.</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.save_table">
<code class="descname">save_table</code><span class="sig-paren">(</span><em>filename='wbridge_table.pickle'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/hbonds/wbridge_analysis.html#WaterBridgeAnalysis.save_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.save_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a> to a pickled file.</p>
<p>If <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a> does not exist yet,
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.generate_table"><code class="xref py py-meth docutils literal"><span class="pre">generate_table()</span></code></a> is called first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – path to the filename</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>Load with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cPickle</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">cPickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries">
<code class="descname">timeseries</code><a class="headerlink" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Time series of water bridges.</p>
<p>Due to the intrinsic complexity of water bridge problem, where several
atoms <span class="math">\(n\)</span> can be linked by the same water. A simple <code class="docutils literal"><span class="pre">atom</span> <span class="pre">1</span> <span class="pre">-</span>
<span class="pre">water</span> <span class="pre">bridge</span> <span class="pre">-</span> <span class="pre">atom</span> <span class="pre">2</span></code> mapping will create a very large list
<span class="math">\(n!/(2(n-2)!)\)</span> due to the rule of combination.</p>
<p>Thus, the output is arranged based on each individual bridging water
allowing the later reconstruction of the water network. The hydrogen
bonds from selection 1 to the <strong>first</strong> bridging water is followed by
the hydrogen bonds from selection 2 to the <strong>same</strong> bridging water.
After that, hydrogen bonds from selection 1 to the <strong>second</strong> bridging
water is succeeded by hydrogen bonds from selection 2 to the <strong>same
second</strong> bridging water. An example of the output is given in
<a class="reference internal" href="#wb-analysis-output"><span class="std std-ref">Output</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To find an acceptor atom in <code class="xref py py-attr docutils literal"><span class="pre">Universe.atoms</span></code> by
<em>index</em> one would use <code class="docutils literal"><span class="pre">u.atoms[acceptor_index]</span></code>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> is a managed attribute and it is generated
from the underlying data in <code class="xref py py-attr docutils literal"><span class="pre">_timeseries</span></code> every time the
attribute is accessed. It is therefore costly to call and if
<a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.timeseries"><code class="xref py py-attr docutils literal"><span class="pre">timeseries</span></code></a> is needed repeatedly it is recommended that you
assign to a variable:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">WaterBridgeAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="n">w</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">timeseries</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">timeseries</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table" title="MDAnalysis.analysis.hbonds.wbridge_analysis.WaterBridgeAnalysis.table"><code class="xref py py-attr docutils literal"><span class="pre">table</span></code></a></dt>
<dd>structured array of the data</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hbond_analysis.html">4.3.1. Hydrogen Bond analysis — <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.hbond_analysis</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hbond_autocorrel.html">4.3.2. Hydrogen bond autocorrelation — <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.hbond_autocorrel</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.3.3. Water Bridge analysis — <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.WaterBridgeAnalysis</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#output">4.3.3.1. Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detection-of-water-bridges">4.3.3.2. Detection of water bridges</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-perform-waterbridgeanalysis">4.3.3.3. How to perform WaterBridgeAnalysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">4.3.3.4. Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">7. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">8. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">9. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">10. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">11. Library functions — <code class="docutils literal"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">12. Version information for MDAnalysis - <code class="docutils literal"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">13. Constants and unit conversion — <code class="docutils literal"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">14. Custom exceptions and warnings — <code class="docutils literal"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">15. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../analysis_modules.html">4. Analysis modules</a><ul>
      <li>Previous: <a href="hbond_autocorrel.html" title="previous chapter">4.3.2. Hydrogen bond autocorrelation — <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hbonds.hbond_autocorrel</span></code></a></li>
      <li>Next: <a href="hole.html" title="next chapter">4.4.1. Generation and Analysis of HOLE pore profiles — <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hole</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Matthieu Chavent, Kathleen Clark, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Max Linke, Jinju Lu, Micaela Matta, Robert McGibbon, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Vedant Rathore, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Ayush Suhane, Matteo Tiberti, Isaac Virshup, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/documentation_pages/analysis/wbridge_analysis.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>