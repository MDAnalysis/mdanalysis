

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>6.1. Trajectory Readers and Writers — MDAnalysis.coordinates &mdash; MDAnalysis 1.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="../../_static/js/versions.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 1.1.0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD" href="CRD.html" />
    <link rel="prev" title="6. Coordinates modules" href="../coordinates_modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/mdanalysis-logo-thin.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.1. Trajectory Readers and Writers  — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#readers">6.1.1. Readers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writers">6.1.2. Writers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timesteps">6.1.3. Timesteps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-coordinate-formats">6.1.4. Supported coordinate formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trajectory-api">6.1.5. Trajectory API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#registry">6.1.5.1. Registry</a></li>
<li class="toctree-l4"><a class="reference internal" href="#timestep-class">6.1.5.2. Timestep class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trajectory-reader-class">6.1.5.3. Trajectory Reader class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trajectory-writer-class">6.1.5.4. Trajectory Writer class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-frame-writer-class">6.1.5.5. Single Frame Writer class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CRD.html">6.2. CRD structure files in MDAnalysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.CRD</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="DCD.html">6.3. DCD trajectory I/O  — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DCD</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="DLPoly.html">6.4. DL_Poly format reader <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DLPoly</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="DMS.html">6.5. DESRES file format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DMS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="GMS.html">6.6. GAMESS trajectory reader — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.GMS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="GSD.html">6.7. GSD trajectory reader  — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.GSD</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="GRO.html">6.8. GRO file format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.GRO</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="INPCRD.html">6.9. INPCRD structure files in MDAnalysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.INPCRD</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="LAMMPS.html">6.10. LAMMPS DCD trajectory and DATA I/O  — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.LAMMPS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="MMTF.html">6.11. MMTF trajectory reader — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.MMTF</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="MOL2.html">6.12. MOL2 file format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.MOL2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="NAMDBIN.html">6.13. NAMDBIN files format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.NAMDBIN</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="PDB.html">6.14. PDB structure files in MDAnalysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PDB</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="PDBQT.html">6.15. PDBQT structure files in MDAnalysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PDBQT</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="PQR.html">6.16. PQR file format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PQR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="TRJ.html">6.17. AMBER trajectories — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="TRR.html">6.18. TRR trajectory files — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRR</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="TRZ.html">6.19. TRZ trajectory I/O  — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRZ</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="TXYZ.html">6.20. TXYZ file format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TXYZ</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="XTC.html">6.21. XTC trajectory files — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.XTC</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="XYZ.html">6.22. XYZ trajectory reader — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.XYZ</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="FHIAIMS.html">6.23. FHI-AIMS file format — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.FHIAIMS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html">6.24. Reading trajectories from memory — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="chemfiles.html">6.25. Reading trajectory with Chemfiles — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.chemfiles</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="null.html">6.26. Null output — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.null</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="base.html">6.27. Base classes — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">6.28. Common functions for coordinate reading — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.core</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="chain.html">6.29. ChainReader — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.chain</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="XDR.html">6.30. XDR based trajectory files — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.XDR</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../converters.html">7. Converter modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">8. Trajectory transformations (“on-the-fly” transformations)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">9. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">10. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">11. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">12. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">13. Library functions — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">14. Version information for MDAnalysis - <code class="docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">15. Constants and unit conversion — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">16. Custom exceptions and warnings — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">17. References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MDAnalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../coordinates_modules.html">6. Coordinates modules</a> &raquo;</li>
        
      <li>6.1. Trajectory Readers and Writers  — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.coordinates</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/documentation_pages/coordinates/init.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-MDAnalysis.coordinates.__init__"></span><div class="section" id="trajectory-readers-and-writers-mdanalysis-coordinates">
<h1>6.1. Trajectory Readers and Writers  — <code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates</span></code><a class="headerlink" href="#trajectory-readers-and-writers-mdanalysis-coordinates" title="Permalink to this headline">¶</a></h1>
<p>The coordinates submodule contains code to read, write and store coordinate
information, either single frames (e.g., the <a class="reference internal" href="GRO.html#module-MDAnalysis.coordinates.GRO" title="MDAnalysis.coordinates.GRO"><code class="xref py py-mod docutils literal notranslate"><span class="pre">GRO</span></code></a>
format) or trajectories (such as the <code class="xref py py-mod docutils literal notranslate"><span class="pre">DCD</span></code> format);
see the <a class="reference internal" href="#id2"><span class="std std-ref">Table of supported coordinate formats</span></a> for all formats.</p>
<p>MDAnalysis calls the classes that read a coordinate trajectory and make the
data available <em>“Readers”</em>. Similarly, classes that write out coordinates are
called <em>“Writers”</em>. Readers and Writers provide a common interface to the
underlying coordinate data. This abstraction of coordinate access through an
object-oriented interface is one of the key capabilities of MDAnalysis.</p>
<div class="section" id="readers">
<span id="id1"></span><h2>6.1.1. Readers<a class="headerlink" href="#readers" title="Permalink to this headline">¶</a></h2>
<p>All Readers are based on a <code class="xref py py-class docutils literal notranslate"><span class="pre">ProtoReader</span></code> class that defines a common
<a class="reference internal" href="#trajectory-api"><span class="std std-ref">Trajectory API</span></a> and allows other code to interface with all trajectory
formats in the same way, independent of the details of the trajectory format
itself.</p>
<p>The <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> contains the API entry point
attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Universe.trajectory</span></code> that points to the actual
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ProtoReader" title="MDAnalysis.coordinates.base.ProtoReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProtoReader</span></code></a> object; all Readers are accessible
through this entry point in the same manner (“<a class="reference external" href="http://c2.com/cgi/wiki?DuckTyping">duck typing</a>”).</p>
<p>There are three types of base Reader which act as starting points for each
specific format. These are:</p>
<dl class="docutils">
<dt><a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ReaderBase" title="MDAnalysis.coordinates.base.ReaderBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReaderBase</span></code></a></dt>
<dd>A standard multi frame Reader which allows iteration over a single
file to provide multiple frames of data.  This is used by formats
such as TRR and DCD.</dd>
<dt><a class="reference internal" href="base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase" title="MDAnalysis.coordinates.base.SingleFrameReaderBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingleFrameReaderBase</span></code></a></dt>
<dd>A simplified Reader which reads a file containing only a single
frame of information.  This is used with formats such as GRO
and CRD</dd>
<dt><a class="reference internal" href="chain.html#MDAnalysis.coordinates.chain.ChainReader" title="MDAnalysis.coordinates.chain.ChainReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainReader</span></code></a></dt>
<dd>An advanced Reader designed to read a sequence of files, to
provide iteration over all the frames in each file seamlessly.
This Reader can also provide this functionality over a
sequence of files in different formats.</dd>
</dl>
<p>Normally, one does not explicitly need to select a reader. This is handled
automatically when creating a <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> and
the appropriate reader for the file type is selected (typically by the file
extension but this choice can be overriden with the <code class="docutils literal notranslate"><span class="pre">format</span></code> argument to
<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>).</p>
<p>If additional simulation data is available, it may be added to and read
alongside a trajectory using
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ProtoReader.add_auxiliary" title="MDAnalysis.coordinates.base.ProtoReader.add_auxiliary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_auxiliary()</span></code></a> as described in
the <a class="reference internal" href="../auxiliary/init.html#auxiliary-api"><span class="std std-ref">Auxiliary API</span></a>.</p>
</div>
<div class="section" id="writers">
<span id="writing-trajectories"></span><h2>6.1.2. Writers<a class="headerlink" href="#writers" title="Permalink to this headline">¶</a></h2>
<p>In order to <strong>write coordinates</strong>, a factory function is provided
(<a class="reference internal" href="core.html#MDAnalysis.coordinates.core.writer" title="MDAnalysis.coordinates.core.writer"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.core.writer()</span></code></a>, which is also made available as
<code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.Writer()</span></code>) that returns a <em>Writer</em> appropriate for the desired
file format (as indicated by the filename suffix). Furthermore, a trajectory
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ProtoReader" title="MDAnalysis.coordinates.base.ProtoReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProtoReader</span></code></a> can also have a method
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ProtoReader.Writer" title="MDAnalysis.coordinates.base.ProtoReader.Writer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Writer()</span></code></a> that returns an appropriate
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.WriterBase" title="MDAnalysis.coordinates.base.WriterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">WriterBase</span></code></a> for the file format of the
trajectory.</p>
<p>In analogy to <a class="reference internal" href="core.html#MDAnalysis.coordinates.core.writer" title="MDAnalysis.coordinates.core.writer"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.core.writer()</span></code></a>, there is also a
<a class="reference internal" href="core.html#MDAnalysis.coordinates.core.reader" title="MDAnalysis.coordinates.core.reader"><code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.core.reader()</span></code></a> function available to return a
trajectory <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ProtoReader" title="MDAnalysis.coordinates.base.ProtoReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProtoReader</span></code></a> instance although this
is often not needed because the <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>
class can choose an appropriate reader automatically.</p>
<p>A typical approach is to generate a new trajectory from an old one, e.g., to
only keep the protein:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB</span><span class="p">,</span> <span class="n">XTC</span><span class="p">)</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s2">&quot;protein&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Writer</span><span class="p">(</span><span class="s2">&quot;protein.xtc&quot;</span><span class="p">,</span> <span class="n">protein</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">)</span> <span class="k">as</span> <span class="n">W</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">:</span>
        <span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <code class="xref py py-func docutils literal notranslate"><span class="pre">with()</span></code> statement will automatically close the trajectory when
the last frame has been written.</p>
</div>
<div class="section" id="timesteps">
<h2>6.1.3. Timesteps<a class="headerlink" href="#timesteps" title="Permalink to this headline">¶</a></h2>
<p>Both Readers and Writers use Timesteps as their working object.  A
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> represents all data for a given
frame in a trajectory.  The data inside a
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> is often accessed indirectly
through a <a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> but it is also possible to
manipulate Timesteps directly.</p>
<p>The current <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> can be accessed
through the <code class="xref py py-attr docutils literal notranslate"><span class="pre">ts</span></code> attribute of
the trajectory attached to the active
<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ts</span>
<span class="n">ts</span><span class="o">.</span><span class="n">positions</span>  <span class="c1"># returns a numpy array of positions</span>
</pre></div>
</div>
<p>Most individual formats have slightly different data available in each Timestep
due to differences in individual simulation packages, but all share in common a
broad set of basic data, detailed in <a class="reference internal" href="#timestep-api">Timestep API</a></p>
</div>
<div class="section" id="supported-coordinate-formats">
<h2>6.1.4. Supported coordinate formats<a class="headerlink" href="#supported-coordinate-formats" title="Permalink to this headline">¶</a></h2>
<p>The table below lists the coordinate file formats understood by MDAnalysis. The
emphasis is on formats that are used in popular molecular dynamics codes. By
default, MDAnalysis figures out formats by looking at the extension. Thus, a
DCD file always has to end with “.dcd” to be recognized as such unless the
format is explicitly specified with the <em>format</em> keyword to
<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a> or
<a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe.load_new" title="MDAnalysis.core.universe.Universe.load_new"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_new()</span></code></a>.  A number of files are
also recognized when they are compressed with <strong class="program">gzip</strong> or
<strong class="program">bzip2</strong> such as “.xyz.bz2”.</p>
<span id="id2"></span><table border="1" class="docutils" id="id23">
<caption><span class="caption-text">Table of supported coordinate formats</span><a class="headerlink" href="#id23" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="17%" />
<col width="13%" />
<col width="8%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">extension</th>
<th class="head">IO</th>
<th class="head">remarks</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CHARMM,
NAMD</td>
<td>dcd</td>
<td>r/w</td>
<td>standard CHARMM binary trajectory; endianness is
autodetected. Fixed atoms may not be handled
correctly (requires testing). Module
<a class="reference internal" href="DCD.html#module-MDAnalysis.coordinates.DCD" title="MDAnalysis.coordinates.DCD"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DCD</span></code></a></td>
</tr>
<tr class="row-odd"><td>LAMMPS</td>
<td>dcd</td>
<td>r/w</td>
<td>CHARMM-style binary trajectory; endianness is
autodetected. Units are appropriate for LAMMPS.
Module <a class="reference internal" href="LAMMPS.html#module-MDAnalysis.coordinates.LAMMPS" title="MDAnalysis.coordinates.LAMMPS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.LAMMPS</span></code></a></td>
</tr>
<tr class="row-even"><td>LAMMPS <a class="footnote-reference" href="#a" id="id3">[1]</a></td>
<td>data</td>
<td>r</td>
<td>Single frame of coordinates read from .data files</td>
</tr>
<tr class="row-odd"><td>LAMMPS <a class="footnote-reference" href="#a" id="id4">[1]</a></td>
<td>lammpsdump</td>
<td>r</td>
<td>Ascii trajectory in atom style</td>
</tr>
<tr class="row-even"><td>Gromacs</td>
<td>xtc</td>
<td>r/w</td>
<td>Compressed (lossy) xtc trajectory format. Module
<a class="reference internal" href="XTC.html#module-MDAnalysis.coordinates.XTC" title="MDAnalysis.coordinates.XTC"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.XTC</span></code></a></td>
</tr>
<tr class="row-odd"><td>Gromacs</td>
<td>trr</td>
<td>r/w</td>
<td>Full precision trr trajectory. Coordinates and
velocities are processed. Module
<a class="reference internal" href="TRR.html#module-MDAnalysis.coordinates.TRR" title="MDAnalysis.coordinates.TRR"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRR</span></code></a></td>
</tr>
<tr class="row-even"><td>XYZ <a class="footnote-reference" href="#a" id="id5">[1]</a></td>
<td>xyz</td>
<td>r/w</td>
<td>Generic white-space separate XYZ format; can be
compressed (gzip or bzip2). Module
<a class="reference internal" href="XYZ.html#module-MDAnalysis.coordinates.XYZ" title="MDAnalysis.coordinates.XYZ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.XYZ</span></code></a></td>
</tr>
<tr class="row-odd"><td>TXYZ <a class="footnote-reference" href="#a" id="id6">[1]</a></td>
<td>txyz,
arc</td>
<td>r</td>
<td>Tinker XYZ format.
Module <a class="reference internal" href="TXYZ.html#module-MDAnalysis.coordinates.TXYZ" title="MDAnalysis.coordinates.TXYZ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TXYZ</span></code></a></td>
</tr>
<tr class="row-even"><td>HOOMD <a class="footnote-reference" href="#a" id="id7">[1]</a></td>
<td>gsd</td>
<td>r</td>
<td>HOOMD GSD format (using <a class="reference external" href="https://gsd.readthedocs.io/en/stable/python-module-gsd.hoomd.html#module-gsd.hoomd" title="(in GSD v2.4.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gsd.hoomd</span></code></a>).
Module <a class="reference internal" href="GSD.html#module-MDAnalysis.coordinates.GSD" title="MDAnalysis.coordinates.GSD"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.GSD</span></code></a></td>
</tr>
<tr class="row-odd"><td>GAMESS</td>
<td>gms,
log,
out</td>
<td>r</td>
<td>Generic semi-formatted GAMESS output log; can be
compressed (gzip or bzip2). Module
<a class="reference internal" href="GMS.html#module-MDAnalysis.coordinates.GMS" title="MDAnalysis.coordinates.GMS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.GMS</span></code></a></td>
</tr>
<tr class="row-even"><td>AMBER</td>
<td>trj,
mdcrd</td>
<td>r</td>
<td>formatted (ASCII) trajectories; the presence of a
periodic box is autodetected (<em>experimental</em>).
Module <a class="reference internal" href="TRJ.html#module-MDAnalysis.coordinates.TRJ" title="MDAnalysis.coordinates.TRJ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ</span></code></a></td>
</tr>
<tr class="row-odd"><td>AMBER</td>
<td>inpcrd,
restrt</td>
<td>r</td>
<td>formatted (ASCII) coordinate/restart file
Module <a class="reference internal" href="INPCRD.html#module-MDAnalysis.coordinates.INPCRD" title="MDAnalysis.coordinates.INPCRD"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.INPCRD</span></code></a></td>
</tr>
<tr class="row-even"><td>AMBER</td>
<td>ncdf, nc</td>
<td>r/w</td>
<td>binary (NetCDF) trajectories are fully supported with
optional <a class="reference external" href="https://github.com/Unidata/netcdf4-python">netcdf4-python</a> module (coordinates and
velocities). Module <a class="reference internal" href="TRJ.html#module-MDAnalysis.coordinates.TRJ" title="MDAnalysis.coordinates.TRJ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRJ</span></code></a></td>
</tr>
<tr class="row-odd"><td>Brookhaven
<a class="footnote-reference" href="#a" id="id8">[1]</a></td>
<td>pdb/ent</td>
<td>r/w</td>
<td>a relaxed PDB format (as used in MD simulations)
is read by default; Multiple frames (MODEL)
are supported but require the <em>multiframe</em> keyword.
Module <a class="reference internal" href="PDB.html#module-MDAnalysis.coordinates.PDB" title="MDAnalysis.coordinates.PDB"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PDB</span></code></a></td>
</tr>
<tr class="row-even"><td>XPDB</td>
<td>pdb</td>
<td>r</td>
<td>Extended PDB format (can use 5-digit residue
numbers). To use, specify the format “XPBD”
explicitly: <code class="docutils literal notranslate"><span class="pre">Universe(...,</span> <span class="pre">format=&quot;XPDB&quot;)</span></code>.
Module <a class="reference internal" href="PDB.html#module-MDAnalysis.coordinates.PDB" title="MDAnalysis.coordinates.PDB"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PDB</span></code></a></td>
</tr>
<tr class="row-odd"><td>PDBQT <a class="footnote-reference" href="#a" id="id9">[1]</a></td>
<td>pdbqt</td>
<td>r/w</td>
<td>file format used by AutoDock with atom types <em>t</em>
and partial charges <em>q</em>. Module:
<a class="reference internal" href="PDBQT.html#module-MDAnalysis.coordinates.PDBQT" title="MDAnalysis.coordinates.PDBQT"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PDBQT</span></code></a></td>
</tr>
<tr class="row-even"><td>PQR <a class="footnote-reference" href="#a" id="id10">[1]</a></td>
<td>pqr</td>
<td>r/w</td>
<td>PDB-like but whitespace-separated files with charge
and radius information. Module
<a class="reference internal" href="PQR.html#module-MDAnalysis.coordinates.PQR" title="MDAnalysis.coordinates.PQR"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.PQR</span></code></a></td>
</tr>
<tr class="row-odd"><td><p class="first">GROMOS96</p>
<p class="last"><a class="footnote-reference" href="#a" id="id11">[1]</a></p>
</td>
<td>gro</td>
<td>r/w</td>
<td>basic GROMOS96 format (velocities as well).  Only
the first frame present will be read.
Module <a class="reference internal" href="GRO.html#module-MDAnalysis.coordinates.GRO" title="MDAnalysis.coordinates.GRO"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.GRO</span></code></a></td>
</tr>
<tr class="row-even"><td>CHARMM
CARD <a class="footnote-reference" href="#a" id="id12">[1]</a></td>
<td>crd</td>
<td>r/w</td>
<td>“CARD” coordinate output from CHARMM; deals with
either standard or EXTended format. Module
<a class="reference internal" href="CRD.html#module-MDAnalysis.coordinates.CRD" title="MDAnalysis.coordinates.CRD"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.CRD</span></code></a></td>
</tr>
<tr class="row-odd"><td>DESRES <a class="footnote-reference" href="#a" id="id13">[1]</a></td>
<td>dms</td>
<td>r</td>
<td>DESRES Molecular Structure file format reader.
Module <a class="reference internal" href="DMS.html#module-MDAnalysis.coordinates.DMS" title="MDAnalysis.coordinates.DMS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DMS</span></code></a></td>
</tr>
<tr class="row-even"><td>IBIsCO/YASP</td>
<td>trz</td>
<td>r/w</td>
<td>Binary IBIsCO or YASP trajectories Module
<a class="reference internal" href="TRZ.html#module-MDAnalysis.coordinates.TRZ" title="MDAnalysis.coordinates.TRZ"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.TRZ</span></code></a></td>
</tr>
<tr class="row-odd"><td>MOL2</td>
<td>mol2</td>
<td>r/w</td>
<td>Text-based Tripos molecular structure format
<a class="reference internal" href="MOL2.html#module-MDAnalysis.coordinates.MOL2" title="MDAnalysis.coordinates.MOL2"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.MOL2</span></code></a></td>
</tr>
<tr class="row-even"><td>DL_Poly <a class="footnote-reference" href="#a" id="id14">[1]</a></td>
<td>config</td>
<td>r</td>
<td>DL_Poly ascii config file
<code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DLPOLY</span></code></td>
</tr>
<tr class="row-odd"><td>DL_Poly <a class="footnote-reference" href="#a" id="id15">[1]</a></td>
<td>history</td>
<td>r</td>
<td>DL_Poly ascii history file
<code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DLPOLY</span></code></td>
</tr>
<tr class="row-even"><td>MMTF <a class="footnote-reference" href="#a" id="id16">[1]</a></td>
<td>mmtf</td>
<td>r</td>
<td>Macromolecular Transmission Format
<a class="reference internal" href="MMTF.html#module-MDAnalysis.coordinates.MMTF" title="MDAnalysis.coordinates.MMTF"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.MMTF</span></code></a></td>
</tr>
<tr class="row-odd"><td>NAMD</td>
<td>coor,
namdbin</td>
<td>r/w</td>
<td>NAMD binary file format for coordinates
<a class="reference internal" href="NAMDBIN.html#module-MDAnalysis.coordinates.NAMDBIN" title="MDAnalysis.coordinates.NAMDBIN"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.NAMDBIN</span></code></a></td>
</tr>
<tr class="row-even"><td>FHIAIMS</td>
<td>in</td>
<td>r/w</td>
<td>FHI-AIMS file format for coordinates
<a class="reference internal" href="FHIAIMS.html#module-MDAnalysis.coordinates.FHIAIMS" title="MDAnalysis.coordinates.FHIAIMS"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.FHIAIMS</span></code></a></td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id4">2</a>, <a class="fn-backref" href="#id5">3</a>, <a class="fn-backref" href="#id6">4</a>, <a class="fn-backref" href="#id7">5</a>, <a class="fn-backref" href="#id8">6</a>, <a class="fn-backref" href="#id9">7</a>, <a class="fn-backref" href="#id10">8</a>, <a class="fn-backref" href="#id11">9</a>, <a class="fn-backref" href="#id12">10</a>, <a class="fn-backref" href="#id13">11</a>, <a class="fn-backref" href="#id14">12</a>, <a class="fn-backref" href="#id15">13</a>, <a class="fn-backref" href="#id16">14</a>)</em> This format can also be used to provide basic <em>topology</em>
information (i.e. the list of atoms); it is possible to create a
full <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Universe</span></code></a> by simply
providing a file of this format: <code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">=</span> <span class="pre">Universe(filename)</span></code></td></tr>
</tbody>
</table>
</div>
<div class="section" id="trajectory-api">
<span id="id17"></span><h2>6.1.5. Trajectory API<a class="headerlink" href="#trajectory-api" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Trajectory API</strong> defines how classes have to be structured that allow
reading and writing of coordinate files. By following the API it is possible to
seamlessly enhance the I/O capabilities of MDAnalysis. The actual underlying
I/O code can be written in C or python or a mixture thereof.</p>
<p>Typically, each format resides in its own module, named by the format specifier
(and using upper case by convention).</p>
<p>Reader and Writer classes are derived from base classes in
<a class="reference internal" href="base.html#module-MDAnalysis.coordinates.base" title="MDAnalysis.coordinates.base"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base</span></code></a>.</p>
<div class="section" id="registry">
<h3>6.1.5.1. Registry<a class="headerlink" href="#registry" title="Permalink to this headline">¶</a></h3>
<p>In various places, MDAnalysis tries to automatically select appropriate formats
(e.g. by looking at file extensions). In order to allow it to choose the
correct format, all I/O classes must subclass either
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ReaderBase" title="MDAnalysis.coordinates.base.ReaderBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.ReaderBase</span></code></a>,
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.SingleFrameReaderBase" title="MDAnalysis.coordinates.base.SingleFrameReaderBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.SingleFrameReaderBase</span></code></a>,
or <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.WriterBase" title="MDAnalysis.coordinates.base.WriterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.WriterBase</span></code></a> and set the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">format</span></code> attribute with a string
defining the expected suffix.  To assign multiple suffixes to an I/O class, a
list of suffixes can be given.</p>
<p>In addition to this, a Reader may define a <code class="docutils literal notranslate"><span class="pre">_format_hint</span></code> staticmethod, which
returns a boolean of if it can process a given object. E.g. the
<a class="reference internal" href="memory.html#MDAnalysis.coordinates.memory.MemoryReader" title="MDAnalysis.coordinates.memory.MemoryReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.memory.MemoryReader</span></code></a> identifies itself as
capable of reading numpy arrays.  This functionality is used in
<code class="xref py py-func docutils literal notranslate"><span class="pre">MDAnalysis.core._get_readers.get_reader_for()</span></code> when figuring out how to
read an object (which was usually supplied to mda.Universe).</p>
<p>To define that a Writer can write multiple trajectory frames, set the
<cite>multiframe</cite> attribute to <code class="docutils literal notranslate"><span class="pre">True</span></code>.  The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.
To define that a Writer <em>does not</em> support single frame writing the
<cite>singleframe</cite> attribute can be set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.  This is <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default, ie we assume all Writers can also do a single frame.</p>
</div>
<div class="section" id="timestep-class">
<span id="timestep-api"></span><h3>6.1.5.2. Timestep class<a class="headerlink" href="#timestep-class" title="Permalink to this headline">¶</a></h3>
<p>A Timestep instance holds data for the current frame. It is updated whenever a
new frame of the trajectory is read.</p>
<p>Timestep classes are derived from
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.Timestep</span></code></a>, which is the primary
implementation example (and used directly for the DCDReader).</p>
<p>The discussion on this format is detailed in <a class="reference external" href="https://github.com/MDAnalysis/mdanalysis/issues/250">Issue 250</a></p>
<div class="section" id="methods">
<h4>6.1.5.2.1. Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">__init__(n_atoms,</span> <span class="pre">positions=True,</span> <span class="pre">velocities=False,</span> <span class="pre">forces=False)</span></code></dt>
<dd>Define the number of atoms this Timestep will hold and whether or not
it will have velocity and force information</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__eq__</span></code></dt>
<dd>Compares a Timestep with another</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__getitem__(atoms)</span></code></dt>
<dd>position(s) of atoms; can be a slice or numpy array and then returns
coordinate array</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__len__()</span></code></dt>
<dd>number of coordinates (atoms) in the frame</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__iter__()</span></code></dt>
<dd>iterator over all coordinates</dd>
<dt><code class="docutils literal notranslate"><span class="pre">copy()</span></code></dt>
<dd>deep copy of the instance</dd>
<dt><code class="docutils literal notranslate"><span class="pre">_init_unitcell</span></code></dt>
<dd>hook that returns empty data structure for the unitcell representation
of this particular file format; called from within <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> to
initialize <code class="xref py py-attr docutils literal notranslate"><span class="pre">Timestep._unitcell</span></code>.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="attributes">
<h4>6.1.5.2.2. Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">n_atoms</span></code></dt>
<dd>number of atoms in the frame</dd>
<dt><code class="docutils literal notranslate"><span class="pre">frame</span></code></dt>
<dd>current frame number (0-based)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">_frame</span></code></dt>
<dd>The native frame number of the trajectory.  This can differ from <code class="docutils literal notranslate"><span class="pre">frame</span></code>
as that will always count sequentially from 0 on iteration, whilst
<code class="docutils literal notranslate"><span class="pre">_frame</span></code> is taken directly from the trajectory.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">time</span></code></dt>
<dd>The current system time in ps.  This value is calculated either from a time
set as the Timestep attribute, or from <cite>frame</cite> * <cite>dt</cite>.  Either method allows
allows an offset to be applied to the time.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dt</span></code></dt>
<dd>The change in system time between different frames.  This can be set as an
attribute, but defaults to 1.0 ps.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">data</span></code></dt>
<dd>A dictionary containing all miscellaneous information for the
current Timestep.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">positions</span></code></dt>
<dd>A numpy array of all positions in this Timestep, otherwise raises a
<a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoDataError</span></code></a></dd>
<dt><code class="docutils literal notranslate"><span class="pre">velocities</span></code></dt>
<dd>If present, returns a numpy array of velocities, otherwise raises a
<a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoDataError</span></code></a></dd>
<dt><code class="docutils literal notranslate"><span class="pre">forces</span></code></dt>
<dd>If present, returns a numpy array of forces, otherwise raises a
<a class="reference internal" href="../exceptions.html#MDAnalysis.exceptions.NoDataError" title="MDAnalysis.exceptions.NoDataError"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoDataError</span></code></a></dd>
<dt><code class="docutils literal notranslate"><span class="pre">has_positions</span></code></dt>
<dd>Boolean of whether position data is available</dd>
<dt><code class="docutils literal notranslate"><span class="pre">has_velocities</span></code></dt>
<dd>Boolean of whether velocity data is available</dd>
<dt><code class="docutils literal notranslate"><span class="pre">has_forces</span></code></dt>
<dd>Boolean of whether force data is available</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dimensions</span></code></dt>
<dd><p class="first">system box dimensions (<cite>x, y, z, alpha, beta, gamma</cite>)
(typically implemented as a property because it needs to translate whatever is in the
underlying <code class="xref py py-class docutils literal notranslate"><span class="pre">_unitcell</span></code> attribute. Also
comes with a setter that takes a MDAnalysis box so that one can do</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Timestep</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">]</span>
</pre></div>
</div>
<p class="last">which then converts automatically to the underlying representation and stores it
in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Timestep._unitcell</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">volume</span></code></dt>
<dd>system box volume (derived as the determinant of the box vectors of <code class="docutils literal notranslate"><span class="pre">dimensions</span></code>)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">aux</span></code></dt>
<dd>namespace for the representative values of any added auxiliary data.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="private-attributes">
<h4>6.1.5.2.3. Private attributes<a class="headerlink" href="#private-attributes" title="Permalink to this headline">¶</a></h4>
<p>These attributes are set directly by the underlying trajectory
readers. Normally the user should not have to directly access those,
but instead should use the attribute above.</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">_pos</span></code></dt>
<dd>raw coordinates, a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code> array; <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">=</span> <span class="pre">_pos[:,0],</span> <span class="pre">Y</span> <span class="pre">=</span>
<span class="pre">_pos[:,1],</span> <span class="pre">Z</span> <span class="pre">=</span> <span class="pre">_pos[:,2]</span></code></dd>
<dt><code class="docutils literal notranslate"><span class="pre">_velocities</span></code></dt>
<dd>raw velocities, a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.float32</span></code> array containing velocities
(similar to <code class="docutils literal notranslate"><span class="pre">_pos</span></code>)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">_forces</span></code></dt>
<dd>forces, similar to velocities above.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">_unitcell</span></code></dt>
<dd><p class="first">native unit cell description; the format depends on the
underlying trajectory format. A user should use the
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep.dimensions" title="MDAnalysis.coordinates.base.Timestep.dimensions"><code class="xref py py-class docutils literal notranslate"><span class="pre">dimensions</span></code></a>
attribute to access the data in a canonical format instead of
accessing <code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep._unitcell</span></code> directly.</p>
<p class="last">The method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Timestep._init_unitcell()</span></code> is a hook to initialize
this attribute.</p>
</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="trajectory-reader-class">
<h3>6.1.5.3. Trajectory Reader class<a class="headerlink" href="#trajectory-reader-class" title="Permalink to this headline">¶</a></h3>
<p>Trajectory readers are derived from <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.ReaderBase" title="MDAnalysis.coordinates.base.ReaderBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.ReaderBase</span></code></a>.
Typically, many methods and attributes are overriden.</p>
<div class="section" id="id18">
<h4>6.1.5.3.1. Methods<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="DCD.html#MDAnalysis.coordinates.DCD.DCDReader" title="MDAnalysis.coordinates.DCD.DCDReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.DCD.DCDReader</span></code></a> class is the primary
implementation example.</p>
<p><strong>Mandatory methods</strong></p>
<p>The following methods must be implemented in a Reader class.</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">__init__(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd><p class="first">open <em>filename</em>; other <em>kwargs</em> are processed as needed and the
Reader is free to ignore them. Typically, when MDAnalysis creates
a Reader from <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> it supplies as much
information as possible in <cite>kwargs</cite>; at the moment the following
data are supplied:</p>
<blockquote class="last">
<div><ul class="simple">
<li><dl class="first docutils">
<dt><em>n_atoms</em>: the number of atoms from the supplied topology.  This is</dt>
<dd>not required for all readers and can be ignored if not
required.</dd>
</dl>
</li>
</ul>
</div></blockquote>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__iter__()</span></code></dt>
<dd><p class="first">allow iteration from beginning to end:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">trajectory</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">close()</span></code></dt>
<dd>close the file and cease I/O</dd>
<dt><code class="docutils literal notranslate"><span class="pre">next()</span></code></dt>
<dd>advance to next time step or raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.9)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IOError</span></code></a> when moving
past the last frame</dd>
<dt><code class="docutils literal notranslate"><span class="pre">rewind()</span></code></dt>
<dd>reposition to first frame</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__entry__()</span></code></dt>
<dd>entry method of a <a class="reference external" href="http://docs.python.org/2/reference/datamodel.html#context-managers">Context Manager</a> (returns self)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__exit__()</span></code></dt>
<dd>exit method of a <a class="reference external" href="http://docs.python.org/2/reference/datamodel.html#context-managers">Context Manager</a>, should call <code class="docutils literal notranslate"><span class="pre">close()</span></code>.</dd>
</dl>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a <code class="docutils literal notranslate"><span class="pre">__del__()</span></code> method should also be present to ensure that the
trajectory is properly closed. However, certain types of Reader can ignore
this requirement. These include the <code class="xref py py-class docutils literal notranslate"><span class="pre">SingleFrameReaderBase</span></code> (file reading
is done within a context manager and needs no closing by hand) and the <code class="xref py py-class docutils literal notranslate"><span class="pre">ChainReader</span></code>
(it is a collection of Readers, each already with its own <code class="docutils literal notranslate"><span class="pre">__del__</span></code> method).</p>
</div>
<p><strong>Optional methods</strong></p>
<p>Not all trajectory formats support the following methods, either because the
data are not available or the methods have not been implemented. Code should
deal with missing methods gracefully.</p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">__len__()</span></code></dt>
<dd>number of frames in trajectory</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__getitem__(arg)</span></code></dt>
<dd><p class="first">advance to time step <cite>arg</cite> = <cite>frame</cite> and return <code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code>; or if <cite>arg</cite> is a
slice, then return an iterable over that part of the trajectory.</p>
<p>The first functionality allows one to randomly access frames in the
trajectory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">314</span><span class="p">]</span>
</pre></div>
</div>
<p>would load frame 314 into the current <code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code>.</p>
<p>Using slices allows iteration over parts of a trajectory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">2000</span><span class="p">]:</span>
    <span class="n">process_frame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>   <span class="c1"># do some analysis on ts</span>
</pre></div>
</div>
<p>or skipping frames</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">universe</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">1000</span><span class="p">::</span><span class="mi">100</span><span class="p">]:</span>
    <span class="n">process_frame</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>   <span class="c1"># do some analysis on ts</span>
</pre></div>
</div>
<p>The last example starts reading the trajectory at frame 1000 and
reads every 100th frame until the end.</p>
<p>A sequence of indices or a mask of booleans can also be provided to index
a trajectory.</p>
<p>The performance of the <code class="docutils literal notranslate"><span class="pre">__getitem__()</span></code> method depends on the underlying
trajectory reader and if it can implement random access to frames. In many
cases this is not easily (or reliably) implementable and thus one is
restricted to sequential iteration.</p>
<p>If the Reader is not able to provide random access to frames then it
should raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> on indexing. It is possible to partially
implement <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code> (as done on
<code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.ProtoReader.__getitem__</span></code> where slicing the
full trajectory is equivalent to
<code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.ProtoReader.__iter__</span></code> (which is always
implemented) and other slices raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.9)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a>.</p>
<p class="last">When indexed with a slice, a sequence of indices, or a mask of booleans,
the return value is an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">FrameIteratorSliced</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">FrameIteratorIndices</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">parse_n_atoms(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd>Provide the number of atoms in the trajectory file, allowing the Reader
to be used to provide an extremely minimal Topology.
Must be implemented as either a staticmethod or a classmethod.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Writer(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd><p class="first">returns a <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.WriterBase" title="MDAnalysis.coordinates.base.WriterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">WriterBase</span></code></a> which is set up with
the same parameters as the trajectory that is being read (e.g. time step,
length etc), which facilitates copying and simple on-the-fly manipulation.</p>
<p>If no Writer is defined then a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code></a> is raised.</p>
<p class="last">The <em>kwargs</em> can be used to customize the Writer as they are typically
passed through to the init method of the Writer, with sensible defaults
filled in; the actual keyword arguments depend on the Writer.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">timeseries(atomGroup,</span> <span class="pre">[start[,stop[,skip[,format]]]])</span></code></dt>
<dd>returns a subset of coordinate data</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="id19">
<h4>6.1.5.3.2. Attributes<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">filename</span></code></dt>
<dd>filename of the trajectory</dd>
<dt><code class="docutils literal notranslate"><span class="pre">n_atoms</span></code></dt>
<dd>number of atoms (coordinate sets) in a frame (constant)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">n_frames</span></code></dt>
<dd>total number of frames (if known) – <code class="docutils literal notranslate"><span class="pre">None</span></code> if not known</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ts</span></code></dt>
<dd>the <code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code> object; typically customized for each
trajectory format and derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">base.Timestep</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">units</span></code></dt>
<dd>dictionary with keys <em>time</em>, <em>length</em>, <em>speed</em>, <em>force</em> and the
appropriate unit (e.g. ‘AKMA’ and ‘Angstrom’ for Charmm dcds, ‘ps’ and
‘nm’ for Gromacs trajectories, <code class="docutils literal notranslate"><span class="pre">None</span></code> and ‘Angstrom’ for PDB).
Any field not used should be set to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">format</span></code></dt>
<dd>string that identifies the file format, e.g. “DCD”, “PDB”, “CRD”, “XTC”,
“TRR”; this is typically the file extension in upper case.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dt</span></code></dt>
<dd>time between frames in ps; a managed attribute (read only) that computes
on the fly <code class="docutils literal notranslate"><span class="pre">skip_timestep</span> <span class="pre">*</span> <span class="pre">delta</span></code> and converts to the MDAnalysis base
unit for time (pico seconds by default)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">totaltime</span></code></dt>
<dd>total length of the trajectory = <code class="docutils literal notranslate"><span class="pre">n_frames</span> <span class="pre">*</span> <span class="pre">dt</span></code></dd>
<dt><code class="docutils literal notranslate"><span class="pre">time</span></code></dt>
<dd>time of the current time step, in MDAnalysis time units (ps)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">frame</span></code></dt>
<dd>frame number of the current time step (0-based)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">aux_list</span></code></dt>
<dd>list of the names of any added auxiliary data.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">_auxs</span></code></dt>
<dd>dictionary of the <a class="reference internal" href="../auxiliary/base.html#MDAnalysis.auxiliary.base.AuxReader" title="MDAnalysis.auxiliary.base.AuxReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">AuxReader</span></code></a>
instances for any added auxiliary data.</dd>
</dl>
</div></blockquote>
<p><strong>Optional attributes</strong></p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">delta</span></code></dt>
<dd>integrator time step (in native units); hence the “length”
of a trajctory frame is  <code class="docutils literal notranslate"><span class="pre">skip_timestep*delta</span></code> time units</dd>
<dt><code class="docutils literal notranslate"><span class="pre">compressed</span></code></dt>
<dd>string that identifies the compression (e.g. “gz” or “bz2”) or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fixed</span></code></dt>
<dd>bool, saying if there are fixed atoms (e.g. dcds)</dd>
<dt><code class="docutils literal notranslate"><span class="pre">periodic</span></code></dt>
<dd>boolean saying if contains box information for periodic boundary conditions
unit cell information is stored in attribute <cite>dimensions</cite></dd>
<dt><code class="docutils literal notranslate"><span class="pre">skip_timestep</span></code></dt>
<dd>number of integrator steps between frames + 1 (i.e.
the stride at which the MD simulation was sampled)</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="trajectory-writer-class">
<h3>6.1.5.4. Trajectory Writer class<a class="headerlink" href="#trajectory-writer-class" title="Permalink to this headline">¶</a></h3>
<p>Trajectory writers are derived from
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.WriterBase" title="MDAnalysis.coordinates.base.WriterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.coordinates.base.WriterBase</span></code></a>. They are used to write
multiple frames to a trajectory file. Every time the
<a class="reference internal" href="base.html#MDAnalysis.coordinates.base.WriterBase.write" title="MDAnalysis.coordinates.base.WriterBase.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> method is called,
another frame is appended to the trajectory.</p>
<p>Typically, many methods and attributes are overriden.</p>
<p>Signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">TrajectoryWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
    <span class="n">w</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Universe</span><span class="p">)</span>    <span class="c1"># write a whole universe</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AtomGroup</span><span class="p">)</span>  <span class="c1"># write a selection of Atoms from Universe</span>
</pre></div>
</div>
<div class="section" id="id20">
<h4>6.1.5.4.1. Methods<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">__init__(filename,n_atoms[,start[,step[,delta[,remarks]]]])</span></code></dt>
<dd>opens <em>filename</em> and writes header if required by format</dd>
<dt><code class="docutils literal notranslate"><span class="pre">write(obj)</span></code></dt>
<dd>write Timestep data in <em>obj</em></dd>
<dt><code class="docutils literal notranslate"><span class="pre">convert_dimensions_to_unitcell(timestep)</span></code></dt>
<dd>take the dimensions from the timestep and convert to the native
unitcell representation of the format</dd>
<dt><code class="docutils literal notranslate"><span class="pre">close()</span></code></dt>
<dd>close file and finish I/O</dd>
<dt><code class="docutils literal notranslate"><span class="pre">__del__()</span></code></dt>
<dd>ensures that close() is called</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="id21">
<h4>6.1.5.4.2. Attributes<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">filename</span></code></dt>
<dd>name of the trajectory file</dd>
<dt><code class="docutils literal notranslate"><span class="pre">start,</span> <span class="pre">stop,</span> <span class="pre">step</span></code></dt>
<dd>first and last frame number (0-based) and step</dd>
<dt><code class="docutils literal notranslate"><span class="pre">units</span></code></dt>
<dd>dictionary with keys <em>time</em>, <em>length</em>, <em>speed</em>, <em>force</em> and the
appropriate unit (e.g. ‘AKMA’ and ‘Angstrom’ for Charmm dcds, ‘ps’ and
‘nm’ for Gromacs trajectories, <code class="docutils literal notranslate"><span class="pre">None</span></code> and ‘Angstrom’ for PDB).
Any field not used should be set to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</dd>
<dt><code class="docutils literal notranslate"><span class="pre">format</span></code></dt>
<dd>string that identifies the file format, e.g. “DCD”, “PDB”, “CRD”, “XTC”,
“TRR”</dd>
</dl>
</div></blockquote>
<p><strong>Optional</strong></p>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">ts</span></code></dt>
<dd><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code> instance</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="single-frame-writer-class">
<h3>6.1.5.5. Single Frame Writer class<a class="headerlink" href="#single-frame-writer-class" title="Permalink to this headline">¶</a></h3>
<p>A single frame writer is a special case of a trajectory writer in that it
writes only a single coordinate frame to a file, for instance, a pdb or gro
file. Unlike trajectory formats, which only contains coordinates, <em>single
frame</em> formats contain much more information (e.g. atom and residue names and
numbers) and hence it is possible to write selections of atoms in a meaningful
way.</p>
<p>Signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">W</span> <span class="o">=</span> <span class="n">FrameWriter</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">AtomGroup</span><span class="p">)</span>
<span class="n">W</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Universe</span><span class="p">)</span>
</pre></div>
</div>
<p>The blanket <em>kwargs</em> is required so that one can pass the same kind of
arguments (filename and n_atoms) as for the Trajectory writers. In
this way, the simple <a class="reference internal" href="core.html#MDAnalysis.coordinates.core.writer" title="MDAnalysis.coordinates.core.writer"><code class="xref py py-func docutils literal notranslate"><span class="pre">writer()</span></code></a>
factory function can be used for all writers.</p>
<div class="section" id="id22">
<h4>6.1.5.5.1. Methods<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt><code class="docutils literal notranslate"><span class="pre">__init__(filename,</span> <span class="pre">**kwargs)</span></code></dt>
<dd>opens <em>filename</em> for writing; <cite>kwargs</cite> are typically ignored</dd>
<dt><code class="docutils literal notranslate"><span class="pre">write(obj)</span></code></dt>
<dd>writes the object <em>obj</em>, containing a
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup" title="MDAnalysis.core.groups.AtomGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">AtomGroup</span></code></a> group of atoms (typically
obtained from a selection) or <a class="reference internal" href="../core/universe.html#MDAnalysis.core.universe.Universe" title="MDAnalysis.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">Universe</span></code></a>
to the file and closes the file</dd>
</dl>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Trajectory and Frame writers can be used in almost exactly the same
manner with the one difference that Frame writers cannot deal with
raw <a class="reference internal" href="base.html#MDAnalysis.coordinates.base.Timestep" title="MDAnalysis.coordinates.base.Timestep"><code class="xref py py-class docutils literal notranslate"><span class="pre">Timestep</span></code></a> objects.</p>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="CRD.html" class="btn btn-neutral float-right" title="6.2. CRD structure files in MDAnalysis — MDAnalysis.coordinates.CRD" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../coordinates_modules.html" class="btn btn-neutral float-left" title="6. Coordinates modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2005-2021, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Irfan Alibay, Anshul Angaria, Luís Pedro Borges Araújo, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Ninad Bhat, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Cédric Bouysset, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Yuanyu Chang, Matthieu Chavent, Haochuan Chen, Kathleen Clark, Charlie Cook, Ruggero Cortini, Nicholas Craven, Ramon Crehuet, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Ali Ehlen, Shujie Fan, Lennard van der Feltz, Philip Fowler, Guillaume Fraux, William Glass, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Ameya Harmalkar, Ivan Hristov, Eugen Hruska, Kyle J. Huston, Siddharth Jain, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Abhishek A. Kognole, Max Linke, Philip Loche, Jinju Lu, Hugo MacDermott-Opeskin, Micaela Matta, Andrew R. McCluskey, Robert McGibbon, Rocco Meli, Manuel Nuno Melo, Dominik &#39;Rathann&#39; Mierzejewski, Henry Mull, Morgan L. Nance, Fiona B. Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Daniele Padula, Nabarun Pal, Mattia F. Palermo, Danny Parton, Shakul Pathak, Joshua L. Phillips, Kashish Punjani, Michael Quevillon, Vedant Rathore, Tyler Reddy, Pedro Reis, Paul Rigor, Andrea Rizzi, Carlos Yanez S., Utkarsh Saxena, Marcello Sega, Sean L. Seyler, Faraaz Shah, Abhishek Shandilya, Shubham Sharma, Paul Smith, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Fenil Suchak, Ayush Suhane, Matthijs Tadema, Joao Miguel Correia Teixeira, Xiki Tempula, Matthew W. Thompson, Hao Tian, Matteo Tiberti, Wiep van der Toorn, Isaac Virshup, Lily Wang, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, Yibo Zhang, Yuxuan Zhuang, and Oliver Beckstein.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = 'https://docs.mdanalysis.org/versions.json'
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        1.1.0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>